var sO=Object.defineProperty;var ZC=i=>{throw TypeError(i)};var aO=(i,e,t)=>e in i?sO(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var it=(i,e,t)=>aO(i,typeof e!="symbol"?e+"":e,t),M2=(i,e,t)=>e.has(i)||ZC("Cannot "+t);var v=(i,e,t)=>(M2(i,e,"read from private field"),t?t.call(i):e.get(i)),q=(i,e,t)=>e.has(i)?ZC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),H=(i,e,t,r)=>(M2(i,e,"write to private field"),r?r.call(i,t):e.set(i,t),t),X=(i,e,t)=>(M2(i,e,"access private method"),t);var Bi=(i,e,t,r)=>({set _(n){H(i,e,n,t)},get _(){return v(i,e,r)}});function oO(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var Li=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Do(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var j2={exports:{}},km={},B2={exports:{}},or={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QC;function lO(){if(QC)return or;QC=1;var i=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function m(V){return V===null||typeof V!="object"?null:(V=f&&V[f]||V["@@iterator"],typeof V=="function"?V:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,g={};function y(V,K,be){this.props=V,this.context=K,this.refs=g,this.updater=be||p}y.prototype.isReactComponent={},y.prototype.setState=function(V,K){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,K,"setState")},y.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function b(){}b.prototype=y.prototype;function _(V,K,be){this.props=V,this.context=K,this.refs=g,this.updater=be||p}var S=_.prototype=new b;S.constructor=_,x(S,y.prototype),S.isPureReactComponent=!0;var k=Array.isArray,C=Object.prototype.hasOwnProperty,R={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function O(V,K,be){var Ae,ce={},Pe=null,Ve=null;if(K!=null)for(Ae in K.ref!==void 0&&(Ve=K.ref),K.key!==void 0&&(Pe=""+K.key),K)C.call(K,Ae)&&!N.hasOwnProperty(Ae)&&(ce[Ae]=K[Ae]);var $e=arguments.length-2;if($e===1)ce.children=be;else if(1<$e){for(var qe=Array($e),Ze=0;Ze<$e;Ze++)qe[Ze]=arguments[Ze+2];ce.children=qe}if(V&&V.defaultProps)for(Ae in $e=V.defaultProps,$e)ce[Ae]===void 0&&(ce[Ae]=$e[Ae]);return{$$typeof:i,type:V,key:Pe,ref:Ve,props:ce,_owner:R.current}}function I(V,K){return{$$typeof:i,type:V.type,key:K,ref:V.ref,props:V.props,_owner:V._owner}}function F(V){return typeof V=="object"&&V!==null&&V.$$typeof===i}function G(V){var K={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(be){return K[be]})}var B=/\/+/g;function Y(V,K){return typeof V=="object"&&V!==null&&V.key!=null?G(""+V.key):K.toString(36)}function j(V,K,be,Ae,ce){var Pe=typeof V;(Pe==="undefined"||Pe==="boolean")&&(V=null);var Ve=!1;if(V===null)Ve=!0;else switch(Pe){case"string":case"number":Ve=!0;break;case"object":switch(V.$$typeof){case i:case e:Ve=!0}}if(Ve)return Ve=V,ce=ce(Ve),V=Ae===""?"."+Y(Ve,0):Ae,k(ce)?(be="",V!=null&&(be=V.replace(B,"$&/")+"/"),j(ce,K,be,"",function(Ze){return Ze})):ce!=null&&(F(ce)&&(ce=I(ce,be+(!ce.key||Ve&&Ve.key===ce.key?"":(""+ce.key).replace(B,"$&/")+"/")+V)),K.push(ce)),1;if(Ve=0,Ae=Ae===""?".":Ae+":",k(V))for(var $e=0;$e<V.length;$e++){Pe=V[$e];var qe=Ae+Y(Pe,$e);Ve+=j(Pe,K,be,qe,ce)}else if(qe=m(V),typeof qe=="function")for(V=qe.call(V),$e=0;!(Pe=V.next()).done;)Pe=Pe.value,qe=Ae+Y(Pe,$e++),Ve+=j(Pe,K,be,qe,ce);else if(Pe==="object")throw K=String(V),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Ve}function ae(V,K,be){if(V==null)return V;var Ae=[],ce=0;return j(V,Ae,"","",function(Pe){return K.call(be,Pe,ce++)}),Ae}function he(V){if(V._status===-1){var K=V._result;K=K(),K.then(function(be){(V._status===0||V._status===-1)&&(V._status=1,V._result=be)},function(be){(V._status===0||V._status===-1)&&(V._status=2,V._result=be)}),V._status===-1&&(V._status=0,V._result=K)}if(V._status===1)return V._result.default;throw V._result}var ee={current:null},Z={transition:null},ie={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:Z,ReactCurrentOwner:R};function ge(){throw Error("act(...) is not supported in production builds of React.")}return or.Children={map:ae,forEach:function(V,K,be){ae(V,function(){K.apply(this,arguments)},be)},count:function(V){var K=0;return ae(V,function(){K++}),K},toArray:function(V){return ae(V,function(K){return K})||[]},only:function(V){if(!F(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},or.Component=y,or.Fragment=t,or.Profiler=n,or.PureComponent=_,or.StrictMode=r,or.Suspense=l,or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,or.act=ge,or.cloneElement=function(V,K,be){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var Ae=x({},V.props),ce=V.key,Pe=V.ref,Ve=V._owner;if(K!=null){if(K.ref!==void 0&&(Pe=K.ref,Ve=R.current),K.key!==void 0&&(ce=""+K.key),V.type&&V.type.defaultProps)var $e=V.type.defaultProps;for(qe in K)C.call(K,qe)&&!N.hasOwnProperty(qe)&&(Ae[qe]=K[qe]===void 0&&$e!==void 0?$e[qe]:K[qe])}var qe=arguments.length-2;if(qe===1)Ae.children=be;else if(1<qe){$e=Array(qe);for(var Ze=0;Ze<qe;Ze++)$e[Ze]=arguments[Ze+2];Ae.children=$e}return{$$typeof:i,type:V.type,key:ce,ref:Pe,props:Ae,_owner:Ve}},or.createContext=function(V){return V={$$typeof:a,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:s,_context:V},V.Consumer=V},or.createElement=O,or.createFactory=function(V){var K=O.bind(null,V);return K.type=V,K},or.createRef=function(){return{current:null}},or.forwardRef=function(V){return{$$typeof:o,render:V}},or.isValidElement=F,or.lazy=function(V){return{$$typeof:h,_payload:{_status:-1,_result:V},_init:he}},or.memo=function(V,K){return{$$typeof:c,type:V,compare:K===void 0?null:K}},or.startTransition=function(V){var K=Z.transition;Z.transition={};try{V()}finally{Z.transition=K}},or.unstable_act=ge,or.useCallback=function(V,K){return ee.current.useCallback(V,K)},or.useContext=function(V){return ee.current.useContext(V)},or.useDebugValue=function(){},or.useDeferredValue=function(V){return ee.current.useDeferredValue(V)},or.useEffect=function(V,K){return ee.current.useEffect(V,K)},or.useId=function(){return ee.current.useId()},or.useImperativeHandle=function(V,K,be){return ee.current.useImperativeHandle(V,K,be)},or.useInsertionEffect=function(V,K){return ee.current.useInsertionEffect(V,K)},or.useLayoutEffect=function(V,K){return ee.current.useLayoutEffect(V,K)},or.useMemo=function(V,K){return ee.current.useMemo(V,K)},or.useReducer=function(V,K,be){return ee.current.useReducer(V,K,be)},or.useRef=function(V){return ee.current.useRef(V)},or.useState=function(V){return ee.current.useState(V)},or.useSyncExternalStore=function(V,K,be){return ee.current.useSyncExternalStore(V,K,be)},or.useTransition=function(){return ee.current.useTransition()},or.version="18.3.1",or}var JC;function yw(){return JC||(JC=1,B2.exports=lO()),B2.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ek;function uO(){if(ek)return km;ek=1;var i=yw(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,f={},m=null,p=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(p=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:p,props:f,_owner:n.current}}return km.Fragment=t,km.jsx=a,km.jsxs=a,km}var tk;function cO(){return tk||(tk=1,j2.exports=uO()),j2.exports}var E=cO(),T=yw();const st=Do(T),rk=oO({__proto__:null,default:st},[T]);var Ry={},z2={exports:{}},ls={},$2={exports:{}},U2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nk;function dO(){return nk||(nk=1,function(i){function e(Z,ie){var ge=Z.length;Z.push(ie);e:for(;0<ge;){var V=ge-1>>>1,K=Z[V];if(0<n(K,ie))Z[V]=ie,Z[ge]=K,ge=V;else break e}}function t(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var ie=Z[0],ge=Z.pop();if(ge!==ie){Z[0]=ge;e:for(var V=0,K=Z.length,be=K>>>1;V<be;){var Ae=2*(V+1)-1,ce=Z[Ae],Pe=Ae+1,Ve=Z[Pe];if(0>n(ce,ge))Pe<K&&0>n(Ve,ce)?(Z[V]=Ve,Z[Pe]=ge,V=Pe):(Z[V]=ce,Z[Ae]=ge,V=Ae);else if(Pe<K&&0>n(Ve,ge))Z[V]=Ve,Z[Pe]=ge,V=Pe;else break e}}return ie}function n(Z,ie){var ge=Z.sortIndex-ie.sortIndex;return ge!==0?ge:Z.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,f=null,m=3,p=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Z){for(var ie=t(c);ie!==null;){if(ie.callback===null)r(c);else if(ie.startTime<=Z)r(c),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=t(c)}}function k(Z){if(g=!1,S(Z),!x)if(t(l)!==null)x=!0,he(C);else{var ie=t(c);ie!==null&&ee(k,ie.startTime-Z)}}function C(Z,ie){x=!1,g&&(g=!1,b(O),O=-1),p=!0;var ge=m;try{for(S(ie),f=t(l);f!==null&&(!(f.expirationTime>ie)||Z&&!G());){var V=f.callback;if(typeof V=="function"){f.callback=null,m=f.priorityLevel;var K=V(f.expirationTime<=ie);ie=i.unstable_now(),typeof K=="function"?f.callback=K:f===t(l)&&r(l),S(ie)}else r(l);f=t(l)}if(f!==null)var be=!0;else{var Ae=t(c);Ae!==null&&ee(k,Ae.startTime-ie),be=!1}return be}finally{f=null,m=ge,p=!1}}var R=!1,N=null,O=-1,I=5,F=-1;function G(){return!(i.unstable_now()-F<I)}function B(){if(N!==null){var Z=i.unstable_now();F=Z;var ie=!0;try{ie=N(!0,Z)}finally{ie?Y():(R=!1,N=null)}}else R=!1}var Y;if(typeof _=="function")Y=function(){_(B)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,ae=j.port2;j.port1.onmessage=B,Y=function(){ae.postMessage(null)}}else Y=function(){y(B,0)};function he(Z){N=Z,R||(R=!0,Y())}function ee(Z,ie){O=y(function(){Z(i.unstable_now())},ie)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Z){Z.callback=null},i.unstable_continueExecution=function(){x||p||(x=!0,he(C))},i.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Z?Math.floor(1e3/Z):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var ie=3;break;default:ie=m}var ge=m;m=ie;try{return Z()}finally{m=ge}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Z,ie){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ge=m;m=Z;try{return ie()}finally{m=ge}},i.unstable_scheduleCallback=function(Z,ie,ge){var V=i.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?V+ge:V):ge=V,Z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ge+K,Z={id:h++,callback:ie,priorityLevel:Z,startTime:ge,expirationTime:K,sortIndex:-1},ge>V?(Z.sortIndex=ge,e(c,Z),t(l)===null&&Z===t(c)&&(g?(b(O),O=-1):g=!0,ee(k,ge-V))):(Z.sortIndex=K,e(l,Z),x||p||(x=!0,he(C))),Z},i.unstable_shouldYield=G,i.unstable_wrapCallback=function(Z){var ie=m;return function(){var ge=m;m=ie;try{return Z.apply(this,arguments)}finally{m=ge}}}}(U2)),U2}var ik;function hO(){return ik||(ik=1,$2.exports=dO()),$2.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sk;function fO(){if(sk)return ls;sk=1;var i=yw(),e=hO();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,w=1;w<arguments.length;w++)d+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,n={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(n[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(u){return l.call(f,u)?!0:l.call(h,u)?!1:c.test(u)?f[u]=!0:(h[u]=!0,!1)}function p(u,d,w,A){if(w!==null&&w.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return A?!1:w!==null?!w.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function x(u,d,w,A){if(d===null||typeof d>"u"||p(u,d,w,A))return!0;if(A)return!1;if(w!==null)switch(w.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function g(u,d,w,A,D,M,Q){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=A,this.attributeNamespace=D,this.mustUseProperty=w,this.propertyName=u,this.type=d,this.sanitizeURL=M,this.removeEmptyString=Q}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){y[u]=new g(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];y[d]=new g(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){y[u]=new g(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){y[u]=new g(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){y[u]=new g(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){y[u]=new g(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){y[u]=new g(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){y[u]=new g(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){y[u]=new g(u,5,!1,u.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function _(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(b,_);y[d]=new g(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(b,_);y[d]=new g(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(b,_);y[d]=new g(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){y[u]=new g(u,1,!1,u.toLowerCase(),null,!1,!1)}),y.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){y[u]=new g(u,1,!1,u.toLowerCase(),null,!0,!0)});function S(u,d,w,A){var D=y.hasOwnProperty(d)?y[d]:null;(D!==null?D.type!==0:A||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(x(d,w,D,A)&&(w=null),A||D===null?m(d)&&(w===null?u.removeAttribute(d):u.setAttribute(d,""+w)):D.mustUseProperty?u[D.propertyName]=w===null?D.type===3?!1:"":w:(d=D.attributeName,A=D.attributeNamespace,w===null?u.removeAttribute(d):(D=D.type,w=D===3||D===4&&w===!0?"":""+w,A?u.setAttributeNS(A,d,w):u.setAttribute(d,w))))}var k=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),R=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),G=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),Z=Symbol.iterator;function ie(u){return u===null||typeof u!="object"?null:(u=Z&&u[Z]||u["@@iterator"],typeof u=="function"?u:null)}var ge=Object.assign,V;function K(u){if(V===void 0)try{throw Error()}catch(w){var d=w.stack.trim().match(/\n( *(at )?)/);V=d&&d[1]||""}return`
`+V+u}var be=!1;function Ae(u,d){if(!u||be)return"";be=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(He){var A=He}Reflect.construct(u,[],d)}else{try{d.call()}catch(He){A=He}u.call(d.prototype)}else{try{throw Error()}catch(He){A=He}u()}}catch(He){if(He&&A&&typeof He.stack=="string"){for(var D=He.stack.split(`
`),M=A.stack.split(`
`),Q=D.length-1,fe=M.length-1;1<=Q&&0<=fe&&D[Q]!==M[fe];)fe--;for(;1<=Q&&0<=fe;Q--,fe--)if(D[Q]!==M[fe]){if(Q!==1||fe!==1)do if(Q--,fe--,0>fe||D[Q]!==M[fe]){var xe=`
`+D[Q].replace(" at new "," at ");return u.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",u.displayName)),xe}while(1<=Q&&0<=fe);break}}}finally{be=!1,Error.prepareStackTrace=w}return(u=u?u.displayName||u.name:"")?K(u):""}function ce(u){switch(u.tag){case 5:return K(u.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return u=Ae(u.type,!1),u;case 11:return u=Ae(u.type.render,!1),u;case 1:return u=Ae(u.type,!0),u;default:return""}}function Pe(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case N:return"Fragment";case R:return"Portal";case I:return"Profiler";case O:return"StrictMode";case Y:return"Suspense";case j:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case G:return(u.displayName||"Context")+".Consumer";case F:return(u._context.displayName||"Context")+".Provider";case B:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ae:return d=u.displayName||null,d!==null?d:Pe(u.type)||"Memo";case he:d=u._payload,u=u._init;try{return Pe(u(d))}catch{}}return null}function Ve(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(d);case 8:return d===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function $e(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function qe(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Ze(u){var d=qe(u)?"checked":"value",w=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),A=""+u[d];if(!u.hasOwnProperty(d)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var D=w.get,M=w.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return D.call(this)},set:function(Q){A=""+Q,M.call(this,Q)}}),Object.defineProperty(u,d,{enumerable:w.enumerable}),{getValue:function(){return A},setValue:function(Q){A=""+Q},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function at(u){u._valueTracker||(u._valueTracker=Ze(u))}function gt(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var w=d.getValue(),A="";return u&&(A=qe(u)?u.checked?"true":"false":u.value),u=A,u!==w?(d.setValue(u),!0):!1}function ut(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function z(u,d){var w=d.checked;return ge({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??u._wrapperState.initialChecked})}function Le(u,d){var w=d.defaultValue==null?"":d.defaultValue,A=d.checked!=null?d.checked:d.defaultChecked;w=$e(d.value!=null?d.value:w),u._wrapperState={initialChecked:A,initialValue:w,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function _e(u,d){d=d.checked,d!=null&&S(u,"checked",d,!1)}function ue(u,d){_e(u,d);var w=$e(d.value),A=d.type;if(w!=null)A==="number"?(w===0&&u.value===""||u.value!=w)&&(u.value=""+w):u.value!==""+w&&(u.value=""+w);else if(A==="submit"||A==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?le(u,d.type,w):d.hasOwnProperty("defaultValue")&&le(u,d.type,$e(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function oe(u,d,w){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var A=d.type;if(!(A!=="submit"&&A!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,w||d===u.value||(u.value=d),u.defaultValue=d}w=u.name,w!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,w!==""&&(u.name=w)}function le(u,d,w){(d!=="number"||ut(u.ownerDocument)!==u)&&(w==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+w&&(u.defaultValue=""+w))}var Oe=Array.isArray;function Te(u,d,w,A){if(u=u.options,d){d={};for(var D=0;D<w.length;D++)d["$"+w[D]]=!0;for(w=0;w<u.length;w++)D=d.hasOwnProperty("$"+u[w].value),u[w].selected!==D&&(u[w].selected=D),D&&A&&(u[w].defaultSelected=!0)}else{for(w=""+$e(w),d=null,D=0;D<u.length;D++){if(u[D].value===w){u[D].selected=!0,A&&(u[D].defaultSelected=!0);return}d!==null||u[D].disabled||(d=u[D])}d!==null&&(d.selected=!0)}}function ye(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return ge({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Ue(u,d){var w=d.value;if(w==null){if(w=d.children,d=d.defaultValue,w!=null){if(d!=null)throw Error(t(92));if(Oe(w)){if(1<w.length)throw Error(t(93));w=w[0]}d=w}d==null&&(d=""),w=d}u._wrapperState={initialValue:$e(w)}}function rt(u,d){var w=$e(d.value),A=$e(d.defaultValue);w!=null&&(w=""+w,w!==u.value&&(u.value=w),d.defaultValue==null&&u.defaultValue!==w&&(u.defaultValue=w)),A!=null&&(u.defaultValue=""+A)}function Ke(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function yt(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rt(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?yt(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var _t,ar=function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,w,A,D){MSApp.execUnsafeLocalFunction(function(){return u(d,w,A,D)})}:u}(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(_t=_t||document.createElement("div"),_t.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=_t.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function cr(u,d){if(d){var w=u.firstChild;if(w&&w===u.lastChild&&w.nodeType===3){w.nodeValue=d;return}}u.textContent=d}var wr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ir=["Webkit","ms","Moz","O"];Object.keys(wr).forEach(function(u){Ir.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),wr[d]=wr[u]})});function Bt(u,d,w){return d==null||typeof d=="boolean"||d===""?"":w||typeof d!="number"||d===0||wr.hasOwnProperty(u)&&wr[u]?(""+d).trim():d+"px"}function Xt(u,d){u=u.style;for(var w in d)if(d.hasOwnProperty(w)){var A=w.indexOf("--")===0,D=Bt(w,d[w],A);w==="float"&&(w="cssFloat"),A?u.setProperty(w,D):u[w]=D}}var Pn=ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function se(u,d){if(d){if(Pn[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function Ye(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qe=null;function ft(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var we=null,U=null,L=null;function re(u){if(u=hm(u)){if(typeof we!="function")throw Error(t(280));var d=u.stateNode;d&&(d=W0(d),we(u.stateNode,u.type,d))}}function Ee(u){U?L?L.push(u):L=[u]:U=u}function P(){if(U){var u=U,d=L;if(L=U=null,re(u),d)for(u=0;u<d.length;u++)re(d[u])}}function Ce(u,d){return u(d)}function Ie(){}var J=!1;function me(u,d,w){if(J)return u(d,w);J=!0;try{return Ce(u,d,w)}finally{J=!1,(U!==null||L!==null)&&(Ie(),P())}}function Fe(u,d){var w=u.stateNode;if(w===null)return null;var A=W0(w);if(A===null)return null;w=A[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(u=u.type,A=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!A;break e;default:u=!1}if(u)return null;if(w&&typeof w!="function")throw Error(t(231,d,typeof w));return w}var vt=!1;if(o)try{var ct={};Object.defineProperty(ct,"passive",{get:function(){vt=!0}}),window.addEventListener("test",ct,ct),window.removeEventListener("test",ct,ct)}catch{vt=!1}function mt(u,d,w,A,D,M,Q,fe,xe){var He=Array.prototype.slice.call(arguments,3);try{d.apply(w,He)}catch(tt){this.onError(tt)}}var Ft=!1,vr=null,Jt=!1,Vt=null,er={onError:function(u){Ft=!0,vr=u}};function Fr(u,d,w,A,D,M,Q,fe,xe){Ft=!1,vr=null,mt.apply(er,arguments)}function Rr(u,d,w,A,D,M,Q,fe,xe){if(Fr.apply(this,arguments),Ft){if(Ft){var He=vr;Ft=!1,vr=null}else throw Error(t(198));Jt||(Jt=!0,Vt=He)}}function yn(u){var d=u,w=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(w=d.return),u=d.return;while(u)}return d.tag===3?w:null}function Hs(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function kr(u){if(yn(u)!==u)throw Error(t(188))}function nn(u){var d=u.alternate;if(!d){if(d=yn(u),d===null)throw Error(t(188));return d!==u?null:u}for(var w=u,A=d;;){var D=w.return;if(D===null)break;var M=D.alternate;if(M===null){if(A=D.return,A!==null){w=A;continue}break}if(D.child===M.child){for(M=D.child;M;){if(M===w)return kr(D),u;if(M===A)return kr(D),d;M=M.sibling}throw Error(t(188))}if(w.return!==A.return)w=D,A=M;else{for(var Q=!1,fe=D.child;fe;){if(fe===w){Q=!0,w=D,A=M;break}if(fe===A){Q=!0,A=D,w=M;break}fe=fe.sibling}if(!Q){for(fe=M.child;fe;){if(fe===w){Q=!0,w=M,A=D;break}if(fe===A){Q=!0,A=M,w=D;break}fe=fe.sibling}if(!Q)throw Error(t(189))}}if(w.alternate!==A)throw Error(t(190))}if(w.tag!==3)throw Error(t(188));return w.stateNode.current===w?u:d}function Kr(u){return u=nn(u),u!==null?vi(u):null}function vi(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=vi(u);if(d!==null)return d;u=u.sibling}return null}var On=e.unstable_scheduleCallback,Fo=e.unstable_cancelCallback,xh=e.unstable_shouldYield,In=e.unstable_requestPaint,yr=e.unstable_now,dr=e.unstable_getCurrentPriorityLevel,kn=e.unstable_ImmediatePriority,_h=e.unstable_UserBlockingPriority,ga=e.unstable_NormalPriority,pc=e.unstable_LowPriority,Gl=e.unstable_IdlePriority,Xa=null,ti=null;function Vp(u){if(ti&&typeof ti.onCommitFiberRoot=="function")try{ti.onCommitFiberRoot(Xa,u,void 0,(u.current.flags&128)===128)}catch{}}var yi=Math.clz32?Math.clz32:de,ne=Math.log,ve=Math.LN2;function de(u){return u>>>=0,u===0?32:31-(ne(u)/ve|0)|0}var Re=64,De=4194304;function Se(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function Ge(u,d){var w=u.pendingLanes;if(w===0)return 0;var A=0,D=u.suspendedLanes,M=u.pingedLanes,Q=w&268435455;if(Q!==0){var fe=Q&~D;fe!==0?A=Se(fe):(M&=Q,M!==0&&(A=Se(M)))}else Q=w&~D,Q!==0?A=Se(Q):M!==0&&(A=Se(M));if(A===0)return 0;if(d!==0&&d!==A&&(d&D)===0&&(D=A&-A,M=d&-d,D>=M||D===16&&(M&4194240)!==0))return d;if((A&4)!==0&&(A|=w&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=A;0<d;)w=31-yi(d),D=1<<w,A|=u[w],d&=~D;return A}function et(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(u,d){for(var w=u.suspendedLanes,A=u.pingedLanes,D=u.expirationTimes,M=u.pendingLanes;0<M;){var Q=31-yi(M),fe=1<<Q,xe=D[Q];xe===-1?((fe&w)===0||(fe&A)!==0)&&(D[Q]=et(fe,d)):xe<=d&&(u.expiredLanes|=fe),M&=~fe}}function nt(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function ht(){var u=Re;return Re<<=1,(Re&4194240)===0&&(Re=64),u}function Ct(u){for(var d=[],w=0;31>w;w++)d.push(u);return d}function Wt(u,d,w){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-yi(d),u[d]=w}function br(u,d){var w=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var A=u.eventTimes;for(u=u.expirationTimes;0<w;){var D=31-yi(w),M=1<<D;d[D]=0,A[D]=-1,u[D]=-1,w&=~M}}function sr(u,d){var w=u.entangledLanes|=d;for(u=u.entanglements;w;){var A=31-yi(w),D=1<<A;D&d|u[A]&d&&(u[A]|=d),w&=~D}}var zt=0;function zr(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var ri,va,ql,gs,Mo,Eh=!1,Yl=[],rs=null,vs=null,Ka=null,mc=new Map,gc=new Map,Za=[],Kw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _0(u,d){switch(u){case"focusin":case"focusout":rs=null;break;case"dragenter":case"dragleave":vs=null;break;case"mouseover":case"mouseout":Ka=null;break;case"pointerover":case"pointerout":mc.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(d.pointerId)}}function Ii(u,d,w,A,D,M){return u===null||u.nativeEvent!==M?(u={blockedOn:d,domEventName:w,eventSystemFlags:A,nativeEvent:M,targetContainers:[D]},d!==null&&(d=hm(d),d!==null&&va(d)),u):(u.eventSystemFlags|=A,d=u.targetContainers,D!==null&&d.indexOf(D)===-1&&d.push(D),u)}function Zw(u,d,w,A,D){switch(d){case"focusin":return rs=Ii(rs,u,d,w,A,D),!0;case"dragenter":return vs=Ii(vs,u,d,w,A,D),!0;case"mouseover":return Ka=Ii(Ka,u,d,w,A,D),!0;case"pointerover":var M=D.pointerId;return mc.set(M,Ii(mc.get(M)||null,u,d,w,A,D)),!0;case"gotpointercapture":return M=D.pointerId,gc.set(M,Ii(gc.get(M)||null,u,d,w,A,D)),!0}return!1}function E0(u){var d=Tc(u.target);if(d!==null){var w=yn(d);if(w!==null){if(d=w.tag,d===13){if(d=Hs(w),d!==null){u.blockedOn=d,Mo(u.priority,function(){ql(w)});return}}else if(d===3&&w.stateNode.current.memoizedState.isDehydrated){u.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Sh(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var w=qp(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(w===null){w=u.nativeEvent;var A=new w.constructor(w.type,w);Qe=A,w.target.dispatchEvent(A),Qe=null}else return d=hm(w),d!==null&&va(d),u.blockedOn=w,!1;d.shift()}return!0}function S0(u,d,w){Sh(u)&&w.delete(d)}function Ws(){Eh=!1,rs!==null&&Sh(rs)&&(rs=null),vs!==null&&Sh(vs)&&(vs=null),Ka!==null&&Sh(Ka)&&(Ka=null),mc.forEach(S0),gc.forEach(S0)}function Xl(u,d){u.blockedOn===d&&(u.blockedOn=null,Eh||(Eh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ws)))}function vc(u){function d(D){return Xl(D,u)}if(0<Yl.length){Xl(Yl[0],u);for(var w=1;w<Yl.length;w++){var A=Yl[w];A.blockedOn===u&&(A.blockedOn=null)}}for(rs!==null&&Xl(rs,u),vs!==null&&Xl(vs,u),Ka!==null&&Xl(Ka,u),mc.forEach(d),gc.forEach(d),w=0;w<Za.length;w++)A=Za[w],A.blockedOn===u&&(A.blockedOn=null);for(;0<Za.length&&(w=Za[0],w.blockedOn===null);)E0(w),w.blockedOn===null&&Za.shift()}var Qa=k.ReactCurrentBatchConfig,Ah=!0;function A0(u,d,w,A){var D=zt,M=Qa.transition;Qa.transition=null;try{zt=1,Gp(u,d,w,A)}finally{zt=D,Qa.transition=M}}function Qw(u,d,w,A){var D=zt,M=Qa.transition;Qa.transition=null;try{zt=4,Gp(u,d,w,A)}finally{zt=D,Qa.transition=M}}function Gp(u,d,w,A){if(Ah){var D=qp(u,d,w,A);if(D===null)k1(u,d,A,yc,w),_0(u,A);else if(Zw(D,u,d,w,A))A.stopPropagation();else if(_0(u,A),d&4&&-1<Kw.indexOf(u)){for(;D!==null;){var M=hm(D);if(M!==null&&ri(M),M=qp(u,d,w,A),M===null&&k1(u,d,A,yc,w),M===D)break;D=M}D!==null&&A.stopPropagation()}else k1(u,d,A,null,w)}}var yc=null;function qp(u,d,w,A){if(yc=null,u=ft(A),u=Tc(u),u!==null)if(d=yn(u),d===null)u=null;else if(w=d.tag,w===13){if(u=Hs(d),u!==null)return u;u=null}else if(w===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return yc=u,null}function Ch(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dr()){case kn:return 1;case _h:return 4;case ga:case pc:return 16;case Gl:return 536870912;default:return 16}default:return 16}}var Fn=null,Yp=null,kh=null;function C0(){if(kh)return kh;var u,d=Yp,w=d.length,A,D="value"in Fn?Fn.value:Fn.textContent,M=D.length;for(u=0;u<w&&d[u]===D[u];u++);var Q=w-u;for(A=1;A<=Q&&d[w-A]===D[M-A];A++);return kh=D.slice(u,1<A?1-A:void 0)}function Th(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Kl(){return!0}function k0(){return!1}function ni(u){function d(w,A,D,M,Q){this._reactName=w,this._targetInst=D,this.type=A,this.nativeEvent=M,this.target=Q,this.currentTarget=null;for(var fe in u)u.hasOwnProperty(fe)&&(w=u[fe],this[fe]=w?w(M):M[fe]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Kl:k0,this.isPropagationStopped=k0,this}return ge(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),d}var Zl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xp=ni(Zl),bc=ge({},Zl,{view:0,detail:0}),Jw=ni(bc),Kp,Zp,wc,Rh=ge({},bc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tm,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==wc&&(wc&&u.type==="mousemove"?(Kp=u.screenX-wc.screenX,Zp=u.screenY-wc.screenY):Zp=Kp=0,wc=u),Kp)},movementY:function(u){return"movementY"in u?u.movementY:Zp}}),T0=ni(Rh),e1=ge({},Rh,{dataTransfer:0}),t1=ni(e1),r1=ge({},bc,{relatedTarget:0}),Qp=ni(r1),n1=ge({},Zl,{animationName:0,elapsedTime:0,pseudoElement:0}),Jp=ni(n1),i1=ge({},Zl,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),s1=ni(i1),a1=ge({},Zl,{data:0}),R0=ni(a1),o1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},em={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xc(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=l1[u])?!!d[u]:!1}function tm(){return xc}var u1=ge({},bc,{key:function(u){if(u.key){var d=o1[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=Th(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?em[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tm,charCode:function(u){return u.type==="keypress"?Th(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Th(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),c1=ni(u1),d1=ge({},Rh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N0=ni(d1),h1=ge({},bc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tm}),f1=ni(h1),p1=ge({},Zl,{propertyName:0,elapsedTime:0,pseudoElement:0}),m1=ni(p1),g1=ge({},Rh,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),v1=ni(g1),y1=[9,13,27,32],rm=o&&"CompositionEvent"in window,bi=null;o&&"documentMode"in document&&(bi=document.documentMode);var _c=o&&"TextEvent"in window&&!bi,nm=o&&(!rm||bi&&8<bi&&11>=bi),Zr=" ",sn=!1;function an(u,d){switch(u){case"keyup":return y1.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ec(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var jo=!1;function D0(u,d){switch(u){case"compositionend":return Ec(d);case"keypress":return d.which!==32?null:(sn=!0,Zr);case"textInput":return u=d.data,u===Zr&&sn?null:u;default:return null}}function L0(u,d){if(jo)return u==="compositionend"||!rm&&an(u,d)?(u=C0(),kh=Yp=Fn=null,jo=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return nm&&d.locale!=="ko"?null:d.data;default:return null}}var P0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function im(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!P0[u.type]:d==="textarea"}function sm(u,d,w,A){Ee(A),d=$0(d,"onChange"),0<d.length&&(w=new Xp("onChange","change",null,w,A),u.push({event:w,listeners:d}))}var Sc=null,Ac=null;function b1(u){fA(u,0)}function Nh(u){var d=Fh(u);if(gt(d))return u}function w1(u,d){if(u==="change")return d}var O0=!1;if(o){var am;if(o){var om="oninput"in document;if(!om){var I0=document.createElement("div");I0.setAttribute("oninput","return;"),om=typeof I0.oninput=="function"}am=om}else am=!1;O0=am&&(!document.documentMode||9<document.documentMode)}function F0(){Sc&&(Sc.detachEvent("onpropertychange",M0),Ac=Sc=null)}function M0(u){if(u.propertyName==="value"&&Nh(Ac)){var d=[];sm(d,Ac,u,ft(u)),me(b1,d)}}function x1(u,d,w){u==="focusin"?(F0(),Sc=d,Ac=w,Sc.attachEvent("onpropertychange",M0)):u==="focusout"&&F0()}function _1(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Nh(Ac)}function E1(u,d){if(u==="click")return Nh(d)}function S1(u,d){if(u==="input"||u==="change")return Nh(d)}function A1(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var ys=typeof Object.is=="function"?Object.is:A1;function Cc(u,d){if(ys(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var w=Object.keys(u),A=Object.keys(d);if(w.length!==A.length)return!1;for(A=0;A<w.length;A++){var D=w[A];if(!l.call(d,D)||!ys(u[D],d[D]))return!1}return!0}function j0(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function kc(u,d){var w=j0(u);u=0;for(var A;w;){if(w.nodeType===3){if(A=u+w.textContent.length,u<=d&&A>=d)return{node:w,offset:d-u};u=A}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=j0(w)}}function Dh(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?Dh(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function W(){for(var u=window,d=ut();d instanceof u.HTMLIFrameElement;){try{var w=typeof d.contentWindow.location.href=="string"}catch{w=!1}if(w)u=d.contentWindow;else break;d=ut(u.document)}return d}function $(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function te(u){var d=W(),w=u.focusedElem,A=u.selectionRange;if(d!==w&&w&&w.ownerDocument&&Dh(w.ownerDocument.documentElement,w)){if(A!==null&&$(w)){if(d=A.start,u=A.end,u===void 0&&(u=d),"selectionStart"in w)w.selectionStart=d,w.selectionEnd=Math.min(u,w.value.length);else if(u=(d=w.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var D=w.textContent.length,M=Math.min(A.start,D);A=A.end===void 0?M:Math.min(A.end,D),!u.extend&&M>A&&(D=A,A=M,M=D),D=kc(w,M);var Q=kc(w,A);D&&Q&&(u.rangeCount!==1||u.anchorNode!==D.node||u.anchorOffset!==D.offset||u.focusNode!==Q.node||u.focusOffset!==Q.offset)&&(d=d.createRange(),d.setStart(D.node,D.offset),u.removeAllRanges(),M>A?(u.addRange(d),u.extend(Q.node,Q.offset)):(d.setEnd(Q.node,Q.offset),u.addRange(d)))}}for(d=[],u=w;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<d.length;w++)u=d[w],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var pe=o&&"documentMode"in document&&11>=document.documentMode,Ne=null,je=null,We=null,Be=!1;function Xe(u,d,w){var A=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;Be||Ne==null||Ne!==ut(A)||(A=Ne,"selectionStart"in A&&$(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),We&&Cc(We,A)||(We=A,A=$0(je,"onSelect"),0<A.length&&(d=new Xp("onSelect","select",null,d,w),u.push({event:d,listeners:A}),d.target=Ne)))}function pt(u,d){var w={};return w[u.toLowerCase()]=d.toLowerCase(),w["Webkit"+u]="webkit"+d,w["Moz"+u]="moz"+d,w}var kt={animationend:pt("Animation","AnimationEnd"),animationiteration:pt("Animation","AnimationIteration"),animationstart:pt("Animation","AnimationStart"),transitionend:pt("Transition","TransitionEnd")},Ot={},Zt={};o&&(Zt=document.createElement("div").style,"AnimationEvent"in window||(delete kt.animationend.animation,delete kt.animationiteration.animation,delete kt.animationstart.animation),"TransitionEvent"in window||delete kt.transitionend.transition);function $r(u){if(Ot[u])return Ot[u];if(!kt[u])return u;var d=kt[u],w;for(w in d)if(d.hasOwnProperty(w)&&w in Zt)return Ot[u]=d[w];return u}var bn=$r("animationend"),wn=$r("animationiteration"),Fi=$r("animationstart"),bs=$r("transitionend"),Ql=new Map,Vs="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ja(u,d){Ql.set(u,d),s(d,[u])}for(var Lh=0;Lh<Vs.length;Lh++){var Ph=Vs[Lh],B0=Ph.toLowerCase(),m3=Ph[0].toUpperCase()+Ph.slice(1);Ja(B0,"on"+m3)}Ja(bn,"onAnimationEnd"),Ja(wn,"onAnimationIteration"),Ja(Fi,"onAnimationStart"),Ja("dblclick","onDoubleClick"),Ja("focusin","onFocus"),Ja("focusout","onBlur"),Ja(bs,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g3=new Set("cancel close invalid load scroll toggle".split(" ").concat(lm));function hA(u,d,w){var A=u.type||"unknown-event";u.currentTarget=w,Rr(A,d,void 0,u),u.currentTarget=null}function fA(u,d){d=(d&4)!==0;for(var w=0;w<u.length;w++){var A=u[w],D=A.event;A=A.listeners;e:{var M=void 0;if(d)for(var Q=A.length-1;0<=Q;Q--){var fe=A[Q],xe=fe.instance,He=fe.currentTarget;if(fe=fe.listener,xe!==M&&D.isPropagationStopped())break e;hA(D,fe,He),M=xe}else for(Q=0;Q<A.length;Q++){if(fe=A[Q],xe=fe.instance,He=fe.currentTarget,fe=fe.listener,xe!==M&&D.isPropagationStopped())break e;hA(D,fe,He),M=xe}}}if(Jt)throw u=Vt,Jt=!1,Vt=null,u}function Gr(u,d){var w=d[P1];w===void 0&&(w=d[P1]=new Set);var A=u+"__bubble";w.has(A)||(pA(d,u,2,!1),w.add(A))}function C1(u,d,w){var A=0;d&&(A|=4),pA(w,u,A,d)}var z0="_reactListening"+Math.random().toString(36).slice(2);function um(u){if(!u[z0]){u[z0]=!0,r.forEach(function(w){w!=="selectionchange"&&(g3.has(w)||C1(w,!1,u),C1(w,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[z0]||(d[z0]=!0,C1("selectionchange",!1,d))}}function pA(u,d,w,A){switch(Ch(d)){case 1:var D=A0;break;case 4:D=Qw;break;default:D=Gp}w=D.bind(null,d,w,u),D=void 0,!vt||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(D=!0),A?D!==void 0?u.addEventListener(d,w,{capture:!0,passive:D}):u.addEventListener(d,w,!0):D!==void 0?u.addEventListener(d,w,{passive:D}):u.addEventListener(d,w,!1)}function k1(u,d,w,A,D){var M=A;if((d&1)===0&&(d&2)===0&&A!==null)e:for(;;){if(A===null)return;var Q=A.tag;if(Q===3||Q===4){var fe=A.stateNode.containerInfo;if(fe===D||fe.nodeType===8&&fe.parentNode===D)break;if(Q===4)for(Q=A.return;Q!==null;){var xe=Q.tag;if((xe===3||xe===4)&&(xe=Q.stateNode.containerInfo,xe===D||xe.nodeType===8&&xe.parentNode===D))return;Q=Q.return}for(;fe!==null;){if(Q=Tc(fe),Q===null)return;if(xe=Q.tag,xe===5||xe===6){A=M=Q;continue e}fe=fe.parentNode}}A=A.return}me(function(){var He=M,tt=ft(w),ot=[];e:{var Je=Ql.get(u);if(Je!==void 0){var Et=Xp,Lt=u;switch(u){case"keypress":if(Th(w)===0)break e;case"keydown":case"keyup":Et=c1;break;case"focusin":Lt="focus",Et=Qp;break;case"focusout":Lt="blur",Et=Qp;break;case"beforeblur":case"afterblur":Et=Qp;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Et=T0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Et=t1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Et=f1;break;case bn:case wn:case Fi:Et=Jp;break;case bs:Et=m1;break;case"scroll":Et=Jw;break;case"wheel":Et=v1;break;case"copy":case"cut":case"paste":Et=s1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Et=N0}var Pt=(d&4)!==0,xn=!Pt&&u==="scroll",Me=Pt?Je!==null?Je+"Capture":null:Je;Pt=[];for(var ke=He,ze;ke!==null;){ze=ke;var dt=ze.stateNode;if(ze.tag===5&&dt!==null&&(ze=dt,Me!==null&&(dt=Fe(ke,Me),dt!=null&&Pt.push(cm(ke,dt,ze)))),xn)break;ke=ke.return}0<Pt.length&&(Je=new Et(Je,Lt,null,w,tt),ot.push({event:Je,listeners:Pt}))}}if((d&7)===0){e:{if(Je=u==="mouseover"||u==="pointerover",Et=u==="mouseout"||u==="pointerout",Je&&w!==Qe&&(Lt=w.relatedTarget||w.fromElement)&&(Tc(Lt)||Lt[Bo]))break e;if((Et||Je)&&(Je=tt.window===tt?tt:(Je=tt.ownerDocument)?Je.defaultView||Je.parentWindow:window,Et?(Lt=w.relatedTarget||w.toElement,Et=He,Lt=Lt?Tc(Lt):null,Lt!==null&&(xn=yn(Lt),Lt!==xn||Lt.tag!==5&&Lt.tag!==6)&&(Lt=null)):(Et=null,Lt=He),Et!==Lt)){if(Pt=T0,dt="onMouseLeave",Me="onMouseEnter",ke="mouse",(u==="pointerout"||u==="pointerover")&&(Pt=N0,dt="onPointerLeave",Me="onPointerEnter",ke="pointer"),xn=Et==null?Je:Fh(Et),ze=Lt==null?Je:Fh(Lt),Je=new Pt(dt,ke+"leave",Et,w,tt),Je.target=xn,Je.relatedTarget=ze,dt=null,Tc(tt)===He&&(Pt=new Pt(Me,ke+"enter",Lt,w,tt),Pt.target=ze,Pt.relatedTarget=xn,dt=Pt),xn=dt,Et&&Lt)t:{for(Pt=Et,Me=Lt,ke=0,ze=Pt;ze;ze=Oh(ze))ke++;for(ze=0,dt=Me;dt;dt=Oh(dt))ze++;for(;0<ke-ze;)Pt=Oh(Pt),ke--;for(;0<ze-ke;)Me=Oh(Me),ze--;for(;ke--;){if(Pt===Me||Me!==null&&Pt===Me.alternate)break t;Pt=Oh(Pt),Me=Oh(Me)}Pt=null}else Pt=null;Et!==null&&mA(ot,Je,Et,Pt,!1),Lt!==null&&xn!==null&&mA(ot,xn,Lt,Pt,!0)}}e:{if(Je=He?Fh(He):window,Et=Je.nodeName&&Je.nodeName.toLowerCase(),Et==="select"||Et==="input"&&Je.type==="file")var It=w1;else if(im(Je))if(O0)It=S1;else{It=_1;var $t=x1}else(Et=Je.nodeName)&&Et.toLowerCase()==="input"&&(Je.type==="checkbox"||Je.type==="radio")&&(It=E1);if(It&&(It=It(u,He))){sm(ot,It,w,tt);break e}$t&&$t(u,Je,He),u==="focusout"&&($t=Je._wrapperState)&&$t.controlled&&Je.type==="number"&&le(Je,"number",Je.value)}switch($t=He?Fh(He):window,u){case"focusin":(im($t)||$t.contentEditable==="true")&&(Ne=$t,je=He,We=null);break;case"focusout":We=je=Ne=null;break;case"mousedown":Be=!0;break;case"contextmenu":case"mouseup":case"dragend":Be=!1,Xe(ot,w,tt);break;case"selectionchange":if(pe)break;case"keydown":case"keyup":Xe(ot,w,tt)}var Ut;if(rm)e:{switch(u){case"compositionstart":var Gt="onCompositionStart";break e;case"compositionend":Gt="onCompositionEnd";break e;case"compositionupdate":Gt="onCompositionUpdate";break e}Gt=void 0}else jo?an(u,w)&&(Gt="onCompositionEnd"):u==="keydown"&&w.keyCode===229&&(Gt="onCompositionStart");Gt&&(nm&&w.locale!=="ko"&&(jo||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&jo&&(Ut=C0()):(Fn=tt,Yp="value"in Fn?Fn.value:Fn.textContent,jo=!0)),$t=$0(He,Gt),0<$t.length&&(Gt=new R0(Gt,u,null,w,tt),ot.push({event:Gt,listeners:$t}),Ut?Gt.data=Ut:(Ut=Ec(w),Ut!==null&&(Gt.data=Ut)))),(Ut=_c?D0(u,w):L0(u,w))&&(He=$0(He,"onBeforeInput"),0<He.length&&(tt=new R0("onBeforeInput","beforeinput",null,w,tt),ot.push({event:tt,listeners:He}),tt.data=Ut))}fA(ot,d)})}function cm(u,d,w){return{instance:u,listener:d,currentTarget:w}}function $0(u,d){for(var w=d+"Capture",A=[];u!==null;){var D=u,M=D.stateNode;D.tag===5&&M!==null&&(D=M,M=Fe(u,w),M!=null&&A.unshift(cm(u,M,D)),M=Fe(u,d),M!=null&&A.push(cm(u,M,D))),u=u.return}return A}function Oh(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function mA(u,d,w,A,D){for(var M=d._reactName,Q=[];w!==null&&w!==A;){var fe=w,xe=fe.alternate,He=fe.stateNode;if(xe!==null&&xe===A)break;fe.tag===5&&He!==null&&(fe=He,D?(xe=Fe(w,M),xe!=null&&Q.unshift(cm(w,xe,fe))):D||(xe=Fe(w,M),xe!=null&&Q.push(cm(w,xe,fe)))),w=w.return}Q.length!==0&&u.push({event:d,listeners:Q})}var v3=/\r\n?/g,y3=/\u0000|\uFFFD/g;function gA(u){return(typeof u=="string"?u:""+u).replace(v3,`
`).replace(y3,"")}function U0(u,d,w){if(d=gA(d),gA(u)!==d&&w)throw Error(t(425))}function H0(){}var T1=null,R1=null;function N1(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var D1=typeof setTimeout=="function"?setTimeout:void 0,b3=typeof clearTimeout=="function"?clearTimeout:void 0,vA=typeof Promise=="function"?Promise:void 0,w3=typeof queueMicrotask=="function"?queueMicrotask:typeof vA<"u"?function(u){return vA.resolve(null).then(u).catch(x3)}:D1;function x3(u){setTimeout(function(){throw u})}function L1(u,d){var w=d,A=0;do{var D=w.nextSibling;if(u.removeChild(w),D&&D.nodeType===8)if(w=D.data,w==="/$"){if(A===0){u.removeChild(D),vc(d);return}A--}else w!=="$"&&w!=="$?"&&w!=="$!"||A++;w=D}while(w);vc(d)}function Jl(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function yA(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var w=u.data;if(w==="$"||w==="$!"||w==="$?"){if(d===0)return u;d--}else w==="/$"&&d++}u=u.previousSibling}return null}var Ih=Math.random().toString(36).slice(2),eo="__reactFiber$"+Ih,dm="__reactProps$"+Ih,Bo="__reactContainer$"+Ih,P1="__reactEvents$"+Ih,_3="__reactListeners$"+Ih,E3="__reactHandles$"+Ih;function Tc(u){var d=u[eo];if(d)return d;for(var w=u.parentNode;w;){if(d=w[Bo]||w[eo]){if(w=d.alternate,d.child!==null||w!==null&&w.child!==null)for(u=yA(u);u!==null;){if(w=u[eo])return w;u=yA(u)}return d}u=w,w=u.parentNode}return null}function hm(u){return u=u[eo]||u[Bo],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function Fh(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function W0(u){return u[dm]||null}var O1=[],Mh=-1;function eu(u){return{current:u}}function qr(u){0>Mh||(u.current=O1[Mh],O1[Mh]=null,Mh--)}function Ur(u,d){Mh++,O1[Mh]=u.current,u.current=d}var tu={},wi=eu(tu),ns=eu(!1),Rc=tu;function jh(u,d){var w=u.type.contextTypes;if(!w)return tu;var A=u.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===d)return A.__reactInternalMemoizedMaskedChildContext;var D={},M;for(M in w)D[M]=d[M];return A&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=D),D}function is(u){return u=u.childContextTypes,u!=null}function V0(){qr(ns),qr(wi)}function bA(u,d,w){if(wi.current!==tu)throw Error(t(168));Ur(wi,d),Ur(ns,w)}function wA(u,d,w){var A=u.stateNode;if(d=d.childContextTypes,typeof A.getChildContext!="function")return w;A=A.getChildContext();for(var D in A)if(!(D in d))throw Error(t(108,Ve(u)||"Unknown",D));return ge({},w,A)}function G0(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||tu,Rc=wi.current,Ur(wi,u),Ur(ns,ns.current),!0}function xA(u,d,w){var A=u.stateNode;if(!A)throw Error(t(169));w?(u=wA(u,d,Rc),A.__reactInternalMemoizedMergedChildContext=u,qr(ns),qr(wi),Ur(wi,u)):qr(ns),Ur(ns,w)}var zo=null,q0=!1,I1=!1;function _A(u){zo===null?zo=[u]:zo.push(u)}function S3(u){q0=!0,_A(u)}function ru(){if(!I1&&zo!==null){I1=!0;var u=0,d=zt;try{var w=zo;for(zt=1;u<w.length;u++){var A=w[u];do A=A(!0);while(A!==null)}zo=null,q0=!1}catch(D){throw zo!==null&&(zo=zo.slice(u+1)),On(kn,ru),D}finally{zt=d,I1=!1}}return null}var Bh=[],zh=0,Y0=null,X0=0,Gs=[],qs=0,Nc=null,$o=1,Uo="";function Dc(u,d){Bh[zh++]=X0,Bh[zh++]=Y0,Y0=u,X0=d}function EA(u,d,w){Gs[qs++]=$o,Gs[qs++]=Uo,Gs[qs++]=Nc,Nc=u;var A=$o;u=Uo;var D=32-yi(A)-1;A&=~(1<<D),w+=1;var M=32-yi(d)+D;if(30<M){var Q=D-D%5;M=(A&(1<<Q)-1).toString(32),A>>=Q,D-=Q,$o=1<<32-yi(d)+D|w<<D|A,Uo=M+u}else $o=1<<M|w<<D|A,Uo=u}function F1(u){u.return!==null&&(Dc(u,1),EA(u,1,0))}function M1(u){for(;u===Y0;)Y0=Bh[--zh],Bh[zh]=null,X0=Bh[--zh],Bh[zh]=null;for(;u===Nc;)Nc=Gs[--qs],Gs[qs]=null,Uo=Gs[--qs],Gs[qs]=null,$o=Gs[--qs],Gs[qs]=null}var ws=null,xs=null,Qr=!1,ya=null;function SA(u,d){var w=Zs(5,null,null,0);w.elementType="DELETED",w.stateNode=d,w.return=u,d=u.deletions,d===null?(u.deletions=[w],u.flags|=16):d.push(w)}function AA(u,d){switch(u.tag){case 5:var w=u.type;return d=d.nodeType!==1||w.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,ws=u,xs=Jl(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,ws=u,xs=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(w=Nc!==null?{id:$o,overflow:Uo}:null,u.memoizedState={dehydrated:d,treeContext:w,retryLane:1073741824},w=Zs(18,null,null,0),w.stateNode=d,w.return=u,u.child=w,ws=u,xs=null,!0):!1;default:return!1}}function j1(u){return(u.mode&1)!==0&&(u.flags&128)===0}function B1(u){if(Qr){var d=xs;if(d){var w=d;if(!AA(u,d)){if(j1(u))throw Error(t(418));d=Jl(w.nextSibling);var A=ws;d&&AA(u,d)?SA(A,w):(u.flags=u.flags&-4097|2,Qr=!1,ws=u)}}else{if(j1(u))throw Error(t(418));u.flags=u.flags&-4097|2,Qr=!1,ws=u}}}function CA(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ws=u}function K0(u){if(u!==ws)return!1;if(!Qr)return CA(u),Qr=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!N1(u.type,u.memoizedProps)),d&&(d=xs)){if(j1(u))throw kA(),Error(t(418));for(;d;)SA(u,d),d=Jl(d.nextSibling)}if(CA(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var w=u.data;if(w==="/$"){if(d===0){xs=Jl(u.nextSibling);break e}d--}else w!=="$"&&w!=="$!"&&w!=="$?"||d++}u=u.nextSibling}xs=null}}else xs=ws?Jl(u.stateNode.nextSibling):null;return!0}function kA(){for(var u=xs;u;)u=Jl(u.nextSibling)}function $h(){xs=ws=null,Qr=!1}function z1(u){ya===null?ya=[u]:ya.push(u)}var A3=k.ReactCurrentBatchConfig;function fm(u,d,w){if(u=w.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(t(309));var A=w.stateNode}if(!A)throw Error(t(147,u));var D=A,M=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===M?d.ref:(d=function(Q){var fe=D.refs;Q===null?delete fe[M]:fe[M]=Q},d._stringRef=M,d)}if(typeof u!="string")throw Error(t(284));if(!w._owner)throw Error(t(290,u))}return u}function Z0(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function TA(u){var d=u._init;return d(u._payload)}function RA(u){function d(Me,ke){if(u){var ze=Me.deletions;ze===null?(Me.deletions=[ke],Me.flags|=16):ze.push(ke)}}function w(Me,ke){if(!u)return null;for(;ke!==null;)d(Me,ke),ke=ke.sibling;return null}function A(Me,ke){for(Me=new Map;ke!==null;)ke.key!==null?Me.set(ke.key,ke):Me.set(ke.index,ke),ke=ke.sibling;return Me}function D(Me,ke){return Me=cu(Me,ke),Me.index=0,Me.sibling=null,Me}function M(Me,ke,ze){return Me.index=ze,u?(ze=Me.alternate,ze!==null?(ze=ze.index,ze<ke?(Me.flags|=2,ke):ze):(Me.flags|=2,ke)):(Me.flags|=1048576,ke)}function Q(Me){return u&&Me.alternate===null&&(Me.flags|=2),Me}function fe(Me,ke,ze,dt){return ke===null||ke.tag!==6?(ke=D2(ze,Me.mode,dt),ke.return=Me,ke):(ke=D(ke,ze),ke.return=Me,ke)}function xe(Me,ke,ze,dt){var It=ze.type;return It===N?tt(Me,ke,ze.props.children,dt,ze.key):ke!==null&&(ke.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===he&&TA(It)===ke.type)?(dt=D(ke,ze.props),dt.ref=fm(Me,ke,ze),dt.return=Me,dt):(dt=xy(ze.type,ze.key,ze.props,null,Me.mode,dt),dt.ref=fm(Me,ke,ze),dt.return=Me,dt)}function He(Me,ke,ze,dt){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==ze.containerInfo||ke.stateNode.implementation!==ze.implementation?(ke=L2(ze,Me.mode,dt),ke.return=Me,ke):(ke=D(ke,ze.children||[]),ke.return=Me,ke)}function tt(Me,ke,ze,dt,It){return ke===null||ke.tag!==7?(ke=Bc(ze,Me.mode,dt,It),ke.return=Me,ke):(ke=D(ke,ze),ke.return=Me,ke)}function ot(Me,ke,ze){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ke=D2(""+ke,Me.mode,ze),ke.return=Me,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case C:return ze=xy(ke.type,ke.key,ke.props,null,Me.mode,ze),ze.ref=fm(Me,null,ke),ze.return=Me,ze;case R:return ke=L2(ke,Me.mode,ze),ke.return=Me,ke;case he:var dt=ke._init;return ot(Me,dt(ke._payload),ze)}if(Oe(ke)||ie(ke))return ke=Bc(ke,Me.mode,ze,null),ke.return=Me,ke;Z0(Me,ke)}return null}function Je(Me,ke,ze,dt){var It=ke!==null?ke.key:null;if(typeof ze=="string"&&ze!==""||typeof ze=="number")return It!==null?null:fe(Me,ke,""+ze,dt);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case C:return ze.key===It?xe(Me,ke,ze,dt):null;case R:return ze.key===It?He(Me,ke,ze,dt):null;case he:return It=ze._init,Je(Me,ke,It(ze._payload),dt)}if(Oe(ze)||ie(ze))return It!==null?null:tt(Me,ke,ze,dt,null);Z0(Me,ze)}return null}function Et(Me,ke,ze,dt,It){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return Me=Me.get(ze)||null,fe(ke,Me,""+dt,It);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case C:return Me=Me.get(dt.key===null?ze:dt.key)||null,xe(ke,Me,dt,It);case R:return Me=Me.get(dt.key===null?ze:dt.key)||null,He(ke,Me,dt,It);case he:var $t=dt._init;return Et(Me,ke,ze,$t(dt._payload),It)}if(Oe(dt)||ie(dt))return Me=Me.get(ze)||null,tt(ke,Me,dt,It,null);Z0(ke,dt)}return null}function Lt(Me,ke,ze,dt){for(var It=null,$t=null,Ut=ke,Gt=ke=0,qn=null;Ut!==null&&Gt<ze.length;Gt++){Ut.index>Gt?(qn=Ut,Ut=null):qn=Ut.sibling;var Sr=Je(Me,Ut,ze[Gt],dt);if(Sr===null){Ut===null&&(Ut=qn);break}u&&Ut&&Sr.alternate===null&&d(Me,Ut),ke=M(Sr,ke,Gt),$t===null?It=Sr:$t.sibling=Sr,$t=Sr,Ut=qn}if(Gt===ze.length)return w(Me,Ut),Qr&&Dc(Me,Gt),It;if(Ut===null){for(;Gt<ze.length;Gt++)Ut=ot(Me,ze[Gt],dt),Ut!==null&&(ke=M(Ut,ke,Gt),$t===null?It=Ut:$t.sibling=Ut,$t=Ut);return Qr&&Dc(Me,Gt),It}for(Ut=A(Me,Ut);Gt<ze.length;Gt++)qn=Et(Ut,Me,Gt,ze[Gt],dt),qn!==null&&(u&&qn.alternate!==null&&Ut.delete(qn.key===null?Gt:qn.key),ke=M(qn,ke,Gt),$t===null?It=qn:$t.sibling=qn,$t=qn);return u&&Ut.forEach(function(du){return d(Me,du)}),Qr&&Dc(Me,Gt),It}function Pt(Me,ke,ze,dt){var It=ie(ze);if(typeof It!="function")throw Error(t(150));if(ze=It.call(ze),ze==null)throw Error(t(151));for(var $t=It=null,Ut=ke,Gt=ke=0,qn=null,Sr=ze.next();Ut!==null&&!Sr.done;Gt++,Sr=ze.next()){Ut.index>Gt?(qn=Ut,Ut=null):qn=Ut.sibling;var du=Je(Me,Ut,Sr.value,dt);if(du===null){Ut===null&&(Ut=qn);break}u&&Ut&&du.alternate===null&&d(Me,Ut),ke=M(du,ke,Gt),$t===null?It=du:$t.sibling=du,$t=du,Ut=qn}if(Sr.done)return w(Me,Ut),Qr&&Dc(Me,Gt),It;if(Ut===null){for(;!Sr.done;Gt++,Sr=ze.next())Sr=ot(Me,Sr.value,dt),Sr!==null&&(ke=M(Sr,ke,Gt),$t===null?It=Sr:$t.sibling=Sr,$t=Sr);return Qr&&Dc(Me,Gt),It}for(Ut=A(Me,Ut);!Sr.done;Gt++,Sr=ze.next())Sr=Et(Ut,Me,Gt,Sr.value,dt),Sr!==null&&(u&&Sr.alternate!==null&&Ut.delete(Sr.key===null?Gt:Sr.key),ke=M(Sr,ke,Gt),$t===null?It=Sr:$t.sibling=Sr,$t=Sr);return u&&Ut.forEach(function(iO){return d(Me,iO)}),Qr&&Dc(Me,Gt),It}function xn(Me,ke,ze,dt){if(typeof ze=="object"&&ze!==null&&ze.type===N&&ze.key===null&&(ze=ze.props.children),typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case C:e:{for(var It=ze.key,$t=ke;$t!==null;){if($t.key===It){if(It=ze.type,It===N){if($t.tag===7){w(Me,$t.sibling),ke=D($t,ze.props.children),ke.return=Me,Me=ke;break e}}else if($t.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===he&&TA(It)===$t.type){w(Me,$t.sibling),ke=D($t,ze.props),ke.ref=fm(Me,$t,ze),ke.return=Me,Me=ke;break e}w(Me,$t);break}else d(Me,$t);$t=$t.sibling}ze.type===N?(ke=Bc(ze.props.children,Me.mode,dt,ze.key),ke.return=Me,Me=ke):(dt=xy(ze.type,ze.key,ze.props,null,Me.mode,dt),dt.ref=fm(Me,ke,ze),dt.return=Me,Me=dt)}return Q(Me);case R:e:{for($t=ze.key;ke!==null;){if(ke.key===$t)if(ke.tag===4&&ke.stateNode.containerInfo===ze.containerInfo&&ke.stateNode.implementation===ze.implementation){w(Me,ke.sibling),ke=D(ke,ze.children||[]),ke.return=Me,Me=ke;break e}else{w(Me,ke);break}else d(Me,ke);ke=ke.sibling}ke=L2(ze,Me.mode,dt),ke.return=Me,Me=ke}return Q(Me);case he:return $t=ze._init,xn(Me,ke,$t(ze._payload),dt)}if(Oe(ze))return Lt(Me,ke,ze,dt);if(ie(ze))return Pt(Me,ke,ze,dt);Z0(Me,ze)}return typeof ze=="string"&&ze!==""||typeof ze=="number"?(ze=""+ze,ke!==null&&ke.tag===6?(w(Me,ke.sibling),ke=D(ke,ze),ke.return=Me,Me=ke):(w(Me,ke),ke=D2(ze,Me.mode,dt),ke.return=Me,Me=ke),Q(Me)):w(Me,ke)}return xn}var Uh=RA(!0),NA=RA(!1),Q0=eu(null),J0=null,Hh=null,$1=null;function U1(){$1=Hh=J0=null}function H1(u){var d=Q0.current;qr(Q0),u._currentValue=d}function W1(u,d,w){for(;u!==null;){var A=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,A!==null&&(A.childLanes|=d)):A!==null&&(A.childLanes&d)!==d&&(A.childLanes|=d),u===w)break;u=u.return}}function Wh(u,d){J0=u,$1=Hh=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(ss=!0),u.firstContext=null)}function Ys(u){var d=u._currentValue;if($1!==u)if(u={context:u,memoizedValue:d,next:null},Hh===null){if(J0===null)throw Error(t(308));Hh=u,J0.dependencies={lanes:0,firstContext:u}}else Hh=Hh.next=u;return d}var Lc=null;function V1(u){Lc===null?Lc=[u]:Lc.push(u)}function DA(u,d,w,A){var D=d.interleaved;return D===null?(w.next=w,V1(d)):(w.next=D.next,D.next=w),d.interleaved=w,Ho(u,A)}function Ho(u,d){u.lanes|=d;var w=u.alternate;for(w!==null&&(w.lanes|=d),w=u,u=u.return;u!==null;)u.childLanes|=d,w=u.alternate,w!==null&&(w.childLanes|=d),w=u,u=u.return;return w.tag===3?w.stateNode:null}var nu=!1;function G1(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LA(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Wo(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function iu(u,d,w){var A=u.updateQueue;if(A===null)return null;if(A=A.shared,(xr&2)!==0){var D=A.pending;return D===null?d.next=d:(d.next=D.next,D.next=d),A.pending=d,Ho(u,w)}return D=A.interleaved,D===null?(d.next=d,V1(A)):(d.next=D.next,D.next=d),A.interleaved=d,Ho(u,w)}function ey(u,d,w){if(d=d.updateQueue,d!==null&&(d=d.shared,(w&4194240)!==0)){var A=d.lanes;A&=u.pendingLanes,w|=A,d.lanes=w,sr(u,w)}}function PA(u,d){var w=u.updateQueue,A=u.alternate;if(A!==null&&(A=A.updateQueue,w===A)){var D=null,M=null;if(w=w.firstBaseUpdate,w!==null){do{var Q={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};M===null?D=M=Q:M=M.next=Q,w=w.next}while(w!==null);M===null?D=M=d:M=M.next=d}else D=M=d;w={baseState:A.baseState,firstBaseUpdate:D,lastBaseUpdate:M,shared:A.shared,effects:A.effects},u.updateQueue=w;return}u=w.lastBaseUpdate,u===null?w.firstBaseUpdate=d:u.next=d,w.lastBaseUpdate=d}function ty(u,d,w,A){var D=u.updateQueue;nu=!1;var M=D.firstBaseUpdate,Q=D.lastBaseUpdate,fe=D.shared.pending;if(fe!==null){D.shared.pending=null;var xe=fe,He=xe.next;xe.next=null,Q===null?M=He:Q.next=He,Q=xe;var tt=u.alternate;tt!==null&&(tt=tt.updateQueue,fe=tt.lastBaseUpdate,fe!==Q&&(fe===null?tt.firstBaseUpdate=He:fe.next=He,tt.lastBaseUpdate=xe))}if(M!==null){var ot=D.baseState;Q=0,tt=He=xe=null,fe=M;do{var Je=fe.lane,Et=fe.eventTime;if((A&Je)===Je){tt!==null&&(tt=tt.next={eventTime:Et,lane:0,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null});e:{var Lt=u,Pt=fe;switch(Je=d,Et=w,Pt.tag){case 1:if(Lt=Pt.payload,typeof Lt=="function"){ot=Lt.call(Et,ot,Je);break e}ot=Lt;break e;case 3:Lt.flags=Lt.flags&-65537|128;case 0:if(Lt=Pt.payload,Je=typeof Lt=="function"?Lt.call(Et,ot,Je):Lt,Je==null)break e;ot=ge({},ot,Je);break e;case 2:nu=!0}}fe.callback!==null&&fe.lane!==0&&(u.flags|=64,Je=D.effects,Je===null?D.effects=[fe]:Je.push(fe))}else Et={eventTime:Et,lane:Je,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},tt===null?(He=tt=Et,xe=ot):tt=tt.next=Et,Q|=Je;if(fe=fe.next,fe===null){if(fe=D.shared.pending,fe===null)break;Je=fe,fe=Je.next,Je.next=null,D.lastBaseUpdate=Je,D.shared.pending=null}}while(!0);if(tt===null&&(xe=ot),D.baseState=xe,D.firstBaseUpdate=He,D.lastBaseUpdate=tt,d=D.shared.interleaved,d!==null){D=d;do Q|=D.lane,D=D.next;while(D!==d)}else M===null&&(D.shared.lanes=0);Ic|=Q,u.lanes=Q,u.memoizedState=ot}}function OA(u,d,w){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var A=u[d],D=A.callback;if(D!==null){if(A.callback=null,A=w,typeof D!="function")throw Error(t(191,D));D.call(A)}}}var pm={},to=eu(pm),mm=eu(pm),gm=eu(pm);function Pc(u){if(u===pm)throw Error(t(174));return u}function q1(u,d){switch(Ur(gm,d),Ur(mm,u),Ur(to,pm),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Rt(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=Rt(d,u)}qr(to),Ur(to,d)}function Vh(){qr(to),qr(mm),qr(gm)}function IA(u){Pc(gm.current);var d=Pc(to.current),w=Rt(d,u.type);d!==w&&(Ur(mm,u),Ur(to,w))}function Y1(u){mm.current===u&&(qr(to),qr(mm))}var on=eu(0);function ry(u){for(var d=u;d!==null;){if(d.tag===13){var w=d.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var X1=[];function K1(){for(var u=0;u<X1.length;u++)X1[u]._workInProgressVersionPrimary=null;X1.length=0}var ny=k.ReactCurrentDispatcher,Z1=k.ReactCurrentBatchConfig,Oc=0,ln=null,Mn=null,Vn=null,iy=!1,vm=!1,ym=0,C3=0;function xi(){throw Error(t(321))}function Q1(u,d){if(d===null)return!1;for(var w=0;w<d.length&&w<u.length;w++)if(!ys(u[w],d[w]))return!1;return!0}function J1(u,d,w,A,D,M){if(Oc=M,ln=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,ny.current=u===null||u.memoizedState===null?N3:D3,u=w(A,D),vm){M=0;do{if(vm=!1,ym=0,25<=M)throw Error(t(301));M+=1,Vn=Mn=null,d.updateQueue=null,ny.current=L3,u=w(A,D)}while(vm)}if(ny.current=oy,d=Mn!==null&&Mn.next!==null,Oc=0,Vn=Mn=ln=null,iy=!1,d)throw Error(t(300));return u}function e2(){var u=ym!==0;return ym=0,u}function ro(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?ln.memoizedState=Vn=u:Vn=Vn.next=u,Vn}function Xs(){if(Mn===null){var u=ln.alternate;u=u!==null?u.memoizedState:null}else u=Mn.next;var d=Vn===null?ln.memoizedState:Vn.next;if(d!==null)Vn=d,Mn=u;else{if(u===null)throw Error(t(310));Mn=u,u={memoizedState:Mn.memoizedState,baseState:Mn.baseState,baseQueue:Mn.baseQueue,queue:Mn.queue,next:null},Vn===null?ln.memoizedState=Vn=u:Vn=Vn.next=u}return Vn}function bm(u,d){return typeof d=="function"?d(u):d}function t2(u){var d=Xs(),w=d.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=u;var A=Mn,D=A.baseQueue,M=w.pending;if(M!==null){if(D!==null){var Q=D.next;D.next=M.next,M.next=Q}A.baseQueue=D=M,w.pending=null}if(D!==null){M=D.next,A=A.baseState;var fe=Q=null,xe=null,He=M;do{var tt=He.lane;if((Oc&tt)===tt)xe!==null&&(xe=xe.next={lane:0,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null}),A=He.hasEagerState?He.eagerState:u(A,He.action);else{var ot={lane:tt,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null};xe===null?(fe=xe=ot,Q=A):xe=xe.next=ot,ln.lanes|=tt,Ic|=tt}He=He.next}while(He!==null&&He!==M);xe===null?Q=A:xe.next=fe,ys(A,d.memoizedState)||(ss=!0),d.memoizedState=A,d.baseState=Q,d.baseQueue=xe,w.lastRenderedState=A}if(u=w.interleaved,u!==null){D=u;do M=D.lane,ln.lanes|=M,Ic|=M,D=D.next;while(D!==u)}else D===null&&(w.lanes=0);return[d.memoizedState,w.dispatch]}function r2(u){var d=Xs(),w=d.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=u;var A=w.dispatch,D=w.pending,M=d.memoizedState;if(D!==null){w.pending=null;var Q=D=D.next;do M=u(M,Q.action),Q=Q.next;while(Q!==D);ys(M,d.memoizedState)||(ss=!0),d.memoizedState=M,d.baseQueue===null&&(d.baseState=M),w.lastRenderedState=M}return[M,A]}function FA(){}function MA(u,d){var w=ln,A=Xs(),D=d(),M=!ys(A.memoizedState,D);if(M&&(A.memoizedState=D,ss=!0),A=A.queue,n2(zA.bind(null,w,A,u),[u]),A.getSnapshot!==d||M||Vn!==null&&Vn.memoizedState.tag&1){if(w.flags|=2048,wm(9,BA.bind(null,w,A,D,d),void 0,null),Gn===null)throw Error(t(349));(Oc&30)!==0||jA(w,d,D)}return D}function jA(u,d,w){u.flags|=16384,u={getSnapshot:d,value:w},d=ln.updateQueue,d===null?(d={lastEffect:null,stores:null},ln.updateQueue=d,d.stores=[u]):(w=d.stores,w===null?d.stores=[u]:w.push(u))}function BA(u,d,w,A){d.value=w,d.getSnapshot=A,$A(d)&&UA(u)}function zA(u,d,w){return w(function(){$A(d)&&UA(u)})}function $A(u){var d=u.getSnapshot;u=u.value;try{var w=d();return!ys(u,w)}catch{return!0}}function UA(u){var d=Ho(u,1);d!==null&&_a(d,u,1,-1)}function HA(u){var d=ro();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bm,lastRenderedState:u},d.queue=u,u=u.dispatch=R3.bind(null,ln,u),[d.memoizedState,u]}function wm(u,d,w,A){return u={tag:u,create:d,destroy:w,deps:A,next:null},d=ln.updateQueue,d===null?(d={lastEffect:null,stores:null},ln.updateQueue=d,d.lastEffect=u.next=u):(w=d.lastEffect,w===null?d.lastEffect=u.next=u:(A=w.next,w.next=u,u.next=A,d.lastEffect=u)),u}function WA(){return Xs().memoizedState}function sy(u,d,w,A){var D=ro();ln.flags|=u,D.memoizedState=wm(1|d,w,void 0,A===void 0?null:A)}function ay(u,d,w,A){var D=Xs();A=A===void 0?null:A;var M=void 0;if(Mn!==null){var Q=Mn.memoizedState;if(M=Q.destroy,A!==null&&Q1(A,Q.deps)){D.memoizedState=wm(d,w,M,A);return}}ln.flags|=u,D.memoizedState=wm(1|d,w,M,A)}function VA(u,d){return sy(8390656,8,u,d)}function n2(u,d){return ay(2048,8,u,d)}function GA(u,d){return ay(4,2,u,d)}function qA(u,d){return ay(4,4,u,d)}function YA(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function XA(u,d,w){return w=w!=null?w.concat([u]):null,ay(4,4,YA.bind(null,d,u),w)}function i2(){}function KA(u,d){var w=Xs();d=d===void 0?null:d;var A=w.memoizedState;return A!==null&&d!==null&&Q1(d,A[1])?A[0]:(w.memoizedState=[u,d],u)}function ZA(u,d){var w=Xs();d=d===void 0?null:d;var A=w.memoizedState;return A!==null&&d!==null&&Q1(d,A[1])?A[0]:(u=u(),w.memoizedState=[u,d],u)}function QA(u,d,w){return(Oc&21)===0?(u.baseState&&(u.baseState=!1,ss=!0),u.memoizedState=w):(ys(w,d)||(w=ht(),ln.lanes|=w,Ic|=w,u.baseState=!0),d)}function k3(u,d){var w=zt;zt=w!==0&&4>w?w:4,u(!0);var A=Z1.transition;Z1.transition={};try{u(!1),d()}finally{zt=w,Z1.transition=A}}function JA(){return Xs().memoizedState}function T3(u,d,w){var A=lu(u);if(w={lane:A,action:w,hasEagerState:!1,eagerState:null,next:null},eC(u))tC(d,w);else if(w=DA(u,d,w,A),w!==null){var D=ji();_a(w,u,A,D),rC(w,d,A)}}function R3(u,d,w){var A=lu(u),D={lane:A,action:w,hasEagerState:!1,eagerState:null,next:null};if(eC(u))tC(d,D);else{var M=u.alternate;if(u.lanes===0&&(M===null||M.lanes===0)&&(M=d.lastRenderedReducer,M!==null))try{var Q=d.lastRenderedState,fe=M(Q,w);if(D.hasEagerState=!0,D.eagerState=fe,ys(fe,Q)){var xe=d.interleaved;xe===null?(D.next=D,V1(d)):(D.next=xe.next,xe.next=D),d.interleaved=D;return}}catch{}finally{}w=DA(u,d,D,A),w!==null&&(D=ji(),_a(w,u,A,D),rC(w,d,A))}}function eC(u){var d=u.alternate;return u===ln||d!==null&&d===ln}function tC(u,d){vm=iy=!0;var w=u.pending;w===null?d.next=d:(d.next=w.next,w.next=d),u.pending=d}function rC(u,d,w){if((w&4194240)!==0){var A=d.lanes;A&=u.pendingLanes,w|=A,d.lanes=w,sr(u,w)}}var oy={readContext:Ys,useCallback:xi,useContext:xi,useEffect:xi,useImperativeHandle:xi,useInsertionEffect:xi,useLayoutEffect:xi,useMemo:xi,useReducer:xi,useRef:xi,useState:xi,useDebugValue:xi,useDeferredValue:xi,useTransition:xi,useMutableSource:xi,useSyncExternalStore:xi,useId:xi,unstable_isNewReconciler:!1},N3={readContext:Ys,useCallback:function(u,d){return ro().memoizedState=[u,d===void 0?null:d],u},useContext:Ys,useEffect:VA,useImperativeHandle:function(u,d,w){return w=w!=null?w.concat([u]):null,sy(4194308,4,YA.bind(null,d,u),w)},useLayoutEffect:function(u,d){return sy(4194308,4,u,d)},useInsertionEffect:function(u,d){return sy(4,2,u,d)},useMemo:function(u,d){var w=ro();return d=d===void 0?null:d,u=u(),w.memoizedState=[u,d],u},useReducer:function(u,d,w){var A=ro();return d=w!==void 0?w(d):d,A.memoizedState=A.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},A.queue=u,u=u.dispatch=T3.bind(null,ln,u),[A.memoizedState,u]},useRef:function(u){var d=ro();return u={current:u},d.memoizedState=u},useState:HA,useDebugValue:i2,useDeferredValue:function(u){return ro().memoizedState=u},useTransition:function(){var u=HA(!1),d=u[0];return u=k3.bind(null,u[1]),ro().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,w){var A=ln,D=ro();if(Qr){if(w===void 0)throw Error(t(407));w=w()}else{if(w=d(),Gn===null)throw Error(t(349));(Oc&30)!==0||jA(A,d,w)}D.memoizedState=w;var M={value:w,getSnapshot:d};return D.queue=M,VA(zA.bind(null,A,M,u),[u]),A.flags|=2048,wm(9,BA.bind(null,A,M,w,d),void 0,null),w},useId:function(){var u=ro(),d=Gn.identifierPrefix;if(Qr){var w=Uo,A=$o;w=(A&~(1<<32-yi(A)-1)).toString(32)+w,d=":"+d+"R"+w,w=ym++,0<w&&(d+="H"+w.toString(32)),d+=":"}else w=C3++,d=":"+d+"r"+w.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},D3={readContext:Ys,useCallback:KA,useContext:Ys,useEffect:n2,useImperativeHandle:XA,useInsertionEffect:GA,useLayoutEffect:qA,useMemo:ZA,useReducer:t2,useRef:WA,useState:function(){return t2(bm)},useDebugValue:i2,useDeferredValue:function(u){var d=Xs();return QA(d,Mn.memoizedState,u)},useTransition:function(){var u=t2(bm)[0],d=Xs().memoizedState;return[u,d]},useMutableSource:FA,useSyncExternalStore:MA,useId:JA,unstable_isNewReconciler:!1},L3={readContext:Ys,useCallback:KA,useContext:Ys,useEffect:n2,useImperativeHandle:XA,useInsertionEffect:GA,useLayoutEffect:qA,useMemo:ZA,useReducer:r2,useRef:WA,useState:function(){return r2(bm)},useDebugValue:i2,useDeferredValue:function(u){var d=Xs();return Mn===null?d.memoizedState=u:QA(d,Mn.memoizedState,u)},useTransition:function(){var u=r2(bm)[0],d=Xs().memoizedState;return[u,d]},useMutableSource:FA,useSyncExternalStore:MA,useId:JA,unstable_isNewReconciler:!1};function ba(u,d){if(u&&u.defaultProps){d=ge({},d),u=u.defaultProps;for(var w in u)d[w]===void 0&&(d[w]=u[w]);return d}return d}function s2(u,d,w,A){d=u.memoizedState,w=w(A,d),w=w==null?d:ge({},d,w),u.memoizedState=w,u.lanes===0&&(u.updateQueue.baseState=w)}var ly={isMounted:function(u){return(u=u._reactInternals)?yn(u)===u:!1},enqueueSetState:function(u,d,w){u=u._reactInternals;var A=ji(),D=lu(u),M=Wo(A,D);M.payload=d,w!=null&&(M.callback=w),d=iu(u,M,D),d!==null&&(_a(d,u,D,A),ey(d,u,D))},enqueueReplaceState:function(u,d,w){u=u._reactInternals;var A=ji(),D=lu(u),M=Wo(A,D);M.tag=1,M.payload=d,w!=null&&(M.callback=w),d=iu(u,M,D),d!==null&&(_a(d,u,D,A),ey(d,u,D))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var w=ji(),A=lu(u),D=Wo(w,A);D.tag=2,d!=null&&(D.callback=d),d=iu(u,D,A),d!==null&&(_a(d,u,A,w),ey(d,u,A))}};function nC(u,d,w,A,D,M,Q){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(A,M,Q):d.prototype&&d.prototype.isPureReactComponent?!Cc(w,A)||!Cc(D,M):!0}function iC(u,d,w){var A=!1,D=tu,M=d.contextType;return typeof M=="object"&&M!==null?M=Ys(M):(D=is(d)?Rc:wi.current,A=d.contextTypes,M=(A=A!=null)?jh(u,D):tu),d=new d(w,M),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=ly,u.stateNode=d,d._reactInternals=u,A&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=D,u.__reactInternalMemoizedMaskedChildContext=M),d}function sC(u,d,w,A){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(w,A),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(w,A),d.state!==u&&ly.enqueueReplaceState(d,d.state,null)}function a2(u,d,w,A){var D=u.stateNode;D.props=w,D.state=u.memoizedState,D.refs={},G1(u);var M=d.contextType;typeof M=="object"&&M!==null?D.context=Ys(M):(M=is(d)?Rc:wi.current,D.context=jh(u,M)),D.state=u.memoizedState,M=d.getDerivedStateFromProps,typeof M=="function"&&(s2(u,d,M,w),D.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(d=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),d!==D.state&&ly.enqueueReplaceState(D,D.state,null),ty(u,w,D,A),D.state=u.memoizedState),typeof D.componentDidMount=="function"&&(u.flags|=4194308)}function Gh(u,d){try{var w="",A=d;do w+=ce(A),A=A.return;while(A);var D=w}catch(M){D=`
Error generating stack: `+M.message+`
`+M.stack}return{value:u,source:d,stack:D,digest:null}}function o2(u,d,w){return{value:u,source:null,stack:w??null,digest:d??null}}function l2(u,d){try{console.error(d.value)}catch(w){setTimeout(function(){throw w})}}var P3=typeof WeakMap=="function"?WeakMap:Map;function aC(u,d,w){w=Wo(-1,w),w.tag=3,w.payload={element:null};var A=d.value;return w.callback=function(){my||(my=!0,E2=A),l2(u,d)},w}function oC(u,d,w){w=Wo(-1,w),w.tag=3;var A=u.type.getDerivedStateFromError;if(typeof A=="function"){var D=d.value;w.payload=function(){return A(D)},w.callback=function(){l2(u,d)}}var M=u.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(w.callback=function(){l2(u,d),typeof A!="function"&&(au===null?au=new Set([this]):au.add(this));var Q=d.stack;this.componentDidCatch(d.value,{componentStack:Q!==null?Q:""})}),w}function lC(u,d,w){var A=u.pingCache;if(A===null){A=u.pingCache=new P3;var D=new Set;A.set(d,D)}else D=A.get(d),D===void 0&&(D=new Set,A.set(d,D));D.has(w)||(D.add(w),u=q3.bind(null,u,d,w),d.then(u,u))}function uC(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function cC(u,d,w,A,D){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(d=Wo(-1,1),d.tag=2,iu(w,d,1))),w.lanes|=1),u):(u.flags|=65536,u.lanes=D,u)}var O3=k.ReactCurrentOwner,ss=!1;function Mi(u,d,w,A){d.child=u===null?NA(d,null,w,A):Uh(d,u.child,w,A)}function dC(u,d,w,A,D){w=w.render;var M=d.ref;return Wh(d,D),A=J1(u,d,w,A,M,D),w=e2(),u!==null&&!ss?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~D,Vo(u,d,D)):(Qr&&w&&F1(d),d.flags|=1,Mi(u,d,A,D),d.child)}function hC(u,d,w,A,D){if(u===null){var M=w.type;return typeof M=="function"&&!N2(M)&&M.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(d.tag=15,d.type=M,fC(u,d,M,A,D)):(u=xy(w.type,null,A,d,d.mode,D),u.ref=d.ref,u.return=d,d.child=u)}if(M=u.child,(u.lanes&D)===0){var Q=M.memoizedProps;if(w=w.compare,w=w!==null?w:Cc,w(Q,A)&&u.ref===d.ref)return Vo(u,d,D)}return d.flags|=1,u=cu(M,A),u.ref=d.ref,u.return=d,d.child=u}function fC(u,d,w,A,D){if(u!==null){var M=u.memoizedProps;if(Cc(M,A)&&u.ref===d.ref)if(ss=!1,d.pendingProps=A=M,(u.lanes&D)!==0)(u.flags&131072)!==0&&(ss=!0);else return d.lanes=u.lanes,Vo(u,d,D)}return u2(u,d,w,A,D)}function pC(u,d,w){var A=d.pendingProps,D=A.children,M=u!==null?u.memoizedState:null;if(A.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ur(Yh,_s),_s|=w;else{if((w&1073741824)===0)return u=M!==null?M.baseLanes|w:w,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,Ur(Yh,_s),_s|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=M!==null?M.baseLanes:w,Ur(Yh,_s),_s|=A}else M!==null?(A=M.baseLanes|w,d.memoizedState=null):A=w,Ur(Yh,_s),_s|=A;return Mi(u,d,D,w),d.child}function mC(u,d){var w=d.ref;(u===null&&w!==null||u!==null&&u.ref!==w)&&(d.flags|=512,d.flags|=2097152)}function u2(u,d,w,A,D){var M=is(w)?Rc:wi.current;return M=jh(d,M),Wh(d,D),w=J1(u,d,w,A,M,D),A=e2(),u!==null&&!ss?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~D,Vo(u,d,D)):(Qr&&A&&F1(d),d.flags|=1,Mi(u,d,w,D),d.child)}function gC(u,d,w,A,D){if(is(w)){var M=!0;G0(d)}else M=!1;if(Wh(d,D),d.stateNode===null)cy(u,d),iC(d,w,A),a2(d,w,A,D),A=!0;else if(u===null){var Q=d.stateNode,fe=d.memoizedProps;Q.props=fe;var xe=Q.context,He=w.contextType;typeof He=="object"&&He!==null?He=Ys(He):(He=is(w)?Rc:wi.current,He=jh(d,He));var tt=w.getDerivedStateFromProps,ot=typeof tt=="function"||typeof Q.getSnapshotBeforeUpdate=="function";ot||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(fe!==A||xe!==He)&&sC(d,Q,A,He),nu=!1;var Je=d.memoizedState;Q.state=Je,ty(d,A,Q,D),xe=d.memoizedState,fe!==A||Je!==xe||ns.current||nu?(typeof tt=="function"&&(s2(d,w,tt,A),xe=d.memoizedState),(fe=nu||nC(d,w,fe,A,Je,xe,He))?(ot||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(d.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=A,d.memoizedState=xe),Q.props=A,Q.state=xe,Q.context=He,A=fe):(typeof Q.componentDidMount=="function"&&(d.flags|=4194308),A=!1)}else{Q=d.stateNode,LA(u,d),fe=d.memoizedProps,He=d.type===d.elementType?fe:ba(d.type,fe),Q.props=He,ot=d.pendingProps,Je=Q.context,xe=w.contextType,typeof xe=="object"&&xe!==null?xe=Ys(xe):(xe=is(w)?Rc:wi.current,xe=jh(d,xe));var Et=w.getDerivedStateFromProps;(tt=typeof Et=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(fe!==ot||Je!==xe)&&sC(d,Q,A,xe),nu=!1,Je=d.memoizedState,Q.state=Je,ty(d,A,Q,D);var Lt=d.memoizedState;fe!==ot||Je!==Lt||ns.current||nu?(typeof Et=="function"&&(s2(d,w,Et,A),Lt=d.memoizedState),(He=nu||nC(d,w,He,A,Je,Lt,xe)||!1)?(tt||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(A,Lt,xe),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(A,Lt,xe)),typeof Q.componentDidUpdate=="function"&&(d.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof Q.componentDidUpdate!="function"||fe===u.memoizedProps&&Je===u.memoizedState||(d.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Je===u.memoizedState||(d.flags|=1024),d.memoizedProps=A,d.memoizedState=Lt),Q.props=A,Q.state=Lt,Q.context=xe,A=He):(typeof Q.componentDidUpdate!="function"||fe===u.memoizedProps&&Je===u.memoizedState||(d.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Je===u.memoizedState||(d.flags|=1024),A=!1)}return c2(u,d,w,A,M,D)}function c2(u,d,w,A,D,M){mC(u,d);var Q=(d.flags&128)!==0;if(!A&&!Q)return D&&xA(d,w,!1),Vo(u,d,M);A=d.stateNode,O3.current=d;var fe=Q&&typeof w.getDerivedStateFromError!="function"?null:A.render();return d.flags|=1,u!==null&&Q?(d.child=Uh(d,u.child,null,M),d.child=Uh(d,null,fe,M)):Mi(u,d,fe,M),d.memoizedState=A.state,D&&xA(d,w,!0),d.child}function vC(u){var d=u.stateNode;d.pendingContext?bA(u,d.pendingContext,d.pendingContext!==d.context):d.context&&bA(u,d.context,!1),q1(u,d.containerInfo)}function yC(u,d,w,A,D){return $h(),z1(D),d.flags|=256,Mi(u,d,w,A),d.child}var d2={dehydrated:null,treeContext:null,retryLane:0};function h2(u){return{baseLanes:u,cachePool:null,transitions:null}}function bC(u,d,w){var A=d.pendingProps,D=on.current,M=!1,Q=(d.flags&128)!==0,fe;if((fe=Q)||(fe=u!==null&&u.memoizedState===null?!1:(D&2)!==0),fe?(M=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(D|=1),Ur(on,D&1),u===null)return B1(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(Q=A.children,u=A.fallback,M?(A=d.mode,M=d.child,Q={mode:"hidden",children:Q},(A&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=Q):M=_y(Q,A,0,null),u=Bc(u,A,w,null),M.return=d,u.return=d,M.sibling=u,d.child=M,d.child.memoizedState=h2(w),d.memoizedState=d2,u):f2(d,Q));if(D=u.memoizedState,D!==null&&(fe=D.dehydrated,fe!==null))return I3(u,d,Q,A,fe,D,w);if(M){M=A.fallback,Q=d.mode,D=u.child,fe=D.sibling;var xe={mode:"hidden",children:A.children};return(Q&1)===0&&d.child!==D?(A=d.child,A.childLanes=0,A.pendingProps=xe,d.deletions=null):(A=cu(D,xe),A.subtreeFlags=D.subtreeFlags&14680064),fe!==null?M=cu(fe,M):(M=Bc(M,Q,w,null),M.flags|=2),M.return=d,A.return=d,A.sibling=M,d.child=A,A=M,M=d.child,Q=u.child.memoizedState,Q=Q===null?h2(w):{baseLanes:Q.baseLanes|w,cachePool:null,transitions:Q.transitions},M.memoizedState=Q,M.childLanes=u.childLanes&~w,d.memoizedState=d2,A}return M=u.child,u=M.sibling,A=cu(M,{mode:"visible",children:A.children}),(d.mode&1)===0&&(A.lanes=w),A.return=d,A.sibling=null,u!==null&&(w=d.deletions,w===null?(d.deletions=[u],d.flags|=16):w.push(u)),d.child=A,d.memoizedState=null,A}function f2(u,d){return d=_y({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function uy(u,d,w,A){return A!==null&&z1(A),Uh(d,u.child,null,w),u=f2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function I3(u,d,w,A,D,M,Q){if(w)return d.flags&256?(d.flags&=-257,A=o2(Error(t(422))),uy(u,d,Q,A)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(M=A.fallback,D=d.mode,A=_y({mode:"visible",children:A.children},D,0,null),M=Bc(M,D,Q,null),M.flags|=2,A.return=d,M.return=d,A.sibling=M,d.child=A,(d.mode&1)!==0&&Uh(d,u.child,null,Q),d.child.memoizedState=h2(Q),d.memoizedState=d2,M);if((d.mode&1)===0)return uy(u,d,Q,null);if(D.data==="$!"){if(A=D.nextSibling&&D.nextSibling.dataset,A)var fe=A.dgst;return A=fe,M=Error(t(419)),A=o2(M,A,void 0),uy(u,d,Q,A)}if(fe=(Q&u.childLanes)!==0,ss||fe){if(A=Gn,A!==null){switch(Q&-Q){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}D=(D&(A.suspendedLanes|Q))!==0?0:D,D!==0&&D!==M.retryLane&&(M.retryLane=D,Ho(u,D),_a(A,u,D,-1))}return R2(),A=o2(Error(t(421))),uy(u,d,Q,A)}return D.data==="$?"?(d.flags|=128,d.child=u.child,d=Y3.bind(null,u),D._reactRetry=d,null):(u=M.treeContext,xs=Jl(D.nextSibling),ws=d,Qr=!0,ya=null,u!==null&&(Gs[qs++]=$o,Gs[qs++]=Uo,Gs[qs++]=Nc,$o=u.id,Uo=u.overflow,Nc=d),d=f2(d,A.children),d.flags|=4096,d)}function wC(u,d,w){u.lanes|=d;var A=u.alternate;A!==null&&(A.lanes|=d),W1(u.return,d,w)}function p2(u,d,w,A,D){var M=u.memoizedState;M===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:A,tail:w,tailMode:D}:(M.isBackwards=d,M.rendering=null,M.renderingStartTime=0,M.last=A,M.tail=w,M.tailMode=D)}function xC(u,d,w){var A=d.pendingProps,D=A.revealOrder,M=A.tail;if(Mi(u,d,A.children,w),A=on.current,(A&2)!==0)A=A&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&wC(u,w,d);else if(u.tag===19)wC(u,w,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}A&=1}if(Ur(on,A),(d.mode&1)===0)d.memoizedState=null;else switch(D){case"forwards":for(w=d.child,D=null;w!==null;)u=w.alternate,u!==null&&ry(u)===null&&(D=w),w=w.sibling;w=D,w===null?(D=d.child,d.child=null):(D=w.sibling,w.sibling=null),p2(d,!1,D,w,M);break;case"backwards":for(w=null,D=d.child,d.child=null;D!==null;){if(u=D.alternate,u!==null&&ry(u)===null){d.child=D;break}u=D.sibling,D.sibling=w,w=D,D=u}p2(d,!0,w,null,M);break;case"together":p2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function cy(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Vo(u,d,w){if(u!==null&&(d.dependencies=u.dependencies),Ic|=d.lanes,(w&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,w=cu(u,u.pendingProps),d.child=w,w.return=d;u.sibling!==null;)u=u.sibling,w=w.sibling=cu(u,u.pendingProps),w.return=d;w.sibling=null}return d.child}function F3(u,d,w){switch(d.tag){case 3:vC(d),$h();break;case 5:IA(d);break;case 1:is(d.type)&&G0(d);break;case 4:q1(d,d.stateNode.containerInfo);break;case 10:var A=d.type._context,D=d.memoizedProps.value;Ur(Q0,A._currentValue),A._currentValue=D;break;case 13:if(A=d.memoizedState,A!==null)return A.dehydrated!==null?(Ur(on,on.current&1),d.flags|=128,null):(w&d.child.childLanes)!==0?bC(u,d,w):(Ur(on,on.current&1),u=Vo(u,d,w),u!==null?u.sibling:null);Ur(on,on.current&1);break;case 19:if(A=(w&d.childLanes)!==0,(u.flags&128)!==0){if(A)return xC(u,d,w);d.flags|=128}if(D=d.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),Ur(on,on.current),A)break;return null;case 22:case 23:return d.lanes=0,pC(u,d,w)}return Vo(u,d,w)}var _C,m2,EC,SC;_C=function(u,d){for(var w=d.child;w!==null;){if(w.tag===5||w.tag===6)u.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===d)break;for(;w.sibling===null;){if(w.return===null||w.return===d)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},m2=function(){},EC=function(u,d,w,A){var D=u.memoizedProps;if(D!==A){u=d.stateNode,Pc(to.current);var M=null;switch(w){case"input":D=z(u,D),A=z(u,A),M=[];break;case"select":D=ge({},D,{value:void 0}),A=ge({},A,{value:void 0}),M=[];break;case"textarea":D=ye(u,D),A=ye(u,A),M=[];break;default:typeof D.onClick!="function"&&typeof A.onClick=="function"&&(u.onclick=H0)}se(w,A);var Q;w=null;for(He in D)if(!A.hasOwnProperty(He)&&D.hasOwnProperty(He)&&D[He]!=null)if(He==="style"){var fe=D[He];for(Q in fe)fe.hasOwnProperty(Q)&&(w||(w={}),w[Q]="")}else He!=="dangerouslySetInnerHTML"&&He!=="children"&&He!=="suppressContentEditableWarning"&&He!=="suppressHydrationWarning"&&He!=="autoFocus"&&(n.hasOwnProperty(He)?M||(M=[]):(M=M||[]).push(He,null));for(He in A){var xe=A[He];if(fe=D!=null?D[He]:void 0,A.hasOwnProperty(He)&&xe!==fe&&(xe!=null||fe!=null))if(He==="style")if(fe){for(Q in fe)!fe.hasOwnProperty(Q)||xe&&xe.hasOwnProperty(Q)||(w||(w={}),w[Q]="");for(Q in xe)xe.hasOwnProperty(Q)&&fe[Q]!==xe[Q]&&(w||(w={}),w[Q]=xe[Q])}else w||(M||(M=[]),M.push(He,w)),w=xe;else He==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,fe=fe?fe.__html:void 0,xe!=null&&fe!==xe&&(M=M||[]).push(He,xe)):He==="children"?typeof xe!="string"&&typeof xe!="number"||(M=M||[]).push(He,""+xe):He!=="suppressContentEditableWarning"&&He!=="suppressHydrationWarning"&&(n.hasOwnProperty(He)?(xe!=null&&He==="onScroll"&&Gr("scroll",u),M||fe===xe||(M=[])):(M=M||[]).push(He,xe))}w&&(M=M||[]).push("style",w);var He=M;(d.updateQueue=He)&&(d.flags|=4)}},SC=function(u,d,w,A){w!==A&&(d.flags|=4)};function xm(u,d){if(!Qr)switch(u.tailMode){case"hidden":d=u.tail;for(var w=null;d!==null;)d.alternate!==null&&(w=d),d=d.sibling;w===null?u.tail=null:w.sibling=null;break;case"collapsed":w=u.tail;for(var A=null;w!==null;)w.alternate!==null&&(A=w),w=w.sibling;A===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:A.sibling=null}}function _i(u){var d=u.alternate!==null&&u.alternate.child===u.child,w=0,A=0;if(d)for(var D=u.child;D!==null;)w|=D.lanes|D.childLanes,A|=D.subtreeFlags&14680064,A|=D.flags&14680064,D.return=u,D=D.sibling;else for(D=u.child;D!==null;)w|=D.lanes|D.childLanes,A|=D.subtreeFlags,A|=D.flags,D.return=u,D=D.sibling;return u.subtreeFlags|=A,u.childLanes=w,d}function M3(u,d,w){var A=d.pendingProps;switch(M1(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(d),null;case 1:return is(d.type)&&V0(),_i(d),null;case 3:return A=d.stateNode,Vh(),qr(ns),qr(wi),K1(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(u===null||u.child===null)&&(K0(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,ya!==null&&(C2(ya),ya=null))),m2(u,d),_i(d),null;case 5:Y1(d);var D=Pc(gm.current);if(w=d.type,u!==null&&d.stateNode!=null)EC(u,d,w,A,D),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!A){if(d.stateNode===null)throw Error(t(166));return _i(d),null}if(u=Pc(to.current),K0(d)){A=d.stateNode,w=d.type;var M=d.memoizedProps;switch(A[eo]=d,A[dm]=M,u=(d.mode&1)!==0,w){case"dialog":Gr("cancel",A),Gr("close",A);break;case"iframe":case"object":case"embed":Gr("load",A);break;case"video":case"audio":for(D=0;D<lm.length;D++)Gr(lm[D],A);break;case"source":Gr("error",A);break;case"img":case"image":case"link":Gr("error",A),Gr("load",A);break;case"details":Gr("toggle",A);break;case"input":Le(A,M),Gr("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!M.multiple},Gr("invalid",A);break;case"textarea":Ue(A,M),Gr("invalid",A)}se(w,M),D=null;for(var Q in M)if(M.hasOwnProperty(Q)){var fe=M[Q];Q==="children"?typeof fe=="string"?A.textContent!==fe&&(M.suppressHydrationWarning!==!0&&U0(A.textContent,fe,u),D=["children",fe]):typeof fe=="number"&&A.textContent!==""+fe&&(M.suppressHydrationWarning!==!0&&U0(A.textContent,fe,u),D=["children",""+fe]):n.hasOwnProperty(Q)&&fe!=null&&Q==="onScroll"&&Gr("scroll",A)}switch(w){case"input":at(A),oe(A,M,!0);break;case"textarea":at(A),Ke(A);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(A.onclick=H0)}A=D,d.updateQueue=A,A!==null&&(d.flags|=4)}else{Q=D.nodeType===9?D:D.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=yt(w)),u==="http://www.w3.org/1999/xhtml"?w==="script"?(u=Q.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof A.is=="string"?u=Q.createElement(w,{is:A.is}):(u=Q.createElement(w),w==="select"&&(Q=u,A.multiple?Q.multiple=!0:A.size&&(Q.size=A.size))):u=Q.createElementNS(u,w),u[eo]=d,u[dm]=A,_C(u,d,!1,!1),d.stateNode=u;e:{switch(Q=Ye(w,A),w){case"dialog":Gr("cancel",u),Gr("close",u),D=A;break;case"iframe":case"object":case"embed":Gr("load",u),D=A;break;case"video":case"audio":for(D=0;D<lm.length;D++)Gr(lm[D],u);D=A;break;case"source":Gr("error",u),D=A;break;case"img":case"image":case"link":Gr("error",u),Gr("load",u),D=A;break;case"details":Gr("toggle",u),D=A;break;case"input":Le(u,A),D=z(u,A),Gr("invalid",u);break;case"option":D=A;break;case"select":u._wrapperState={wasMultiple:!!A.multiple},D=ge({},A,{value:void 0}),Gr("invalid",u);break;case"textarea":Ue(u,A),D=ye(u,A),Gr("invalid",u);break;default:D=A}se(w,D),fe=D;for(M in fe)if(fe.hasOwnProperty(M)){var xe=fe[M];M==="style"?Xt(u,xe):M==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,xe!=null&&ar(u,xe)):M==="children"?typeof xe=="string"?(w!=="textarea"||xe!=="")&&cr(u,xe):typeof xe=="number"&&cr(u,""+xe):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(n.hasOwnProperty(M)?xe!=null&&M==="onScroll"&&Gr("scroll",u):xe!=null&&S(u,M,xe,Q))}switch(w){case"input":at(u),oe(u,A,!1);break;case"textarea":at(u),Ke(u);break;case"option":A.value!=null&&u.setAttribute("value",""+$e(A.value));break;case"select":u.multiple=!!A.multiple,M=A.value,M!=null?Te(u,!!A.multiple,M,!1):A.defaultValue!=null&&Te(u,!!A.multiple,A.defaultValue,!0);break;default:typeof D.onClick=="function"&&(u.onclick=H0)}switch(w){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return _i(d),null;case 6:if(u&&d.stateNode!=null)SC(u,d,u.memoizedProps,A);else{if(typeof A!="string"&&d.stateNode===null)throw Error(t(166));if(w=Pc(gm.current),Pc(to.current),K0(d)){if(A=d.stateNode,w=d.memoizedProps,A[eo]=d,(M=A.nodeValue!==w)&&(u=ws,u!==null))switch(u.tag){case 3:U0(A.nodeValue,w,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&U0(A.nodeValue,w,(u.mode&1)!==0)}M&&(d.flags|=4)}else A=(w.nodeType===9?w:w.ownerDocument).createTextNode(A),A[eo]=d,d.stateNode=A}return _i(d),null;case 13:if(qr(on),A=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Qr&&xs!==null&&(d.mode&1)!==0&&(d.flags&128)===0)kA(),$h(),d.flags|=98560,M=!1;else if(M=K0(d),A!==null&&A.dehydrated!==null){if(u===null){if(!M)throw Error(t(318));if(M=d.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(t(317));M[eo]=d}else $h(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;_i(d),M=!1}else ya!==null&&(C2(ya),ya=null),M=!0;if(!M)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=w,d):(A=A!==null,A!==(u!==null&&u.memoizedState!==null)&&A&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(on.current&1)!==0?jn===0&&(jn=3):R2())),d.updateQueue!==null&&(d.flags|=4),_i(d),null);case 4:return Vh(),m2(u,d),u===null&&um(d.stateNode.containerInfo),_i(d),null;case 10:return H1(d.type._context),_i(d),null;case 17:return is(d.type)&&V0(),_i(d),null;case 19:if(qr(on),M=d.memoizedState,M===null)return _i(d),null;if(A=(d.flags&128)!==0,Q=M.rendering,Q===null)if(A)xm(M,!1);else{if(jn!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(Q=ry(u),Q!==null){for(d.flags|=128,xm(M,!1),A=Q.updateQueue,A!==null&&(d.updateQueue=A,d.flags|=4),d.subtreeFlags=0,A=w,w=d.child;w!==null;)M=w,u=A,M.flags&=14680066,Q=M.alternate,Q===null?(M.childLanes=0,M.lanes=u,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=Q.childLanes,M.lanes=Q.lanes,M.child=Q.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=Q.memoizedProps,M.memoizedState=Q.memoizedState,M.updateQueue=Q.updateQueue,M.type=Q.type,u=Q.dependencies,M.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),w=w.sibling;return Ur(on,on.current&1|2),d.child}u=u.sibling}M.tail!==null&&yr()>Xh&&(d.flags|=128,A=!0,xm(M,!1),d.lanes=4194304)}else{if(!A)if(u=ry(Q),u!==null){if(d.flags|=128,A=!0,w=u.updateQueue,w!==null&&(d.updateQueue=w,d.flags|=4),xm(M,!0),M.tail===null&&M.tailMode==="hidden"&&!Q.alternate&&!Qr)return _i(d),null}else 2*yr()-M.renderingStartTime>Xh&&w!==1073741824&&(d.flags|=128,A=!0,xm(M,!1),d.lanes=4194304);M.isBackwards?(Q.sibling=d.child,d.child=Q):(w=M.last,w!==null?w.sibling=Q:d.child=Q,M.last=Q)}return M.tail!==null?(d=M.tail,M.rendering=d,M.tail=d.sibling,M.renderingStartTime=yr(),d.sibling=null,w=on.current,Ur(on,A?w&1|2:w&1),d):(_i(d),null);case 22:case 23:return T2(),A=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==A&&(d.flags|=8192),A&&(d.mode&1)!==0?(_s&1073741824)!==0&&(_i(d),d.subtreeFlags&6&&(d.flags|=8192)):_i(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function j3(u,d){switch(M1(d),d.tag){case 1:return is(d.type)&&V0(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return Vh(),qr(ns),qr(wi),K1(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return Y1(d),null;case 13:if(qr(on),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));$h()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return qr(on),null;case 4:return Vh(),null;case 10:return H1(d.type._context),null;case 22:case 23:return T2(),null;case 24:return null;default:return null}}var dy=!1,Ei=!1,B3=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function qh(u,d){var w=u.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(A){fn(u,d,A)}else w.current=null}function g2(u,d,w){try{w()}catch(A){fn(u,d,A)}}var AC=!1;function z3(u,d){if(T1=Ah,u=W(),$(u)){if("selectionStart"in u)var w={start:u.selectionStart,end:u.selectionEnd};else e:{w=(w=u.ownerDocument)&&w.defaultView||window;var A=w.getSelection&&w.getSelection();if(A&&A.rangeCount!==0){w=A.anchorNode;var D=A.anchorOffset,M=A.focusNode;A=A.focusOffset;try{w.nodeType,M.nodeType}catch{w=null;break e}var Q=0,fe=-1,xe=-1,He=0,tt=0,ot=u,Je=null;t:for(;;){for(var Et;ot!==w||D!==0&&ot.nodeType!==3||(fe=Q+D),ot!==M||A!==0&&ot.nodeType!==3||(xe=Q+A),ot.nodeType===3&&(Q+=ot.nodeValue.length),(Et=ot.firstChild)!==null;)Je=ot,ot=Et;for(;;){if(ot===u)break t;if(Je===w&&++He===D&&(fe=Q),Je===M&&++tt===A&&(xe=Q),(Et=ot.nextSibling)!==null)break;ot=Je,Je=ot.parentNode}ot=Et}w=fe===-1||xe===-1?null:{start:fe,end:xe}}else w=null}w=w||{start:0,end:0}}else w=null;for(R1={focusedElem:u,selectionRange:w},Ah=!1,Tt=d;Tt!==null;)if(d=Tt,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,Tt=u;else for(;Tt!==null;){d=Tt;try{var Lt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Lt!==null){var Pt=Lt.memoizedProps,xn=Lt.memoizedState,Me=d.stateNode,ke=Me.getSnapshotBeforeUpdate(d.elementType===d.type?Pt:ba(d.type,Pt),xn);Me.__reactInternalSnapshotBeforeUpdate=ke}break;case 3:var ze=d.stateNode.containerInfo;ze.nodeType===1?ze.textContent="":ze.nodeType===9&&ze.documentElement&&ze.removeChild(ze.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(dt){fn(d,d.return,dt)}if(u=d.sibling,u!==null){u.return=d.return,Tt=u;break}Tt=d.return}return Lt=AC,AC=!1,Lt}function _m(u,d,w){var A=d.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var D=A=A.next;do{if((D.tag&u)===u){var M=D.destroy;D.destroy=void 0,M!==void 0&&g2(d,w,M)}D=D.next}while(D!==A)}}function hy(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var w=d=d.next;do{if((w.tag&u)===u){var A=w.create;w.destroy=A()}w=w.next}while(w!==d)}}function v2(u){var d=u.ref;if(d!==null){var w=u.stateNode;switch(u.tag){case 5:u=w;break;default:u=w}typeof d=="function"?d(u):d.current=u}}function CC(u){var d=u.alternate;d!==null&&(u.alternate=null,CC(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[eo],delete d[dm],delete d[P1],delete d[_3],delete d[E3])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function kC(u){return u.tag===5||u.tag===3||u.tag===4}function TC(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||kC(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function y2(u,d,w){var A=u.tag;if(A===5||A===6)u=u.stateNode,d?w.nodeType===8?w.parentNode.insertBefore(u,d):w.insertBefore(u,d):(w.nodeType===8?(d=w.parentNode,d.insertBefore(u,w)):(d=w,d.appendChild(u)),w=w._reactRootContainer,w!=null||d.onclick!==null||(d.onclick=H0));else if(A!==4&&(u=u.child,u!==null))for(y2(u,d,w),u=u.sibling;u!==null;)y2(u,d,w),u=u.sibling}function b2(u,d,w){var A=u.tag;if(A===5||A===6)u=u.stateNode,d?w.insertBefore(u,d):w.appendChild(u);else if(A!==4&&(u=u.child,u!==null))for(b2(u,d,w),u=u.sibling;u!==null;)b2(u,d,w),u=u.sibling}var ii=null,wa=!1;function su(u,d,w){for(w=w.child;w!==null;)RC(u,d,w),w=w.sibling}function RC(u,d,w){if(ti&&typeof ti.onCommitFiberUnmount=="function")try{ti.onCommitFiberUnmount(Xa,w)}catch{}switch(w.tag){case 5:Ei||qh(w,d);case 6:var A=ii,D=wa;ii=null,su(u,d,w),ii=A,wa=D,ii!==null&&(wa?(u=ii,w=w.stateNode,u.nodeType===8?u.parentNode.removeChild(w):u.removeChild(w)):ii.removeChild(w.stateNode));break;case 18:ii!==null&&(wa?(u=ii,w=w.stateNode,u.nodeType===8?L1(u.parentNode,w):u.nodeType===1&&L1(u,w),vc(u)):L1(ii,w.stateNode));break;case 4:A=ii,D=wa,ii=w.stateNode.containerInfo,wa=!0,su(u,d,w),ii=A,wa=D;break;case 0:case 11:case 14:case 15:if(!Ei&&(A=w.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){D=A=A.next;do{var M=D,Q=M.destroy;M=M.tag,Q!==void 0&&((M&2)!==0||(M&4)!==0)&&g2(w,d,Q),D=D.next}while(D!==A)}su(u,d,w);break;case 1:if(!Ei&&(qh(w,d),A=w.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=w.memoizedProps,A.state=w.memoizedState,A.componentWillUnmount()}catch(fe){fn(w,d,fe)}su(u,d,w);break;case 21:su(u,d,w);break;case 22:w.mode&1?(Ei=(A=Ei)||w.memoizedState!==null,su(u,d,w),Ei=A):su(u,d,w);break;default:su(u,d,w)}}function NC(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var w=u.stateNode;w===null&&(w=u.stateNode=new B3),d.forEach(function(A){var D=X3.bind(null,u,A);w.has(A)||(w.add(A),A.then(D,D))})}}function xa(u,d){var w=d.deletions;if(w!==null)for(var A=0;A<w.length;A++){var D=w[A];try{var M=u,Q=d,fe=Q;e:for(;fe!==null;){switch(fe.tag){case 5:ii=fe.stateNode,wa=!1;break e;case 3:ii=fe.stateNode.containerInfo,wa=!0;break e;case 4:ii=fe.stateNode.containerInfo,wa=!0;break e}fe=fe.return}if(ii===null)throw Error(t(160));RC(M,Q,D),ii=null,wa=!1;var xe=D.alternate;xe!==null&&(xe.return=null),D.return=null}catch(He){fn(D,d,He)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)DC(d,u),d=d.sibling}function DC(u,d){var w=u.alternate,A=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(xa(d,u),no(u),A&4){try{_m(3,u,u.return),hy(3,u)}catch(Pt){fn(u,u.return,Pt)}try{_m(5,u,u.return)}catch(Pt){fn(u,u.return,Pt)}}break;case 1:xa(d,u),no(u),A&512&&w!==null&&qh(w,w.return);break;case 5:if(xa(d,u),no(u),A&512&&w!==null&&qh(w,w.return),u.flags&32){var D=u.stateNode;try{cr(D,"")}catch(Pt){fn(u,u.return,Pt)}}if(A&4&&(D=u.stateNode,D!=null)){var M=u.memoizedProps,Q=w!==null?w.memoizedProps:M,fe=u.type,xe=u.updateQueue;if(u.updateQueue=null,xe!==null)try{fe==="input"&&M.type==="radio"&&M.name!=null&&_e(D,M),Ye(fe,Q);var He=Ye(fe,M);for(Q=0;Q<xe.length;Q+=2){var tt=xe[Q],ot=xe[Q+1];tt==="style"?Xt(D,ot):tt==="dangerouslySetInnerHTML"?ar(D,ot):tt==="children"?cr(D,ot):S(D,tt,ot,He)}switch(fe){case"input":ue(D,M);break;case"textarea":rt(D,M);break;case"select":var Je=D._wrapperState.wasMultiple;D._wrapperState.wasMultiple=!!M.multiple;var Et=M.value;Et!=null?Te(D,!!M.multiple,Et,!1):Je!==!!M.multiple&&(M.defaultValue!=null?Te(D,!!M.multiple,M.defaultValue,!0):Te(D,!!M.multiple,M.multiple?[]:"",!1))}D[dm]=M}catch(Pt){fn(u,u.return,Pt)}}break;case 6:if(xa(d,u),no(u),A&4){if(u.stateNode===null)throw Error(t(162));D=u.stateNode,M=u.memoizedProps;try{D.nodeValue=M}catch(Pt){fn(u,u.return,Pt)}}break;case 3:if(xa(d,u),no(u),A&4&&w!==null&&w.memoizedState.isDehydrated)try{vc(d.containerInfo)}catch(Pt){fn(u,u.return,Pt)}break;case 4:xa(d,u),no(u);break;case 13:xa(d,u),no(u),D=u.child,D.flags&8192&&(M=D.memoizedState!==null,D.stateNode.isHidden=M,!M||D.alternate!==null&&D.alternate.memoizedState!==null||(_2=yr())),A&4&&NC(u);break;case 22:if(tt=w!==null&&w.memoizedState!==null,u.mode&1?(Ei=(He=Ei)||tt,xa(d,u),Ei=He):xa(d,u),no(u),A&8192){if(He=u.memoizedState!==null,(u.stateNode.isHidden=He)&&!tt&&(u.mode&1)!==0)for(Tt=u,tt=u.child;tt!==null;){for(ot=Tt=tt;Tt!==null;){switch(Je=Tt,Et=Je.child,Je.tag){case 0:case 11:case 14:case 15:_m(4,Je,Je.return);break;case 1:qh(Je,Je.return);var Lt=Je.stateNode;if(typeof Lt.componentWillUnmount=="function"){A=Je,w=Je.return;try{d=A,Lt.props=d.memoizedProps,Lt.state=d.memoizedState,Lt.componentWillUnmount()}catch(Pt){fn(A,w,Pt)}}break;case 5:qh(Je,Je.return);break;case 22:if(Je.memoizedState!==null){OC(ot);continue}}Et!==null?(Et.return=Je,Tt=Et):OC(ot)}tt=tt.sibling}e:for(tt=null,ot=u;;){if(ot.tag===5){if(tt===null){tt=ot;try{D=ot.stateNode,He?(M=D.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(fe=ot.stateNode,xe=ot.memoizedProps.style,Q=xe!=null&&xe.hasOwnProperty("display")?xe.display:null,fe.style.display=Bt("display",Q))}catch(Pt){fn(u,u.return,Pt)}}}else if(ot.tag===6){if(tt===null)try{ot.stateNode.nodeValue=He?"":ot.memoizedProps}catch(Pt){fn(u,u.return,Pt)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===u)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===u)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===u)break e;tt===ot&&(tt=null),ot=ot.return}tt===ot&&(tt=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:xa(d,u),no(u),A&4&&NC(u);break;case 21:break;default:xa(d,u),no(u)}}function no(u){var d=u.flags;if(d&2){try{e:{for(var w=u.return;w!==null;){if(kC(w)){var A=w;break e}w=w.return}throw Error(t(160))}switch(A.tag){case 5:var D=A.stateNode;A.flags&32&&(cr(D,""),A.flags&=-33);var M=TC(u);b2(u,M,D);break;case 3:case 4:var Q=A.stateNode.containerInfo,fe=TC(u);y2(u,fe,Q);break;default:throw Error(t(161))}}catch(xe){fn(u,u.return,xe)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function $3(u,d,w){Tt=u,LC(u)}function LC(u,d,w){for(var A=(u.mode&1)!==0;Tt!==null;){var D=Tt,M=D.child;if(D.tag===22&&A){var Q=D.memoizedState!==null||dy;if(!Q){var fe=D.alternate,xe=fe!==null&&fe.memoizedState!==null||Ei;fe=dy;var He=Ei;if(dy=Q,(Ei=xe)&&!He)for(Tt=D;Tt!==null;)Q=Tt,xe=Q.child,Q.tag===22&&Q.memoizedState!==null?IC(D):xe!==null?(xe.return=Q,Tt=xe):IC(D);for(;M!==null;)Tt=M,LC(M),M=M.sibling;Tt=D,dy=fe,Ei=He}PC(u)}else(D.subtreeFlags&8772)!==0&&M!==null?(M.return=D,Tt=M):PC(u)}}function PC(u){for(;Tt!==null;){var d=Tt;if((d.flags&8772)!==0){var w=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Ei||hy(5,d);break;case 1:var A=d.stateNode;if(d.flags&4&&!Ei)if(w===null)A.componentDidMount();else{var D=d.elementType===d.type?w.memoizedProps:ba(d.type,w.memoizedProps);A.componentDidUpdate(D,w.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var M=d.updateQueue;M!==null&&OA(d,M,A);break;case 3:var Q=d.updateQueue;if(Q!==null){if(w=null,d.child!==null)switch(d.child.tag){case 5:w=d.child.stateNode;break;case 1:w=d.child.stateNode}OA(d,Q,w)}break;case 5:var fe=d.stateNode;if(w===null&&d.flags&4){w=fe;var xe=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":xe.autoFocus&&w.focus();break;case"img":xe.src&&(w.src=xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var He=d.alternate;if(He!==null){var tt=He.memoizedState;if(tt!==null){var ot=tt.dehydrated;ot!==null&&vc(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ei||d.flags&512&&v2(d)}catch(Je){fn(d,d.return,Je)}}if(d===u){Tt=null;break}if(w=d.sibling,w!==null){w.return=d.return,Tt=w;break}Tt=d.return}}function OC(u){for(;Tt!==null;){var d=Tt;if(d===u){Tt=null;break}var w=d.sibling;if(w!==null){w.return=d.return,Tt=w;break}Tt=d.return}}function IC(u){for(;Tt!==null;){var d=Tt;try{switch(d.tag){case 0:case 11:case 15:var w=d.return;try{hy(4,d)}catch(xe){fn(d,w,xe)}break;case 1:var A=d.stateNode;if(typeof A.componentDidMount=="function"){var D=d.return;try{A.componentDidMount()}catch(xe){fn(d,D,xe)}}var M=d.return;try{v2(d)}catch(xe){fn(d,M,xe)}break;case 5:var Q=d.return;try{v2(d)}catch(xe){fn(d,Q,xe)}}}catch(xe){fn(d,d.return,xe)}if(d===u){Tt=null;break}var fe=d.sibling;if(fe!==null){fe.return=d.return,Tt=fe;break}Tt=d.return}}var U3=Math.ceil,fy=k.ReactCurrentDispatcher,w2=k.ReactCurrentOwner,Ks=k.ReactCurrentBatchConfig,xr=0,Gn=null,Tn=null,si=0,_s=0,Yh=eu(0),jn=0,Em=null,Ic=0,py=0,x2=0,Sm=null,as=null,_2=0,Xh=1/0,Go=null,my=!1,E2=null,au=null,gy=!1,ou=null,vy=0,Am=0,S2=null,yy=-1,by=0;function ji(){return(xr&6)!==0?yr():yy!==-1?yy:yy=yr()}function lu(u){return(u.mode&1)===0?1:(xr&2)!==0&&si!==0?si&-si:A3.transition!==null?(by===0&&(by=ht()),by):(u=zt,u!==0||(u=window.event,u=u===void 0?16:Ch(u.type)),u)}function _a(u,d,w,A){if(50<Am)throw Am=0,S2=null,Error(t(185));Wt(u,w,A),((xr&2)===0||u!==Gn)&&(u===Gn&&((xr&2)===0&&(py|=w),jn===4&&uu(u,si)),os(u,A),w===1&&xr===0&&(d.mode&1)===0&&(Xh=yr()+500,q0&&ru()))}function os(u,d){var w=u.callbackNode;lt(u,d);var A=Ge(u,u===Gn?si:0);if(A===0)w!==null&&Fo(w),u.callbackNode=null,u.callbackPriority=0;else if(d=A&-A,u.callbackPriority!==d){if(w!=null&&Fo(w),d===1)u.tag===0?S3(MC.bind(null,u)):_A(MC.bind(null,u)),w3(function(){(xr&6)===0&&ru()}),w=null;else{switch(zr(A)){case 1:w=kn;break;case 4:w=_h;break;case 16:w=ga;break;case 536870912:w=Gl;break;default:w=ga}w=VC(w,FC.bind(null,u))}u.callbackPriority=d,u.callbackNode=w}}function FC(u,d){if(yy=-1,by=0,(xr&6)!==0)throw Error(t(327));var w=u.callbackNode;if(Kh()&&u.callbackNode!==w)return null;var A=Ge(u,u===Gn?si:0);if(A===0)return null;if((A&30)!==0||(A&u.expiredLanes)!==0||d)d=wy(u,A);else{d=A;var D=xr;xr|=2;var M=BC();(Gn!==u||si!==d)&&(Go=null,Xh=yr()+500,Mc(u,d));do try{V3();break}catch(fe){jC(u,fe)}while(!0);U1(),fy.current=M,xr=D,Tn!==null?d=0:(Gn=null,si=0,d=jn)}if(d!==0){if(d===2&&(D=nt(u),D!==0&&(A=D,d=A2(u,D))),d===1)throw w=Em,Mc(u,0),uu(u,A),os(u,yr()),w;if(d===6)uu(u,A);else{if(D=u.current.alternate,(A&30)===0&&!H3(D)&&(d=wy(u,A),d===2&&(M=nt(u),M!==0&&(A=M,d=A2(u,M))),d===1))throw w=Em,Mc(u,0),uu(u,A),os(u,yr()),w;switch(u.finishedWork=D,u.finishedLanes=A,d){case 0:case 1:throw Error(t(345));case 2:jc(u,as,Go);break;case 3:if(uu(u,A),(A&130023424)===A&&(d=_2+500-yr(),10<d)){if(Ge(u,0)!==0)break;if(D=u.suspendedLanes,(D&A)!==A){ji(),u.pingedLanes|=u.suspendedLanes&D;break}u.timeoutHandle=D1(jc.bind(null,u,as,Go),d);break}jc(u,as,Go);break;case 4:if(uu(u,A),(A&4194240)===A)break;for(d=u.eventTimes,D=-1;0<A;){var Q=31-yi(A);M=1<<Q,Q=d[Q],Q>D&&(D=Q),A&=~M}if(A=D,A=yr()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*U3(A/1960))-A,10<A){u.timeoutHandle=D1(jc.bind(null,u,as,Go),A);break}jc(u,as,Go);break;case 5:jc(u,as,Go);break;default:throw Error(t(329))}}}return os(u,yr()),u.callbackNode===w?FC.bind(null,u):null}function A2(u,d){var w=Sm;return u.current.memoizedState.isDehydrated&&(Mc(u,d).flags|=256),u=wy(u,d),u!==2&&(d=as,as=w,d!==null&&C2(d)),u}function C2(u){as===null?as=u:as.push.apply(as,u)}function H3(u){for(var d=u;;){if(d.flags&16384){var w=d.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var A=0;A<w.length;A++){var D=w[A],M=D.getSnapshot;D=D.value;try{if(!ys(M(),D))return!1}catch{return!1}}}if(w=d.child,d.subtreeFlags&16384&&w!==null)w.return=d,d=w;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function uu(u,d){for(d&=~x2,d&=~py,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var w=31-yi(d),A=1<<w;u[w]=-1,d&=~A}}function MC(u){if((xr&6)!==0)throw Error(t(327));Kh();var d=Ge(u,0);if((d&1)===0)return os(u,yr()),null;var w=wy(u,d);if(u.tag!==0&&w===2){var A=nt(u);A!==0&&(d=A,w=A2(u,A))}if(w===1)throw w=Em,Mc(u,0),uu(u,d),os(u,yr()),w;if(w===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,jc(u,as,Go),os(u,yr()),null}function k2(u,d){var w=xr;xr|=1;try{return u(d)}finally{xr=w,xr===0&&(Xh=yr()+500,q0&&ru())}}function Fc(u){ou!==null&&ou.tag===0&&(xr&6)===0&&Kh();var d=xr;xr|=1;var w=Ks.transition,A=zt;try{if(Ks.transition=null,zt=1,u)return u()}finally{zt=A,Ks.transition=w,xr=d,(xr&6)===0&&ru()}}function T2(){_s=Yh.current,qr(Yh)}function Mc(u,d){u.finishedWork=null,u.finishedLanes=0;var w=u.timeoutHandle;if(w!==-1&&(u.timeoutHandle=-1,b3(w)),Tn!==null)for(w=Tn.return;w!==null;){var A=w;switch(M1(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&V0();break;case 3:Vh(),qr(ns),qr(wi),K1();break;case 5:Y1(A);break;case 4:Vh();break;case 13:qr(on);break;case 19:qr(on);break;case 10:H1(A.type._context);break;case 22:case 23:T2()}w=w.return}if(Gn=u,Tn=u=cu(u.current,null),si=_s=d,jn=0,Em=null,x2=py=Ic=0,as=Sm=null,Lc!==null){for(d=0;d<Lc.length;d++)if(w=Lc[d],A=w.interleaved,A!==null){w.interleaved=null;var D=A.next,M=w.pending;if(M!==null){var Q=M.next;M.next=D,A.next=Q}w.pending=A}Lc=null}return u}function jC(u,d){do{var w=Tn;try{if(U1(),ny.current=oy,iy){for(var A=ln.memoizedState;A!==null;){var D=A.queue;D!==null&&(D.pending=null),A=A.next}iy=!1}if(Oc=0,Vn=Mn=ln=null,vm=!1,ym=0,w2.current=null,w===null||w.return===null){jn=1,Em=d,Tn=null;break}e:{var M=u,Q=w.return,fe=w,xe=d;if(d=si,fe.flags|=32768,xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var He=xe,tt=fe,ot=tt.tag;if((tt.mode&1)===0&&(ot===0||ot===11||ot===15)){var Je=tt.alternate;Je?(tt.updateQueue=Je.updateQueue,tt.memoizedState=Je.memoizedState,tt.lanes=Je.lanes):(tt.updateQueue=null,tt.memoizedState=null)}var Et=uC(Q);if(Et!==null){Et.flags&=-257,cC(Et,Q,fe,M,d),Et.mode&1&&lC(M,He,d),d=Et,xe=He;var Lt=d.updateQueue;if(Lt===null){var Pt=new Set;Pt.add(xe),d.updateQueue=Pt}else Lt.add(xe);break e}else{if((d&1)===0){lC(M,He,d),R2();break e}xe=Error(t(426))}}else if(Qr&&fe.mode&1){var xn=uC(Q);if(xn!==null){(xn.flags&65536)===0&&(xn.flags|=256),cC(xn,Q,fe,M,d),z1(Gh(xe,fe));break e}}M=xe=Gh(xe,fe),jn!==4&&(jn=2),Sm===null?Sm=[M]:Sm.push(M),M=Q;do{switch(M.tag){case 3:M.flags|=65536,d&=-d,M.lanes|=d;var Me=aC(M,xe,d);PA(M,Me);break e;case 1:fe=xe;var ke=M.type,ze=M.stateNode;if((M.flags&128)===0&&(typeof ke.getDerivedStateFromError=="function"||ze!==null&&typeof ze.componentDidCatch=="function"&&(au===null||!au.has(ze)))){M.flags|=65536,d&=-d,M.lanes|=d;var dt=oC(M,fe,d);PA(M,dt);break e}}M=M.return}while(M!==null)}$C(w)}catch(It){d=It,Tn===w&&w!==null&&(Tn=w=w.return);continue}break}while(!0)}function BC(){var u=fy.current;return fy.current=oy,u===null?oy:u}function R2(){(jn===0||jn===3||jn===2)&&(jn=4),Gn===null||(Ic&268435455)===0&&(py&268435455)===0||uu(Gn,si)}function wy(u,d){var w=xr;xr|=2;var A=BC();(Gn!==u||si!==d)&&(Go=null,Mc(u,d));do try{W3();break}catch(D){jC(u,D)}while(!0);if(U1(),xr=w,fy.current=A,Tn!==null)throw Error(t(261));return Gn=null,si=0,jn}function W3(){for(;Tn!==null;)zC(Tn)}function V3(){for(;Tn!==null&&!xh();)zC(Tn)}function zC(u){var d=WC(u.alternate,u,_s);u.memoizedProps=u.pendingProps,d===null?$C(u):Tn=d,w2.current=null}function $C(u){var d=u;do{var w=d.alternate;if(u=d.return,(d.flags&32768)===0){if(w=M3(w,d,_s),w!==null){Tn=w;return}}else{if(w=j3(w,d),w!==null){w.flags&=32767,Tn=w;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{jn=6,Tn=null;return}}if(d=d.sibling,d!==null){Tn=d;return}Tn=d=u}while(d!==null);jn===0&&(jn=5)}function jc(u,d,w){var A=zt,D=Ks.transition;try{Ks.transition=null,zt=1,G3(u,d,w,A)}finally{Ks.transition=D,zt=A}return null}function G3(u,d,w,A){do Kh();while(ou!==null);if((xr&6)!==0)throw Error(t(327));w=u.finishedWork;var D=u.finishedLanes;if(w===null)return null;if(u.finishedWork=null,u.finishedLanes=0,w===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var M=w.lanes|w.childLanes;if(br(u,M),u===Gn&&(Tn=Gn=null,si=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||gy||(gy=!0,VC(ga,function(){return Kh(),null})),M=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||M){M=Ks.transition,Ks.transition=null;var Q=zt;zt=1;var fe=xr;xr|=4,w2.current=null,z3(u,w),DC(w,u),te(R1),Ah=!!T1,R1=T1=null,u.current=w,$3(w),In(),xr=fe,zt=Q,Ks.transition=M}else u.current=w;if(gy&&(gy=!1,ou=u,vy=D),M=u.pendingLanes,M===0&&(au=null),Vp(w.stateNode),os(u,yr()),d!==null)for(A=u.onRecoverableError,w=0;w<d.length;w++)D=d[w],A(D.value,{componentStack:D.stack,digest:D.digest});if(my)throw my=!1,u=E2,E2=null,u;return(vy&1)!==0&&u.tag!==0&&Kh(),M=u.pendingLanes,(M&1)!==0?u===S2?Am++:(Am=0,S2=u):Am=0,ru(),null}function Kh(){if(ou!==null){var u=zr(vy),d=Ks.transition,w=zt;try{if(Ks.transition=null,zt=16>u?16:u,ou===null)var A=!1;else{if(u=ou,ou=null,vy=0,(xr&6)!==0)throw Error(t(331));var D=xr;for(xr|=4,Tt=u.current;Tt!==null;){var M=Tt,Q=M.child;if((Tt.flags&16)!==0){var fe=M.deletions;if(fe!==null){for(var xe=0;xe<fe.length;xe++){var He=fe[xe];for(Tt=He;Tt!==null;){var tt=Tt;switch(tt.tag){case 0:case 11:case 15:_m(8,tt,M)}var ot=tt.child;if(ot!==null)ot.return=tt,Tt=ot;else for(;Tt!==null;){tt=Tt;var Je=tt.sibling,Et=tt.return;if(CC(tt),tt===He){Tt=null;break}if(Je!==null){Je.return=Et,Tt=Je;break}Tt=Et}}}var Lt=M.alternate;if(Lt!==null){var Pt=Lt.child;if(Pt!==null){Lt.child=null;do{var xn=Pt.sibling;Pt.sibling=null,Pt=xn}while(Pt!==null)}}Tt=M}}if((M.subtreeFlags&2064)!==0&&Q!==null)Q.return=M,Tt=Q;else e:for(;Tt!==null;){if(M=Tt,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:_m(9,M,M.return)}var Me=M.sibling;if(Me!==null){Me.return=M.return,Tt=Me;break e}Tt=M.return}}var ke=u.current;for(Tt=ke;Tt!==null;){Q=Tt;var ze=Q.child;if((Q.subtreeFlags&2064)!==0&&ze!==null)ze.return=Q,Tt=ze;else e:for(Q=ke;Tt!==null;){if(fe=Tt,(fe.flags&2048)!==0)try{switch(fe.tag){case 0:case 11:case 15:hy(9,fe)}}catch(It){fn(fe,fe.return,It)}if(fe===Q){Tt=null;break e}var dt=fe.sibling;if(dt!==null){dt.return=fe.return,Tt=dt;break e}Tt=fe.return}}if(xr=D,ru(),ti&&typeof ti.onPostCommitFiberRoot=="function")try{ti.onPostCommitFiberRoot(Xa,u)}catch{}A=!0}return A}finally{zt=w,Ks.transition=d}}return!1}function UC(u,d,w){d=Gh(w,d),d=aC(u,d,1),u=iu(u,d,1),d=ji(),u!==null&&(Wt(u,1,d),os(u,d))}function fn(u,d,w){if(u.tag===3)UC(u,u,w);else for(;d!==null;){if(d.tag===3){UC(d,u,w);break}else if(d.tag===1){var A=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(au===null||!au.has(A))){u=Gh(w,u),u=oC(d,u,1),d=iu(d,u,1),u=ji(),d!==null&&(Wt(d,1,u),os(d,u));break}}d=d.return}}function q3(u,d,w){var A=u.pingCache;A!==null&&A.delete(d),d=ji(),u.pingedLanes|=u.suspendedLanes&w,Gn===u&&(si&w)===w&&(jn===4||jn===3&&(si&130023424)===si&&500>yr()-_2?Mc(u,0):x2|=w),os(u,d)}function HC(u,d){d===0&&((u.mode&1)===0?d=1:(d=De,De<<=1,(De&130023424)===0&&(De=4194304)));var w=ji();u=Ho(u,d),u!==null&&(Wt(u,d,w),os(u,w))}function Y3(u){var d=u.memoizedState,w=0;d!==null&&(w=d.retryLane),HC(u,w)}function X3(u,d){var w=0;switch(u.tag){case 13:var A=u.stateNode,D=u.memoizedState;D!==null&&(w=D.retryLane);break;case 19:A=u.stateNode;break;default:throw Error(t(314))}A!==null&&A.delete(d),HC(u,w)}var WC;WC=function(u,d,w){if(u!==null)if(u.memoizedProps!==d.pendingProps||ns.current)ss=!0;else{if((u.lanes&w)===0&&(d.flags&128)===0)return ss=!1,F3(u,d,w);ss=(u.flags&131072)!==0}else ss=!1,Qr&&(d.flags&1048576)!==0&&EA(d,X0,d.index);switch(d.lanes=0,d.tag){case 2:var A=d.type;cy(u,d),u=d.pendingProps;var D=jh(d,wi.current);Wh(d,w),D=J1(null,d,A,u,D,w);var M=e2();return d.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,is(A)?(M=!0,G0(d)):M=!1,d.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,G1(d),D.updater=ly,d.stateNode=D,D._reactInternals=d,a2(d,A,u,w),d=c2(null,d,A,!0,M,w)):(d.tag=0,Qr&&M&&F1(d),Mi(null,d,D,w),d=d.child),d;case 16:A=d.elementType;e:{switch(cy(u,d),u=d.pendingProps,D=A._init,A=D(A._payload),d.type=A,D=d.tag=Z3(A),u=ba(A,u),D){case 0:d=u2(null,d,A,u,w);break e;case 1:d=gC(null,d,A,u,w);break e;case 11:d=dC(null,d,A,u,w);break e;case 14:d=hC(null,d,A,ba(A.type,u),w);break e}throw Error(t(306,A,""))}return d;case 0:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:ba(A,D),u2(u,d,A,D,w);case 1:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:ba(A,D),gC(u,d,A,D,w);case 3:e:{if(vC(d),u===null)throw Error(t(387));A=d.pendingProps,M=d.memoizedState,D=M.element,LA(u,d),ty(d,A,null,w);var Q=d.memoizedState;if(A=Q.element,M.isDehydrated)if(M={element:A,isDehydrated:!1,cache:Q.cache,pendingSuspenseBoundaries:Q.pendingSuspenseBoundaries,transitions:Q.transitions},d.updateQueue.baseState=M,d.memoizedState=M,d.flags&256){D=Gh(Error(t(423)),d),d=yC(u,d,A,w,D);break e}else if(A!==D){D=Gh(Error(t(424)),d),d=yC(u,d,A,w,D);break e}else for(xs=Jl(d.stateNode.containerInfo.firstChild),ws=d,Qr=!0,ya=null,w=NA(d,null,A,w),d.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if($h(),A===D){d=Vo(u,d,w);break e}Mi(u,d,A,w)}d=d.child}return d;case 5:return IA(d),u===null&&B1(d),A=d.type,D=d.pendingProps,M=u!==null?u.memoizedProps:null,Q=D.children,N1(A,D)?Q=null:M!==null&&N1(A,M)&&(d.flags|=32),mC(u,d),Mi(u,d,Q,w),d.child;case 6:return u===null&&B1(d),null;case 13:return bC(u,d,w);case 4:return q1(d,d.stateNode.containerInfo),A=d.pendingProps,u===null?d.child=Uh(d,null,A,w):Mi(u,d,A,w),d.child;case 11:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:ba(A,D),dC(u,d,A,D,w);case 7:return Mi(u,d,d.pendingProps,w),d.child;case 8:return Mi(u,d,d.pendingProps.children,w),d.child;case 12:return Mi(u,d,d.pendingProps.children,w),d.child;case 10:e:{if(A=d.type._context,D=d.pendingProps,M=d.memoizedProps,Q=D.value,Ur(Q0,A._currentValue),A._currentValue=Q,M!==null)if(ys(M.value,Q)){if(M.children===D.children&&!ns.current){d=Vo(u,d,w);break e}}else for(M=d.child,M!==null&&(M.return=d);M!==null;){var fe=M.dependencies;if(fe!==null){Q=M.child;for(var xe=fe.firstContext;xe!==null;){if(xe.context===A){if(M.tag===1){xe=Wo(-1,w&-w),xe.tag=2;var He=M.updateQueue;if(He!==null){He=He.shared;var tt=He.pending;tt===null?xe.next=xe:(xe.next=tt.next,tt.next=xe),He.pending=xe}}M.lanes|=w,xe=M.alternate,xe!==null&&(xe.lanes|=w),W1(M.return,w,d),fe.lanes|=w;break}xe=xe.next}}else if(M.tag===10)Q=M.type===d.type?null:M.child;else if(M.tag===18){if(Q=M.return,Q===null)throw Error(t(341));Q.lanes|=w,fe=Q.alternate,fe!==null&&(fe.lanes|=w),W1(Q,w,d),Q=M.sibling}else Q=M.child;if(Q!==null)Q.return=M;else for(Q=M;Q!==null;){if(Q===d){Q=null;break}if(M=Q.sibling,M!==null){M.return=Q.return,Q=M;break}Q=Q.return}M=Q}Mi(u,d,D.children,w),d=d.child}return d;case 9:return D=d.type,A=d.pendingProps.children,Wh(d,w),D=Ys(D),A=A(D),d.flags|=1,Mi(u,d,A,w),d.child;case 14:return A=d.type,D=ba(A,d.pendingProps),D=ba(A.type,D),hC(u,d,A,D,w);case 15:return fC(u,d,d.type,d.pendingProps,w);case 17:return A=d.type,D=d.pendingProps,D=d.elementType===A?D:ba(A,D),cy(u,d),d.tag=1,is(A)?(u=!0,G0(d)):u=!1,Wh(d,w),iC(d,A,D),a2(d,A,D,w),c2(null,d,A,!0,u,w);case 19:return xC(u,d,w);case 22:return pC(u,d,w)}throw Error(t(156,d.tag))};function VC(u,d){return On(u,d)}function K3(u,d,w,A){this.tag=u,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zs(u,d,w,A){return new K3(u,d,w,A)}function N2(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Z3(u){if(typeof u=="function")return N2(u)?1:0;if(u!=null){if(u=u.$$typeof,u===B)return 11;if(u===ae)return 14}return 2}function cu(u,d){var w=u.alternate;return w===null?(w=Zs(u.tag,d,u.key,u.mode),w.elementType=u.elementType,w.type=u.type,w.stateNode=u.stateNode,w.alternate=u,u.alternate=w):(w.pendingProps=d,w.type=u.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=u.flags&14680064,w.childLanes=u.childLanes,w.lanes=u.lanes,w.child=u.child,w.memoizedProps=u.memoizedProps,w.memoizedState=u.memoizedState,w.updateQueue=u.updateQueue,d=u.dependencies,w.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},w.sibling=u.sibling,w.index=u.index,w.ref=u.ref,w}function xy(u,d,w,A,D,M){var Q=2;if(A=u,typeof u=="function")N2(u)&&(Q=1);else if(typeof u=="string")Q=5;else e:switch(u){case N:return Bc(w.children,D,M,d);case O:Q=8,D|=8;break;case I:return u=Zs(12,w,d,D|2),u.elementType=I,u.lanes=M,u;case Y:return u=Zs(13,w,d,D),u.elementType=Y,u.lanes=M,u;case j:return u=Zs(19,w,d,D),u.elementType=j,u.lanes=M,u;case ee:return _y(w,D,M,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case F:Q=10;break e;case G:Q=9;break e;case B:Q=11;break e;case ae:Q=14;break e;case he:Q=16,A=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=Zs(Q,w,d,D),d.elementType=u,d.type=A,d.lanes=M,d}function Bc(u,d,w,A){return u=Zs(7,u,A,d),u.lanes=w,u}function _y(u,d,w,A){return u=Zs(22,u,A,d),u.elementType=ee,u.lanes=w,u.stateNode={isHidden:!1},u}function D2(u,d,w){return u=Zs(6,u,null,d),u.lanes=w,u}function L2(u,d,w){return d=Zs(4,u.children!==null?u.children:[],u.key,d),d.lanes=w,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function Q3(u,d,w,A,D){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ct(0),this.expirationTimes=Ct(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ct(0),this.identifierPrefix=A,this.onRecoverableError=D,this.mutableSourceEagerHydrationData=null}function P2(u,d,w,A,D,M,Q,fe,xe){return u=new Q3(u,d,w,fe,xe),d===1?(d=1,M===!0&&(d|=8)):d=0,M=Zs(3,null,null,d),u.current=M,M.stateNode=u,M.memoizedState={element:A,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},G1(M),u}function J3(u,d,w){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:A==null?null:""+A,children:u,containerInfo:d,implementation:w}}function GC(u){if(!u)return tu;u=u._reactInternals;e:{if(yn(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(is(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var w=u.type;if(is(w))return wA(u,w,d)}return d}function qC(u,d,w,A,D,M,Q,fe,xe){return u=P2(w,A,!0,u,D,M,Q,fe,xe),u.context=GC(null),w=u.current,A=ji(),D=lu(w),M=Wo(A,D),M.callback=d??null,iu(w,M,D),u.current.lanes=D,Wt(u,D,A),os(u,A),u}function Ey(u,d,w,A){var D=d.current,M=ji(),Q=lu(D);return w=GC(w),d.context===null?d.context=w:d.pendingContext=w,d=Wo(M,Q),d.payload={element:u},A=A===void 0?null:A,A!==null&&(d.callback=A),u=iu(D,d,Q),u!==null&&(_a(u,D,Q,M),ey(u,D,Q)),Q}function Sy(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function YC(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var w=u.retryLane;u.retryLane=w!==0&&w<d?w:d}}function O2(u,d){YC(u,d),(u=u.alternate)&&YC(u,d)}function eO(){return null}var XC=typeof reportError=="function"?reportError:function(u){console.error(u)};function I2(u){this._internalRoot=u}Ay.prototype.render=I2.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));Ey(u,d,null,null)},Ay.prototype.unmount=I2.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;Fc(function(){Ey(null,u,null,null)}),d[Bo]=null}};function Ay(u){this._internalRoot=u}Ay.prototype.unstable_scheduleHydration=function(u){if(u){var d=gs();u={blockedOn:null,target:u,priority:d};for(var w=0;w<Za.length&&d!==0&&d<Za[w].priority;w++);Za.splice(w,0,u),w===0&&E0(u)}};function F2(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Cy(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function KC(){}function tO(u,d,w,A,D){if(D){if(typeof A=="function"){var M=A;A=function(){var He=Sy(Q);M.call(He)}}var Q=qC(d,A,u,0,null,!1,!1,"",KC);return u._reactRootContainer=Q,u[Bo]=Q.current,um(u.nodeType===8?u.parentNode:u),Fc(),Q}for(;D=u.lastChild;)u.removeChild(D);if(typeof A=="function"){var fe=A;A=function(){var He=Sy(xe);fe.call(He)}}var xe=P2(u,0,!1,null,null,!1,!1,"",KC);return u._reactRootContainer=xe,u[Bo]=xe.current,um(u.nodeType===8?u.parentNode:u),Fc(function(){Ey(d,xe,w,A)}),xe}function ky(u,d,w,A,D){var M=w._reactRootContainer;if(M){var Q=M;if(typeof D=="function"){var fe=D;D=function(){var xe=Sy(Q);fe.call(xe)}}Ey(d,Q,u,D)}else Q=tO(w,d,u,D,A);return Sy(Q)}ri=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var w=Se(d.pendingLanes);w!==0&&(sr(d,w|1),os(d,yr()),(xr&6)===0&&(Xh=yr()+500,ru()))}break;case 13:Fc(function(){var A=Ho(u,1);if(A!==null){var D=ji();_a(A,u,1,D)}}),O2(u,1)}},va=function(u){if(u.tag===13){var d=Ho(u,134217728);if(d!==null){var w=ji();_a(d,u,134217728,w)}O2(u,134217728)}},ql=function(u){if(u.tag===13){var d=lu(u),w=Ho(u,d);if(w!==null){var A=ji();_a(w,u,d,A)}O2(u,d)}},gs=function(){return zt},Mo=function(u,d){var w=zt;try{return zt=u,d()}finally{zt=w}},we=function(u,d,w){switch(d){case"input":if(ue(u,w),d=w.name,w.type==="radio"&&d!=null){for(w=u;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<w.length;d++){var A=w[d];if(A!==u&&A.form===u.form){var D=W0(A);if(!D)throw Error(t(90));gt(A),ue(A,D)}}}break;case"textarea":rt(u,w);break;case"select":d=w.value,d!=null&&Te(u,!!w.multiple,d,!1)}},Ce=k2,Ie=Fc;var rO={usingClientEntryPoint:!1,Events:[hm,Fh,W0,Ee,P,k2]},Cm={findFiberByHostInstance:Tc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nO={bundleType:Cm.bundleType,version:Cm.version,rendererPackageName:Cm.rendererPackageName,rendererConfig:Cm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Kr(u),u===null?null:u.stateNode},findFiberByHostInstance:Cm.findFiberByHostInstance||eO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ty=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ty.isDisabled&&Ty.supportsFiber)try{Xa=Ty.inject(nO),ti=Ty}catch{}}return ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rO,ls.createPortal=function(u,d){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!F2(d))throw Error(t(200));return J3(u,d,null,w)},ls.createRoot=function(u,d){if(!F2(u))throw Error(t(299));var w=!1,A="",D=XC;return d!=null&&(d.unstable_strictMode===!0&&(w=!0),d.identifierPrefix!==void 0&&(A=d.identifierPrefix),d.onRecoverableError!==void 0&&(D=d.onRecoverableError)),d=P2(u,1,!1,null,null,w,!1,A,D),u[Bo]=d.current,um(u.nodeType===8?u.parentNode:u),new I2(d)},ls.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Kr(d),u=u===null?null:u.stateNode,u},ls.flushSync=function(u){return Fc(u)},ls.hydrate=function(u,d,w){if(!Cy(d))throw Error(t(200));return ky(null,u,d,!0,w)},ls.hydrateRoot=function(u,d,w){if(!F2(u))throw Error(t(405));var A=w!=null&&w.hydratedSources||null,D=!1,M="",Q=XC;if(w!=null&&(w.unstable_strictMode===!0&&(D=!0),w.identifierPrefix!==void 0&&(M=w.identifierPrefix),w.onRecoverableError!==void 0&&(Q=w.onRecoverableError)),d=qC(d,null,u,1,w??null,D,!1,M,Q),u[Bo]=d.current,um(u),A)for(u=0;u<A.length;u++)w=A[u],D=w._getVersion,D=D(w._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[w,D]:d.mutableSourceEagerHydrationData.push(w,D);return new Ay(d)},ls.render=function(u,d,w){if(!Cy(d))throw Error(t(200));return ky(null,u,d,!1,w)},ls.unmountComponentAtNode=function(u){if(!Cy(u))throw Error(t(40));return u._reactRootContainer?(Fc(function(){ky(null,null,u,!1,function(){u._reactRootContainer=null,u[Bo]=null})}),!0):!1},ls.unstable_batchedUpdates=k2,ls.unstable_renderSubtreeIntoContainer=function(u,d,w,A){if(!Cy(w))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return ky(u,d,w,!1,A)},ls.version="18.3.1-next-f1338f8080-20240426",ls}var ak;function pN(){if(ak)return z2.exports;ak=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),z2.exports=fO(),z2.exports}var ok;function pO(){if(ok)return Ry;ok=1;var i=pN();return Ry.createRoot=i.createRoot,Ry.hydrateRoot=i.hydrateRoot,Ry}var mO=pO();const gO=Do(mO);async function fi(i,e={},t){return window.__TAURI_INTERNALS__.invoke(i,e,t)}function lg(i,e="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(i,e)}var lk;(function(i){i.WINDOW_RESIZED="tauri://resize",i.WINDOW_MOVED="tauri://move",i.WINDOW_CLOSE_REQUESTED="tauri://close-requested",i.WINDOW_DESTROYED="tauri://destroyed",i.WINDOW_FOCUS="tauri://focus",i.WINDOW_BLUR="tauri://blur",i.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",i.WINDOW_THEME_CHANGED="tauri://theme-changed",i.WINDOW_CREATED="tauri://window-created",i.WEBVIEW_CREATED="tauri://webview-created",i.DRAG_ENTER="tauri://drag-enter",i.DRAG_OVER="tauri://drag-over",i.DRAG_DROP="tauri://drag-drop",i.DRAG_LEAVE="tauri://drag-leave"})(lk||(lk={}));var uk;(function(i){i[i.Critical=1]="Critical",i[i.Informational=2]="Informational"})(uk||(uk={}));var ck;(function(i){i.None="none",i.Normal="normal",i.Indeterminate="indeterminate",i.Paused="paused",i.Error="error"})(ck||(ck={}));var dk;(function(i){i.Disabled="disabled",i.Throttle="throttle",i.Suspend="suspend"})(dk||(dk={}));var hk;(function(i){i.AppearanceBased="appearanceBased",i.Light="light",i.Dark="dark",i.MediumLight="mediumLight",i.UltraDark="ultraDark",i.Titlebar="titlebar",i.Selection="selection",i.Menu="menu",i.Popover="popover",i.Sidebar="sidebar",i.HeaderView="headerView",i.Sheet="sheet",i.WindowBackground="windowBackground",i.HudWindow="hudWindow",i.FullScreenUI="fullScreenUI",i.Tooltip="tooltip",i.ContentBackground="contentBackground",i.UnderWindowBackground="underWindowBackground",i.UnderPageBackground="underPageBackground",i.Mica="mica",i.Blur="blur",i.Acrylic="acrylic",i.Tabbed="tabbed",i.TabbedDark="tabbedDark",i.TabbedLight="tabbedLight"})(hk||(hk={}));var fk;(function(i){i.FollowsWindowActiveState="followsWindowActiveState",i.Active="active",i.Inactive="inactive"})(fk||(fk={}));var Tm={},pk;function vO(){if(pk)return Tm;pk=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.parse=a,Tm.serialize=c;const i=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,s=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function a(m,p){const x=new s,g=m.length;if(g<2)return x;const y=(p==null?void 0:p.decode)||h;let b=0;do{const _=m.indexOf("=",b);if(_===-1)break;const S=m.indexOf(";",b),k=S===-1?g:S;if(_>k){b=m.lastIndexOf(";",_-1)+1;continue}const C=o(m,b,_),R=l(m,_,C),N=m.slice(C,R);if(x[N]===void 0){let O=o(m,_+1,k),I=l(m,k,O);const F=y(m.slice(O,I));x[N]=F}b=k+1}while(b<g);return x}function o(m,p,x){do{const g=m.charCodeAt(p);if(g!==32&&g!==9)return p}while(++p<x);return x}function l(m,p,x){for(;p>x;){const g=m.charCodeAt(--p);if(g!==32&&g!==9)return p+1}return x}function c(m,p,x){const g=(x==null?void 0:x.encode)||encodeURIComponent;if(!i.test(m))throw new TypeError(`argument name is invalid: ${m}`);const y=g(p);if(!e.test(y))throw new TypeError(`argument val is invalid: ${p}`);let b=m+"="+y;if(!x)return b;if(x.maxAge!==void 0){if(!Number.isInteger(x.maxAge))throw new TypeError(`option maxAge is invalid: ${x.maxAge}`);b+="; Max-Age="+x.maxAge}if(x.domain){if(!t.test(x.domain))throw new TypeError(`option domain is invalid: ${x.domain}`);b+="; Domain="+x.domain}if(x.path){if(!r.test(x.path))throw new TypeError(`option path is invalid: ${x.path}`);b+="; Path="+x.path}if(x.expires){if(!f(x.expires)||!Number.isFinite(x.expires.valueOf()))throw new TypeError(`option expires is invalid: ${x.expires}`);b+="; Expires="+x.expires.toUTCString()}if(x.httpOnly&&(b+="; HttpOnly"),x.secure&&(b+="; Secure"),x.partitioned&&(b+="; Partitioned"),x.priority)switch(typeof x.priority=="string"?x.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${x.priority}`)}if(x.sameSite)switch(typeof x.sameSite=="string"?x.sameSite.toLowerCase():x.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${x.sameSite}`)}return b}function h(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function f(m){return n.call(m)==="[object Date]"}return Tm}vO();var mk="popstate";function yO(i={}){function e(r,n){let{pathname:s,search:a,hash:o}=r.location;return o_("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(r,n){return typeof n=="string"?n:mg(n)}return wO(e,t,null,i)}function hn(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Ga(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bO(){return Math.random().toString(36).substring(2,10)}function gk(i,e){return{usr:i.state,key:i.key,idx:e}}function o_(i,e,t=null,r){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Mp(e):e,state:t,key:e&&e.key||r||bO()}}function mg({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Mp(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substring(r),i=i.substring(0,r)),i&&(e.pathname=i)}return e}function wO(i,e,t,r={}){let{window:n=document.defaultView,v5Compat:s=!1}=r,a=n.history,o="POP",l=null,c=h();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function h(){return(a.state||{idx:null}).idx}function f(){o="POP";let y=h(),b=y==null?null:y-c;c=y,l&&l({action:o,location:g.location,delta:b})}function m(y,b){o="PUSH";let _=o_(g.location,y,b);c=h()+1;let S=gk(_,c),k=g.createHref(_);try{a.pushState(S,"",k)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;n.location.assign(k)}s&&l&&l({action:o,location:g.location,delta:1})}function p(y,b){o="REPLACE";let _=o_(g.location,y,b);c=h();let S=gk(_,c),k=g.createHref(_);a.replaceState(S,"",k),s&&l&&l({action:o,location:g.location,delta:0})}function x(y){return xO(y)}let g={get action(){return o},get location(){return i(n,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(mk,f),l=y,()=>{n.removeEventListener(mk,f),l=null}},createHref(y){return e(n,y)},createURL:x,encodeLocation(y){let b=x(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:p,go(y){return a.go(y)}};return g}function xO(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),hn(t,"No window.location.(origin|href) available to create URL");let r=typeof i=="string"?i:mg(i);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function mN(i,e,t="/"){return _O(i,e,t,!1)}function _O(i,e,t,r){let n=typeof e=="string"?Mp(e):e,s=Ol(n.pathname||"/",t);if(s==null)return null;let a=gN(i);EO(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=OO(s);o=LO(a[l],c,r)}return o}function gN(i,e=[],t=[],r=""){let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(hn(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=Rl([r,l.relativePath]),h=t.concat(l);s.children&&s.children.length>0&&(hn(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),gN(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:NO(c,s.index),routesMeta:h})};return i.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of vN(s.path))n(s,a,l)}),e}function vN(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return n?[s,""]:[s];let a=vN(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>i.startsWith("/")&&l===""?"/":l)}function EO(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:DO(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var SO=/^:[\w-]+$/,AO=3,CO=2,kO=1,TO=10,RO=-2,vk=i=>i==="*";function NO(i,e){let t=i.split("/"),r=t.length;return t.some(vk)&&(r+=RO),e&&(r+=CO),t.filter(n=>!vk(n)).reduce((n,s)=>n+(SO.test(s)?AO:s===""?kO:TO),r)}function DO(i,e){return i.length===e.length&&i.slice(0,-1).every((r,n)=>r===e[n])?i[i.length-1]-e[e.length-1]:0}function LO(i,e,t=!1){let{routesMeta:r}=i,n={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],c=o===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=Rb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),m=l.route;if(!f&&c&&t&&!r[r.length-1].route.index&&(f=Rb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(n,f.params),a.push({params:n,pathname:Rl([s,f.pathname]),pathnameBase:jO(Rl([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=Rl([s,f.pathnameBase]))}return a}function Rb(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=PO(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((c,{paramName:h,isOptional:f},m)=>{if(h==="*"){let x=o[m]||"";a=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const p=o[m];return f&&!p?c[h]=void 0:c[h]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:i}}function PO(i,e=!1,t=!0){Ga(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let r=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function OO(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ga(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Ol(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function IO(i,e="/"){let{pathname:t,search:r="",hash:n=""}=typeof i=="string"?Mp(i):i;return{pathname:t?t.startsWith("/")?t:FO(t,e):e,search:BO(r),hash:zO(n)}}function FO(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function H2(i,e,t,r){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function MO(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function yN(i){let e=MO(i);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function bN(i,e,t,r=!1){let n;typeof i=="string"?n=Mp(i):(n={...i},hn(!n.pathname||!n.pathname.includes("?"),H2("?","pathname","search",n)),hn(!n.pathname||!n.pathname.includes("#"),H2("#","pathname","hash",n)),hn(!n.search||!n.search.includes("#"),H2("#","search","hash",n)));let s=i===""||n.pathname==="",a=s?"/":n.pathname,o;if(a==null)o=t;else{let f=e.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),f-=1;n.pathname=m.join("/")}o=f>=0?e[f]:"/"}let l=IO(n,o),c=a&&a!=="/"&&a.endsWith("/"),h=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var Rl=i=>i.join("/").replace(/\/\/+/g,"/"),jO=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),BO=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,zO=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function $O(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var wN=["POST","PUT","PATCH","DELETE"];new Set(wN);var UO=["GET",...wN];new Set(UO);var jp=T.createContext(null);jp.displayName="DataRouter";var bw=T.createContext(null);bw.displayName="DataRouterState";var xN=T.createContext({isTransitioning:!1});xN.displayName="ViewTransition";var HO=T.createContext(new Map);HO.displayName="Fetchers";var WO=T.createContext(null);WO.displayName="Await";var Lo=T.createContext(null);Lo.displayName="Navigation";var t0=T.createContext(null);t0.displayName="Location";var Po=T.createContext({outlet:null,matches:[],isDataRoute:!1});Po.displayName="Route";var sS=T.createContext(null);sS.displayName="RouteError";function VO(i,{relative:e}={}){hn(r0(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=T.useContext(Lo),{hash:n,pathname:s,search:a}=n0(i,{relative:e}),o=s;return t!=="/"&&(o=s==="/"?t:Rl([t,s])),r.createHref({pathname:o,search:a,hash:n})}function r0(){return T.useContext(t0)!=null}function uc(){return hn(r0(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(t0).location}var _N="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function EN(i){T.useContext(Lo).static||T.useLayoutEffect(i)}function Br(){let{isDataRoute:i}=T.useContext(Po);return i?iI():GO()}function GO(){hn(r0(),"useNavigate() may be used only in the context of a <Router> component.");let i=T.useContext(jp),{basename:e,navigator:t}=T.useContext(Lo),{matches:r}=T.useContext(Po),{pathname:n}=uc(),s=JSON.stringify(yN(r)),a=T.useRef(!1);return EN(()=>{a.current=!0}),T.useCallback((l,c={})=>{if(Ga(a.current,_N),!a.current)return;if(typeof l=="number"){t.go(l);return}let h=bN(l,JSON.parse(s),n,c.relative==="path");i==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Rl([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,s,n,i])}T.createContext(null);function cc(){let{matches:i}=T.useContext(Po),e=i[i.length-1];return e?e.params:{}}function n0(i,{relative:e}={}){let{matches:t}=T.useContext(Po),{pathname:r}=uc(),n=JSON.stringify(yN(t));return T.useMemo(()=>bN(i,JSON.parse(n),r,e==="path"),[i,n,r,e])}function qO(i,e){return SN(i,e)}function SN(i,e,t,r){var b;hn(r0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=T.useContext(Lo),{matches:s}=T.useContext(Po),a=s[s.length-1],o=a?a.params:{},l=a?a.pathname:"/",c=a?a.pathnameBase:"/",h=a&&a.route;{let _=h&&h.path||"";AN(l,!h||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let f=uc(),m;if(e){let _=typeof e=="string"?Mp(e):e;hn(c==="/"||((b=_.pathname)==null?void 0:b.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${_.pathname}" was given in the \`location\` prop.`),m=_}else m=f;let p=m.pathname||"/",x=p;if(c!=="/"){let _=c.replace(/^\//,"").split("/");x="/"+p.replace(/^\//,"").split("/").slice(_.length).join("/")}let g=mN(i,{pathname:x});Ga(h||g!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Ga(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=QO(g&&g.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:Rl([c,n.encodeLocation?n.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Rl([c,n.encodeLocation?n.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,t,r);return e&&y?T.createElement(t0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},y):y}function YO(){let i=nI(),e=$O(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,r="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",i),a=T.createElement(T.Fragment,null,T.createElement("p",null,"💿 Hey developer 👋"),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:s},"ErrorBoundary")," or"," ",T.createElement("code",{style:s},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),t?T.createElement("pre",{style:n},t):null,a)}var XO=T.createElement(YO,null),KO=class extends T.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){console.error("React Router caught the following error during render",i,e)}render(){return this.state.error!==void 0?T.createElement(Po.Provider,{value:this.props.routeContext},T.createElement(sS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ZO({routeContext:i,match:e,children:t}){let r=T.useContext(jp);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(Po.Provider,{value:i},t)}function QO(i,e=[],t=null,r=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let n=i,s=t==null?void 0:t.errors;if(s!=null){let l=n.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);hn(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),n=n.slice(0,Math.min(n.length,l+1))}let a=!1,o=-1;if(t)for(let l=0;l<n.length;l++){let c=n[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:h,errors:f}=t,m=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||m){a=!0,o>=0?n=n.slice(0,o+1):n=[n[0]];break}}}return n.reduceRight((l,c,h)=>{let f,m=!1,p=null,x=null;t&&(f=s&&c.route.id?s[c.route.id]:void 0,p=c.route.errorElement||XO,a&&(o<0&&h===0?(AN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,x=null):o===h&&(m=!0,x=c.route.hydrateFallbackElement||null)));let g=e.concat(n.slice(0,h+1)),y=()=>{let b;return f?b=p:m?b=x:c.route.Component?b=T.createElement(c.route.Component,null):c.route.element?b=c.route.element:b=l,T.createElement(ZO,{match:c,routeContext:{outlet:l,matches:g,isDataRoute:t!=null},children:b})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?T.createElement(KO,{location:t.location,revalidation:t.revalidation,component:p,error:f,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}function aS(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function JO(i){let e=T.useContext(jp);return hn(e,aS(i)),e}function eI(i){let e=T.useContext(bw);return hn(e,aS(i)),e}function tI(i){let e=T.useContext(Po);return hn(e,aS(i)),e}function oS(i){let e=tI(i),t=e.matches[e.matches.length-1];return hn(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function rI(){return oS("useRouteId")}function nI(){var r;let i=T.useContext(sS),e=eI("useRouteError"),t=oS("useRouteError");return i!==void 0?i:(r=e.errors)==null?void 0:r[t]}function iI(){let{router:i}=JO("useNavigate"),e=oS("useNavigate"),t=T.useRef(!1);return EN(()=>{t.current=!0}),T.useCallback(async(n,s={})=>{Ga(t.current,_N),t.current&&(typeof n=="number"?i.navigate(n):await i.navigate(n,{fromRouteId:e,...s}))},[i,e])}var yk={};function AN(i,e,t){!e&&!yk[i]&&(yk[i]=!0,Ga(!1,t))}T.memo(sI);function sI({routes:i,future:e,state:t}){return SN(i,void 0,t,e)}function Bn(i){hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aI({basename:i="/",children:e=null,location:t,navigationType:r="POP",navigator:n,static:s=!1}){hn(!r0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=i.replace(/^\/*/,"/"),o=T.useMemo(()=>({basename:a,navigator:n,static:s,future:{}}),[a,n,s]);typeof t=="string"&&(t=Mp(t));let{pathname:l="/",search:c="",hash:h="",state:f=null,key:m="default"}=t,p=T.useMemo(()=>{let x=Ol(l,a);return x==null?null:{location:{pathname:x,search:c,hash:h,state:f,key:m},navigationType:r}},[a,l,c,h,f,m,r]);return Ga(p!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:T.createElement(Lo.Provider,{value:o},T.createElement(t0.Provider,{children:e,value:p}))}function oI({children:i,location:e}){return qO(l_(i),e)}function l_(i,e=[]){let t=[];return T.Children.forEach(i,(r,n)=>{if(!T.isValidElement(r))return;let s=[...e,n];if(r.type===T.Fragment){t.push.apply(t,l_(r.props.children,s));return}hn(r.type===Bn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=l_(r.props.children,s)),t.push(a)}),t}var Gy="get",qy="application/x-www-form-urlencoded";function ww(i){return i!=null&&typeof i.tagName=="string"}function lI(i){return ww(i)&&i.tagName.toLowerCase()==="button"}function uI(i){return ww(i)&&i.tagName.toLowerCase()==="form"}function cI(i){return ww(i)&&i.tagName.toLowerCase()==="input"}function dI(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function hI(i,e){return i.button===0&&(!e||e==="_self")&&!dI(i)}function u_(i=""){return new URLSearchParams(typeof i=="string"||Array.isArray(i)||i instanceof URLSearchParams?i:Object.keys(i).reduce((e,t)=>{let r=i[t];return e.concat(Array.isArray(r)?r.map(n=>[t,n]):[[t,r]])},[]))}function fI(i,e){let t=u_(i);return e&&e.forEach((r,n)=>{t.has(n)||e.getAll(n).forEach(s=>{t.append(n,s)})}),t}var Ny=null;function pI(){if(Ny===null)try{new FormData(document.createElement("form"),0),Ny=!1}catch{Ny=!0}return Ny}var mI=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function W2(i){return i!=null&&!mI.has(i)?(Ga(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${qy}"`),null):i}function gI(i,e){let t,r,n,s,a;if(uI(i)){let o=i.getAttribute("action");r=o?Ol(o,e):null,t=i.getAttribute("method")||Gy,n=W2(i.getAttribute("enctype"))||qy,s=new FormData(i)}else if(lI(i)||cI(i)&&(i.type==="submit"||i.type==="image")){let o=i.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=i.getAttribute("formaction")||o.getAttribute("action");if(r=l?Ol(l,e):null,t=i.getAttribute("formmethod")||o.getAttribute("method")||Gy,n=W2(i.getAttribute("formenctype"))||W2(o.getAttribute("enctype"))||qy,s=new FormData(o,i),!pI()){let{name:c,type:h,value:f}=i;if(h==="image"){let m=c?`${c}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else c&&s.append(c,f)}}else{if(ww(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Gy,r=null,n=qy,a=i}return s&&n==="text/plain"&&(a=s,s=void 0),{action:r,method:t.toLowerCase(),encType:n,formData:s,body:a}}function lS(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}async function vI(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function yI(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function bI(i,e,t){let r=await Promise.all(i.map(async n=>{let s=e.routes[n.route.id];if(s){let a=await vI(s,t);return a.links?a.links():[]}return[]}));return EI(r.flat(1).filter(yI).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function bk(i,e,t,r,n,s){let a=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>{var h;return t[c].pathname!==l.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,c)=>a(l,c)||o(l,c)):s==="data"?e.filter((l,c)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(i,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function wI(i,e,{includeHydrateFallback:t}={}){return xI(i.map(r=>{let n=e.routes[r.route.id];if(!n)return[];let s=[n.module];return n.clientActionModule&&(s=s.concat(n.clientActionModule)),n.clientLoaderModule&&(s=s.concat(n.clientLoaderModule)),t&&n.hydrateFallbackModule&&(s=s.concat(n.hydrateFallbackModule)),n.imports&&(s=s.concat(n.imports)),s}).flat(1))}function xI(i){return[...new Set(i)]}function _I(i){let e={},t=Object.keys(i).sort();for(let r of t)e[r]=i[r];return e}function EI(i,e){let t=new Set;return new Set(e),i.reduce((r,n)=>{let s=JSON.stringify(_I(n));return t.has(s)||(t.add(s),r.push({key:s,link:n})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var SI=new Set([100,101,204,205]);function AI(i,e){let t=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t.pathname==="/"?t.pathname="_root.data":e&&Ol(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function CN(){let i=T.useContext(jp);return lS(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function CI(){let i=T.useContext(bw);return lS(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var uS=T.createContext(void 0);uS.displayName="FrameworkContext";function kN(){let i=T.useContext(uS);return lS(i,"You must render this element inside a <HydratedRouter> element"),i}function kI(i,e){let t=T.useContext(uS),[r,n]=T.useState(!1),[s,a]=T.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:f}=e,m=T.useRef(null);T.useEffect(()=>{if(i==="render"&&a(!0),i==="viewport"){let g=b=>{b.forEach(_=>{a(_.isIntersecting)})},y=new IntersectionObserver(g,{threshold:.5});return m.current&&y.observe(m.current),()=>{y.disconnect()}}},[i]),T.useEffect(()=>{if(r){let g=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(g)}}},[r]);let p=()=>{n(!0)},x=()=>{n(!1),a(!1)};return t?i!=="intent"?[s,m,{}]:[s,m,{onFocus:Rm(o,p),onBlur:Rm(l,x),onMouseEnter:Rm(c,p),onMouseLeave:Rm(h,x),onTouchStart:Rm(f,p)}]:[!1,m,{}]}function Rm(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function TI({page:i,...e}){let{router:t}=CN(),r=T.useMemo(()=>mN(t.routes,i,t.basename),[t.routes,i,t.basename]);return r?T.createElement(NI,{page:i,matches:r,...e}):null}function RI(i){let{manifest:e,routeModules:t}=kN(),[r,n]=T.useState([]);return T.useEffect(()=>{let s=!1;return bI(i,e,t).then(a=>{s||n(a)}),()=>{s=!0}},[i,e,t]),r}function NI({page:i,matches:e,...t}){let r=uc(),{manifest:n,routeModules:s}=kN(),{basename:a}=CN(),{loaderData:o,matches:l}=CI(),c=T.useMemo(()=>bk(i,e,l,n,r,"data"),[i,e,l,n,r]),h=T.useMemo(()=>bk(i,e,l,n,r,"assets"),[i,e,l,n,r]),f=T.useMemo(()=>{if(i===r.pathname+r.search+r.hash)return[];let x=new Set,g=!1;if(e.forEach(b=>{var S;let _=n.routes[b.route.id];!_||!_.hasLoader||(!c.some(k=>k.route.id===b.route.id)&&b.route.id in o&&((S=s[b.route.id])!=null&&S.shouldRevalidate)||_.hasClientLoader?g=!0:x.add(b.route.id))}),x.size===0)return[];let y=AI(i,a);return g&&x.size>0&&y.searchParams.set("_routes",e.filter(b=>x.has(b.route.id)).map(b=>b.route.id).join(",")),[y.pathname+y.search]},[a,o,r,n,c,e,i,s]),m=T.useMemo(()=>wI(h,n),[h,n]),p=RI(h);return T.createElement(T.Fragment,null,f.map(x=>T.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),m.map(x=>T.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),p.map(({key:x,link:g})=>T.createElement("link",{key:x,...g})))}function DI(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var TN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{TN&&(window.__reactRouterVersion="7.6.3")}catch{}function LI({basename:i,children:e,window:t}){let r=T.useRef();r.current==null&&(r.current=yO({window:t,v5Compat:!0}));let n=r.current,[s,a]=T.useState({action:n.action,location:n.location}),o=T.useCallback(l=>{T.startTransition(()=>a(l))},[a]);return T.useLayoutEffect(()=>n.listen(o),[n,o]),T.createElement(aI,{basename:i,children:e,location:s.location,navigationType:s.action,navigator:n})}var RN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NN=T.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:h,viewTransition:f,...m},p){let{basename:x}=T.useContext(Lo),g=typeof c=="string"&&RN.test(c),y,b=!1;if(typeof c=="string"&&g&&(y=c,TN))try{let I=new URL(window.location.href),F=c.startsWith("//")?new URL(I.protocol+c):new URL(c),G=Ol(F.pathname,x);F.origin===I.origin&&G!=null?c=G+F.search+F.hash:b=!0}catch{Ga(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=VO(c,{relative:n}),[S,k,C]=kI(r,m),R=FI(c,{replace:a,state:o,target:l,preventScrollReset:h,relative:n,viewTransition:f});function N(I){e&&e(I),I.defaultPrevented||R(I)}let O=T.createElement("a",{...m,...C,href:y||_,onClick:b||s?e:N,ref:DI(p,k),target:l,"data-discover":!g&&t==="render"?"true":void 0});return S&&!g?T.createElement(T.Fragment,null,O,T.createElement(TI,{page:_})):O});NN.displayName="Link";var PI=T.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:n=!1,style:s,to:a,viewTransition:o,children:l,...c},h){let f=n0(a,{relative:c.relative}),m=uc(),p=T.useContext(bw),{navigator:x,basename:g}=T.useContext(Lo),y=p!=null&&$I(f)&&o===!0,b=x.encodeLocation?x.encodeLocation(f).pathname:f.pathname,_=m.pathname,S=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(_=_.toLowerCase(),S=S?S.toLowerCase():null,b=b.toLowerCase()),S&&g&&(S=Ol(S,g)||S);const k=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=_===b||!n&&_.startsWith(b)&&_.charAt(k)==="/",R=S!=null&&(S===b||!n&&S.startsWith(b)&&S.charAt(b.length)==="/"),N={isActive:C,isPending:R,isTransitioning:y},O=C?e:void 0,I;typeof r=="function"?I=r(N):I=[r,C?"active":null,R?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let F=typeof s=="function"?s(N):s;return T.createElement(NN,{...c,"aria-current":O,className:I,ref:h,style:F,to:a,viewTransition:o},typeof l=="function"?l(N):l)});PI.displayName="NavLink";var OI=T.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:n,state:s,method:a=Gy,action:o,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:f,...m},p)=>{let x=BI(),g=zI(o,{relative:c}),y=a.toLowerCase()==="get"?"get":"post",b=typeof o=="string"&&RN.test(o),_=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let k=S.nativeEvent.submitter,C=(k==null?void 0:k.getAttribute("formmethod"))||a;x(k||S.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:n,state:s,relative:c,preventScrollReset:h,viewTransition:f})};return T.createElement("form",{ref:p,method:y,action:g,onSubmit:r?l:_,...m,"data-discover":!b&&i==="render"?"true":void 0})});OI.displayName="Form";function II(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DN(i){let e=T.useContext(jp);return hn(e,II(i)),e}function FI(i,{target:e,replace:t,state:r,preventScrollReset:n,relative:s,viewTransition:a}={}){let o=Br(),l=uc(),c=n0(i,{relative:s});return T.useCallback(h=>{if(hI(h,e)){h.preventDefault();let f=t!==void 0?t:mg(l)===mg(c);o(i,{replace:f,state:r,preventScrollReset:n,relative:s,viewTransition:a})}},[l,o,c,t,r,e,i,n,s,a])}function Ul(i){Ga(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=T.useRef(u_(i)),t=T.useRef(!1),r=uc(),n=T.useMemo(()=>fI(r.search,t.current?null:e.current),[r.search]),s=Br(),a=T.useCallback((o,l)=>{const c=u_(typeof o=="function"?o(n):o);t.current=!0,s("?"+c,l)},[s,n]);return[n,a]}var MI=0,jI=()=>`__${String(++MI)}__`;function BI(){let{router:i}=DN("useSubmit"),{basename:e}=T.useContext(Lo),t=rI();return T.useCallback(async(r,n={})=>{let{action:s,method:a,encType:o,formData:l,body:c}=gI(r,e);if(n.navigate===!1){let h=n.fetcherKey||jI();await i.fetch(h,t,n.action||s,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,flushSync:n.flushSync})}else await i.navigate(n.action||s,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,replace:n.replace,state:n.state,fromRouteId:t,flushSync:n.flushSync,viewTransition:n.viewTransition})},[i,e,t])}function zI(i,{relative:e}={}){let{basename:t}=T.useContext(Lo),r=T.useContext(Po);hn(r,"useFormAction must be used inside a RouteContext");let[n]=r.matches.slice(-1),s={...n0(i||".",{relative:e})},a=uc();if(i==null){s.search=a.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(h=>h==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let h=o.toString();s.search=h?`?${h}`:""}}return(!i||i===".")&&n.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:Rl([t,s.pathname])),mg(s)}function $I(i,e={}){let t=T.useContext(xN);hn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=DN("useViewTransitionState"),n=n0(i,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Ol(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=Ol(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Rb(n.pathname,a)!=null||Rb(n.pathname,s)!=null}[...SI];function LN(i){var e,t,r="";if(typeof i=="string"||typeof i=="number")r+=i;else if(typeof i=="object")if(Array.isArray(i)){var n=i.length;for(e=0;e<n;e++)i[e]&&(t=LN(i[e]))&&(r&&(r+=" "),r+=t)}else for(t in i)i[t]&&(r&&(r+=" "),r+=t);return r}function Va(){for(var i,e,t=0,r="",n=arguments.length;t<n;t++)(i=arguments[t])&&(e=LN(i))&&(r&&(r+=" "),r+=e);return r}function UI(i){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i))}UI(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var i0=i=>typeof i=="number"&&!isNaN(i),uh=i=>typeof i=="string",Il=i=>typeof i=="function",HI=i=>uh(i)||i0(i),c_=i=>uh(i)||Il(i)?i:null,WI=(i,e)=>i===!1||i0(i)&&i>0?i:e,d_=i=>T.isValidElement(i)||uh(i)||Il(i)||i0(i);function VI(i,e,t=300){let{scrollHeight:r,style:n}=i;requestAnimationFrame(()=>{n.minHeight="initial",n.height=r+"px",n.transition=`all ${t}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(e,t)})})}function GI({enter:i,exit:e,appendPosition:t=!1,collapse:r=!0,collapseDuration:n=300}){return function({children:s,position:a,preventExitTransition:o,done:l,nodeRef:c,isIn:h,playToast:f}){let m=t?`${i}--${a}`:i,p=t?`${e}--${a}`:e,x=T.useRef(0);return T.useLayoutEffect(()=>{let g=c.current,y=m.split(" "),b=_=>{_.target===c.current&&(f(),g.removeEventListener("animationend",b),g.removeEventListener("animationcancel",b),x.current===0&&_.type!=="animationcancel"&&g.classList.remove(...y))};g.classList.add(...y),g.addEventListener("animationend",b),g.addEventListener("animationcancel",b)},[]),T.useEffect(()=>{let g=c.current,y=()=>{g.removeEventListener("animationend",y),r?VI(g,l,n):l()};h||(o?y():(x.current=1,g.className+=` ${p}`,g.addEventListener("animationend",y)))},[h]),st.createElement(st.Fragment,null,s)}}function wk(i,e){return{content:PN(i.content,i.props),containerId:i.props.containerId,id:i.props.toastId,theme:i.props.theme,type:i.props.type,data:i.props.data||{},isLoading:i.props.isLoading,icon:i.props.icon,reason:i.removalReason,status:e}}function PN(i,e,t=!1){return T.isValidElement(i)&&!uh(i.type)?T.cloneElement(i,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):Il(i)?i({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):i}function qI({closeToast:i,theme:e,ariaLabel:t="close"}){return st.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:r=>{r.stopPropagation(),i(!0)},"aria-label":t},st.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},st.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function YI({delay:i,isRunning:e,closeToast:t,type:r="default",hide:n,className:s,controlledProgress:a,progress:o,rtl:l,isIn:c,theme:h}){let f=n||a&&o===0,m={animationDuration:`${i}ms`,animationPlayState:e?"running":"paused"};a&&(m.transform=`scaleX(${o})`);let p=Va("Toastify__progress-bar",a?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":l}),x=Il(s)?s({rtl:l,type:r,defaultClassName:p}):Va(p,s),g={[a&&o>=1?"onTransitionEnd":"onAnimationEnd"]:a&&o<1?null:()=>{c&&t()}};return st.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},st.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${r}`}),st.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:x,style:m,...g}))}var XI=1,ON=()=>`${XI++}`;function KI(i,e,t){let r=1,n=0,s=[],a=[],o=e,l=new Map,c=new Set,h=_=>(c.add(_),()=>c.delete(_)),f=()=>{a=Array.from(l.values()),c.forEach(_=>_())},m=({containerId:_,toastId:S,updateId:k})=>{let C=_?_!==i:i!==1,R=l.has(S)&&k==null;return C||R},p=(_,S)=>{l.forEach(k=>{var C;(S==null||S===k.props.toastId)&&((C=k.toggle)==null||C.call(k,_))})},x=_=>{var S,k;(k=(S=_.props)==null?void 0:S.onClose)==null||k.call(S,_.removalReason),_.isActive=!1},g=_=>{if(_==null)l.forEach(x);else{let S=l.get(_);S&&x(S)}f()},y=()=>{n-=s.length,s=[]},b=_=>{var S,k;let{toastId:C,updateId:R}=_.props,N=R==null;_.staleId&&l.delete(_.staleId),_.isActive=!0,l.set(C,_),f(),t(wk(_,N?"added":"updated")),N&&((k=(S=_.props).onOpen)==null||k.call(S))};return{id:i,props:o,observe:h,toggle:p,removeToast:g,toasts:l,clearQueue:y,buildToast:(_,S)=>{if(m(S))return;let{toastId:k,updateId:C,data:R,staleId:N,delay:O}=S,I=C==null;I&&n++;let F={...o,style:o.toastStyle,key:r++,...Object.fromEntries(Object.entries(S).filter(([B,Y])=>Y!=null)),toastId:k,updateId:C,data:R,isIn:!1,className:c_(S.className||o.toastClassName),progressClassName:c_(S.progressClassName||o.progressClassName),autoClose:S.isLoading?!1:WI(S.autoClose,o.autoClose),closeToast(B){l.get(k).removalReason=B,g(k)},deleteToast(){let B=l.get(k);if(B!=null){if(t(wk(B,"removed")),l.delete(k),n--,n<0&&(n=0),s.length>0){b(s.shift());return}f()}}};F.closeButton=o.closeButton,S.closeButton===!1||d_(S.closeButton)?F.closeButton=S.closeButton:S.closeButton===!0&&(F.closeButton=d_(o.closeButton)?o.closeButton:!0);let G={content:_,props:F,staleId:N};o.limit&&o.limit>0&&n>o.limit&&I?s.push(G):i0(O)?setTimeout(()=>{b(G)},O):b(G)},setProps(_){o=_},setToggle:(_,S)=>{let k=l.get(_);k&&(k.toggle=S)},isToastActive:_=>{var S;return(S=l.get(_))==null?void 0:S.isActive},getSnapshot:()=>a}}var qi=new Map,gg=[],h_=new Set,ZI=i=>h_.forEach(e=>e(i)),IN=()=>qi.size>0;function QI(){gg.forEach(i=>MN(i.content,i.options)),gg=[]}var JI=(i,{containerId:e})=>{var t;return(t=qi.get(e||1))==null?void 0:t.toasts.get(i)};function FN(i,e){var t;if(e)return!!((t=qi.get(e))!=null&&t.isToastActive(i));let r=!1;return qi.forEach(n=>{n.isToastActive(i)&&(r=!0)}),r}function eF(i){if(!IN()){gg=gg.filter(e=>i!=null&&e.options.toastId!==i);return}if(i==null||HI(i))qi.forEach(e=>{e.removeToast(i)});else if(i&&("containerId"in i||"id"in i)){let e=qi.get(i.containerId);e?e.removeToast(i.id):qi.forEach(t=>{t.removeToast(i.id)})}}var tF=(i={})=>{qi.forEach(e=>{e.props.limit&&(!i.containerId||e.id===i.containerId)&&e.clearQueue()})};function MN(i,e){d_(i)&&(IN()||gg.push({content:i,options:e}),qi.forEach(t=>{t.buildToast(i,e)}))}function rF(i){var e;(e=qi.get(i.containerId||1))==null||e.setToggle(i.id,i.fn)}function jN(i,e){qi.forEach(t=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===t.id)&&t.toggle(i,e==null?void 0:e.id)})}function nF(i){let e=i.containerId||1;return{subscribe(t){let r=KI(e,i,ZI);qi.set(e,r);let n=r.observe(t);return QI(),()=>{n(),qi.delete(e)}},setProps(t){var r;(r=qi.get(e))==null||r.setProps(t)},getSnapshot(){var t;return(t=qi.get(e))==null?void 0:t.getSnapshot()}}}function iF(i){return h_.add(i),()=>{h_.delete(i)}}function sF(i){return i&&(uh(i.toastId)||i0(i.toastId))?i.toastId:ON()}function s0(i,e){return MN(i,e),e.toastId}function xw(i,e){return{...e,type:e&&e.type||i,toastId:sF(e)}}function _w(i){return(e,t)=>s0(e,xw(i,t))}function wt(i,e){return s0(i,xw("default",e))}wt.loading=(i,e)=>s0(i,xw("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function aF(i,{pending:e,error:t,success:r},n){let s;e&&(s=uh(e)?wt.loading(e,n):wt.loading(e.render,{...n,...e}));let a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},o=(c,h,f)=>{if(h==null){wt.dismiss(s);return}let m={type:c,...a,...n,data:f},p=uh(h)?{render:h}:h;return s?wt.update(s,{...m,...p}):wt(p.render,{...m,...p}),f},l=Il(i)?i():i;return l.then(c=>o("success",r,c)).catch(c=>o("error",t,c)),l}wt.promise=aF;wt.success=_w("success");wt.info=_w("info");wt.error=_w("error");wt.warning=_w("warning");wt.warn=wt.warning;wt.dark=(i,e)=>s0(i,xw("default",{theme:"dark",...e}));function oF(i){eF(i)}wt.dismiss=oF;wt.clearWaitingQueue=tF;wt.isActive=FN;wt.update=(i,e={})=>{let t=JI(i,e);if(t){let{props:r,content:n}=t,s={delay:100,...r,...e,toastId:e.toastId||i,updateId:ON()};s.toastId!==i&&(s.staleId=i);let a=s.render||n;delete s.render,s0(a,s)}};wt.done=i=>{wt.update(i,{progress:1})};wt.onChange=iF;wt.play=i=>jN(!0,i);wt.pause=i=>jN(!1,i);function lF(i){var e;let{subscribe:t,getSnapshot:r,setProps:n}=T.useRef(nF(i)).current;n(i);let s=(e=T.useSyncExternalStore(t,r,r))==null?void 0:e.slice();function a(o){if(!s)return[];let l=new Map;return i.newestOnTop&&s.reverse(),s.forEach(c=>{let{position:h}=c.props;l.has(h)||l.set(h,[]),l.get(h).push(c)}),Array.from(l,c=>o(c[0],c[1]))}return{getToastToRender:a,isToastActive:FN,count:s==null?void 0:s.length}}function uF(i){let[e,t]=T.useState(!1),[r,n]=T.useState(!1),s=T.useRef(null),a=T.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:l,closeToast:c,onClick:h,closeOnClick:f}=i;rF({id:i.toastId,containerId:i.containerId,fn:t}),T.useEffect(()=>{if(i.pauseOnFocusLoss)return m(),()=>{p()}},[i.pauseOnFocusLoss]);function m(){document.hasFocus()||b(),window.addEventListener("focus",y),window.addEventListener("blur",b)}function p(){window.removeEventListener("focus",y),window.removeEventListener("blur",b)}function x(N){if(i.draggable===!0||i.draggable===N.pointerType){_();let O=s.current;a.canCloseOnClick=!0,a.canDrag=!0,O.style.transition="none",i.draggableDirection==="x"?(a.start=N.clientX,a.removalDistance=O.offsetWidth*(i.draggablePercent/100)):(a.start=N.clientY,a.removalDistance=O.offsetHeight*(i.draggablePercent===80?i.draggablePercent*1.5:i.draggablePercent)/100)}}function g(N){let{top:O,bottom:I,left:F,right:G}=s.current.getBoundingClientRect();N.nativeEvent.type!=="touchend"&&i.pauseOnHover&&N.clientX>=F&&N.clientX<=G&&N.clientY>=O&&N.clientY<=I?b():y()}function y(){t(!0)}function b(){t(!1)}function _(){a.didMove=!1,document.addEventListener("pointermove",k),document.addEventListener("pointerup",C)}function S(){document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",C)}function k(N){let O=s.current;if(a.canDrag&&O){a.didMove=!0,e&&b(),i.draggableDirection==="x"?a.delta=N.clientX-a.start:a.delta=N.clientY-a.start,a.start!==N.clientX&&(a.canCloseOnClick=!1);let I=i.draggableDirection==="x"?`${a.delta}px, var(--y)`:`0, calc(${a.delta}px + var(--y))`;O.style.transform=`translate3d(${I},0)`,O.style.opacity=`${1-Math.abs(a.delta/a.removalDistance)}`}}function C(){S();let N=s.current;if(a.canDrag&&a.didMove&&N){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance){n(!0),i.closeToast(!0),i.collapseAll();return}N.style.transition="transform 0.2s, opacity 0.2s",N.style.removeProperty("transform"),N.style.removeProperty("opacity")}}let R={onPointerDown:x,onPointerUp:g};return o&&l&&(R.onMouseEnter=b,i.stacked||(R.onMouseLeave=y)),f&&(R.onClick=N=>{h&&h(N),a.canCloseOnClick&&c(!0)}),{playToast:y,pauseToast:b,isRunning:e,preventExitTransition:r,toastRef:s,eventHandlers:R}}var cF=typeof window<"u"?T.useLayoutEffect:T.useEffect,Ew=({theme:i,type:e,isLoading:t,...r})=>st.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:i==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...r});function dF(i){return st.createElement(Ew,{...i},st.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function hF(i){return st.createElement(Ew,{...i},st.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function fF(i){return st.createElement(Ew,{...i},st.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function pF(i){return st.createElement(Ew,{...i},st.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function mF(){return st.createElement("div",{className:"Toastify__spinner"})}var f_={info:hF,warning:dF,success:fF,error:pF,spinner:mF},gF=i=>i in f_;function vF({theme:i,type:e,isLoading:t,icon:r}){let n=null,s={theme:i,type:e};return r===!1||(Il(r)?n=r({...s,isLoading:t}):T.isValidElement(r)?n=T.cloneElement(r,s):t?n=f_.spinner():gF(e)&&(n=f_[e](s))),n}var yF=i=>{let{isRunning:e,preventExitTransition:t,toastRef:r,eventHandlers:n,playToast:s}=uF(i),{closeButton:a,children:o,autoClose:l,onClick:c,type:h,hideProgressBar:f,closeToast:m,transition:p,position:x,className:g,style:y,progressClassName:b,updateId:_,role:S,progress:k,rtl:C,toastId:R,deleteToast:N,isIn:O,isLoading:I,closeOnClick:F,theme:G,ariaLabel:B}=i,Y=Va("Toastify__toast",`Toastify__toast-theme--${G}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":C},{"Toastify__toast--close-on-click":F}),j=Il(g)?g({rtl:C,position:x,type:h,defaultClassName:Y}):Va(Y,g),ae=vF(i),he=!!k||!l,ee={closeToast:m,type:h,theme:G},Z=null;return a===!1||(Il(a)?Z=a(ee):T.isValidElement(a)?Z=T.cloneElement(a,ee):Z=qI(ee)),st.createElement(p,{isIn:O,done:N,position:x,preventExitTransition:t,nodeRef:r,playToast:s},st.createElement("div",{id:R,tabIndex:0,onClick:c,"data-in":O,className:j,...n,style:y,ref:r,...O&&{role:S,"aria-label":B}},ae!=null&&st.createElement("div",{className:Va("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!I})},ae),PN(o,i,!e),Z,!i.customProgressBar&&st.createElement(YI,{..._&&!he?{key:`p-${_}`}:{},rtl:C,theme:G,delay:l,isRunning:e,isIn:O,closeToast:m,hide:f,type:h,className:b,controlledProgress:he,progress:k||0})))},bF=(i,e=!1)=>({enter:`Toastify--animate Toastify__${i}-enter`,exit:`Toastify--animate Toastify__${i}-exit`,appendPosition:e}),wF=GI(bF("bounce",!0)),xF={position:"top-right",transition:wF,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:i=>i.altKey&&i.code==="KeyT"};function _F(i){let e={...xF,...i},t=i.stacked,[r,n]=T.useState(!0),s=T.useRef(null),{getToastToRender:a,isToastActive:o,count:l}=lF(e),{className:c,style:h,rtl:f,containerId:m,hotKeys:p}=e;function x(y){let b=Va("Toastify__toast-container",`Toastify__toast-container--${y}`,{"Toastify__toast-container--rtl":f});return Il(c)?c({position:y,rtl:f,defaultClassName:b}):Va(b,c_(c))}function g(){t&&(n(!0),wt.play())}return cF(()=>{var y;if(t){let b=s.current.querySelectorAll('[data-in="true"]'),_=12,S=(y=e.position)==null?void 0:y.includes("top"),k=0,C=0;Array.from(b).reverse().forEach((R,N)=>{let O=R;O.classList.add("Toastify__toast--stacked"),N>0&&(O.dataset.collapsed=`${r}`),O.dataset.pos||(O.dataset.pos=S?"top":"bot");let I=k*(r?.2:1)+(r?0:_*N);O.style.setProperty("--y",`${S?I:I*-1}px`),O.style.setProperty("--g",`${_}`),O.style.setProperty("--s",`${1-(r?C:0)}`),k+=O.offsetHeight,C+=.025})}},[r,l,t]),T.useEffect(()=>{function y(b){var _;let S=s.current;p(b)&&((_=S.querySelector('[tabIndex="0"]'))==null||_.focus(),n(!1),wt.pause()),b.key==="Escape"&&(document.activeElement===S||S!=null&&S.contains(document.activeElement))&&(n(!0),wt.play())}return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}},[p]),st.createElement("section",{ref:s,className:"Toastify",id:m,onMouseEnter:()=>{t&&(n(!1),wt.pause())},onMouseLeave:g,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},a((y,b)=>{let _=b.length?{...h}:{...h,pointerEvents:"none"};return st.createElement("div",{tabIndex:-1,className:x(y),"data-stacked":t,style:_,key:`c-${y}`},b.map(({content:S,props:k})=>st.createElement(yF,{...k,stacked:t,collapseAll:g,isIn:o(k.toastId,k.containerId),key:`t-${k.key}`},S)))}))}const xk=i=>{let e;const t=new Set,r=(c,h)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const m=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(p=>p(e,m))}},n=()=>e,o={setState:r,getState:n,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=i(r,n,o);return o},EF=i=>i?xk(i):xk,SF=i=>i;function AF(i,e=SF){const t=st.useSyncExternalStore(i.subscribe,()=>e(i.getState()),()=>e(i.getInitialState()));return st.useDebugValue(t),t}const CF=i=>{const e=EF(i),t=r=>AF(e,r);return Object.assign(t,e),t},fh=i=>CF;function dc(i,e){let t;try{t=i()}catch{return}return{getItem:n=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(n))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(n,s)=>t.setItem(n,JSON.stringify(s,void 0)),removeItem:n=>t.removeItem(n)}}const p_=i=>e=>{try{const t=i(e);return t instanceof Promise?t:{then(r){return p_(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return p_(r)(t)}}}},kF=(i,e)=>(t,r,n)=>{let s={storage:dc(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return i((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...g)},r,n);const h=()=>{const g=s.partialize({...r()});return c.setItem(s.name,{state:g,version:s.version})},f=n.setState;n.setState=(g,y)=>{f(g,y),h()};const m=i((...g)=>{t(...g),h()},r,n);n.getInitialState=()=>m;let p;const x=()=>{var g,y;if(!c)return;a=!1,o.forEach(_=>{var S;return _((S=r())!=null?S:m)});const b=((y=s.onRehydrateStorage)==null?void 0:y.call(s,(g=r())!=null?g:m))||void 0;return p_(c.getItem.bind(c))(s.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==s.version){if(s.migrate){const S=s.migrate(_.state,_.version);return S instanceof Promise?S.then(k=>[!0,k]):[!0,S]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var S;const[k,C]=_;if(p=s.merge(C,(S=r())!=null?S:m),t(p,!0),k)return h()}).then(()=>{b==null||b(p,void 0),p=r(),a=!0,l.forEach(_=>_(p))}).catch(_=>{b==null||b(void 0,_)})};return n.persist={setOptions:g=>{s={...s,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c==null||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},s.skipHydration||x(),p||m},ph=kF;function Sw(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function TF(i,e){let t;const r=()=>{if(t)return t;const n=indexedDB.open(i);return n.onupgradeneeded=()=>n.result.createObjectStore(e),t=Sw(n),t.then(s=>{s.onclose=()=>t=void 0},()=>{}),t};return(n,s)=>r().then(a=>s(a.transaction(e,n).objectStore(e)))}let V2;function cS(){return V2||(V2=TF("keyval-store","keyval")),V2}function dS(i,e=cS()){return e("readonly",t=>Sw(t.get(i)))}function hS(i,e,t=cS()){return t("readwrite",r=>(r.put(e,i),Sw(r.transaction)))}function fS(i,e=cS()){return e("readwrite",t=>(t.delete(i),Sw(t.transaction)))}const RF={getItem:async i=>await dS(i)||null,setItem:async(i,e)=>{await hS(i,e)},removeItem:async i=>{await fS(i)}},NF=fh()(ph(i=>({logs:[],setLogs:e=>i({logs:e}),addLog:e=>i(t=>({logs:[...t.logs,e]})),hasHydrated:!1,setHasHydrated:e=>i({hasHydrated:e})}),{name:"log-storage",storage:dc(()=>RF),onRehydrateStorage:i=>()=>i.setHasHydrated(!0),partialize:i=>({logs:i.logs})}));function Yt({onPress:i,children:e,className:t,disabled:r,...n}){const s=T.useMemo(()=>`bg-tertiary border border-primary text-sm font-semibold rounded-xl p-3 text-white flex flex-row items-center justify-center gap-2 ${t||""} ${r?"opacity-50 hover:cursor-not-allowed":"hover:cursor-pointer hover:bg-quaternary"}`,[t,r]);return E.jsx("button",{onClick:i,className:s,disabled:r,"aria-busy":r,...n,children:e})}const DF=T.memo(({provider:i,onClick:e})=>E.jsx("div",{children:E.jsx(Yt,{onPress:()=>e(i.route),className:"w-full md:w-full p-5",children:i.name})})),_k=i=>Symbol.iterator in i,Ek=i=>"entries"in i,Sk=(i,e)=>{const t=i instanceof Map?i:new Map(i.entries()),r=e instanceof Map?e:new Map(e.entries());if(t.size!==r.size)return!1;for(const[n,s]of t)if(!Object.is(s,r.get(n)))return!1;return!0},LF=(i,e)=>{const t=i[Symbol.iterator](),r=e[Symbol.iterator]();let n=t.next(),s=r.next();for(;!n.done&&!s.done;){if(!Object.is(n.value,s.value))return!1;n=t.next(),s=r.next()}return!!n.done&&!!s.done};function PF(i,e){return Object.is(i,e)?!0:typeof i!="object"||i===null||typeof e!="object"||e===null||Object.getPrototypeOf(i)!==Object.getPrototypeOf(e)?!1:_k(i)&&_k(e)?Ek(i)&&Ek(e)?Sk(i,e):LF(i,e):Sk({entries:()=>Object.entries(i)},{entries:()=>Object.entries(e)})}function Dt(i){const e=st.useRef(void 0);return t=>{const r=i(t);return PF(e.current,r)?e.current:e.current=r}}const OF=(i,e,t,r)=>{var s,a,o,l;const n=[t,{code:e,...r||{}}];if((a=(s=i==null?void 0:i.services)==null?void 0:s.logger)!=null&&a.forward)return i.services.logger.forward(n,"warn","react-i18next::",!0);ah(n[0])&&(n[0]=`react-i18next:: ${n[0]}`),(l=(o=i==null?void 0:i.services)==null?void 0:o.logger)!=null&&l.warn?i.services.logger.warn(...n):console!=null&&console.warn&&console.warn(...n)},Ak={},m_=(i,e,t,r)=>{ah(t)&&Ak[t]||(ah(t)&&(Ak[t]=new Date),OF(i,e,t,r))},BN=(i,e)=>()=>{if(i.isInitialized)e();else{const t=()=>{setTimeout(()=>{i.off("initialized",t)},0),e()};i.on("initialized",t)}},g_=(i,e,t)=>{i.loadNamespaces(e,BN(i,t))},Ck=(i,e,t,r)=>{if(ah(t)&&(t=[t]),i.options.preload&&i.options.preload.indexOf(e)>-1)return g_(i,t,r);t.forEach(n=>{i.options.ns.indexOf(n)<0&&i.options.ns.push(n)}),i.loadLanguages(e,BN(i,r))},IF=(i,e,t={})=>!e.languages||!e.languages.length?(m_(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(i,{lng:t.lng,precheck:(r,n)=>{var s;if(((s=t.bindI18n)==null?void 0:s.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!n(r.isLanguageChangingTo,i))return!1}}),ah=i=>typeof i=="string",FF=i=>typeof i=="object"&&i!==null,MF=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,jF={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},BF=i=>jF[i],zF=i=>i.replace(MF,BF);let v_={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:zF};const $F=(i={})=>{v_={...v_,...i}},UF=()=>v_;let zN;const HF=i=>{zN=i},WF=()=>zN,VF={type:"3rdParty",init(i){$F(i.options.react),HF(i)}},GF=T.createContext();class qF{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const YF=(i,e)=>{const t=T.useRef();return T.useEffect(()=>{t.current=i},[i,e]),t.current},$N=(i,e,t,r)=>i.getFixedT(e,t,r),XF=(i,e,t,r)=>T.useCallback($N(i,e,t,r),[i,e,t,r]),ir=(i,e={})=>{var k,C,R,N;const{i18n:t}=e,{i18n:r,defaultNS:n}=T.useContext(GF)||{},s=t||r||WF();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new qF),!s){m_(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const O=(F,G)=>ah(G)?G:FF(G)&&ah(G.defaultValue)?G.defaultValue:Array.isArray(F)?F[F.length-1]:F,I=[O,{},!1];return I.t=O,I.i18n={},I.ready=!1,I}(k=s.options.react)!=null&&k.wait&&m_(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const a={...UF(),...s.options.react,...e},{useSuspense:o,keyPrefix:l}=a;let c=n||((C=s.options)==null?void 0:C.defaultNS);c=ah(c)?[c]:c||["translation"],(N=(R=s.reportNamespaces).addUsedNamespaces)==null||N.call(R,c);const h=(s.isInitialized||s.initializedStoreOnce)&&c.every(O=>IF(O,s,a)),f=XF(s,e.lng||null,a.nsMode==="fallback"?c:c[0],l),m=()=>f,p=()=>$N(s,e.lng||null,a.nsMode==="fallback"?c:c[0],l),[x,g]=T.useState(m);let y=c.join();e.lng&&(y=`${e.lng}${y}`);const b=YF(y),_=T.useRef(!0);T.useEffect(()=>{const{bindI18n:O,bindI18nStore:I}=a;_.current=!0,!h&&!o&&(e.lng?Ck(s,e.lng,c,()=>{_.current&&g(p)}):g_(s,c,()=>{_.current&&g(p)})),h&&b&&b!==y&&_.current&&g(p);const F=()=>{_.current&&g(p)};return O&&(s==null||s.on(O,F)),I&&(s==null||s.store.on(I,F)),()=>{_.current=!1,s&&(O==null||O.split(" ").forEach(G=>s.off(G,F))),I&&s&&I.split(" ").forEach(G=>s.store.off(G,F))}},[s,y]),T.useEffect(()=>{_.current&&h&&g(m)},[s,l,h]);const S=[x,s,h];if(S.t=x,S.i18n=s,S.ready=h,h||!h&&!o)return S;throw new Promise(O=>{e.lng?Ck(s,e.lng,c,()=>O()):g_(s,c,()=>O())})},UN=typeof document<"u"?st.useLayoutEffect:()=>{};function KF(i){const e=T.useRef(null);return UN(()=>{e.current=i},[i]),T.useCallback((...t)=>{const r=e.current;return r==null?void 0:r(...t)},[])}const hc=i=>{var e;return(e=i==null?void 0:i.ownerDocument)!==null&&e!==void 0?e:document},Qc=i=>i&&"window"in i&&i.window===i?i:hc(i).defaultView||window;function ZF(i){return i!==null&&typeof i=="object"&&"nodeType"in i&&typeof i.nodeType=="number"}function QF(i){return ZF(i)&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in i}let JF=!1;function pS(){return JF}function HN(i,e){if(!pS())return e&&i?i.contains(e):!1;if(!i||!e)return!1;let t=e;for(;t!==null;){if(t===i)return!0;t.tagName==="SLOT"&&t.assignedSlot?t=t.assignedSlot.parentNode:QF(t)?t=t.host:t=t.parentNode}return!1}const y_=(i=document)=>{var e;if(!pS())return i.activeElement;let t=i.activeElement;for(;t&&"shadowRoot"in t&&(!((e=t.shadowRoot)===null||e===void 0)&&e.activeElement);)t=t.shadowRoot.activeElement;return t};function WN(i){return pS()&&i.target.shadowRoot&&i.composedPath?i.composedPath()[0]:i.target}function eM(i){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(t=>i.test(t.brand)))||i.test(window.navigator.userAgent)}function tM(i){var e;return typeof window<"u"&&window.navigator!=null?i.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function VN(i){let e=null;return()=>(e==null&&(e=i()),e)}const rM=VN(function(){return tM(/^Mac/i)}),nM=VN(function(){return eM(/Android/i)});function GN(){let i=T.useRef(new Map),e=T.useCallback((n,s,a,o)=>{let l=o!=null&&o.once?(...c)=>{i.current.delete(a),a(...c)}:a;i.current.set(a,{type:s,eventTarget:n,fn:l,options:o}),n.addEventListener(s,l,o)},[]),t=T.useCallback((n,s,a,o)=>{var l;let c=((l=i.current.get(a))===null||l===void 0?void 0:l.fn)||a;n.removeEventListener(s,c,o),i.current.delete(a)},[]),r=T.useCallback(()=>{i.current.forEach((n,s)=>{t(n.eventTarget,n.type,s,n.options)})},[t]);return T.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:t,removeAllGlobalListeners:r}}function iM(i){return i.mozInputSource===0&&i.isTrusted?!0:nM()&&i.pointerType?i.type==="click"&&i.buttons===1:i.detail===0&&!i.pointerType}var qN=pN();function YN(i){let e=i;return e.nativeEvent=i,e.isDefaultPrevented=()=>e.defaultPrevented,e.isPropagationStopped=()=>e.cancelBubble,e.persist=()=>{},e}function sM(i,e){Object.defineProperty(i,"target",{value:e}),Object.defineProperty(i,"currentTarget",{value:e})}function XN(i){let e=T.useRef({isFocused:!1,observer:null});UN(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=KF(r=>{i==null||i(r)});return T.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let n=r.target,s=a=>{if(e.current.isFocused=!1,n.disabled){let o=YN(a);t(o)}e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};n.addEventListener("focusout",s,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&n.disabled){var a;(a=e.current.observer)===null||a===void 0||a.disconnect();let o=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:o})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:o}))}}),e.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let aM=!1,a0=null,b_=new Set,ug=new Map,ch=!1,w_=!1;const oM={Tab:!0,Escape:!0};function mS(i,e){for(let t of b_)t(i,e)}function lM(i){return!(i.metaKey||!rM()&&i.altKey||i.ctrlKey||i.key==="Control"||i.key==="Shift"||i.key==="Meta")}function Nb(i){ch=!0,lM(i)&&(a0="keyboard",mS("keyboard",i))}function wf(i){a0="pointer",(i.type==="mousedown"||i.type==="pointerdown")&&(ch=!0,mS("pointer",i))}function KN(i){iM(i)&&(ch=!0,a0="virtual")}function ZN(i){i.target===window||i.target===document||aM||!i.isTrusted||(!ch&&!w_&&(a0="virtual",mS("virtual",i)),ch=!1,w_=!1)}function QN(){ch=!1,w_=!0}function x_(i){if(typeof window>"u"||typeof document>"u"||ug.get(Qc(i)))return;const e=Qc(i),t=hc(i);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ch=!0,r.apply(this,arguments)},t.addEventListener("keydown",Nb,!0),t.addEventListener("keyup",Nb,!0),t.addEventListener("click",KN,!0),e.addEventListener("focus",ZN,!0),e.addEventListener("blur",QN,!1),typeof PointerEvent<"u"&&(t.addEventListener("pointerdown",wf,!0),t.addEventListener("pointermove",wf,!0),t.addEventListener("pointerup",wf,!0)),e.addEventListener("beforeunload",()=>{JN(i)},{once:!0}),ug.set(e,{focus:r})}const JN=(i,e)=>{const t=Qc(i),r=hc(i);e&&r.removeEventListener("DOMContentLoaded",e),ug.has(t)&&(t.HTMLElement.prototype.focus=ug.get(t).focus,r.removeEventListener("keydown",Nb,!0),r.removeEventListener("keyup",Nb,!0),r.removeEventListener("click",KN,!0),t.removeEventListener("focus",ZN,!0),t.removeEventListener("blur",QN,!1),typeof PointerEvent<"u"&&(r.removeEventListener("pointerdown",wf,!0),r.removeEventListener("pointermove",wf,!0),r.removeEventListener("pointerup",wf,!0)),ug.delete(t))};function uM(i){const e=hc(i);let t;return e.readyState!=="loading"?x_(i):(t=()=>{x_(i)},e.addEventListener("DOMContentLoaded",t)),()=>JN(i,t)}typeof document<"u"&&uM();function e5(){return a0!=="pointer"}const cM=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function dM(i,e,t){let r=hc(t==null?void 0:t.target);const n=typeof window<"u"?Qc(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,s=typeof window<"u"?Qc(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,a=typeof window<"u"?Qc(t==null?void 0:t.target).HTMLElement:HTMLElement,o=typeof window<"u"?Qc(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return i=i||r.activeElement instanceof n&&!cM.has(r.activeElement.type)||r.activeElement instanceof s||r.activeElement instanceof a&&r.activeElement.isContentEditable,!(i&&e==="keyboard"&&t instanceof o&&!oM[t.key])}function hM(i,e,t){x_(),T.useEffect(()=>{let r=(n,s)=>{dM(!!(t!=null&&t.isTextInput),n,s)&&i(e5())};return b_.add(r),()=>{b_.delete(r)}},e)}function fM(i){let{isDisabled:e,onFocus:t,onBlur:r,onFocusChange:n}=i;const s=T.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),n&&n(!1),!0},[r,n]),a=XN(s),o=T.useCallback(l=>{const c=hc(l.target),h=c?y_(c):y_();l.target===l.currentTarget&&h===WN(l.nativeEvent)&&(t&&t(l),n&&n(!0),a(l))},[n,t,a]);return{focusProps:{onFocus:!e&&(t||n||r)?o:void 0,onBlur:!e&&(r||n)?s:void 0}}}function pM(i){let{isDisabled:e,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:n}=i,s=T.useRef({isFocusWithin:!1}),{addGlobalListener:a,removeAllGlobalListeners:o}=GN(),l=T.useCallback(f=>{f.currentTarget.contains(f.target)&&s.current.isFocusWithin&&!f.currentTarget.contains(f.relatedTarget)&&(s.current.isFocusWithin=!1,o(),t&&t(f),n&&n(!1))},[t,n,s,o]),c=XN(l),h=T.useCallback(f=>{if(!f.currentTarget.contains(f.target))return;const m=hc(f.target),p=y_(m);if(!s.current.isFocusWithin&&p===WN(f.nativeEvent)){r&&r(f),n&&n(!0),s.current.isFocusWithin=!0,c(f);let x=f.currentTarget;a(m,"focus",g=>{if(s.current.isFocusWithin&&!HN(x,g.target)){let y=new m.defaultView.FocusEvent("blur",{relatedTarget:g.target});sM(y,x);let b=YN(y);l(b)}},{capture:!0})}},[r,n,c,a,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:h,onBlur:l}}}let __=!1,G2=0;function mM(){__=!0,setTimeout(()=>{__=!1},50)}function kk(i){i.pointerType==="touch"&&mM()}function gM(){if(!(typeof document>"u"))return typeof PointerEvent<"u"&&document.addEventListener("pointerup",kk),G2++,()=>{G2--,!(G2>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",kk)}}function vM(i){let{onHoverStart:e,onHoverChange:t,onHoverEnd:r,isDisabled:n}=i,[s,a]=T.useState(!1),o=T.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;T.useEffect(gM,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=GN(),{hoverProps:h,triggerHoverEnd:f}=T.useMemo(()=>{let m=(g,y)=>{if(o.pointerType=y,n||y==="touch"||o.isHovered||!g.currentTarget.contains(g.target))return;o.isHovered=!0;let b=g.currentTarget;o.target=b,l(hc(g.target),"pointerover",_=>{o.isHovered&&o.target&&!HN(o.target,_.target)&&p(_,_.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:b,pointerType:y}),t&&t(!0),a(!0)},p=(g,y)=>{let b=o.target;o.pointerType="",o.target=null,!(y==="touch"||!o.isHovered||!b)&&(o.isHovered=!1,c(),r&&r({type:"hoverend",target:b,pointerType:y}),t&&t(!1),a(!1))},x={};return typeof PointerEvent<"u"&&(x.onPointerEnter=g=>{__&&g.pointerType==="mouse"||m(g,g.pointerType)},x.onPointerLeave=g=>{!n&&g.currentTarget.contains(g.target)&&p(g,g.pointerType)}),{hoverProps:x,triggerHoverEnd:p}},[e,t,r,n,o,l,c]);return T.useEffect(()=>{n&&f({currentTarget:o.target},o.pointerType)},[n]),{hoverProps:h,isHovered:s}}function yM(i={}){let{autoFocus:e=!1,isTextInput:t,within:r}=i,n=T.useRef({isFocused:!1,isFocusVisible:e||e5()}),[s,a]=T.useState(!1),[o,l]=T.useState(()=>n.current.isFocused&&n.current.isFocusVisible),c=T.useCallback(()=>l(n.current.isFocused&&n.current.isFocusVisible),[]),h=T.useCallback(p=>{n.current.isFocused=p,a(p),c()},[c]);hM(p=>{n.current.isFocusVisible=p,c()},[],{isTextInput:t});let{focusProps:f}=fM({isDisabled:r,onFocusChange:h}),{focusWithinProps:m}=pM({isDisabled:!r,onFocusWithinChange:h});return{isFocused:s,isFocusVisible:o,focusProps:r?m:f}}var bM=Object.defineProperty,wM=(i,e,t)=>e in i?bM(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,q2=(i,e,t)=>(wM(i,typeof e!="symbol"?e+"":e,t),t);let xM=class{constructor(){q2(this,"current",this.detect()),q2(this,"handoffState","pending"),q2(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},oh=new xM;function Bp(i){var e,t;return oh.isServer?null:i?"ownerDocument"in i?i.ownerDocument:"current"in i?(t=(e=i.current)==null?void 0:e.ownerDocument)!=null?t:document:null:document}function Aw(i){typeof queueMicrotask=="function"?queueMicrotask(i):Promise.resolve().then(i).catch(e=>setTimeout(()=>{throw e}))}function Hl(){let i=[],e={addEventListener(t,r,n,s){return t.addEventListener(r,n,s),e.add(()=>t.removeEventListener(r,n,s))},requestAnimationFrame(...t){let r=requestAnimationFrame(...t);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...t){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...t))},setTimeout(...t){let r=setTimeout(...t);return e.add(()=>clearTimeout(r))},microTask(...t){let r={current:!0};return Aw(()=>{r.current&&t[0]()}),e.add(()=>{r.current=!1})},style(t,r,n){let s=t.style.getPropertyValue(r);return Object.assign(t.style,{[r]:n}),this.add(()=>{Object.assign(t.style,{[r]:s})})},group(t){let r=Hl();return t(r),this.add(()=>r.dispose())},add(t){return i.includes(t)||i.push(t),()=>{let r=i.indexOf(t);if(r>=0)for(let n of i.splice(r,1))n()}},dispose(){for(let t of i.splice(0))t()}};return e}function Cw(){let[i]=T.useState(Hl);return T.useEffect(()=>()=>i.dispose(),[i]),i}let Pi=(i,e)=>{oh.isServer?T.useEffect(i,e):T.useLayoutEffect(i,e)};function mh(i){let e=T.useRef(i);return Pi(()=>{e.current=i},[i]),e}let gr=function(i){let e=mh(i);return st.useCallback((...t)=>e.current(...t),[e])};function _M(i){let e=i.width/2,t=i.height/2;return{top:i.clientY-t,right:i.clientX+e,bottom:i.clientY+t,left:i.clientX-e}}function EM(i,e){return!(!i||!e||i.right<e.left||i.left>e.right||i.bottom<e.top||i.top>e.bottom)}function SM({disabled:i=!1}={}){let e=T.useRef(null),[t,r]=T.useState(!1),n=Cw(),s=gr(()=>{e.current=null,r(!1),n.dispose()}),a=gr(o=>{if(n.dispose(),e.current===null){e.current=o.currentTarget,r(!0);{let l=Bp(o.currentTarget);n.addEventListener(l,"pointerup",s,!1),n.addEventListener(l,"pointermove",c=>{if(e.current){let h=_M(c);r(EM(h,e.current.getBoundingClientRect()))}},!1),n.addEventListener(l,"pointercancel",s,!1)}}});return{pressed:t,pressProps:i?{}:{onPointerDown:a,onPointerUp:s,onClick:s}}}let AM=T.createContext(void 0);function CM(){return T.useContext(AM)}function E_(...i){return Array.from(new Set(i.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function pa(i,e,...t){if(i in e){let n=e[i];return typeof n=="function"?n(...t):n}let r=new Error(`Tried to handle "${i}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(n=>`"${n}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,pa),r}var Lp=(i=>(i[i.None=0]="None",i[i.RenderStrategy=1]="RenderStrategy",i[i.Static=2]="Static",i))(Lp||{}),Zu=(i=>(i[i.Unmount=0]="Unmount",i[i.Hidden=1]="Hidden",i))(Zu||{});function Zi(){let i=TM();return T.useCallback(e=>kM({mergeRefs:i,...e}),[i])}function kM({ourProps:i,theirProps:e,slot:t,defaultTag:r,features:n,visible:s=!0,name:a,mergeRefs:o}){o=o??RM;let l=t5(e,i);if(s)return Dy(l,t,r,a,o);let c=n??0;if(c&2){let{static:h=!1,...f}=l;if(h)return Dy(f,t,r,a,o)}if(c&1){let{unmount:h=!0,...f}=l;return pa(h?0:1,{0(){return null},1(){return Dy({...f,hidden:!0,style:{display:"none"}},t,r,a,o)}})}return Dy(l,t,r,a,o)}function Dy(i,e={},t,r,n){let{as:s=t,children:a,refName:o="ref",...l}=Y2(i,["unmount","static"]),c=i.ref!==void 0?{[o]:i.ref}:{},h=typeof a=="function"?a(e):a;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let f={};if(e){let m=!1,p=[];for(let[x,g]of Object.entries(e))typeof g=="boolean"&&(m=!0),g===!0&&p.push(x.replace(/([A-Z])/g,y=>`-${y.toLowerCase()}`));if(m){f["data-headlessui-state"]=p.join(" ");for(let x of p)f[`data-${x}`]=""}}if(s===T.Fragment&&(Object.keys(Uc(l)).length>0||Object.keys(Uc(f)).length>0))if(!T.isValidElement(h)||Array.isArray(h)&&h.length>1){if(Object.keys(Uc(l)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Uc(l)).concat(Object.keys(Uc(f))).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`))}else{let m=h.props,p=m==null?void 0:m.className,x=typeof p=="function"?(...b)=>E_(p(...b),l.className):E_(p,l.className),g=x?{className:x}:{},y=t5(h.props,Uc(Y2(l,["ref"])));for(let b in f)b in y&&delete f[b];return T.cloneElement(h,Object.assign({},y,f,c,{ref:n(NM(h),c.ref)},g))}return T.createElement(s,Object.assign({},Y2(l,["ref"]),s!==T.Fragment&&c,s!==T.Fragment&&f),h)}function TM(){let i=T.useRef([]),e=T.useCallback(t=>{for(let r of i.current)r!=null&&(typeof r=="function"?r(t):r.current=t)},[]);return(...t)=>{if(!t.every(r=>r==null))return i.current=t,e}}function RM(...i){return i.every(e=>e==null)?void 0:e=>{for(let t of i)t!=null&&(typeof t=="function"?t(e):t.current=e)}}function t5(...i){if(i.length===0)return{};if(i.length===1)return i[0];let e={},t={};for(let r of i)for(let n in r)n.startsWith("on")&&typeof r[n]=="function"?(t[n]!=null||(t[n]=[]),t[n].push(r[n])):e[n]=r[n];if(e.disabled||e["aria-disabled"])for(let r in t)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(t[r]=[n=>{var s;return(s=n==null?void 0:n.preventDefault)==null?void 0:s.call(n)}]);for(let r in t)Object.assign(e,{[r](n,...s){let a=t[r];for(let o of a){if((n instanceof Event||(n==null?void 0:n.nativeEvent)instanceof Event)&&n.defaultPrevented)return;o(n,...s)}}});return e}function Tk(...i){if(i.length===0)return{};if(i.length===1)return i[0];let e={},t={};for(let r of i)for(let n in r)n.startsWith("on")&&typeof r[n]=="function"?(t[n]!=null||(t[n]=[]),t[n].push(r[n])):e[n]=r[n];for(let r in t)Object.assign(e,{[r](...n){let s=t[r];for(let a of s)a==null||a(...n)}});return e}function gi(i){var e;return Object.assign(T.forwardRef(i),{displayName:(e=i.displayName)!=null?e:i.name})}function Uc(i){let e=Object.assign({},i);for(let t in e)e[t]===void 0&&delete e[t];return e}function Y2(i,e=[]){let t=Object.assign({},i);for(let r of e)r in t&&delete t[r];return t}function NM(i){return st.version.split(".")[0]>="19"?i.props.ref:i.ref}let DM="span";var Db=(i=>(i[i.None=1]="None",i[i.Focusable=2]="Focusable",i[i.Hidden=4]="Hidden",i))(Db||{});function LM(i,e){var t;let{features:r=1,...n}=i,s={ref:e,"aria-hidden":(r&2)===2?!0:(t=n["aria-hidden"])!=null?t:void 0,hidden:(r&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(r&4)===4&&(r&2)!==2&&{display:"none"}}};return Zi()({ourProps:s,theirProps:n,slot:{},defaultTag:DM,name:"Hidden"})}let S_=gi(LM);function r5(i){return typeof i!="object"||i===null?!1:"nodeType"in i}function ec(i){return r5(i)&&"tagName"in i}function Fl(i){return ec(i)&&"accessKey"in i}function ko(i){return ec(i)&&"tabIndex"in i}function PM(i){return ec(i)&&"style"in i}function OM(i){return Fl(i)&&i.nodeName==="IFRAME"}function IM(i){return Fl(i)&&i.nodeName==="INPUT"}function FM(i){return Fl(i)&&i.nodeName==="FIELDSET"}function n5(i){return Fl(i)&&i.nodeName==="LEGEND"}function MM(i){let e=i.parentElement,t=null;for(;e&&!FM(e);)n5(e)&&(t=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&jM(t)?!1:r}function jM(i){if(!i)return!1;let e=i.previousElementSibling;for(;e!==null;){if(n5(e))return!1;e=e.previousElementSibling}return!0}let i5=Symbol();function s5(i,e=!0){return Object.assign(i,{[i5]:e})}function Us(...i){let e=T.useRef(i);T.useEffect(()=>{e.current=i},[i]);let t=gr(r=>{for(let n of e.current)n!=null&&(typeof n=="function"?n(r):n.current=r)});return i.every(r=>r==null||(r==null?void 0:r[i5]))?void 0:t}let gS=T.createContext(null);gS.displayName="DescriptionContext";function a5(){let i=T.useContext(gS);if(i===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,a5),e}return i}function BM(){let[i,e]=T.useState([]);return[i.length>0?i.join(" "):void 0,T.useMemo(()=>function(t){let r=gr(s=>(e(a=>[...a,s]),()=>e(a=>{let o=a.slice(),l=o.indexOf(s);return l!==-1&&o.splice(l,1),o}))),n=T.useMemo(()=>({register:r,slot:t.slot,name:t.name,props:t.props,value:t.value}),[r,t.slot,t.name,t.props,t.value]);return st.createElement(gS.Provider,{value:n},t.children)},[e])]}let zM="p";function $M(i,e){let t=T.useId(),r=CM(),{id:n=`headlessui-description-${t}`,...s}=i,a=a5(),o=Us(e);Pi(()=>a.register(n),[n,a.register]);let l=r||!1,c=T.useMemo(()=>({...a.slot,disabled:l}),[a.slot,l]),h={ref:o,...a.props,id:n};return Zi()({ourProps:h,theirProps:s,slot:c,defaultTag:zM,name:a.name||"Description"})}let UM=gi($M),HM=Object.assign(UM,{});var Gc=(i=>(i.Space=" ",i.Enter="Enter",i.Escape="Escape",i.Backspace="Backspace",i.Delete="Delete",i.ArrowLeft="ArrowLeft",i.ArrowUp="ArrowUp",i.ArrowRight="ArrowRight",i.ArrowDown="ArrowDown",i.Home="Home",i.End="End",i.PageUp="PageUp",i.PageDown="PageDown",i.Tab="Tab",i))(Gc||{});let WM=T.createContext(()=>{});function o5({value:i,children:e}){return st.createElement(WM.Provider,{value:i},e)}function Zh(i,e,t){let r=t.initialDeps??[],n;function s(){var a,o,l,c;let h;t.key&&((a=t.debug)!=null&&a.call(t))&&(h=Date.now());const f=i();if(!(f.length!==r.length||f.some((x,g)=>r[g]!==x)))return n;r=f;let p;if(t.key&&((o=t.debug)!=null&&o.call(t))&&(p=Date.now()),n=e(...f),t.key&&((l=t.debug)!=null&&l.call(t))){const x=Math.round((Date.now()-h)*100)/100,g=Math.round((Date.now()-p)*100)/100,y=g/16,b=(_,S)=>{for(_=String(_);_.length<S;)_=" "+_;return _};console.info(`%c⏱ ${b(g,5)} /${b(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,t==null?void 0:t.key)}return(c=t==null?void 0:t.onChange)==null||c.call(t,n),n}return s.updateDeps=a=>{r=a},s}function Rk(i,e){if(i===void 0)throw new Error("Unexpected undefined");return i}const VM=(i,e)=>Math.abs(i-e)<1.01,GM=(i,e,t)=>{let r;return function(...n){i.clearTimeout(r),r=i.setTimeout(()=>e.apply(this,n),t)}},Nk=i=>{const{offsetWidth:e,offsetHeight:t}=i;return{width:e,height:t}},qM=i=>i,YM=i=>{const e=Math.max(i.startIndex-i.overscan,0),t=Math.min(i.endIndex+i.overscan,i.count-1),r=[];for(let n=e;n<=t;n++)r.push(n);return r},XM=(i,e)=>{const t=i.scrollElement;if(!t)return;const r=i.targetWindow;if(!r)return;const n=a=>{const{width:o,height:l}=a;e({width:Math.round(o),height:Math.round(l)})};if(n(Nk(t)),!r.ResizeObserver)return()=>{};const s=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){n({width:c.inlineSize,height:c.blockSize});return}}n(Nk(t))};i.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return s.observe(t,{box:"border-box"}),()=>{s.unobserve(t)}},Dk={passive:!0},Lk=typeof window>"u"?!0:"onscrollend"in window,KM=(i,e)=>{const t=i.scrollElement;if(!t)return;const r=i.targetWindow;if(!r)return;let n=0;const s=i.options.useScrollendEvent&&Lk?()=>{}:GM(r,()=>{e(n,!1)},i.options.isScrollingResetDelay),a=h=>()=>{const{horizontal:f,isRtl:m}=i.options;n=f?t.scrollLeft*(m&&-1||1):t.scrollTop,s(),e(n,h)},o=a(!0),l=a(!1);l(),t.addEventListener("scroll",o,Dk);const c=i.options.useScrollendEvent&&Lk;return c&&t.addEventListener("scrollend",l,Dk),()=>{t.removeEventListener("scroll",o),c&&t.removeEventListener("scrollend",l)}},ZM=(i,e,t)=>{if(e!=null&&e.borderBoxSize){const r=e.borderBoxSize[0];if(r)return Math.round(r[t.options.horizontal?"inlineSize":"blockSize"])}return i[t.options.horizontal?"offsetWidth":"offsetHeight"]},QM=(i,{adjustments:e=0,behavior:t},r)=>{var n,s;const a=i+e;(s=(n=r.scrollElement)==null?void 0:n.scrollTo)==null||s.call(n,{[r.options.horizontal?"left":"top"]:a,behavior:t})};class JM{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let t=null;const r=()=>t||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:t=new this.targetWindow.ResizeObserver(n=>{n.forEach(s=>{const a=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var n;(n=r())==null||n.disconnect(),t=null},observe:n=>{var s;return(s=r())==null?void 0:s.observe(n,{box:"border-box"})},unobserve:n=>{var s;return(s=r())==null?void 0:s.unobserve(n)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([r,n])=>{typeof n>"u"&&delete t[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:qM,rangeExtractor:YM,onChange:()=>{},measureElement:ZM,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...t}},this.notify=t=>{var r,n;(n=(r=this.options).onChange)==null||n.call(r,this,t)},this.maybeNotify=Zh(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var t;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((t=this.scrollElement)==null?void 0:t.window)??null,this.elementsCache.forEach(n=>{this.observer.observe(n)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(n,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<n?"forward":"backward":null,this.scrollOffset=n,this.isScrolling=s,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(t,r)=>{const n=new Map,s=new Map;for(let a=r-1;a>=0;a--){const o=t[a];if(n.has(o.lane))continue;const l=s.get(o.lane);if(l==null||o.end>l.end?s.set(o.lane,o):o.end<l.end&&n.set(o.lane,!0),n.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=Zh(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(t,r,n,s,a)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:r,scrollMargin:n,getItemKey:s,enabled:a}),{key:!1}),this.getMeasurements=Zh(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:r,scrollMargin:n,getItemKey:s,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let h=l;h<t;h++){const f=s(h),m=this.options.lanes===1?c[h-1]:this.getFurthestMeasurement(c,h),p=m?m.end+this.options.gap:r+n,x=o.get(f),g=typeof x=="number"?x:this.options.estimateSize(h),y=p+g,b=m?m.lane:h%this.options.lanes;c[h]={index:h,start:p,size:g,end:y,key:f,lane:b}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Zh(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(t,r,n,s)=>this.range=t.length>0&&r>0?ej({measurements:t,outerSize:r,scrollOffset:n,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Zh(()=>{let t=null,r=null;const n=this.calculateRange();return n&&(t=n.startIndex,r=n.endIndex),this.maybeNotify.updateDeps([this.isScrolling,t,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,t,r]},(t,r,n,s,a)=>s===null||a===null?[]:t({startIndex:s,endIndex:a,overscan:r,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const r=this.options.indexAttribute,n=t.getAttribute(r);return n?parseInt(n,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(t,r)=>{const n=this.indexFromElement(t),s=this.measurementsCache[n];if(!s)return;const a=s.key,o=this.elementsCache.get(a);o!==t&&(o&&this.observer.unobserve(o),this.observer.observe(t),this.elementsCache.set(a,t)),t.isConnected&&this.resizeItem(n,this.options.measureElement(t,r,this))},this.resizeItem=(t,r)=>{const n=this.measurementsCache[t];if(!n)return;const s=this.itemSizeCache.get(n.key)??n.size,a=r-s;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(n,a,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,r)),this.notify(!1))},this.measureElement=t=>{if(!t){this.elementsCache.forEach((r,n)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(n))});return}this._measureElement(t,void 0)},this.getVirtualItems=Zh(()=>[this.getVirtualIndexes(),this.getMeasurements()],(t,r)=>{const n=[];for(let s=0,a=t.length;s<a;s++){const o=t[s],l=r[o];n.push(l)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const r=this.getMeasurements();if(r.length!==0)return Rk(r[l5(0,r.length-1,n=>Rk(r[n]).start,t)])},this.getOffsetForAlignment=(t,r,n=0)=>{const s=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=t>=a+s?"end":"start"),r==="center"?t+=(n-s)/2:r==="end"&&(t-=s);const o=this.getTotalSize()+this.options.scrollMargin-s;return Math.max(Math.min(o,t),0)},this.getOffsetForIndex=(t,r="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const n=this.measurementsCache[t];if(!n)return;const s=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(n.end>=a+s-this.options.scrollPaddingEnd)r="end";else if(n.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,n.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(t,{align:r="start",behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,r),{adjustments:void 0,behavior:n})},this.scrollToIndex=(t,{align:r="auto",behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t=Math.max(0,Math.min(t,this.options.count-1));let s=0;const a=10,o=c=>{if(!this.targetWindow)return;const h=this.getOffsetForIndex(t,c);if(!h){console.warn("Failed to get offset for index:",t);return}const[f,m]=h;this._scrollToOffset(f,{adjustments:void 0,behavior:n}),this.targetWindow.requestAnimationFrame(()=>{const p=this.getScrollOffset(),x=this.getOffsetForIndex(t,m);if(!x){console.warn("Failed to get offset for index:",t);return}VM(x[0],p)||l(m)})},l=c=>{this.targetWindow&&(s++,s<a?this.targetWindow.requestAnimationFrame(()=>o(c)):console.warn(`Failed to scroll to index ${t} after ${a} attempts.`))};o(r)},this.scrollBy=(t,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+t,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var t;const r=this.getMeasurements();let n;if(r.length===0)n=this.options.paddingStart;else if(this.options.lanes===1)n=((t=r[r.length-1])==null?void 0:t.end)??0;else{const s=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&s.some(o=>o===null);){const o=r[a];s[o.lane]===null&&(s[o.lane]=o.end),a--}n=Math.max(...s.filter(o=>o!==null))}return Math.max(n-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(t,{adjustments:r,behavior:n})=>{this.options.scrollToFn(t,{behavior:n,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}const l5=(i,e,t,r)=>{for(;i<=e;){const n=(i+e)/2|0,s=t(n);if(s<r)i=n+1;else if(s>r)e=n-1;else return n}return i>0?i-1:0};function ej({measurements:i,outerSize:e,scrollOffset:t,lanes:r}){const n=i.length-1,s=l=>i[l].start;if(i.length<=r)return{startIndex:0,endIndex:n};let a=l5(0,n,s,t),o=a;if(r===1)for(;o<n&&i[o].end<t+e;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<n&&l.some(h=>h<t+e);){const h=i[o];l[h.lane]=h.end,o++}const c=Array(r).fill(t+e);for(;a>=0&&c.some(h=>h>=t);){const h=i[a];c[h.lane]=h.start,a--}a=Math.max(0,a-a%r),o=Math.min(n,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const Pk=typeof document<"u"?T.useLayoutEffect:T.useEffect;function tj(i){const e=T.useReducer(()=>({}),{})[1],t={...i,onChange:(n,s)=>{var a;s?qN.flushSync(e):e(),(a=i.onChange)==null||a.call(i,n,s)}},[r]=T.useState(()=>new JM(t));return r.setOptions(t),Pk(()=>r._didMount(),[]),Pk(()=>r._willUpdate()),r}function u5(i){return tj({observeElementRect:XM,observeElementOffset:KM,scrollToFn:QM,...i})}let c5=class extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return t===void 0&&(t=this.factory(e),this.set(e,t)),t}};var rj=Object.defineProperty,nj=(i,e,t)=>e in i?rj(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ij=(i,e,t)=>(nj(i,e+"",t),t),d5=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Qs=(i,e,t)=>(d5(i,e,"read from private field"),t?t.call(i):e.get(i)),X2=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Ok=(i,e,t,r)=>(d5(i,e,"write to private field"),e.set(i,t),t),ao,Bm,zm;let sj=class{constructor(e){X2(this,ao,{}),X2(this,Bm,new c5(()=>new Set)),X2(this,zm,new Set),ij(this,"disposables",Hl()),Ok(this,ao,e)}dispose(){this.disposables.dispose()}get state(){return Qs(this,ao)}subscribe(e,t){let r={selector:e,callback:t,current:e(Qs(this,ao))};return Qs(this,zm).add(r),this.disposables.add(()=>{Qs(this,zm).delete(r)})}on(e,t){return Qs(this,Bm).get(e).add(t),this.disposables.add(()=>{Qs(this,Bm).get(e).delete(t)})}send(e){let t=this.reduce(Qs(this,ao),e);if(t!==Qs(this,ao)){Ok(this,ao,t);for(let r of Qs(this,zm)){let n=r.selector(Qs(this,ao));h5(r.current,n)||(r.current=n,r.callback(n))}for(let r of Qs(this,Bm).get(e.type))r(Qs(this,ao),e)}}};ao=new WeakMap,Bm=new WeakMap,zm=new WeakMap;function h5(i,e){return Object.is(i,e)?!0:typeof i!="object"||i===null||typeof e!="object"||e===null?!1:Array.isArray(i)&&Array.isArray(e)?i.length!==e.length?!1:K2(i[Symbol.iterator](),e[Symbol.iterator]()):i instanceof Map&&e instanceof Map||i instanceof Set&&e instanceof Set?i.size!==e.size?!1:K2(i.entries(),e.entries()):Ik(i)&&Ik(e)?K2(Object.entries(i)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function K2(i,e){do{let t=i.next(),r=e.next();if(t.done&&r.done)return!0;if(t.done||r.done||!Object.is(t.value,r.value))return!1}while(!0)}function Ik(i){if(Object.prototype.toString.call(i)!=="[object Object]")return!1;let e=Object.getPrototypeOf(i);return e===null||Object.getPrototypeOf(e)===null}var aj=Object.defineProperty,oj=(i,e,t)=>e in i?aj(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Fk=(i,e,t)=>(oj(i,typeof e!="symbol"?e+"":e,t),t),lj=(i=>(i[i.Push=0]="Push",i[i.Pop=1]="Pop",i))(lj||{});let uj={0(i,e){let t=e.id,r=i.stack,n=i.stack.indexOf(t);if(n!==-1){let s=i.stack.slice();return s.splice(n,1),s.push(t),r=s,{...i,stack:r}}return{...i,stack:[...i.stack,t]}},1(i,e){let t=e.id,r=i.stack.indexOf(t);if(r===-1)return i;let n=i.stack.slice();return n.splice(r,1),{...i,stack:n}}},cj=class f5 extends sj{constructor(){super(...arguments),Fk(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),Fk(this,"selectors",{isTop:(e,t)=>e.stack[e.stack.length-1]===t,inStack:(e,t)=>e.stack.includes(t)})}static new(){return new f5({stack:[]})}reduce(e,t){return pa(t.type,uj,e,t)}};const p5=new c5(()=>cj.new());var Z2={exports:{}},Q2={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mk;function dj(){if(Mk)return Q2;Mk=1;var i=yw();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var t=typeof Object.is=="function"?Object.is:e,r=i.useSyncExternalStore,n=i.useRef,s=i.useEffect,a=i.useMemo,o=i.useDebugValue;return Q2.useSyncExternalStoreWithSelector=function(l,c,h,f,m){var p=n(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=a(function(){function y(C){if(!b){if(b=!0,_=C,C=f(C),m!==void 0&&x.hasValue){var R=x.value;if(m(R,C))return S=R}return S=C}if(R=S,t(_,C))return R;var N=f(C);return m!==void 0&&m(R,N)?(_=C,R):(_=C,S=N)}var b=!1,_,S,k=h===void 0?null:h;return[function(){return y(c())},k===null?void 0:function(){return y(k())}]},[c,h,f,m]);var g=r(l,p[0],p[1]);return s(function(){x.hasValue=!0,x.value=g},[g]),o(g),g},Q2}var jk;function hj(){return jk||(jk=1,Z2.exports=dj()),Z2.exports}var fj=hj();function m5(i,e,t=h5){return fj.useSyncExternalStoreWithSelector(gr(r=>i.subscribe(pj,r)),gr(()=>i.state),gr(()=>i.state),gr(e),t)}function pj(i){return i}function o0(i,e){let t=T.useId(),r=p5.get(e),[n,s]=m5(r,T.useCallback(a=>[r.selectors.isTop(a,t),r.selectors.inStack(a,t)],[r,t]));return Pi(()=>{if(i)return r.actions.push(t),()=>r.actions.pop(t)},[r,i,t]),i?s?n:!0:!1}let A_=new Map,cg=new Map;function Bk(i){var e;let t=(e=cg.get(i))!=null?e:0;return cg.set(i,t+1),t!==0?()=>zk(i):(A_.set(i,{"aria-hidden":i.getAttribute("aria-hidden"),inert:i.inert}),i.setAttribute("aria-hidden","true"),i.inert=!0,()=>zk(i))}function zk(i){var e;let t=(e=cg.get(i))!=null?e:1;if(t===1?cg.delete(i):cg.set(i,t-1),t!==1)return;let r=A_.get(i);r&&(r["aria-hidden"]===null?i.removeAttribute("aria-hidden"):i.setAttribute("aria-hidden",r["aria-hidden"]),i.inert=r.inert,A_.delete(i))}function mj(i,{allowed:e,disallowed:t}={}){let r=o0(i,"inert-others");Pi(()=>{var n,s;if(!r)return;let a=Hl();for(let l of(n=t==null?void 0:t())!=null?n:[])l&&a.add(Bk(l));let o=(s=e==null?void 0:e())!=null?s:[];for(let l of o){if(!l)continue;let c=Bp(l);if(!c)continue;let h=l.parentElement;for(;h&&h!==c.body;){for(let f of h.children)o.some(m=>f.contains(m))||a.add(Bk(f));h=h.parentElement}}return a.dispose},[r,e,t])}function gj(i,e,t){let r=mh(n=>{let s=n.getBoundingClientRect();s.x===0&&s.y===0&&s.width===0&&s.height===0&&t()});T.useEffect(()=>{if(!i)return;let n=e===null?null:Fl(e)?e:e.current;if(!n)return;let s=Hl();if(typeof ResizeObserver<"u"){let a=new ResizeObserver(()=>r.current(n));a.observe(n),s.add(()=>a.disconnect())}if(typeof IntersectionObserver<"u"){let a=new IntersectionObserver(()=>r.current(n));a.observe(n),s.add(()=>a.disconnect())}return()=>s.dispose()},[e,r,i])}let Lb=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(i=>`${i}:not([tabindex='-1'])`).join(","),vj=["[data-autofocus]"].map(i=>`${i}:not([tabindex='-1'])`).join(",");var Tl=(i=>(i[i.First=1]="First",i[i.Previous=2]="Previous",i[i.Next=4]="Next",i[i.Last=8]="Last",i[i.WrapAround=16]="WrapAround",i[i.NoScroll=32]="NoScroll",i[i.AutoFocus=64]="AutoFocus",i))(Tl||{}),C_=(i=>(i[i.Error=0]="Error",i[i.Overflow=1]="Overflow",i[i.Success=2]="Success",i[i.Underflow=3]="Underflow",i))(C_||{}),yj=(i=>(i[i.Previous=-1]="Previous",i[i.Next=1]="Next",i))(yj||{});function bj(i=document.body){return i==null?[]:Array.from(i.querySelectorAll(Lb)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}function wj(i=document.body){return i==null?[]:Array.from(i.querySelectorAll(vj)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var g5=(i=>(i[i.Strict=0]="Strict",i[i.Loose=1]="Loose",i))(g5||{});function xj(i,e=0){var t;return i===((t=Bp(i))==null?void 0:t.body)?!1:pa(e,{0(){return i.matches(Lb)},1(){let r=i;for(;r!==null;){if(r.matches(Lb))return!0;r=r.parentElement}return!1}})}var _j=(i=>(i[i.Keyboard=0]="Keyboard",i[i.Mouse=1]="Mouse",i))(_j||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",i=>{i.metaKey||i.altKey||i.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",i=>{i.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:i.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Nl(i){i==null||i.focus({preventScroll:!0})}let Ej=["textarea","input"].join(",");function Sj(i){var e,t;return(t=(e=i==null?void 0:i.matches)==null?void 0:e.call(i,Ej))!=null?t:!1}function Aj(i,e=t=>t){return i.slice().sort((t,r)=>{let n=e(t),s=e(r);if(n===null||s===null)return 0;let a=n.compareDocumentPosition(s);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function dg(i,e,{sorted:t=!0,relativeTo:r=null,skipElements:n=[]}={}){let s=Array.isArray(i)?i.length>0?i[0].ownerDocument:document:i.ownerDocument,a=Array.isArray(i)?t?Aj(i):i:e&64?wj(i):bj(i);n.length>0&&a.length>1&&(a=a.filter(p=>!n.some(x=>x!=null&&"current"in x?(x==null?void 0:x.current)===p:x===p))),r=r??s.activeElement;let o=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(r))-1;if(e&4)return Math.max(0,a.indexOf(r))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=e&32?{preventScroll:!0}:{},h=0,f=a.length,m;do{if(h>=f||h+f<=0)return 0;let p=l+h;if(e&16)p=(p+f)%f;else{if(p<0)return 3;if(p>=f)return 1}m=a[p],m==null||m.focus(c),h+=o}while(m!==s.activeElement);return e&6&&Sj(m)&&m.select(),2}function v5(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Cj(){return/Android/gi.test(window.navigator.userAgent)}function $k(){return v5()||Cj()}function Ly(i,e,t,r){let n=mh(t);T.useEffect(()=>{if(!i)return;function s(a){n.current(a)}return document.addEventListener(e,s,r),()=>document.removeEventListener(e,s,r)},[i,e,r])}function y5(i,e,t,r){let n=mh(t);T.useEffect(()=>{if(!i)return;function s(a){n.current(a)}return window.addEventListener(e,s,r),()=>window.removeEventListener(e,s,r)},[i,e,r])}const Uk=30;function kj(i,e,t){let r=mh(t),n=T.useCallback(function(o,l){if(o.defaultPrevented)return;let c=l(o);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let h=function f(m){return typeof m=="function"?f(m()):Array.isArray(m)||m instanceof Set?m:[m]}(e);for(let f of h)if(f!==null&&(f.contains(c)||o.composed&&o.composedPath().includes(f)))return;return!xj(c,g5.Loose)&&c.tabIndex!==-1&&o.preventDefault(),r.current(o,c)},[r,e]),s=T.useRef(null);Ly(i,"pointerdown",o=>{var l,c;$k()||(s.current=((c=(l=o.composedPath)==null?void 0:l.call(o))==null?void 0:c[0])||o.target)},!0),Ly(i,"pointerup",o=>{if($k()||!s.current)return;let l=s.current;return s.current=null,n(o,()=>l)},!0);let a=T.useRef({x:0,y:0});Ly(i,"touchstart",o=>{a.current.x=o.touches[0].clientX,a.current.y=o.touches[0].clientY},!0),Ly(i,"touchend",o=>{let l={x:o.changedTouches[0].clientX,y:o.changedTouches[0].clientY};if(!(Math.abs(l.x-a.current.x)>=Uk||Math.abs(l.y-a.current.y)>=Uk))return n(o,()=>ko(o.target)?o.target:null)},!0),y5(i,"blur",o=>n(o,()=>OM(window.document.activeElement)?window.document.activeElement:null),!0)}function kw(...i){return T.useMemo(()=>Bp(...i),[...i])}function b5(i,e,t,r){let n=mh(t);T.useEffect(()=>{i=i??window;function s(a){n.current(a)}return i.addEventListener(e,s,r),()=>i.removeEventListener(e,s,r)},[i,e,r])}function Tj(i,e){return T.useMemo(()=>{var t;if(i.type)return i.type;let r=(t=i.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button"||(e==null?void 0:e.tagName)==="BUTTON"&&!e.hasAttribute("type"))return"button"},[i.type,i.as,e])}function Rj(i){return T.useSyncExternalStore(i.subscribe,i.getSnapshot,i.getSnapshot)}function Nj(i,e){let t=i(),r=new Set;return{getSnapshot(){return t},subscribe(n){return r.add(n),()=>r.delete(n)},dispatch(n,...s){let a=e[n].call(t,...s);a&&(t=a,r.forEach(o=>o()))}}}function Dj(){let i;return{before({doc:e}){var t;let r=e.documentElement,n=(t=e.defaultView)!=null?t:window;i=Math.max(0,n.innerWidth-r.clientWidth)},after({doc:e,d:t}){let r=e.documentElement,n=Math.max(0,r.clientWidth-r.offsetWidth),s=Math.max(0,i-n);t.style(r,"paddingRight",`${s}px`)}}}function Lj(){return v5()?{before({doc:i,d:e,meta:t}){function r(n){return t.containers.flatMap(s=>s()).some(s=>s.contains(n))}e.microTask(()=>{var n;if(window.getComputedStyle(i.documentElement).scrollBehavior!=="auto"){let o=Hl();o.style(i.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>o.dispose()))}let s=(n=window.scrollY)!=null?n:window.pageYOffset,a=null;e.addEventListener(i,"click",o=>{if(ko(o.target))try{let l=o.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),h=i.querySelector(c);ko(h)&&!r(h)&&(a=h)}catch{}},!0),e.addEventListener(i,"touchstart",o=>{if(ko(o.target)&&PM(o.target))if(r(o.target)){let l=o.target;for(;l.parentElement&&r(l.parentElement);)l=l.parentElement;e.style(l,"overscrollBehavior","contain")}else e.style(o.target,"touchAction","none")}),e.addEventListener(i,"touchmove",o=>{if(ko(o.target)){if(IM(o.target))return;if(r(o.target)){let l=o.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&o.preventDefault()}else o.preventDefault()}},{passive:!1}),e.add(()=>{var o;let l=(o=window.scrollY)!=null?o:window.pageYOffset;s!==l&&window.scrollTo(0,s),a&&a.isConnected&&(a.scrollIntoView({block:"nearest"}),a=null)})})}}:{}}function Pj(){return{before({doc:i,d:e}){e.style(i.documentElement,"overflow","hidden")}}}function Oj(i){let e={};for(let t of i)Object.assign(e,t(e));return e}let Jc=Nj(()=>new Map,{PUSH(i,e){var t;let r=(t=this.get(i))!=null?t:{doc:i,count:0,d:Hl(),meta:new Set};return r.count++,r.meta.add(e),this.set(i,r),this},POP(i,e){let t=this.get(i);return t&&(t.count--,t.meta.delete(e)),this},SCROLL_PREVENT({doc:i,d:e,meta:t}){let r={doc:i,d:e,meta:Oj(t)},n=[Lj(),Dj(),Pj()];n.forEach(({before:s})=>s==null?void 0:s(r)),n.forEach(({after:s})=>s==null?void 0:s(r))},SCROLL_ALLOW({d:i}){i.dispose()},TEARDOWN({doc:i}){this.delete(i)}});Jc.subscribe(()=>{let i=Jc.getSnapshot(),e=new Map;for(let[t]of i)e.set(t,t.documentElement.style.overflow);for(let t of i.values()){let r=e.get(t.doc)==="hidden",n=t.count!==0;(n&&!r||!n&&r)&&Jc.dispatch(t.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",t),t.count===0&&Jc.dispatch("TEARDOWN",t)}});function Ij(i,e,t=()=>({containers:[]})){let r=Rj(Jc),n=e?r.get(e):void 0,s=n?n.count>0:!1;return Pi(()=>{if(!(!e||!i))return Jc.dispatch("PUSH",e,t),()=>Jc.dispatch("POP",e,t)},[i,e]),s}function Fj(i,e,t=()=>[document.body]){let r=o0(i,"scroll-lock");Ij(r,e,n=>{var s;return{containers:[...(s=n.containers)!=null?s:[],t]}})}function Mj(i=0){let[e,t]=T.useState(i),r=T.useCallback(l=>t(l),[e]),n=T.useCallback(l=>t(c=>c|l),[e]),s=T.useCallback(l=>(e&l)===l,[e]),a=T.useCallback(l=>t(c=>c&~l),[t]),o=T.useCallback(l=>t(c=>c^l),[t]);return{flags:e,setFlag:r,addFlag:n,hasFlag:s,removeFlag:a,toggleFlag:o}}var jj={},Hk,Wk;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((Hk=process==null?void 0:jj)==null?void 0:Hk.NODE_ENV)==="test"&&typeof((Wk=Element==null?void 0:Element.prototype)==null?void 0:Wk.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var Bj=(i=>(i[i.None=0]="None",i[i.Closed=1]="Closed",i[i.Enter=2]="Enter",i[i.Leave=4]="Leave",i))(Bj||{});function w5(i){let e={};for(let t in i)i[t]===!0&&(e[`data-${t}`]="");return e}function x5(i,e,t,r){let[n,s]=T.useState(t),{hasFlag:a,addFlag:o,removeFlag:l}=Mj(i&&n?3:0),c=T.useRef(!1),h=T.useRef(!1),f=Cw();return Pi(()=>{var m;if(i){if(t&&s(!0),!e){t&&o(3);return}return(m=r==null?void 0:r.start)==null||m.call(r,t),zj(e,{inFlight:c,prepare(){h.current?h.current=!1:h.current=c.current,c.current=!0,!h.current&&(t?(o(3),l(4)):(o(4),l(2)))},run(){h.current?t?(l(3),o(4)):(l(4),o(3)):t?l(1):o(1)},done(){var p;h.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(c.current=!1,l(7),t||s(!1),(p=r==null?void 0:r.end)==null||p.call(r,t))}})}},[i,t,e,f]),i?[n,{closed:a(1),enter:a(2),leave:a(4),transition:a(2)||a(4)}]:[t,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function zj(i,{prepare:e,run:t,done:r,inFlight:n}){let s=Hl();return Uj(i,{prepare:e,inFlight:n}),s.nextFrame(()=>{t(),s.requestAnimationFrame(()=>{s.add($j(i,r))})}),s.dispose}function $j(i,e){var t,r;let n=Hl();if(!i)return n.dispose;let s=!1;n.add(()=>{s=!0});let a=(r=(t=i.getAnimations)==null?void 0:t.call(i).filter(o=>o instanceof CSSTransition))!=null?r:[];return a.length===0?(e(),n.dispose):(Promise.allSettled(a.map(o=>o.finished)).then(()=>{s||e()}),n.dispose)}function Uj(i,{inFlight:e,prepare:t}){if(e!=null&&e.current){t();return}let r=i.style.transition;i.style.transition="none",t(),i.offsetHeight,i.style.transition=r}function vS(i,e){let t=T.useRef([]),r=gr(i);T.useEffect(()=>{let n=[...t.current];for(let[s,a]of e.entries())if(t.current[s]!==a){let o=r(e,n);return t.current=e,o}},[r,...e])}let Tw=T.createContext(null);Tw.displayName="OpenClosedContext";var Yi=(i=>(i[i.Open=1]="Open",i[i.Closed=2]="Closed",i[i.Closing=4]="Closing",i[i.Opening=8]="Opening",i))(Yi||{});function l0(){return T.useContext(Tw)}function _5({value:i,children:e}){return st.createElement(Tw.Provider,{value:i},e)}function E5({children:i}){return st.createElement(Tw.Provider,{value:null},i)}function Hj(i){function e(){document.readyState!=="loading"&&(i(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let fu=[];Hj(()=>{function i(e){if(!ko(e.target)||e.target===document.body||fu[0]===e.target)return;let t=e.target;t=t.closest(Lb),fu.unshift(t??e.target),fu=fu.filter(r=>r!=null&&r.isConnected),fu.splice(10)}window.addEventListener("click",i,{capture:!0}),window.addEventListener("mousedown",i,{capture:!0}),window.addEventListener("focus",i,{capture:!0}),document.body.addEventListener("click",i,{capture:!0}),document.body.addEventListener("mousedown",i,{capture:!0}),document.body.addEventListener("focus",i,{capture:!0})});function S5(i){let e=gr(i),t=T.useRef(!1);T.useEffect(()=>(t.current=!1,()=>{t.current=!0,Aw(()=>{t.current&&e()})}),[e])}function Wj(){let i=typeof document>"u";return"useSyncExternalStore"in rk?(e=>e.useSyncExternalStore)(rk)(()=>()=>{},()=>!1,()=>!i):!1}function u0(){let i=Wj(),[e,t]=T.useState(oh.isHandoffComplete);return e&&oh.isHandoffComplete===!1&&t(!1),T.useEffect(()=>{e!==!0&&t(!0)},[e]),T.useEffect(()=>oh.handoff(),[]),i?!1:e}let A5=T.createContext(!1);function Vj(){return T.useContext(A5)}function Vk(i){return st.createElement(A5.Provider,{value:i.force},i.children)}function Gj(i){let e=Vj(),t=T.useContext(k5),[r,n]=T.useState(()=>{var s;if(!e&&t!==null)return(s=t.current)!=null?s:null;if(oh.isServer)return null;let a=i==null?void 0:i.getElementById("headlessui-portal-root");if(a)return a;if(i===null)return null;let o=i.createElement("div");return o.setAttribute("id","headlessui-portal-root"),i.body.appendChild(o)});return T.useEffect(()=>{r!==null&&(i!=null&&i.body.contains(r)||i==null||i.body.appendChild(r))},[r,i]),T.useEffect(()=>{e||t!==null&&n(t.current)},[t,n,e]),r}let C5=T.Fragment,qj=gi(function(i,e){let{ownerDocument:t=null,...r}=i,n=T.useRef(null),s=Us(s5(p=>{n.current=p}),e),a=kw(n),o=t??a,l=Gj(o),[c]=T.useState(()=>{var p;return oh.isServer?null:(p=o==null?void 0:o.createElement("div"))!=null?p:null}),h=T.useContext(k_),f=u0();Pi(()=>{!l||!c||l.contains(c)||(c.setAttribute("data-headlessui-portal",""),l.appendChild(c))},[l,c]),Pi(()=>{if(c&&h)return h.register(c)},[h,c]),S5(()=>{var p;!l||!c||(r5(c)&&l.contains(c)&&l.removeChild(c),l.childNodes.length<=0&&((p=l.parentElement)==null||p.removeChild(l)))});let m=Zi();return f?!l||!c?null:qN.createPortal(m({ourProps:{ref:s},theirProps:r,slot:{},defaultTag:C5,name:"Portal"}),c):null});function Yj(i,e){let t=Us(e),{enabled:r=!0,ownerDocument:n,...s}=i,a=Zi();return r?st.createElement(qj,{...s,ownerDocument:n,ref:t}):a({ourProps:{ref:t},theirProps:s,slot:{},defaultTag:C5,name:"Portal"})}let Xj=T.Fragment,k5=T.createContext(null);function Kj(i,e){let{target:t,...r}=i,n={ref:Us(e)},s=Zi();return st.createElement(k5.Provider,{value:t},s({ourProps:n,theirProps:r,defaultTag:Xj,name:"Popover.Group"}))}let k_=T.createContext(null);function Zj(){let i=T.useContext(k_),e=T.useRef([]),t=gr(s=>(e.current.push(s),i&&i.register(s),()=>r(s))),r=gr(s=>{let a=e.current.indexOf(s);a!==-1&&e.current.splice(a,1),i&&i.unregister(s)}),n=T.useMemo(()=>({register:t,unregister:r,portals:e}),[t,r,e]);return[e,T.useMemo(()=>function({children:s}){return st.createElement(k_.Provider,{value:n},s)},[n])]}let Qj=gi(Yj),T5=gi(Kj),Jj=Object.assign(Qj,{Group:T5});function e4(i,e=typeof document<"u"?document.defaultView:null,t){let r=o0(i,"escape");b5(e,"keydown",n=>{r&&(n.defaultPrevented||n.key===Gc.Escape&&t(n))})}function t4(){var i;let[e]=T.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[t,r]=T.useState((i=e==null?void 0:e.matches)!=null?i:!1);return Pi(()=>{if(!e)return;function n(s){r(s.matches)}return e.addEventListener("change",n),()=>e.removeEventListener("change",n)},[e]),t}function r4({defaultContainers:i=[],portals:e,mainTreeNode:t}={}){let r=kw(t),n=gr(()=>{var s,a;let o=[];for(let l of i)l!==null&&(ec(l)?o.push(l):"current"in l&&ec(l.current)&&o.push(l.current));if(e!=null&&e.current)for(let l of e.current)o.push(l);for(let l of(s=r==null?void 0:r.querySelectorAll("html > *, body > *"))!=null?s:[])l!==document.body&&l!==document.head&&ec(l)&&l.id!=="headlessui-portal-root"&&(t&&(l.contains(t)||l.contains((a=t==null?void 0:t.getRootNode())==null?void 0:a.host))||o.some(c=>l.contains(c))||o.push(l));return o});return{resolveContainers:n,contains:gr(s=>n().some(a=>a.contains(s)))}}let R5=T.createContext(null);function Gk({children:i,node:e}){let[t,r]=T.useState(null),n=N5(e??t);return st.createElement(R5.Provider,{value:n},i,n===null&&st.createElement(S_,{features:Db.Hidden,ref:s=>{var a,o;if(s){for(let l of(o=(a=Bp(s))==null?void 0:a.querySelectorAll("html > *, body > *"))!=null?o:[])if(l!==document.body&&l!==document.head&&ec(l)&&l!=null&&l.contains(s)){r(l);break}}}}))}function N5(i=null){var e;return(e=T.useContext(R5))!=null?e:i}function yS(){let i=T.useRef(!1);return Pi(()=>(i.current=!0,()=>{i.current=!1}),[]),i}var $m=(i=>(i[i.Forwards=0]="Forwards",i[i.Backwards=1]="Backwards",i))($m||{});function n4(){let i=T.useRef(0);return y5(!0,"keydown",e=>{e.key==="Tab"&&(i.current=e.shiftKey?1:0)},!0),i}function D5(i){if(!i)return new Set;if(typeof i=="function")return new Set(i());let e=new Set;for(let t of i.current)ec(t.current)&&e.add(t.current);return e}let i4="div";var qc=(i=>(i[i.None=0]="None",i[i.InitialFocus=1]="InitialFocus",i[i.TabLock=2]="TabLock",i[i.FocusLock=4]="FocusLock",i[i.RestoreFocus=8]="RestoreFocus",i[i.AutoFocus=16]="AutoFocus",i))(qc||{});function s4(i,e){let t=T.useRef(null),r=Us(t,e),{initialFocus:n,initialFocusFallback:s,containers:a,features:o=15,...l}=i;u0()||(o=0);let c=kw(t);u4(o,{ownerDocument:c});let h=c4(o,{ownerDocument:c,container:t,initialFocus:n,initialFocusFallback:s});d4(o,{ownerDocument:c,container:t,containers:a,previousActiveElement:h});let f=n4(),m=gr(_=>{if(!Fl(t.current))return;let S=t.current;(k=>k())(()=>{pa(f.current,{[$m.Forwards]:()=>{dg(S,Tl.First,{skipElements:[_.relatedTarget,s]})},[$m.Backwards]:()=>{dg(S,Tl.Last,{skipElements:[_.relatedTarget,s]})}})})}),p=o0(!!(o&2),"focus-trap#tab-lock"),x=Cw(),g=T.useRef(!1),y={ref:r,onKeyDown(_){_.key=="Tab"&&(g.current=!0,x.requestAnimationFrame(()=>{g.current=!1}))},onBlur(_){if(!(o&4))return;let S=D5(a);Fl(t.current)&&S.add(t.current);let k=_.relatedTarget;ko(k)&&k.dataset.headlessuiFocusGuard!=="true"&&(L5(S,k)||(g.current?dg(t.current,pa(f.current,{[$m.Forwards]:()=>Tl.Next,[$m.Backwards]:()=>Tl.Previous})|Tl.WrapAround,{relativeTo:_.target}):ko(_.target)&&Nl(_.target)))}},b=Zi();return st.createElement(st.Fragment,null,p&&st.createElement(S_,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:Db.Focusable}),b({ourProps:y,theirProps:l,defaultTag:i4,name:"FocusTrap"}),p&&st.createElement(S_,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:Db.Focusable}))}let a4=gi(s4),o4=Object.assign(a4,{features:qc});function l4(i=!0){let e=T.useRef(fu.slice());return vS(([t],[r])=>{r===!0&&t===!1&&Aw(()=>{e.current.splice(0)}),r===!1&&t===!0&&(e.current=fu.slice())},[i,fu,e]),gr(()=>{var t;return(t=e.current.find(r=>r!=null&&r.isConnected))!=null?t:null})}function u4(i,{ownerDocument:e}){let t=!!(i&8),r=l4(t);vS(()=>{t||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&Nl(r())},[t]),S5(()=>{t&&Nl(r())})}function c4(i,{ownerDocument:e,container:t,initialFocus:r,initialFocusFallback:n}){let s=T.useRef(null),a=o0(!!(i&1),"focus-trap#initial-focus"),o=yS();return vS(()=>{if(i===0)return;if(!a){n!=null&&n.current&&Nl(n.current);return}let l=t.current;l&&Aw(()=>{if(!o.current)return;let c=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===c){s.current=c;return}}else if(l.contains(c)){s.current=c;return}if(r!=null&&r.current)Nl(r.current);else{if(i&16){if(dg(l,Tl.First|Tl.AutoFocus)!==C_.Error)return}else if(dg(l,Tl.First)!==C_.Error)return;if(n!=null&&n.current&&(Nl(n.current),(e==null?void 0:e.activeElement)===n.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}s.current=e==null?void 0:e.activeElement})},[n,a,i]),s}function d4(i,{ownerDocument:e,container:t,containers:r,previousActiveElement:n}){let s=yS(),a=!!(i&4);b5(e==null?void 0:e.defaultView,"focus",o=>{if(!a||!s.current)return;let l=D5(r);Fl(t.current)&&l.add(t.current);let c=n.current;if(!c)return;let h=o.target;Fl(h)?L5(l,h)?(n.current=h,Nl(h)):(o.preventDefault(),o.stopPropagation(),Nl(c)):Nl(n.current)},!0)}function L5(i,e){for(let t of i)if(t.contains(e))return!0;return!1}function P5(i){var e;return!!(i.enter||i.enterFrom||i.enterTo||i.leave||i.leaveFrom||i.leaveTo)||((e=i.as)!=null?e:I5)!==T.Fragment||st.Children.count(i.children)===1}let Rw=T.createContext(null);Rw.displayName="TransitionContext";var h4=(i=>(i.Visible="visible",i.Hidden="hidden",i))(h4||{});function f4(){let i=T.useContext(Rw);if(i===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return i}function p4(){let i=T.useContext(Nw);if(i===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return i}let Nw=T.createContext(null);Nw.displayName="NestingContext";function Dw(i){return"children"in i?Dw(i.children):i.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function O5(i,e){let t=mh(i),r=T.useRef([]),n=yS(),s=Cw(),a=gr((p,x=Zu.Hidden)=>{let g=r.current.findIndex(({el:y})=>y===p);g!==-1&&(pa(x,{[Zu.Unmount](){r.current.splice(g,1)},[Zu.Hidden](){r.current[g].state="hidden"}}),s.microTask(()=>{var y;!Dw(r)&&n.current&&((y=t.current)==null||y.call(t))}))}),o=gr(p=>{let x=r.current.find(({el:g})=>g===p);return x?x.state!=="visible"&&(x.state="visible"):r.current.push({el:p,state:"visible"}),()=>a(p,Zu.Unmount)}),l=T.useRef([]),c=T.useRef(Promise.resolve()),h=T.useRef({enter:[],leave:[]}),f=gr((p,x,g)=>{l.current.splice(0),e&&(e.chains.current[x]=e.chains.current[x].filter(([y])=>y!==p)),e==null||e.chains.current[x].push([p,new Promise(y=>{l.current.push(y)})]),e==null||e.chains.current[x].push([p,new Promise(y=>{Promise.all(h.current[x].map(([b,_])=>_)).then(()=>y())})]),x==="enter"?c.current=c.current.then(()=>e==null?void 0:e.wait.current).then(()=>g(x)):g(x)}),m=gr((p,x,g)=>{Promise.all(h.current[x].splice(0).map(([y,b])=>b)).then(()=>{var y;(y=l.current.shift())==null||y()}).then(()=>g(x))});return T.useMemo(()=>({children:r,register:o,unregister:a,onStart:f,onStop:m,wait:c,chains:h}),[o,a,r,f,m,h,c])}let I5=T.Fragment,F5=Lp.RenderStrategy;function m4(i,e){var t,r;let{transition:n=!0,beforeEnter:s,afterEnter:a,beforeLeave:o,afterLeave:l,enter:c,enterFrom:h,enterTo:f,entered:m,leave:p,leaveFrom:x,leaveTo:g,...y}=i,[b,_]=T.useState(null),S=T.useRef(null),k=P5(i),C=Us(...k?[S,e,_]:e===null?[]:[e]),R=(t=y.unmount)==null||t?Zu.Unmount:Zu.Hidden,{show:N,appear:O,initial:I}=f4(),[F,G]=T.useState(N?"visible":"hidden"),B=p4(),{register:Y,unregister:j}=B;Pi(()=>Y(S),[Y,S]),Pi(()=>{if(R===Zu.Hidden&&S.current){if(N&&F!=="visible"){G("visible");return}return pa(F,{hidden:()=>j(S),visible:()=>Y(S)})}},[F,S,Y,j,N,R]);let ae=u0();Pi(()=>{if(k&&ae&&F==="visible"&&S.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[S,F,ae,k]);let he=I&&!O,ee=O&&N&&I,Z=T.useRef(!1),ie=O5(()=>{Z.current||(G("hidden"),j(S))},B),ge=gr(Ve=>{Z.current=!0;let $e=Ve?"enter":"leave";ie.onStart(S,$e,qe=>{qe==="enter"?s==null||s():qe==="leave"&&(o==null||o())})}),V=gr(Ve=>{let $e=Ve?"enter":"leave";Z.current=!1,ie.onStop(S,$e,qe=>{qe==="enter"?a==null||a():qe==="leave"&&(l==null||l())}),$e==="leave"&&!Dw(ie)&&(G("hidden"),j(S))});T.useEffect(()=>{k&&n||(ge(N),V(N))},[N,k,n]);let K=!(!n||!k||!ae||he),[,be]=x5(K,b,N,{start:ge,end:V}),Ae=Uc({ref:C,className:((r=E_(y.className,ee&&c,ee&&h,be.enter&&c,be.enter&&be.closed&&h,be.enter&&!be.closed&&f,be.leave&&p,be.leave&&!be.closed&&x,be.leave&&be.closed&&g,!be.transition&&N&&m))==null?void 0:r.trim())||void 0,...w5(be)}),ce=0;F==="visible"&&(ce|=Yi.Open),F==="hidden"&&(ce|=Yi.Closed),N&&F==="hidden"&&(ce|=Yi.Opening),!N&&F==="visible"&&(ce|=Yi.Closing);let Pe=Zi();return st.createElement(Nw.Provider,{value:ie},st.createElement(_5,{value:ce},Pe({ourProps:Ae,theirProps:y,defaultTag:I5,features:F5,visible:F==="visible",name:"Transition.Child"})))}function g4(i,e){let{show:t,appear:r=!1,unmount:n=!0,...s}=i,a=T.useRef(null),o=P5(i),l=Us(...o?[a,e]:e===null?[]:[e]);u0();let c=l0();if(t===void 0&&c!==null&&(t=(c&Yi.Open)===Yi.Open),t===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,f]=T.useState(t?"visible":"hidden"),m=O5(()=>{t||f("hidden")}),[p,x]=T.useState(!0),g=T.useRef([t]);Pi(()=>{p!==!1&&g.current[g.current.length-1]!==t&&(g.current.push(t),x(!1))},[g,t]);let y=T.useMemo(()=>({show:t,appear:r,initial:p}),[t,r,p]);Pi(()=>{t?f("visible"):!Dw(m)&&a.current!==null&&f("hidden")},[t,m]);let b={unmount:n},_=gr(()=>{var C;p&&x(!1),(C=i.beforeEnter)==null||C.call(i)}),S=gr(()=>{var C;p&&x(!1),(C=i.beforeLeave)==null||C.call(i)}),k=Zi();return st.createElement(Nw.Provider,{value:m},st.createElement(Rw.Provider,{value:y},k({ourProps:{...b,as:T.Fragment,children:st.createElement(M5,{ref:l,...b,...s,beforeEnter:_,beforeLeave:S})},theirProps:{},defaultTag:T.Fragment,features:F5,visible:h==="visible",name:"Transition"})))}function v4(i,e){let t=T.useContext(Rw)!==null,r=l0()!==null;return st.createElement(st.Fragment,null,!t&&r?st.createElement(T_,{ref:e,...i}):st.createElement(M5,{ref:e,...i}))}let T_=gi(g4),M5=gi(m4),bS=gi(v4),y4=Object.assign(T_,{Child:bS,Root:T_});var b4=(i=>(i[i.Open=0]="Open",i[i.Closed=1]="Closed",i))(b4||{}),w4=(i=>(i[i.SetTitleId=0]="SetTitleId",i))(w4||{});let x4={0(i,e){return i.titleId===e.id?i:{...i,titleId:e.id}}},wS=T.createContext(null);wS.displayName="DialogContext";function Lw(i){let e=T.useContext(wS);if(e===null){let t=new Error(`<${i} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Lw),t}return e}function _4(i,e){return pa(e.type,x4,i,e)}let qk=gi(function(i,e){let t=T.useId(),{id:r=`headlessui-dialog-${t}`,open:n,onClose:s,initialFocus:a,role:o="dialog",autoFocus:l=!0,__demoMode:c=!1,unmount:h=!1,...f}=i,m=T.useRef(!1);o=function(){return o==="dialog"||o==="alertdialog"?o:(m.current||(m.current=!0,console.warn(`Invalid role [${o}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let p=l0();n===void 0&&p!==null&&(n=(p&Yi.Open)===Yi.Open);let x=T.useRef(null),g=Us(x,e),y=kw(x),b=n?0:1,[_,S]=T.useReducer(_4,{titleId:null,descriptionId:null,panelRef:T.createRef()}),k=gr(()=>s(!1)),C=gr(be=>S({type:0,id:be})),R=u0()?b===0:!1,[N,O]=Zj(),I={get current(){var be;return(be=_.panelRef.current)!=null?be:x.current}},F=N5(),{resolveContainers:G}=r4({mainTreeNode:F,portals:N,defaultContainers:[I]}),B=p!==null?(p&Yi.Closing)===Yi.Closing:!1;mj(c||B?!1:R,{allowed:gr(()=>{var be,Ae;return[(Ae=(be=x.current)==null?void 0:be.closest("[data-headlessui-portal]"))!=null?Ae:null]}),disallowed:gr(()=>{var be;return[(be=F==null?void 0:F.closest("body > *:not(#headlessui-portal-root)"))!=null?be:null]})});let Y=p5.get(null);Pi(()=>{if(R)return Y.actions.push(r),()=>Y.actions.pop(r)},[Y,r,R]);let j=m5(Y,T.useCallback(be=>Y.selectors.isTop(be,r),[Y,r]));kj(j,G,be=>{be.preventDefault(),k()}),e4(j,y==null?void 0:y.defaultView,be=>{be.preventDefault(),be.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),k()}),Fj(c||B?!1:R,y,G),gj(R,x,k);let[ae,he]=BM(),ee=T.useMemo(()=>[{dialogState:b,close:k,setTitleId:C,unmount:h},_],[b,_,k,C,h]),Z=T.useMemo(()=>({open:b===0}),[b]),ie={ref:g,id:r,role:o,tabIndex:-1,"aria-modal":c?void 0:b===0?!0:void 0,"aria-labelledby":_.titleId,"aria-describedby":ae,unmount:h},ge=!t4(),V=qc.None;R&&!c&&(V|=qc.RestoreFocus,V|=qc.TabLock,l&&(V|=qc.AutoFocus),ge&&(V|=qc.InitialFocus));let K=Zi();return st.createElement(E5,null,st.createElement(Vk,{force:!0},st.createElement(Jj,null,st.createElement(wS.Provider,{value:ee},st.createElement(T5,{target:x},st.createElement(Vk,{force:!1},st.createElement(he,{slot:Z},st.createElement(O,null,st.createElement(o4,{initialFocus:a,initialFocusFallback:x,containers:G,features:V},st.createElement(o5,{value:k},K({ourProps:ie,theirProps:f,slot:Z,defaultTag:E4,features:S4,visible:b===0,name:"Dialog"})))))))))))}),E4="div",S4=Lp.RenderStrategy|Lp.Static;function A4(i,e){let{transition:t=!1,open:r,...n}=i,s=l0(),a=i.hasOwnProperty("open")||s!==null,o=i.hasOwnProperty("onClose");if(!a&&!o)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!a)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!o)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!s&&typeof i.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${i.open}`);if(typeof i.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${i.onClose}`);return(r!==void 0||t)&&!n.static?st.createElement(Gk,null,st.createElement(y4,{show:r,transition:t,unmount:n.unmount},st.createElement(qk,{ref:e,...n}))):st.createElement(Gk,null,st.createElement(qk,{ref:e,open:r,...n}))}let C4="div";function k4(i,e){let t=T.useId(),{id:r=`headlessui-dialog-panel-${t}`,transition:n=!1,...s}=i,[{dialogState:a,unmount:o},l]=Lw("Dialog.Panel"),c=Us(e,l.panelRef),h=T.useMemo(()=>({open:a===0}),[a]),f=gr(y=>{y.stopPropagation()}),m={ref:c,id:r,onClick:f},p=n?bS:T.Fragment,x=n?{unmount:o}:{},g=Zi();return st.createElement(p,{...x},g({ourProps:m,theirProps:s,slot:h,defaultTag:C4,name:"Dialog.Panel"}))}let T4="div";function R4(i,e){let{transition:t=!1,...r}=i,[{dialogState:n,unmount:s}]=Lw("Dialog.Backdrop"),a=T.useMemo(()=>({open:n===0}),[n]),o={ref:e,"aria-hidden":!0},l=t?bS:T.Fragment,c=t?{unmount:s}:{},h=Zi();return st.createElement(l,{...c},h({ourProps:o,theirProps:r,slot:a,defaultTag:T4,name:"Dialog.Backdrop"}))}let N4="h2";function D4(i,e){let t=T.useId(),{id:r=`headlessui-dialog-title-${t}`,...n}=i,[{dialogState:s,setTitleId:a}]=Lw("Dialog.Title"),o=Us(e);T.useEffect(()=>(a(r),()=>a(null)),[r,a]);let l=T.useMemo(()=>({open:s===0}),[s]),c={ref:o,id:r};return Zi()({ourProps:c,theirProps:n,slot:l,defaultTag:N4,name:"Dialog.Title"})}let L4=gi(A4),Qi=gi(k4);gi(R4);let Ji=gi(D4),ms=Object.assign(L4,{Panel:Qi,Title:Ji,Description:HM});var Yk;let P4=(Yk=st.startTransition)!=null?Yk:function(i){i()};var O4=(i=>(i[i.Open=0]="Open",i[i.Closed=1]="Closed",i))(O4||{}),I4=(i=>(i[i.ToggleDisclosure=0]="ToggleDisclosure",i[i.CloseDisclosure=1]="CloseDisclosure",i[i.SetButtonId=2]="SetButtonId",i[i.SetPanelId=3]="SetPanelId",i[i.SetButtonElement=4]="SetButtonElement",i[i.SetPanelElement=5]="SetPanelElement",i))(I4||{});let F4={0:i=>({...i,disclosureState:pa(i.disclosureState,{0:1,1:0})}),1:i=>i.disclosureState===1?i:{...i,disclosureState:1},2(i,e){return i.buttonId===e.buttonId?i:{...i,buttonId:e.buttonId}},3(i,e){return i.panelId===e.panelId?i:{...i,panelId:e.panelId}},4(i,e){return i.buttonElement===e.element?i:{...i,buttonElement:e.element}},5(i,e){return i.panelElement===e.element?i:{...i,panelElement:e.element}}},xS=T.createContext(null);xS.displayName="DisclosureContext";function _S(i){let e=T.useContext(xS);if(e===null){let t=new Error(`<${i} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,_S),t}return e}let ES=T.createContext(null);ES.displayName="DisclosureAPIContext";function j5(i){let e=T.useContext(ES);if(e===null){let t=new Error(`<${i} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,j5),t}return e}let SS=T.createContext(null);SS.displayName="DisclosurePanelContext";function M4(){return T.useContext(SS)}function j4(i,e){return pa(e.type,F4,i,e)}let B4=T.Fragment;function z4(i,e){let{defaultOpen:t=!1,...r}=i,n=T.useRef(null),s=Us(e,s5(g=>{n.current=g},i.as===void 0||i.as===T.Fragment)),a=T.useReducer(j4,{disclosureState:t?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:o,buttonId:l},c]=a,h=gr(g=>{c({type:1});let y=Bp(n);if(!y||!l)return;let b=g?ko(g)?g:"current"in g&&ko(g.current)?g.current:y.getElementById(l):y.getElementById(l);b==null||b.focus()}),f=T.useMemo(()=>({close:h}),[h]),m=T.useMemo(()=>({open:o===0,close:h}),[o,h]),p={ref:s},x=Zi();return st.createElement(xS.Provider,{value:a},st.createElement(ES.Provider,{value:f},st.createElement(o5,{value:h},st.createElement(_5,{value:pa(o,{0:Yi.Open,1:Yi.Closed})},x({ourProps:p,theirProps:r,slot:m,defaultTag:B4,name:"Disclosure"})))))}let $4="button";function U4(i,e){let t=T.useId(),{id:r=`headlessui-disclosure-button-${t}`,disabled:n=!1,autoFocus:s=!1,...a}=i,[o,l]=_S("Disclosure.Button"),c=M4(),h=c===null?!1:c===o.panelId,f=T.useRef(null),m=Us(f,e,gr(I=>{if(!h)return l({type:4,element:I})}));T.useEffect(()=>{if(!h)return l({type:2,buttonId:r}),()=>{l({type:2,buttonId:null})}},[r,l,h]);let p=gr(I=>{var F;if(h){if(o.disclosureState===1)return;switch(I.key){case Gc.Space:case Gc.Enter:I.preventDefault(),I.stopPropagation(),l({type:0}),(F=o.buttonElement)==null||F.focus();break}}else switch(I.key){case Gc.Space:case Gc.Enter:I.preventDefault(),I.stopPropagation(),l({type:0});break}}),x=gr(I=>{switch(I.key){case Gc.Space:I.preventDefault();break}}),g=gr(I=>{var F;MM(I.currentTarget)||n||(h?(l({type:0}),(F=o.buttonElement)==null||F.focus()):l({type:0}))}),{isFocusVisible:y,focusProps:b}=yM({autoFocus:s}),{isHovered:_,hoverProps:S}=vM({isDisabled:n}),{pressed:k,pressProps:C}=SM({disabled:n}),R=T.useMemo(()=>({open:o.disclosureState===0,hover:_,active:k,disabled:n,focus:y,autofocus:s}),[o,_,k,y,n,s]),N=Tj(i,o.buttonElement),O=Tk(h?{ref:m,type:N,disabled:n||void 0,autoFocus:s,onKeyDown:p,onClick:g}:{ref:m,id:r,type:N,"aria-expanded":o.disclosureState===0,"aria-controls":o.panelElement?o.panelId:void 0,disabled:n||void 0,autoFocus:s,onKeyDown:p,onKeyUp:x,onClick:g},b,S,C);return Zi()({ourProps:O,theirProps:a,slot:R,defaultTag:$4,name:"Disclosure.Button"})}let H4="div",W4=Lp.RenderStrategy|Lp.Static;function V4(i,e){let t=T.useId(),{id:r=`headlessui-disclosure-panel-${t}`,transition:n=!1,...s}=i,[a,o]=_S("Disclosure.Panel"),{close:l}=j5("Disclosure.Panel"),[c,h]=T.useState(null),f=Us(e,gr(_=>{P4(()=>o({type:5,element:_}))}),h);T.useEffect(()=>(o({type:3,panelId:r}),()=>{o({type:3,panelId:null})}),[r,o]);let m=l0(),[p,x]=x5(n,c,m!==null?(m&Yi.Open)===Yi.Open:a.disclosureState===0),g=T.useMemo(()=>({open:a.disclosureState===0,close:l}),[a.disclosureState,l]),y={ref:f,id:r,...w5(x)},b=Zi();return st.createElement(E5,null,st.createElement(SS.Provider,{value:a.panelId},b({ourProps:y,theirProps:s,slot:g,defaultTag:H4,features:W4,visible:p,name:"Disclosure.Panel"})))}let G4=gi(z4),Yy=gi(U4),Xy=gi(V4),J2=Object.assign(G4,{Button:Yy,Panel:Xy});async function q4(i={}){return typeof i=="object"&&Object.freeze(i),await fi("plugin:dialog|open",{options:i})}async function rc(i,e){var r,n,s;const t=typeof e=="string"?{title:e}:e;return await fi("plugin:dialog|ask",{message:i.toString(),title:(r=t==null?void 0:t.title)==null?void 0:r.toString(),kind:t==null?void 0:t.kind,yesButtonLabel:(n=t==null?void 0:t.okLabel)==null?void 0:n.toString(),noButtonLabel:(s=t==null?void 0:t.cancelLabel)==null?void 0:s.toString()})}var hr;(function(i){i[i.Audio=1]="Audio",i[i.Cache=2]="Cache",i[i.Config=3]="Config",i[i.Data=4]="Data",i[i.LocalData=5]="LocalData",i[i.Document=6]="Document",i[i.Download=7]="Download",i[i.Picture=8]="Picture",i[i.Public=9]="Public",i[i.Video=10]="Video",i[i.Resource=11]="Resource",i[i.Temp=12]="Temp",i[i.AppConfig=13]="AppConfig",i[i.AppData=14]="AppData",i[i.AppLocalData=15]="AppLocalData",i[i.AppCache=16]="AppCache",i[i.AppLog=17]="AppLog",i[i.Desktop=18]="Desktop",i[i.Executable=19]="Executable",i[i.Font=20]="Font",i[i.Home=21]="Home",i[i.Runtime=22]="Runtime",i[i.Template=23]="Template"})(hr||(hr={}));async function Dl(){return fi("plugin:path|resolve_directory",{directory:hr.AppLocalData})}async function Gi(...i){return fi("plugin:path|join",{paths:i})}var Xk;(function(i){i[i.Start=0]="Start",i[i.Current=1]="Current",i[i.End=2]="End"})(Xk||(Xk={}));async function Kk(i,e,t){if(i instanceof URL&&i.protocol!=="file:"||e instanceof URL&&e.protocol!=="file:")throw new TypeError("Must be a file URL.");await fi("plugin:fs|copy_file",{fromPath:i instanceof URL?i.toString():i,toPath:e instanceof URL?e.toString():e,options:t})}async function B5(i,e){if(i instanceof URL&&i.protocol!=="file:")throw new TypeError("Must be a file URL.");await fi("plugin:fs|mkdir",{path:i instanceof URL?i.toString():i,options:e})}async function Um(i,e){if(i instanceof URL&&i.protocol!=="file:")throw new TypeError("Must be a file URL.");await fi("plugin:fs|remove",{path:i instanceof URL?i.toString():i,options:e})}async function ex(i,e){if(i instanceof URL&&i.protocol!=="file:")throw new TypeError("Must be a file URL.");return await fi("plugin:fs|exists",{path:i instanceof URL?i.toString():i,options:e})}const Yc=class Yc{constructor(){it(this,"db",null);it(this,"Database",null)}static getInstance(){return Yc.instance||(Yc.instance=new Yc),Yc.instance}async loadDatabase(){}async connect(){}async execute(e,t=[]){return null}async select(e,t=[]){return null}async close(){}};it(Yc,"instance");let R_=Yc;const nr=R_.getInstance(),zs=fh()(ph(i=>({apiKey:"",setApiKey:e=>i({apiKey:e}),username:"",setUsername:e=>i({username:e}),password:"",roles:{is_admin:!1,add_file:!1,delete_file:!1,edit_metadata:!1,manage_collections:!1,manage_library:!1,create_user:!1},setRoles:e=>i({roles:e}),setPassword:e=>i({password:e}),displayAuthModal:!1,setDisplayAuthModal:e=>i({displayAuthModal:e}),oauthGoogleAccessToken:"",setOauthGoogleAccessToken:e=>i({oauthGoogleAccessToken:e}),oauthGoogleRefreshToken:"",setOauthGoogleRefreshToken:e=>i({oauthGoogleRefreshToken:e}),oauthDropboxAccessToken:"",setOauthDropboxAccessToken:e=>i({oauthDropboxAccessToken:e}),oauthDropboxRefreshToken:"",setOauthDropboxRefreshToken:e=>i({oauthDropboxRefreshToken:e}),hasHydrated:!1,setHasHydrated:e=>i({hasHydrated:e})}),{name:"auth-storage",storage:dc(()=>localStorage),onRehydrateStorage:i=>()=>i.setHasHydrated(!0),partialize:i=>({apiKey:i.apiKey,roles:i.roles,oauthGoogleAccessToken:i.oauthGoogleAccessToken,oauthGoogleRefreshToken:i.oauthGoogleRefreshToken,oauthDropboxAccessToken:i.oauthDropboxAccessToken,oauthDropboxRefreshToken:i.oauthDropboxRefreshToken})})),Ln=fh()(ph(i=>({activeTab:"/",setActiveTab:e=>i({activeTab:e}),server:"",setServer:e=>i({server:e}),serverUsername:"",setServerUsername:e=>i({serverUsername:e}),serverPassword:"",setServerPassword:e=>i({serverPassword:e}),isConnected:!1,setIsConnected:e=>i({isConnected:e}),config:{},setConfig:e=>i({config:e}),serverVersion:"",setServerVersion:e=>i({serverVersion:e}),users:[],setUsers:e=>i({users:e}),hasHydrated:!1,setHasHydrated:e=>i({hasHydrated:e})}),{name:"common-storage",storage:dc(()=>localStorage),onRehydrateStorage:i=>()=>i.setHasHydrated(!0),partialize:i=>({server:i.server,serverUsername:i.serverUsername,serverPassword:i.serverPassword,isConnected:i.isConnected,config:i.config,serverVersion:i.serverVersion,users:i.users})}));function Wl(){const{server:i}=Ln(Dt(t=>({server:t.server})));return{makeRequest:T.useCallback(async(t,r,n,s,a,o)=>{if(!zs||zs.getState().apiKey.length===0)throw new Error("Unable to access authentication server");if((!a||a.length===0)&&(!i||i.length===0))throw new Error("No server URL provided");const l=a?a+t:i+t,c=l.replace(/[/:?&]/g,"_");let h=null;o&&(h=new FormData,h.append("file",o));const f={Authorization:zs.getState().apiKey.length>0?`Bearer ${zs.getState().apiKey}`:""};h||(f["Content-Type"]="application/json");try{const m=await fetch(l,{method:r,headers:f,cache:"no-store",body:h||(n?JSON.stringify(n):void 0)});if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);let p=null;try{p=await m.json()}catch{return{status:!1}}return p?(s&&(await nr.connect(),await nr.execute("DELETE FROM cache WHERE key = ?",[c]),await nr.execute("INSERT INTO cache (key, value) VALUES (?, ?)",[c,JSON.stringify(p)])),p):{status:!1}}catch{if(s){await nr.connect();const p=await nr.execute("SELECT * FROM cache WHERE key = ?",[c]);if(p&&p.length>0)return JSON.parse(p[0].value)}return{status:!1}}},[i,zs])}}const Y4={getItem:async i=>await dS(i)||null,setItem:async(i,e)=>{await hS(i,e)},removeItem:async i=>{await fS(i)}},X4=({name:i,handler:e})=>fh()(ph(e,{name:i,storage:dc(()=>Y4)})),Xr=X4({name:"devourer/library",handler:i=>({libraryId:null,libraryName:null,libraryPath:null,librariesData:null,libraryData:null,filesData:null,fileData:null,currentSeries:null,currentBook:null,recentlyRead:null,setLibraryId:e=>i({libraryId:e}),setLibraryName:e=>i({libraryName:e}),setLibraryPath:e=>i({libraryPath:e}),setLibrariesData:e=>i({librariesData:e}),setLibraryData:e=>i({libraryData:e}),setFilesData:e=>i({filesData:e}),setFileData:e=>i({fileData:e}),setCurrentSeries:e=>i({currentSeries:e}),setCurrentBook:e=>i({currentBook:e}),setRecentlyRead:e=>i({recentlyRead:e})})});function vn(){const{makeRequest:i}=Wl(),{setIsConnected:e}=Ln(Dt(Z=>({setIsConnected:Z.setIsConnected}))),[t,r]=T.useState(null),{setLibrariesData:n,setLibraryId:s,libraryId:a,setLibraryData:o,setRecentlyRead:l}=Xr(Dt(Z=>({setLibrariesData:Z.setLibrariesData,setLibraryId:Z.setLibraryId,libraryId:Z.libraryId,setLibraryData:Z.setLibraryData,setRecentlyRead:Z.setRecentlyRead}))),c=Br(),h=async()=>{var K;const Z=await q4({multiple:!1,directory:!1});if(!Z)return;const ie=(K=Z.split(".").pop())==null?void 0:K.toLowerCase();ie||wt.error("Unsupported file type",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}});const ge=await Dl();let V=null;if(["epub","pdf"].includes(ie)){V=await Gi(ge,String(hr.AppLocalData),`local.${ie}`),await Kk(Z,V,{toPathBaseDir:hr.AppLocalData});const be=`/book/0/read?opdsType=${ie==="pdf"?"opds-pdf":"opds-epub"}&opdsUrl=local:${V}`;c(be)}else if(["cbz","zip","cbr","rar"].includes(ie)){V=await Gi(ge,String(hr.AppLocalData),`local.${ie}`),await Kk(Z,V,{toPathBaseDir:hr.AppLocalData});const be=`/manga/0/read?directOpen=true&directFile=${V}`;c(be)}else{wt.error("Unsupported file type",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}});return}},f=async Z=>{const ie=await i("/libraries","GET",void 0,!1,Z);if(!ie.status)throw e(!1),new Error("Failed to fetch libraries");e(!0),n(ie.libraries);const ge=await S();return l(ge),!0},m=async Z=>(console.log(Z),console.log("/migrate/calibre","POST",{calibrePath:Z.path,libraryName:Z.name,libraryMetadataProvider:Z.metadata.provider}),(await i("/migrate/calibre","POST",{calibrePath:Z.path,libraryName:Z.name,libraryMetadataProvider:Z.metadata.provider},!1)).status?(wt.success("Library imported successfully, give it a minute to start scanning then refresh using the icon at the top right.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),!0):(wt.error("Failed to import library. Please check your Calibre path and try again.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),!1)),p=async Z=>{const ie=await i(`/library/${Z}`,"GET",void 0,!1);if(console.log("library",ie),!ie.status)throw e(!1),s(null),F(null),wt.error("Failed to fetch library",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),new Error("Failed to fetch library");return s(Z),o(ie.library),!0},x=async Z=>{const ie=await i(`/library/${Z}/scan`,"GET",void 0,!1);if(!ie.status)throw new Error("Failed to fetch scan status");return r(ie),!0},g=async(Z,ie)=>{if(!(await i(`/collections/${Z}/${ie}`,"PATCH")).status)throw new Error("Failed to add to collection");return!0},y=async(Z,ie)=>{if(!(await i(`/collections/${Z}/${ie}`,"DELETE")).status)throw new Error("Failed to remove from collection");return!0},b=async Z=>{if(!(await i(`/collections/${Z}`,"DELETE")).status)throw new Error("Failed to delete collection");return!0},_=async Z=>{const ie=await i(`/library/${Z}/scan`,"POST");return ie.status?wt.success("Scan started.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff",zIndex:1e3}}):wt.error("Scan failed. If a scan is still in progress, this is likely the reason.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff",zIndex:1e3}}),ie},S=async()=>{const Z=await i("/recently-read","GET");if(!Z.status)throw new Error("Failed to fetch recently read");return Z.recentlyRead},k=async Z=>{const ie=await i("/libraries","POST",Z);if(ie.status)return s(ie.library.id),wt.success("Library created successfully, give it a minute to start scanning then refresh using the icon at the top right.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),ie.library;throw new Error("Failed to create library")},C=async(Z,ie)=>{const ge=await i(`/library/${Z}`,"PATCH",ie);if(ge.status)return wt.success("Library updated successfully.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),ge.library;throw new Error("Failed to update library")},R=async Z=>{if((await i(`/library/${Z}`,"DELETE")).status)return wt.success("Library deleted successfully.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),!0;throw new Error("Failed to delete library")},N=async Z=>{if((await i(`/library/${Z.libraryId}/collections`,"POST",Z)).status)return wt.success("Collection created successfully.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),!0;throw new Error("Failed to create collection")},O=async()=>a?(await new Promise(Z=>setTimeout(Z,10)),await p(a),!0):!1,[I,F]=T.useState(null),[G,B]=T.useState(!1),[Y,j]=T.useState(null),ae=async()=>{try{B(!0),j(null);const Z=await nr.select("SELECT * FROM BookFile ORDER by title ASC");o({id:9999,name:"Local Books",type:"book",series:Z.map(ie=>({...ie,metadata:ie.metadata?JSON.parse(ie.metadata):{}}))})}catch(Z){console.error("Failed to load local books:",Z),j(Z instanceof Error?Z.message:"Failed to load local books"),o(null)}finally{B(!1)}},he=async()=>{try{B(!0),j(null);const Z=await nr.select("SELECT * FROM MangaSeries ORDER by title ASC");o({id:9998,name:"Local Manga",type:"manga",series:Z.map(ie=>({...ie,manga_data:ie.manga_data?JSON.parse(ie.manga_data):{}}))})}catch(Z){console.error("Failed to load local manga:",Z),j(Z instanceof Error?Z.message:"Failed to load local manga"),o(null)}finally{B(!1)}},ee=async Z=>{const ie=await i("/roles","GET",void 0,!1,Z);if(!ie.status)throw new Error("Failed to fetch roles");return ie};return T.useEffect(()=>{if(!a){o(null);return}a===9999?ae():a===9998&&he()},[a]),{retrieveLibraries:f,retrieveLibrary:p,scanLibrary:_,getRecentlyRead:S,createLibrary:k,updateLibrary:C,deleteLibrary:R,refreshLibrary:O,createCollection:N,library:I,isLoadingLocalLibrary:G,localLibraryError:Y,loadLocalBooks:ae,loadLocalManga:he,addToCollection:g,removeFromCollection:y,deleteCollection:b,scanStatus:t,getScanStatus:x,openLocalFile:h,importLibrary:m,getRoles:ee}}function zp(){const i=Br(),{t:e}=ir(),{makeRequest:t}=Wl(),{server:r,setServer:n,setActiveTab:s,setIsConnected:a,setServerVersion:o,setUsers:l}=Ln(Dt(O=>({setActiveTab:O.setActiveTab,server:O.server,setServer:O.setServer,setIsConnected:O.setIsConnected,setServerVersion:O.setServerVersion,setUsers:O.setUsers}))),{apiKey:c,setApiKey:h,setDisplayAuthModal:f,setRoles:m,setUsername:p}=zs(Dt(O=>({apiKey:O.apiKey,setApiKey:O.setApiKey,setDisplayAuthModal:O.setDisplayAuthModal,setRoles:O.setRoles,setUsername:O.setUsername}))),{retrieveLibraries:x,getRoles:g}=vn(),[y,b]=T.useState(!0),_=T.useCallback(async O=>{try{if(await x(O)){try{const G=await(await fetch(`${O}/version`)).json();o(G.version)}catch(F){o("0.0.1"),console.error("Server version retrieval error:",F)}try{const F=await g(O);m(F.roles),p(F.username)}catch(F){console.error("Server roles retrieval error:",F)}return f(!1),s("/libraries"),a(!0),i("/libraries"),!0}else return wt.error(e("server.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1}catch(I){return console.error("Server connection error:",I),wt.error(e("server.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1}finally{b(!1)}},[x,e,s,a,i,c]);T.useEffect(()=>{n("http://localhost:9024"),b(!1)},[]);const S=T.useCallback(async(O,I)=>{if(r===""||y)return;const F=r.trim().replace(/\/$/,"");n(F),b(!0);try{if((await fetch(`${F}/health`)).status!==200)return wt.error(e("server.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),b(!1),!1;if(await new Promise(B=>setTimeout(B,200)),c&&c.length>0){const B=await fetch(`${F}/status`,{headers:{Authorization:`Bearer ${c}`}});if(await new Promise(Y=>setTimeout(Y,50)),B.status===200)return await _(F)}if(O&&O.length>0&&I&&I.length>0){console.log("Logging in"),console.log(F),console.log(O),console.log(I);const B=await fetch(`${F}/login`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:O,password:I})});if(B.status===200){const Y=await B.json();if(Y.status&&Y.token){h(Y.token),await new Promise(ae=>setTimeout(ae,50));const j=await _(F);return b(!1),j}}}return wt.error("Failed to log in to server. Please check your credentials.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),f(!0),!1}catch(G){return console.error("Connection error:",G),wt.error(e("server.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),f(!0),!1}finally{b(!1)}},[r,y,n,e,s,i,f,_]),k=T.useCallback(async()=>{const O=await t("/users","GET");if(!O.status)throw new Error("Failed to fetch users");l(O.users)},[t,l]),C=T.useCallback(async(O,I,F)=>{if(!(await t("/users","POST",{username:O,password:I,role:F})).status)throw new Error("Failed to create user");return!0},[t]),R=T.useCallback(async(O,I,F)=>{if(!(await t(`/user/${O}`,"PATCH",{role:I,password:F})).status)throw new Error("Failed to edit user");return!0},[t]),N=T.useCallback(async O=>{if(await rc("Are you sure you want to delete this user?",{title:"Devourer",kind:"warning"})){if(!(await t(`/user/${O}`,"DELETE")).status)throw wt.error("Failed to delete user.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),new Error("Failed to delete user");return wt.success("User successfully deleted.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),await k(),!0}else return!1},[t,k]);return{connectToServer:S,loading:y,getUsers:k,createUser:C,deleteUser:N,editUser:R}}const z5=T.memo(({value:i,onChange:e})=>{const{t}=ir(),[r,n]=T.useState(null),[s,a]=T.useState(null),[o,l]=T.useState(!1),{connectToServer:c,loading:h}=zp(),{displayAuthModal:f,setDisplayAuthModal:m}=zs(Dt(x=>({displayAuthModal:x.displayAuthModal,setDisplayAuthModal:x.setDisplayAuthModal}))),p=()=>{m(!1)};return E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex flex-col items-center justify-center w-full",children:[E.jsx("div",{className:"w-full",children:E.jsx("input",{type:"text",value:i,onChange:x=>e(x.target.value),className:K4.input,placeholder:t("common.serverUrl"),"aria-label":t("common.serverUrl"),disabled:h})}),E.jsx("div",{className:"w-full",children:E.jsx(Yt,{onPress:async()=>{if(o)return;l(!0),await c(r||void 0,s||void 0)||l(!1)},className:`rounded-t-none md:text-lg w-full md:w-full p-4 ${o?"opacity-50 hover:cursor-not-allowed":""}`,disabled:h,"aria-busy":h,children:t(h?"common.connecting":"common.connectToServer")})})]}),E.jsx(ms,{open:f,as:"div",className:"relative z-10 focus:outline-none",onClose:()=>{o||p()},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-white/5 p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsx(Ji,{as:"h3",className:"text-base/7 font-medium text-white",children:t("login.title")}),E.jsx("p",{className:"mt-2 text-sm/6 text-white",children:t("login.description")}),E.jsxs("div",{className:"mt-2 text-white/85",children:[E.jsx("label",{htmlFor:"username",className:"text-sm/6 font-semibold",children:t("login.username")}),E.jsx("input",{type:"text",value:r||"",onChange:x=>n(x.target.value),className:"my-2 border border-primary rounded-md p-3 w-full bg-input text-white focus:outline-none focus:border-primary transition-colors"}),E.jsx("label",{htmlFor:"password",className:"text-sm/6 font-semibold",children:t("login.password")}),E.jsx("input",{type:"password",value:s||"",onChange:x=>a(x.target.value),className:"my-2 border border-primary rounded-md p-3 w-full bg-input text-white focus:outline-none focus:border-primary transition-colors"})]}),E.jsx("div",{className:"mt-4",children:E.jsx(Yt,{className:`w-full md:w-full ${o?"opacity-50 hover:cursor-not-allowed":""}`,onPress:async()=>{if(o)return;l(!0),await c(r||void 0,s||void 0)||l(!1)},disabled:h,"aria-busy":h,children:t("login.login")})})]})})})})]})});z5.displayName="ServerInput";function $5(){const{server:i,setServer:e}=Ln(Dt(t=>({server:t.server,setServer:t.setServer})));return E.jsx(z5,{value:i,onChange:t=>{e(t.toLowerCase().trim())}})}const K4={input:"border border-primary border-b-0 rounded-md rounded-b-none p-5 w-full bg-input text-white focus:outline-none focus:border-primary transition-colors"},Z4="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%20width='200'%20height='200'%20style='shape-rendering:%20auto;%20display:%20block;%20background:%20transparent;'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3cpath%20style='transform:scale(0.8);transform-origin:50px%2050px'%20stroke-linecap='round'%20d='M24.3%2030C11.4%2030%205%2043.3%205%2050s6.4%2020%2019.3%2020c19.3%200%2032.1-40%2051.4-40%20C88.6%2030%2095%2043.3%2095%2050s-6.4%2020-19.3%2020C56.4%2070%2043.6%2030%2024.3%2030z'%20stroke-dasharray='42.76482137044271%2042.76482137044271'%20stroke-width='8'%20stroke='%230c90e9'%20fill='none'%3e%3canimate%20values='0;256.58892822265625'%20keyTimes='0;1'%20dur='1s'%20repeatCount='indefinite'%20attributeName='stroke-dashoffset'%3e%3c/animate%3e%3c/path%3e%3cg%3e%3c/g%3e%3c/g%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io%20--%3e%3c/svg%3e",$p=()=>E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full md:w-1/2 md:mx-auto",children:E.jsx("div",{className:"flex items-center justify-center",children:E.jsx("img",{src:Z4,alt:"Loading"})})}),Q4=[{id:"/",label:"tabBar.home",icon:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"},{id:"/libraries",label:"tabBar.libraries",icon:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"},{id:"/settings/client",label:"tabBar.settings",icon:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}],J4=st.memo(({tab:i,label:e,isActive:t,onPress:r})=>E.jsx(E.Fragment,{children:E.jsxs("button",{className:`w-full items-center py-1 transition-all duration-300 ease-in-out shadow-none rounded-full flex flex-col items-center justify-center ${t?"bg-quaternary inset-shadow-sm ring-2 ring-primary shadow-lg shadow-blue-200/10":"bg-secondary shadow-none hover:font-bold"}`,onClick:r,role:"tab","aria-selected":t,children:[E.jsx("svg",{fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:t?"white":"#aaaaaa",height:24,width:24,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:i.icon})}),E.jsx("span",{className:`text-xs md:text-sm ${t?"text-white":"text-white/80"}`,children:e})]})}),(i,e)=>i.isActive===e.isActive&&i.label===e.label),es=st.memo(()=>{const i=Ln(s=>s.activeTab),e=Ln(s=>s.setActiveTab),t=Br(),{t:r}=ir(),n=T.useCallback(s=>{e(s.id),t(`${s.id}`)},[e,t]);return T.useEffect(()=>{const s=window.location.pathname;s.includes("/libraries")||s.includes("/library")||s.includes("/book")||s.includes("/manga")?e("/libraries"):s.includes("/settings/client")?e("/settings/client"):e("/")},[i]),E.jsx("div",{className:"fixed bottom-0 left-0 mb-5 w-screen px-10 md:left-[25%] md:w-1/2",style:{position:"fixed"},children:E.jsx("div",{className:"w-full grid grid-cols-3 gap-5 rounded-full bg-primary/80 p-3 inset-shadow-sm shadow-xl shadow-blue-200/10 backdrop-blur-xl ring-2 ring-white",role:"tablist",style:{transform:void 0,WebkitTransform:void 0},children:Q4.map(s=>E.jsx(J4,{tab:s,label:r(s.label),isActive:i===s.id,onPress:()=>n(s)},s.id))})})}),ts=({children:i,...e})=>E.jsx("div",{className:`${e8.container} ${e.className}`,...e,children:i}),e8={container:"p-3 min-h-screen w-full flex flex-col"},t8=[{key:"googleDrive",name:"Google Drive",route:"/providers/google",web:!1},{key:"dropbox",name:"Dropbox",route:"/providers/dropbox",web:!1},{key:"opds",name:"OPDS",route:"/opds",web:!0}],r8={providers:{dropbox:!1,googleDrive:!0,opds:!0}};function n8(){const i=Br(),{loading:e}=zp(),t=T.useCallback(r=>{i(r)},[i]);return E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-24 pt-8",children:e?E.jsx($p,{}):E.jsx(E.Fragment,{children:E.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full md:w-1/2 md:mx-auto",children:[E.jsx($5,{}),E.jsx("div",{className:"mt-5 gap-5 grid grid-cols-1 md:grid-cols-4 w-full",children:t8.map(r=>E.jsx(T.Fragment,{children:r8.providers[r.key]&&r.web&&E.jsx(DF,{provider:r,onClick:t},r.route)},r.route))})]})})}),!e&&E.jsx(es,{})]})}const i8={getItem:async i=>await dS(i)||null,setItem:async(i,e)=>{await hS(i,e)},removeItem:async i=>{await fS(i)}},s8=({name:i,handler:e})=>fh()(ph(e,{name:i,storage:dc(()=>i8)})),gh=s8({name:"devourer/opds",handler:i=>({opdsUrl:null,opdsLibraries:null,opdsBooks:null,opdsLibraryUrl:null,opdsLimit:50,opdsPage:1,nextLink:null,prevLink:null,setOpdsUrl:e=>i({opdsUrl:e}),setOpdsLibraries:e=>i({opdsLibraries:e}),setOpdsBooks:e=>i({opdsBooks:e}),setOpdsLibraryUrl:e=>i({opdsLibraryUrl:e}),setOpdsLimit:e=>i({opdsLimit:e}),setOpdsPage:e=>i({opdsPage:e}),setNextLink:e=>i({nextLink:e}),setPrevLink:e=>i({prevLink:e})})});function AS(){const{setOpdsUrl:i,setOpdsLibraries:e,setOpdsBooks:t,opdsLibraries:r,opdsUrl:n,opdsPage:s,opdsLimit:a,setNextLink:o,setPrevLink:l}=gh(Dt(b=>({setOpdsUrl:b.setOpdsUrl,setOpdsLibraries:b.setOpdsLibraries,setOpdsBooks:b.setOpdsBooks,opdsLibraries:b.opdsLibraries,opdsUrl:b.opdsUrl,opdsPage:b.opdsPage,opdsLimit:b.opdsLimit,setNextLink:b.setNextLink,setPrevLink:b.setPrevLink}))),c=Br(),h=b=>{var R;const S=new DOMParser().parseFromString(b,"text/xml"),k=S.querySelector("parsererror");if(k)throw console.error("XML content around error:",b.substring(0,2e3)),new Error("XML parsing failed: "+k.textContent);return S.querySelector("feed")||(console.error("No feed element found. Document structure:",(R=S.documentElement)==null?void 0:R.tagName),console.error("XML content:",b.substring(0,1e3))),S},f=b=>{var R,N,O;const _=b.querySelector("feed");if(!_)throw new Error("Invalid OPDS feed: no feed element found");const S={id:((R=_.querySelector("id"))==null?void 0:R.textContent)||"",title:((N=_.querySelector("title"))==null?void 0:N.textContent)||"",updated:((O=_.querySelector("updated"))==null?void 0:O.textContent)||"",entries:[],links:[]},k=_.querySelectorAll("link");S.links=Array.from(k).map(I=>({rel:I.getAttribute("rel")||"",href:I.getAttribute("href")||"",type:I.getAttribute("type")||""}));const C=_.querySelectorAll("entry");return S.entries=Array.from(C).map(I=>{var B,Y,j,ae;const F=[],G=I.querySelectorAll("link");return F.push(...Array.from(G).map(he=>({rel:he.getAttribute("rel")||"",href:he.getAttribute("href")||"",type:he.getAttribute("type")||""}))),{id:((B=I.querySelector("id"))==null?void 0:B.textContent)||"",title:((Y=I.querySelector("title"))==null?void 0:Y.textContent)||"",updated:((j=I.querySelector("updated"))==null?void 0:j.textContent)||"",content:((ae=I.querySelector("content"))==null?void 0:ae.textContent)||"",links:F}}),S},m=async b=>{const S=await(await fetch(b)).text(),k=h(S);return f(k).entries.filter(R=>R.links.some(N=>N.rel==="subsection"))},p=async b=>{const S=await(await fetch(b)).text(),k=h(S),C=f(k),R=new URL(b),N=C.links.find(I=>I.rel==="next"),O=C.links.find(I=>I.rel==="prev");return o(N?new URL(N.href,R).toString():null),l(O?new URL(O.href,R).toString():null),{books:C.entries.filter(I=>I.links.some(F=>F.rel==="http://opds-spec.org/acquisition")),nextPage:N?new URL(N.href,R).toString():null,prevPage:O?new URL(O.href,R).toString():null}};return{connectToOpds:async b=>{try{const _=await m(b);return _.length>0?(e(_),i(b),c("/libraries-opds"),!0):(t([]),{libraries:_,books:[]})}catch(_){throw t([]),e([]),i(null),wt.error("No libraries found at this URL.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),console.error("Error connecting to OPDS:",_),_}},getLibraries:m,getOpdsLibrary:async b=>{const _=r&&r.find(N=>N.id===b);if(!_)throw wt.error("Library not found.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),new Error("Library not found");const S=_.links.find(N=>N.rel==="subsection");if(!S)throw wt.error("Library link not found.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),new Error("Library link not found");const k=new URL(n||""),C=new URL(S.href,k).toString(),R=await p(C+`?page=${s}&limit=${a}`);return t(R),await new Promise(N=>setTimeout(N,50)),c("/library-opds"),{library:_,books:R}},getBooks:p,getBooksByPage:async b=>{const _=await p(b);return t(_),!0},parseXmlToJson:h,extractOpdsData:f}}const a8=T.memo(({value:i,onChange:e})=>{const{t}=ir(),{connectToOpds:r}=AS();return E.jsxs("div",{className:"flex flex-col items-center justify-center w-full",children:[E.jsx("div",{className:"w-full",children:E.jsx("input",{type:"text",value:i,onChange:n=>e(n.target.value),className:o8.input,placeholder:t("common.serverUrl"),"aria-label":t("common.serverUrl")})}),E.jsx("div",{className:"w-full",children:E.jsx(Yt,{onPress:()=>{r(i)},className:"rounded-t-none md:text-lg w-full md:w-full p-4",children:"Connect to OPDS Server"})})]})});U5.displayName="OpdsConnect";function U5(){const{opdsUrl:i,setOpdsUrl:e}=gh(Dt(t=>({opdsUrl:t.opdsUrl,setOpdsUrl:t.setOpdsUrl})));return E.jsx(a8,{value:i||"",onChange:e})}const o8={input:"border border-primary border-b-0 rounded-md rounded-b-none p-5 w-full bg-input text-white focus:outline-none focus:border-primary transition-colors"};function l8(){const{loading:i}=zp();return E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-24 pt-8",children:E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full md:w-1/2 md:mx-auto",children:E.jsx(U5,{})})}),!i&&E.jsx(es,{})]})}function u8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const Pp=T.forwardRef(u8);function c8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z",clipRule:"evenodd"}))}const d8=T.forwardRef(c8);function h8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M12.97 3.97a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06l6.22-6.22H3a.75.75 0 0 1 0-1.5h16.19l-6.22-6.22a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const f8=T.forwardRef(h8);function p8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm.53 5.47a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72v5.69a.75.75 0 0 0 1.5 0v-5.69l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z",clipRule:"evenodd"}))}const m8=T.forwardRef(p8);function g8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{d:"M11.25 4.533A9.707 9.707 0 0 0 6 3a9.735 9.735 0 0 0-3.25.555.75.75 0 0 0-.5.707v14.25a.75.75 0 0 0 1 .707A8.237 8.237 0 0 1 6 18.75c1.995 0 3.823.707 5.25 1.886V4.533ZM12.75 20.636A8.214 8.214 0 0 1 18 18.75c.966 0 1.89.166 2.75.47a.75.75 0 0 0 1-.708V4.262a.75.75 0 0 0-.5-.707A9.735 9.735 0 0 0 18 3a9.707 9.707 0 0 0-5.25 1.533v16.103Z"}))}const H5=T.forwardRef(g8);function v8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M10.72 11.47a.75.75 0 0 0 0 1.06l7.5 7.5a.75.75 0 1 0 1.06-1.06L12.31 12l6.97-6.97a.75.75 0 0 0-1.06-1.06l-7.5 7.5Z",clipRule:"evenodd"}),T.createElement("path",{fillRule:"evenodd",d:"M4.72 11.47a.75.75 0 0 0 0 1.06l7.5 7.5a.75.75 0 1 0 1.06-1.06L6.31 12l6.97-6.97a.75.75 0 0 0-1.06-1.06l-7.5 7.5Z",clipRule:"evenodd"}))}const y8=T.forwardRef(v8);function b8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M13.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L11.69 12 4.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}),T.createElement("path",{fillRule:"evenodd",d:"M19.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06L17.69 12l-6.97-6.97a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))}const w8=T.forwardRef(b8);function x8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z",clipRule:"evenodd"}))}const Ky=T.forwardRef(x8);function _8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z",clipRule:"evenodd"}))}const E8=T.forwardRef(_8);function S8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))}const A8=T.forwardRef(S8);function C8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const k8=T.forwardRef(C8);function T8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z",clipRule:"evenodd"}))}const Zk=T.forwardRef(T8);function R8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875ZM12.75 12a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25V18a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25V12Z",clipRule:"evenodd"}),T.createElement("path",{d:"M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"}))}const N8=T.forwardRef(R8);function D8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z"}),T.createElement("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"}))}const L8=T.forwardRef(D8);function P8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M19.5 21a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-5.379a.75.75 0 0 1-.53-.22L11.47 3.66A2.25 2.25 0 0 0 9.879 3H4.5a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3h15Zm-6.75-10.5a.75.75 0 0 0-1.5 0v4.19l-1.72-1.72a.75.75 0 0 0-1.06 1.06l3 3a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72V10.5Z",clipRule:"evenodd"}))}const O8=T.forwardRef(P8);function I8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M19.5 21a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-5.379a.75.75 0 0 1-.53-.22L11.47 3.66A2.25 2.25 0 0 0 9.879 3H4.5a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3h15Zm-6.75-10.5a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25v2.25a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25V10.5Z",clipRule:"evenodd"}))}const F8=T.forwardRef(I8);function M8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Zm8.25-3.75a.75.75 0 0 1 .75.75v2.25h2.25a.75.75 0 0 1 0 1.5h-2.25v2.25a.75.75 0 0 1-1.5 0v-2.25H7.5a.75.75 0 0 1 0-1.5h2.25V7.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const j8=T.forwardRef(M8);function B8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z",clipRule:"evenodd"}))}const CS=T.forwardRef(B8);function z8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M4.25 12a.75.75 0 0 1 .75-.75h14a.75.75 0 0 1 0 1.5H5a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"}))}const $8=T.forwardRef(z8);function U8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const kS=T.forwardRef(U8);function H8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z",clipRule:"evenodd"}))}const Qk=T.forwardRef(H8);function W8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const TS=T.forwardRef(W8);function V8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const W5=T.forwardRef(V8);function G8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{d:"M12 2.25a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-1.5 0V3a.75.75 0 0 1 .75-.75ZM7.5 12a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM18.894 6.166a.75.75 0 0 0-1.06-1.06l-1.591 1.59a.75.75 0 1 0 1.06 1.061l1.591-1.59ZM21.75 12a.75.75 0 0 1-.75.75h-2.25a.75.75 0 0 1 0-1.5H21a.75.75 0 0 1 .75.75ZM17.834 18.894a.75.75 0 0 0 1.06-1.06l-1.59-1.591a.75.75 0 1 0-1.061 1.06l1.59 1.591ZM12 18a.75.75 0 0 1 .75.75V21a.75.75 0 0 1-1.5 0v-2.25A.75.75 0 0 1 12 18ZM7.758 17.303a.75.75 0 0 0-1.061-1.06l-1.591 1.59a.75.75 0 0 0 1.06 1.061l1.591-1.59ZM6 12a.75.75 0 0 1-.75.75H3a.75.75 0 0 1 0-1.5h2.25A.75.75 0 0 1 6 12ZM6.697 7.757a.75.75 0 0 0 1.06-1.06l-1.59-1.591a.75.75 0 0 0-1.061 1.06l1.59 1.591Z"}))}const q8=T.forwardRef(G8);function Y8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M5.25 2.25a3 3 0 0 0-3 3v4.318a3 3 0 0 0 .879 2.121l9.58 9.581c.92.92 2.39 1.186 3.548.428a18.849 18.849 0 0 0 5.441-5.44c.758-1.16.492-2.629-.428-3.548l-9.58-9.581a3 3 0 0 0-2.122-.879H5.25ZM6.375 7.5a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25Z",clipRule:"evenodd"}))}const X8=T.forwardRef(Y8);function K8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z",clipRule:"evenodd"}))}const Z8=T.forwardRef(K8);function Q8({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z",clipRule:"evenodd"}))}const J8=T.forwardRef(Q8);function e6({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Oo=T.forwardRef(e6),t6=T.memo(({isOpen:i,onClose:e,onSubmit:t})=>{var S,k,C;const{t:r}=ir(),{importLibrary:n}=vn(),{makeRequest:s}=Wl(),{serverVersion:a}=Ln(Dt(R=>({serverVersion:R.serverVersion}))),[o,l]=T.useState(null),[c,h]=T.useState(!1),[f,m]=T.useState({id:0,name:"",path:"",metadata:{provider:"myanimelist",apiKey:""},type:"manga",series:[]}),[p,x]=T.useState(!1),[g,y]=T.useState(null);T.useEffect(()=>{g||(async()=>{const{status:N,providers:O}=await s("/metadata/providers","GET");N&&y(Object.values(O))})()},[s]),T.useEffect(()=>{a&&a>="1.1.0"?h(!0):h(!1)},[a]);const b=T.useCallback(async()=>{var R,N,O;if(f.name&&f.name.length===0){l(r("libraries.createErrorName"));return}if(f.path&&f.path.length===0){l(r("libraries.createErrorPath"));return}if(((R=f.metadata)==null?void 0:R.provider)==="comicvine"&&(!((N=f.metadata)!=null&&N.apiKey)||((O=f.metadata)==null?void 0:O.apiKey.length)===0)){l(r("libraries.createErrorApiKey"));return}x(!0),l(null);try{await t(f),e()}catch(I){l(I instanceof Error?I.message:"An error occurred")}finally{x(!1)}},[f,t,e,r]),_=T.useCallback(async()=>{if(!f.path||f.path.length===0||!f.name||f.name.length===0){l(r("libraries.formFields"));return}await rc(r("libraries.calibreAreYouSure"),{title:"Devourer",kind:"info"})&&await n(f)&&e()},[f,e,r]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:r("libraries.createRemoteLibrary")}),E.jsx("button",{className:"hover:cursor-pointer",onClick:e,children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"name",className:"font-semibold",children:r("libraries.name")}),E.jsx("input",{type:"text",id:"name",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:f.name,onChange:R=>m({...f,name:R.target.value})}),E.jsx("label",{htmlFor:"path",className:"font-semibold",children:r("libraries.path")}),E.jsx("input",{type:"text",id:"path",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:f.path,onChange:R=>m({...f,path:R.target.value})}),E.jsx("label",{htmlFor:"type",className:"font-semibold",children:r("libraries.type")}),E.jsxs("select",{id:"type",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:f.type,onChange:R=>{R.target.value==="manga"?m({...f,metadata:{provider:"myanimelist",apiKey:""},type:"manga"}):R.target.value==="book"&&m({...f,metadata:{provider:"googlebooks",apiKey:""},type:"book"})},children:[E.jsx("option",{value:"manga",children:r("common.manga")}),E.jsx("option",{value:"book",children:r("common.book")})]}),E.jsx("label",{htmlFor:"type",className:"font-semibold",children:r("libraries.metadataProvider")}),E.jsx("select",{id:"metadataProvider",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:(S=f.metadata)==null?void 0:S.provider,onChange:R=>m({...f,metadata:{...f.metadata,provider:R.target.value}}),children:g&&g.filter(R=>R.properties.library_type===f.type).map(R=>E.jsx("option",{value:R.key,children:R.name},R.key))}),g&&((k=g.find(R=>{var N;return R.key===((N=f.metadata)==null?void 0:N.provider)}))==null?void 0:k.properties.key_required)&&E.jsxs(E.Fragment,{children:[E.jsx("label",{htmlFor:"path",className:"font-semibold",children:r("libraries.metadataApiKey")}),E.jsx("input",{type:"text",id:"path",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:(C=f.metadata)==null?void 0:C.apiKey,onChange:R=>m({...f,metadata:{...f.metadata,apiKey:R.target.value}})})]})]}),o&&E.jsx("div",{className:"mt-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:o}),E.jsx("div",{className:"mt-5",children:E.jsx("button",{className:`bg-secondary hover:bg-tertiary text-white w-full p-3 rounded-md font-semibold hover:cursor-pointer ${p?"opacity-50":""}`,disabled:p,onClick:b,children:r("libraries.createLibrary")})}),f.type==="book"&&c&&E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"mt-2",children:E.jsx("button",{className:`bg-secondary hover:bg-tertiary text-white w-full p-3 rounded-md font-semibold hover:cursor-pointer ${p?"opacity-50":""}`,disabled:p,onClick:_,children:r("libraries.importFromCalibre")})}),E.jsx("div",{className:"text-sm mt-2",children:r("libraries.importFromCalibreDescription")})]})]})})})})}),Jk={book:[{label:"Google Books",value:"googlebooks",keyRequired:!1},{label:"OpenLibrary",value:"openlibrary",keyRequired:!1}],manga:[{label:"ComicVine",value:"comicvine",keyRequired:!0},{label:"Jikan (MyAnimeList)",value:"myanimelist",keyRequired:!1}]},r6=T.memo(({library:i,isOpen:e,onClose:t})=>{var y,b,_;const{t:r}=ir(),{retrieveLibrary:n,updateLibrary:s,retrieveLibraries:a,deleteLibrary:o}=vn(),[l,c]=T.useState(!1),[h,f]=T.useState(null),[m,p]=T.useState(i),x=T.useCallback(async()=>{var S,k,C;if(m.name&&m.name.length===0){f(r("libraries.createErrorName"));return}if(m.path&&m.path.length===0){f(r("libraries.createErrorPath"));return}if(((S=m.metadata)==null?void 0:S.provider)==="comicvine"&&(!((k=m.metadata)!=null&&k.apiKey)||((C=m.metadata)==null?void 0:C.apiKey.length)===0)){f(r("libraries.createErrorApiKey"));return}c(!0),f(null);try{await s(i.id,{metadata:m.metadata,name:m.name,path:m.path}),await n(i.id),t()}catch(R){f(R instanceof Error?R.message:"An error occurred")}finally{c(!1)}},[m,i,t,r]),g=T.useCallback(async()=>{await rc("Are you sure you want to delete this library? This action cannot be done, and will leave the the files on your filesystem.",{title:"Devourer",kind:"warning"})&&(await o(i.id),await a(),t())},[i,t]);return E.jsx(ms,{open:e,as:"div",className:"relative z-10 focus:outline-none",onClose:t,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:r("libraries.editRemoteLibrary")}),E.jsx("button",{className:"hover:cursor-pointer",onClick:t,children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"name",className:"font-semibold",children:r("libraries.name")}),E.jsx("input",{type:"text",id:"name",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:m.name,onChange:S=>p({...m,name:S.target.value})}),E.jsxs("label",{htmlFor:"path",className:"font-semibold",children:[r("libraries.path")," ",E.jsxs("span",{className:"text-xs text-gray-500",children:[E.jsx("br",{}),r("libraries.editPathInfo")]})]}),E.jsx("input",{type:"text",id:"path",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:m.path,onChange:S=>p({...m,path:S.target.value})}),E.jsx("label",{htmlFor:"type",className:"font-semibold",children:r("libraries.metadataProvider")}),E.jsx("select",{id:"metadataProvider",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:(y=m.metadata)==null?void 0:y.provider,onChange:S=>p({...m,metadata:{...m.metadata,provider:S.target.value}}),children:Jk[m.type].map(S=>E.jsx("option",{value:S.value,children:S.label},S.value))}),((b=Jk[m.type].find(S=>{var k;return S.value===((k=m.metadata)==null?void 0:k.provider)}))==null?void 0:b.keyRequired)&&E.jsxs(E.Fragment,{children:[E.jsx("label",{htmlFor:"path",className:"font-semibold",children:r("libraries.metadataApiKey")}),E.jsx("input",{type:"text",id:"path",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:(_=m.metadata)==null?void 0:_.apiKey,onChange:S=>p({...m,metadata:{...m.metadata,apiKey:S.target.value}})})]})]}),h&&E.jsx("div",{className:"mt-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:h}),E.jsx("div",{children:E.jsx(Yt,{className:"w-full",disabled:l,onPress:x,children:r("libraries.editLibrary")})}),E.jsx("div",{className:"mt-2",children:E.jsx(Yt,{className:"w-full",disabled:l,onPress:g,children:r("libraries.deleteLibrary")})})]})})})})}),n6=T.memo(({library:i,server:e,onNavigate:t,setEditLibraryId:r,setDisplayEditModal:n})=>{var s,a;return E.jsxs("button",{className:"hover:cursor-pointer relative","aria-label":`Go to ${i.name}`,onClick:()=>t(i.id.toString()),children:[E.jsx("div",{className:"absolute top-1 right-1 flex flex-row items-center justify-center",children:E.jsx("div",{className:"h-[2.5rem] w-auto px-[1rem] flex items-center justify-center rounded-full bg-black/75 text-white text-sm font-semibold",children:((s=i.seriesCount)==null?void 0:s.toLocaleString())||0})}),E.jsx("div",{className:"absolute top-1 left-1 flex flex-row items-center justify-center",children:E.jsx("button",{className:"rounded-full bg-black/75 text-white text-sm font-semibold h-[2.5rem] w-[2.5rem] flex items-center justify-center hover:cursor-pointer transition-all duration-300",onClick:o=>{o.stopPropagation(),r(i.id),n(!0)},children:E.jsx(kS,{className:"w-4 h-4"})})}),E.jsx("div",{className:"w-full bg-tertiary rounded-t-xl h-[16rem] flex flex-row",children:(a=i.series)==null?void 0:a.map((o,l)=>E.jsx("div",{className:"w-1/3",children:E.jsx("img",{src:`${e}/cover-image/${i.id}/${o.id}.webp`,alt:i.type==="book"?o.title:o.name,className:`w-full h-full object-cover ${l===0?"rounded-tl-xl":l===2?"rounded-tr-xl":""}`})},o.id))}),E.jsx("div",{className:"bg-primary text-white p-5 rounded-b-xl w-full mx-auto font-semibold",children:i.name})]},i.id)}),i6=T.memo(()=>{const{t:i}=ir(),e=Br(),{openLocalFile:t}=vn();return E.jsxs(E.Fragment,{children:[E.jsx(Yt,{onPress:()=>e("/library/9999?local=book"),children:i("libraries.viewOfflineBooks")}),E.jsx(Yt,{onPress:()=>e("/library/9998?local=manga"),children:i("libraries.viewOfflineManga")}),E.jsx(Yt,{onPress:()=>t(),children:i("libraries.openLocalFile")})]})});function s6(){const{server:i,isConnected:e}=Ln(Dt(S=>({server:S.server,isConnected:S.isConnected}))),{roles:t}=zs(Dt(S=>({roles:S.roles}))),{librariesData:r,setLibraryId:n,recentlyRead:s}=Xr(Dt(S=>({librariesData:S.librariesData,recentlyRead:S.recentlyRead,setLibraryId:S.setLibraryId}))),{retrieveLibraries:a,createLibrary:o,retrieveLibrary:l}=vn(),{t:c}=ir(),h=Br(),[f,m]=T.useState(!1),[p,x]=T.useState(!1),[g,y]=T.useState(null),b=T.useCallback(async S=>{if(!r)return null;n(Number(S)),l(Number(S)),h(`/library/${S}`)},[h]),_=T.useMemo(()=>!1,[]);return T.useEffect(()=>{a()},[]),E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsxs(ts,{className:"flex-1 px-5 pb-24 pt-12",children:[E.jsxs("div",{className:"flex flex-col md:flex-row gap-2 mb-5 mt-[1.5rem] md:mt-0",children:[_&&E.jsx(i6,{}),(t.is_admin||t.add_file)&&E.jsx(Yt,{className:"ml-auto mr-0 rounded-full w-full md:w-auto px-2 py-1",onPress:()=>{h("/users")},children:E.jsx(J8,{className:"w-5 h-5"})}),(t.is_admin||t.create_user)&&E.jsx(Yt,{className:"rounded-full w-full md:w-auto px-2 py-1",onPress:()=>{a(),wt.success(c("toast.librariesRefreshed"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"})},children:E.jsx(d8,{className:"w-5 h-5"})})]}),E.jsx("div",{className:"flex flex-col items-center justify-center mb-[4rem]",children:e?E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"w-full",children:[E.jsx("div",{className:"flex flex-row gap-2",children:E.jsx("h1",{className:"text-2xl text-white font-bold",children:"Continue reading"})}),E.jsx("div",{className:"w-full flex flex-row overflow-x-auto gap-5 my-5",children:s&&s.map(S=>E.jsx("button",{className:"min-w-[calc(50%-0.625rem)] md:min-w-[8rem] md:w-[8rem] hover:cursor-pointer",onClick:()=>{let k=null;const C=r==null?void 0:r.find(R=>R.id===S.library_id);C&&(C.type==="book"?k=`/book/${S.series_id}/read`:k=`/manga/${S.file_id}/read`,h(k))},children:E.jsx("img",{src:`${i}/preview-image/${S.library_id}/${S.series_id}/${S.file_id}.jpg`,alt:S.title,className:"w-full h-full object-cover rounded-xl"})}))})]}),E.jsxs("div",{className:"w-full",children:[E.jsxs("div",{className:"flex flex-row gap-2",children:[E.jsx("h1",{className:"text-2xl text-white font-bold",children:c(_?"libraries.remote":"libraries.general")}),t.manage_library&&E.jsx(Yt,{className:a6.button,onPress:()=>m(!0),children:E.jsx(TS,{className:"w-5 h-5"})})]}),E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-5 w-full mt-5",children:r&&r.map(S=>E.jsx(n6,{library:S,server:i,onNavigate:b,setEditLibraryId:y,setDisplayEditModal:x},S.id))})]})]}):E.jsxs("div",{children:[E.jsx("div",{className:"text-white",children:c("libraries.pleaseConnect")}),E.jsx("div",{className:"w-full mt-5",children:E.jsx($5,{})})]})})]}),E.jsx(es,{})]}),f&&E.jsx(t6,{isOpen:f,onClose:()=>m(!1),onSubmit:o}),r&&p&&g&&E.jsx(r6,{library:r==null?void 0:r.find(S=>S.id===g),isOpen:p,onClose:()=>{x(!1),y(null)}})]})}const a6={button:"px-2 py-1 rounded-full"};function o6(){const{t:i}=ir(),{opdsLibraries:e}=gh(Dt(r=>({opdsLibraries:r.opdsLibraries}))),{getOpdsLibrary:t}=AS();return E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:`${e?"":"flex-1"} px-5 pt-8`,children:E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full",children:e?E.jsx("div",{className:"w-full",children:E.jsx("div",{className:"mt-5 mb-24",children:E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-5 auto-rows-fr",children:e.map((r,n)=>E.jsx(Yt,{className:"md:w-full py-10",onPress:()=>{t(r.id)},children:r.title},`opds-library-${r.id}-${n}`))})})}):E.jsx("div",{children:i("common.loading")})})}),E.jsx(es,{})]})}const l6=T.memo(({isOpen:i,onClose:e})=>{const{t}=ir(),{libraryData:r}=Xr(Dt(p=>({libraryData:p.libraryData}))),{retrieveLibrary:n}=vn(),{makeRequest:s}=Wl(),[a,o]=T.useState(null),[l,c]=T.useState({title:"",path:"",library_id:r.id}),[h,f]=T.useState(!1),m=T.useCallback(async()=>{if(l.title&&l.title.length===0){o(t("libraries.createErrorName"));return}if(l.path&&l.path.length===0){o(t("libraries.createErrorPath"));return}f(!0),o(null);try{const{status:p,message:x}=await s("/series","PUT",{payload:l});p?(await n(r.id),e()):o(x)}catch(p){o(p instanceof Error?p.message:"An error occurred")}finally{f(!1)}},[l,e,t,r]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:"Create series"}),E.jsx("button",{className:"hover:cursor-pointer",onClick:e,children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"name",className:"font-semibold",children:"Series name"}),E.jsx("input",{type:"text",id:"name",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:l.title,onChange:p=>c({...l,title:p.target.value})}),E.jsxs("label",{htmlFor:"path",className:"font-semibold",children:["Folder name"," ",E.jsx("span",{className:"text-xs",children:'(relative to library path e.g. "One Piece")'})]}),E.jsx("input",{type:"text",id:"path",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:l.path,onChange:p=>c({...l,path:p.target.value})})]}),E.jsx("div",{children:"You will be able to edit metadata and add files to this series after creation."}),a&&E.jsx("div",{className:"mt-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:a}),E.jsx("div",{className:"mt-5",children:E.jsx("button",{className:`bg-secondary hover:bg-tertiary text-white w-full p-3 rounded-md font-semibold hover:cursor-pointer ${h?"opacity-50":""}`,disabled:h,onClick:m,children:"Create series"})})]})})})})}),V5=T.memo(({isOpen:i,onClose:e,libraryId:t})=>{const{t:r}=ir(),{libraryData:n}=Xr(Dt(x=>({libraryData:x.libraryData}))),{retrieveLibrary:s}=vn(),{makeRequest:a}=Wl(),[o,l]=T.useState(null),[c,h]=T.useState(null),[f,m]=T.useState(!1),p=T.useCallback(async()=>{if(!c){l(r("libraries.createErrorFile"));return}m(!0),l(null);try{const{status:x,message:g}=await a(`/book/${t}`,"PUT",void 0,void 0,void 0,c);x?(await s(n.id),e()):l(g)}catch(x){l(x instanceof Error?x.message:"An error occurred")}finally{m(!1)}},[c,e,r,n]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:"Upload book"}),E.jsx("button",{className:"hover:cursor-pointer",onClick:e,children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"file",className:"font-semibold",children:"File"}),E.jsx("input",{type:"file",id:"file",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",multiple:!1,onChange:x=>{const g=["epub","pdf"];x.target.files&&x.target.files.length>0&&g.includes(x.target.files[0].name.split(".").pop())?h(x.target.files[0]):l("File must be an epub or pdf.")}})]}),o&&E.jsx("div",{className:"mt-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:o}),E.jsx("div",{className:"mt-5",children:E.jsx("button",{className:`bg-secondary hover:bg-tertiary text-white w-full p-3 rounded-md font-semibold hover:cursor-pointer ${f?"opacity-50":""}`,disabled:f,onClick:p,children:"Upload book"})})]})})})})});function u6({activeTab:i,setActiveTab:e,isLocal:t,setDisplayCreateCollectionModal:r,libraryId:n}){const{t:s}=ir(),{scanLibrary:a,scanStatus:o,getScanStatus:l}=vn(),{roles:c}=zs(Dt(p=>({roles:p.roles}))),{libraryData:h}=Xr(Dt(p=>({libraryData:p.libraryData}))),[f,m]=T.useState(!1);return T.useEffect(()=>{if(n&&l){l(n);const p=setInterval(()=>{l(n)},3e4);return()=>clearInterval(p)}},[n]),E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-2 mt-5",children:[E.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-2 w-full",children:[E.jsxs("button",{onClick:()=>e("files"),className:`w-full md:w-auto flex flex-row gap-2 ${i==="files"?"bg-quaternary":"bg-primary"} ${eT.button}`,children:[E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"})}),s("library.files")]}),!t&&E.jsxs("button",{onClick:()=>e("collections"),className:`w-full md:w-auto flex flex-row gap-2 ${i==="collections"?"bg-quaternary":"bg-primary"} ${eT.button}`,children:[E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),s("library.collections")]}),i==="collections"&&E.jsxs(Yt,{onPress:()=>r(!0),className:"flex flex-row gap-2 ml-auto mr-0",children:[E.jsx(TS,{className:"size-4"}),s("library.createCollection")]})]}),E.jsx("div",{className:"w-full md:w-auto",children:c.add_file&&E.jsx(Yt,{onPress:async()=>{m(!0)},className:"w-full md:w-[12rem]",disabled:o&&o.remaining&&o.remaining.length>0,children:(h==null?void 0:h.type)==="book"?"Upload book":"Create series"})}),E.jsx("div",{className:"w-full md:w-auto",children:c.add_file&&E.jsx(Yt,{onPress:async()=>{a(n),await new Promise(p=>setTimeout(p,100)),l(n)},className:"w-full md:w-[12rem]",disabled:o&&o.remaining&&o.remaining.length>0,children:o&&o.remaining&&o.remaining.length>0?s("library.scanInProgress"):s("library.scan")})})]}),(h==null?void 0:h.type)==="manga"&&c.add_file&&f&&E.jsx(l6,{isOpen:f,onClose:()=>m(!1)}),(h==null?void 0:h.type)==="book"&&c.add_file&&f&&E.jsx(V5,{libraryId:n,isOpen:f,onClose:()=>m(!1)})]})}const eT={button:"text-white px-5 py-3 rounded-xl font-semibold hover:cursor-pointer"};function tT({filter:i,setFilter:e,filterBy:t,setFilterBy:r,placeholder:n,collection:s}){return E.jsxs("div",{className:"flex flex-row mt-5",children:[!s&&E.jsxs("select",{value:t,onChange:a=>{e(""),r(a.target.value)},className:"flex-shrink-1 border border-gray-400 border-r-0 rounded-md rounded-r-none p-3 bg-tertiary text-white",children:[E.jsx("option",{value:"title",children:"Title"}),E.jsx("option",{value:"author",children:"Author"}),E.jsx("option",{value:"genre",children:"Genre"})]}),E.jsx("input",{placeholder:n,className:c6.input,value:i,onChange:a=>e(a.target.value)})]})}const c6={input:"border border-gray-400 rounded-md rounded-l-none p-3 w-full bg-input text-white"},G5=async(i,e,t,r)=>{const n=await Dl(),s=r?r.replace(/[/:?&]/g,"_"):"default";try{if(i==="book"){const a=await Gi(n,String(hr.AppLocalData),s,"books",`${e}`,"files","cover.webp");return await ex(a,{baseDir:hr.AppLocalData})?lg(a):null}else if(i==="manga"){const a=await Gi(n,String(hr.AppLocalData),s,"series",String(e),"cover.webp");return await ex(a,{baseDir:hr.AppLocalData})?lg(a):null}else{const a=await Gi(n,String(hr.AppLocalData),s,"series",String(e),"files",`${t}.jpg`);return await ex(a,{baseDir:hr.AppLocalData})?lg(a):null}}catch(a){return console.error("Error creating directory",a),null}},Xc=class Xc{constructor(){it(this,"cache",new Map);it(this,"loadingStates",new Map);it(this,"imagePool",new Set);it(this,"maxCacheSize",500);it(this,"maxImagePoolSize",50);setInterval(()=>this.cleanupCache(),5*60*1e3)}static getInstance(){return Xc.instance||(Xc.instance=new Xc),Xc.instance}generateCacheKey(e,t,r){return`${t}-${e}-${r||"local"}`}getCachedImage(e){const t=this.cache.get(e);return t?(t.lastAccessed=Date.now(),t.accessCount++,t.url):null}getOrCreateImage(){if(this.imagePool.size>0){const t=this.imagePool.values().next().value;return this.imagePool.delete(t),t}const e=new Image;return e.crossOrigin="anonymous",e.decoding="async",e}returnImageToPool(e){this.imagePool.size<this.maxImagePoolSize&&(e.src="",e.onload=null,e.onerror=null,this.imagePool.add(e))}async loadImage(e,t,r={}){const n=this.getCachedImage(t);if(n)return n;const s=this.loadingStates.get(t);if(s)return s.promise;const a=new AbortController,o=this.performImageLoad(e,t,a,r);this.loadingStates.set(t,{promise:o,abortController:a});try{return await o}finally{this.loadingStates.delete(t)}}async performImageLoad(e,t,r,n){return new Promise(s=>{const a=this.getOrCreateImage(),o=n.timeout||1e4,l=()=>{clearTimeout(c),this.returnImageToPool(a)},c=setTimeout(()=>{l(),s(null)},o);a.onload=()=>{this.setCacheEntry(t,e),l(),s(e)},a.onerror=()=>{l(),s(null)},r.signal.addEventListener("abort",()=>{l(),s(null)}),"fetchPriority"in a&&n.priority&&(a.fetchPriority=n.priority),a.src=e})}setCacheEntry(e,t){this.cache.size>=this.maxCacheSize&&this.evictLeastUsed(),this.cache.set(e,{url:t,timestamp:Date.now(),accessCount:1,lastAccessed:Date.now()})}evictLeastUsed(){let e="",t=1/0;for(const[r,n]of this.cache.entries()){const s=Math.max(0,Date.now()-n.lastAccessed)/1e3,a=n.accessCount-s/3600;a<t&&(t=a,e=r)}e&&this.cache.delete(e)}cleanupCache(){const e=Date.now(),t=30*60*1e3;for(const[r,n]of this.cache.entries())e-n.lastAccessed>t&&this.cache.delete(r)}cancelLoad(e){const t=this.loadingStates.get(e);t&&(t.abortController.abort(),this.loadingStates.delete(e))}clearCache(){this.cache.clear();for(const[e,t]of this.loadingStates.entries())t.abortController.abort();this.loadingStates.clear()}getCacheStats(){return{size:this.cache.size,loadingCount:this.loadingStates.size,poolSize:this.imagePool.size}}async preloadImages(e,t,r={}){const{batchSize:n=10,delayMs:s=100}=r;for(let a=0;a<e.length;a+=n){const o=e.slice(a,a+n),l=t.slice(a,a+n),c=o.map((h,f)=>this.loadImage(h,l[f],{priority:"low",timeout:5e3}));await Promise.allSettled(c),a+n<e.length&&await new Promise(h=>setTimeout(h,s))}}};it(Xc,"instance");let N_=Xc;const Ua=N_.getInstance();function Pw({type:i,entity:e,libraryId:t,offline:r=!1,fallbackUrl:n}){const[s,a]=T.useState(null),[o,l]=T.useState(!0),[c,h]=T.useState(null),f=T.useRef(!0),m=T.useRef(null),{server:p}=Ln(Dt(_=>({server:_.server}))),x=T.useMemo(()=>{const _=r?i==="book"?e.file_id:e.series_id:e.id;return Ua.generateCacheKey(_,i,t)},[i,e,t,r]),g=T.useMemo(()=>!p||!t||r?null:i==="file"?`${p}/preview-image/${t}/${e.series_id}/${e.id}.jpg`:`${p}/cover-image/${t}/${e.id}.webp`,[p,t,e.id,r]),y=T.useCallback(async()=>{if(!e||!f.current)return;if((r?i==="book"?e.file_id:e.series_id:e.id)<=0){l(!1),a(n||"");return}if(!r&&(!p||!t)){l(!0);return}const S=Ua.getCachedImage(x);if(S){f.current&&(a(S),l(!1),h(null));return}l(!0),h(null),m.current=x;try{let k=null;if(r){const C=i==="book"?e.file_id:e.series_id,R=i==="manga"||i==="file"?e.file_id:void 0,N=e.server;k=await G5(i,C,R,N),k&&Ua.setCacheEntry(x,k)}else g&&(k=await Ua.loadImage(g,x,{timeout:1e4,priority:"high"}));if(!f.current||m.current!==x)return;k?(a(k),l(!1),h(null)):(a(n||""),h(r?"Local image not found":"Failed to load image"),l(!1))}catch(k){if(!f.current||m.current!==x)return;h(k instanceof Error?k.message:"Failed to load image"),a(n||""),l(!1)}},[x,i,e,r,g,n,p,t]),b=T.useCallback(()=>{m.current&&Ua.cancelLoad(m.current),y()},[y]);return T.useEffect(()=>(f.current=!0,y(),()=>{f.current=!1,m.current&&Ua.cancelLoad(m.current)}),[y]),{imagePath:s,isLoading:o,error:c,retry:b}}const RS=T.memo(function({entity:e,offline:t}){const{libraryData:r}=Xr(Dt(f=>({libraryData:f.libraryData}))),n=Br(),s=T.useRef(null),{imagePath:a,isLoading:o}=Pw({type:(r==null?void 0:r.type)||"book",entity:e,libraryId:r==null?void 0:r.id,offline:t});T.useEffect(()=>{if(a&&s.current){const f=s.current;f.src!==a&&(f.src=a);const m=new Image;m.src=a,m.onload=()=>{f.src===a&&f.complete&&(f.style.opacity="1")}}},[a]);const l=T.useCallback(()=>{if(!r)return;const f=r.type==="manga"?`/manga/${t?e.series_id:e.id}${t?`?isLocal=true&server=${e.server}`:""}`:`/book/${t?e.file_id:e.id}${t?`?isLocal=true&server=${e.server}`:""}`;n(f)},[r,e.id,t,n]),c=T.useMemo(()=>{var f,m,p;if((r==null?void 0:r.type)==="book"){const x=e;return(m=(f=x.metadata)==null?void 0:f.epub)!=null&&m.title&&x.metadata.epub.title.length>0?x.metadata.epub.title:((p=x.metadata)==null?void 0:p.original_title)||x.title}else{const x=e;if(x.manga_data.titles){const g=x.manga_data.titles.find(y=>y.type==="English");if(g)return g.title}return x.title}},[r,e]),h=T.useMemo(()=>(r==null?void 0:r.type)==="book"&&e.is_read,[r,e]);return!r||o?E.jsxs("div",{className:"bg-primary text-white rounded-xl flex flex-col h-full animate-pulse",children:[E.jsx("div",{className:"h-[16rem] bg-gray-300 rounded-t-xl"}),E.jsx("div",{className:"text-sm p-3 flex-1 flex items-center justify-center",children:E.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"})})]}):E.jsxs("button",{className:"bg-primary text-white rounded-xl flex flex-col hover:cursor-pointer h-full transition-transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":c,onClick:l,style:{contain:"layout style paint"},children:[E.jsxs("div",{className:"h-[16rem] w-full relative overflow-hidden",children:[E.jsx("img",{ref:s,src:a||"",alt:e.title,className:"w-full h-full object-cover rounded-t-xl",style:{willChange:"auto",opacity:a?"1":"0",transition:"opacity 0.2s ease-in-out"},onLoad:f=>{const m=f.currentTarget;m.style.opacity="1"},onError:f=>{const m=f.currentTarget;a&&m.src!==a&&setTimeout(()=>{m.src=a},100)}}),e.rating&&e.rating>0&&E.jsx("div",{className:"absolute bottom-1 left-1 flex flex-row items-center gap-2 bg-black/50 rounded-full p-1",children:Array.from({length:e.rating||0}).map((f,m)=>E.jsx(W5,{className:`w-4 h-4 ${m<(e.rating||0)?"text-yellow-500":"text-gray-500"}`},m))}),h&&E.jsx("div",{className:"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]}),E.jsx("div",{className:"text-sm w-full p-3 flex-1 flex items-center justify-center",children:E.jsx("span",{className:"line-clamp-3 text-center leading-relaxed",children:c})})]})},(i,e)=>i.entity.id===e.entity.id&&i.entity.title===e.entity.title&&i.offline===e.offline&&i.entity.is_read===e.entity.is_read),d6=T.memo(function({entity:e,isLandscape:t,offline:r}){var a,o,l;const n=Br(),{library:s}=vn();return s?E.jsxs("tr",{className:"hover:cursor-pointer",onClick:()=>{n(`/book/${s==null?void 0:s.id}/${e.id}`)},children:[E.jsx("td",{className:"p-3",children:E.jsxs("div",{className:"flex flex-row items-center gap-2",children:[s.type==="book"?E.jsx(E.Fragment,{children:e.metadata.epub&&e.metadata.epub.title&&e.metadata.epub.title.length>0?e.metadata.epub.title:e.metadata.original_title}):E.jsx(E.Fragment,{}),s.type==="book"&&e.is_read&&E.jsx("div",{className:"bg-black/50 text-white p-1 rounded-full",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-4",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]})}),t?E.jsx(E.Fragment,{children:s.type==="book"?E.jsxs(E.Fragment,{children:[E.jsx("td",{className:"p-3",children:(a=e.metadata.authors)==null?void 0:a.join(", ")}),E.jsx("td",{className:"p-3",children:(o=e.metadata.genres)==null?void 0:o.join(", ")}),E.jsx("td",{className:"p-3",children:(l=e.metadata.publishers)==null?void 0:l.join(", ")}),E.jsx("td",{className:"p-3",children:e.metadata.publish_date})]}):E.jsx(E.Fragment,{})}):null,E.jsx("td",{className:"p-3 text-right",children:E.jsx("button",{className:"bg-secondary px-2 py-1 rounded-lg text-sm text-white hover:cursor-pointer",onClick:()=>{if(!s)return;const c=s.type==="manga"?`/manga/${r?e.series_id:e.id}${r?`?isLocal=true&server=${e.server}`:""}`:`/book/${r?e.file_id:e.id}${r?`?isLocal=true&server=${e.server}`:""}`;n(c)},children:"View"})})]},e.id):null});function h6({series:i,isLandscape:e,offline:t}){const{t:r}=ir();return E.jsxs("table",{className:"w-full text-sm [&>tbody>*:nth-child(odd)]:bg-input [&>tbody>*:nth-child(even)]:bg-primary text-white rounded-lg overflow-hidden",children:[E.jsx("thead",{children:E.jsxs("tr",{className:"bg-primary text-left",children:[E.jsx("th",{className:"p-3",children:r("library.tableHeaders.title")}),e?E.jsxs(E.Fragment,{children:[E.jsx("th",{className:"p-3",children:r("library.tableHeaders.authors")}),E.jsx("th",{className:"p-3",children:r("library.tableHeaders.genres")}),E.jsx("th",{className:"p-3",children:r("library.tableHeaders.publishers")}),E.jsx("th",{className:"p-3",children:r("library.tableHeaders.publishDate")})]}):null,E.jsx("th",{className:"p-3 text-right",children:" "})]})}),E.jsx("tbody",{children:i.map(n=>E.jsx(d6,{entity:n,isLandscape:e,offline:t},n.id))})]})}function f6({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const q5=T.forwardRef(f6);function p6({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"}))}const m6=T.forwardRef(p6);function g6({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const v6=T.forwardRef(g6);function y6({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5"}))}const b6=T.forwardRef(y6);function w6({title:i,titleId:e,...t},r){return T.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),i?T.createElement("title",{id:e},i):null,T.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const x6=T.forwardRef(w6),c0=fh()(ph(i=>({libraryViewMode:"grid",setLibraryViewMode:e=>i({libraryViewMode:e}),bookTheme:"light",setBookTheme:e=>i({bookTheme:e}),bookCustomBackground:"#9FA172",setBookCustomBackground:e=>i({bookCustomBackground:e}),bookCustomForeground:"#ffffff",setBookCustomForeground:e=>i({bookCustomForeground:e}),bookCustomFontSize:100,setBookCustomFontSize:e=>i({bookCustomFontSize:e}),bookCustomFontFamily:"Lexend",setBookCustomFontFamily:e=>i({bookCustomFontFamily:e}),libraryPosition:0,setLibraryPosition:e=>i({libraryPosition:e}),libraryOfflinePosition:0,setLibraryOfflinePosition:e=>i({libraryOfflinePosition:e}),mangaDirection:"ltr",setMangaDirection:e=>i({mangaDirection:e}),mangaViewMode:"single",setMangaViewMode:e=>i({mangaViewMode:e}),mangaFitMode:"contain",setMangaFitMode:e=>i({mangaFitMode:e}),hasHydrated:!1,setHasHydrated:e=>i({hasHydrated:e})}),{name:"ui-storage",storage:dc(()=>localStorage),onRehydrateStorage:i=>()=>i.setHasHydrated(!0),partialize:i=>({libraryViewMode:i.libraryViewMode,bookTheme:i.bookTheme,bookCustomBackground:i.bookCustomBackground,bookCustomForeground:i.bookCustomForeground,bookCustomFontSize:i.bookCustomFontSize,bookCustomFontFamily:i.bookCustomFontFamily,libraryPosition:i.libraryPosition,libraryOfflinePosition:i.libraryOfflinePosition,mangaDirection:i.mangaDirection,mangaViewMode:i.mangaViewMode,mangaFitMode:i.mangaFitMode})}));function _6(){const{t:i}=ir(),{libraryViewMode:e,setLibraryViewMode:t}=c0(Dt(r=>({libraryViewMode:r.libraryViewMode,setLibraryViewMode:r.setLibraryViewMode})));return E.jsxs("div",{className:"mt-5 flex flex-row gap-3 justify-end",children:[E.jsxs("button",{className:`${e==="grid"?"bg-quaternary":"bg-primary"} px-3 py-1 rounded-lg text-xs text-white flex flex-row items-center gap-2 hover:cursor-pointer`,onClick:()=>t("grid"),children:[E.jsx(m6,{className:"size-4"}),i("library.viewMode.grid")]}),E.jsxs("button",{className:`${e==="table"?"bg-quaternary":"bg-primary"} px-3 py-1 rounded-lg text-xs text-white flex flex-row items-center gap-2 hover:cursor-pointer`,onClick:()=>t("table"),children:[E.jsx(b6,{className:"size-4"}),i("library.viewMode.table")]})]})}function E6({collection:i}){const e=Br(),{server:t}=Ln(Dt(n=>({server:n.server}))),{libraryData:r}=Xr(Dt(n=>({libraryData:n.libraryData})));return E.jsxs("button",{className:"bg-primary text-white rounded-xl hover:cursor-pointer flex flex-col items-center justify-start",onClick:()=>{e(`/collection/${i.id}`)},children:[E.jsx("div",{className:"h-[16rem] w-full relative overflow-hidden",children:i.series.length>0&&E.jsx("img",{src:`${t}/cover-image/${r.id}/${i.series[0]}.webp`,alt:i.name,className:"w-full h-full object-cover rounded-t-xl"})}),E.jsx("div",{className:"text-sm p-3 text-center",children:i.name})]},i.id)}function S6({items:i,server:e,libraryId:t,startIndex:r=0,endIndex:n,offline:s=!1}){const a=T.useRef(new Set),o=T.useRef([]),l=T.useRef(null),c=T.useCallback((h,f="medium")=>{if(a.current.has(h))return;a.current.add(h);const m=new Image;m.crossOrigin="anonymous",m.decoding="async";const p={img:m,url:h};m.onload=()=>{const x=o.current.findIndex(g=>g.url===h);x>-1&&o.current.splice(x,1),m.onload=null,m.onerror=null},m.onerror=()=>{a.current.delete(h);const x=o.current.findIndex(g=>g.url===h);x>-1&&o.current.splice(x,1),m.onload=null,m.onerror=null},o.current.push(p),f==="high"?m.src=h:"requestIdleCallback"in window?l.current=requestIdleCallback(()=>{m.src=h},{timeout:f==="medium"?1e3:5e3}):setTimeout(()=>{m.src=h},f==="medium"?100:500)},[]);return T.useEffect(()=>{if(s||!e||!t)return;const h=n||i.length,f=i.slice(r,h);l.current&&cancelIdleCallback(l.current),o.current.forEach(g=>{g.img.src="",g.img.onload=null,g.img.onerror=null}),o.current=[],f.forEach(g=>{const y=`${e}/cover-image/${t}/${g.id}.webp`;c(y,"high")});const m=Math.max(0,r-20),p=Math.min(i.length,h+20);return i.slice(m,p).forEach(g=>{const y=`${e}/cover-image/${t}/${g.id}.webp`;a.current.has(y)||c(y,"medium")}),()=>{l.current&&cancelIdleCallback(l.current),o.current.forEach(g=>{g.img.src="",g.img.onload=null,g.img.onerror=null}),o.current=[]}},[i,e,t,r,n,s,c]),{preloadedCount:a.current.size,isPreloading:o.current.length>0}}const A6=st.memo(function({items:e,columnCount:t,offline:r}){return E.jsx("div",{className:"grid gap-5 px-1 w-full virtual-grid-row",style:{gridTemplateColumns:`repeat(${t}, minmax(0, 1fr))`,marginBottom:"16px"},children:e.map(n=>E.jsx(RS,{entity:n,offline:r},n.id))})});function C6({items:i,offline:e=!1}){const t=T.useRef(null),[r,n]=T.useState(()=>{const g=window.innerWidth;return g>=1536?8:g>=1024?6:g>=768?4:1}),s=T.useRef(new Map),{server:a}=Ln(Dt(g=>({server:g.server}))),{library:o}=vn(),l=T.useCallback(()=>{const g=window.innerWidth;let y=1;g>=1536?y=8:g>=1024?y=6:g>=768&&(y=4),y!==r&&(n(y),s.current.clear())},[r]);T.useEffect(()=>{l();const g=()=>{l()};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[l]);const c=T.useMemo(()=>{const g=[];for(let y=0;y<i.length;y+=r)g.push(i.slice(y,y+r));return g},[i,r]),h=T.useCallback(g=>{const y=s.current.get(g);if(y)return y;const b=300,_=c[g];if(!(_!=null&&_.length))return b;const S=_.reduce((C,R)=>{var O;const N=((O=R.title)==null?void 0:O.length)||0;return N>100?C+40:N>50?C+20:C},0),k=b+S;return s.current.set(g,k),k},[c]),f=u5({count:c.length,getScrollElement:()=>t.current,estimateSize:h,overscan:3,measureElement:g=>{const y=g.getBoundingClientRect().height,b=parseInt(g.getAttribute("data-index")||"0",10);return s.current.set(b,y),y}}),m=f.getVirtualItems(),{visibleStartIndex:p,visibleEndIndex:x}=T.useMemo(()=>{var b,_;const g=((b=m[0])==null?void 0:b.index)||0,y=((_=m[m.length-1])==null?void 0:_.index)||0;return{visibleStartIndex:Math.max(0,g*r-r*3),visibleEndIndex:Math.min(i.length,(y+1)*r+r*3)}},[m,r,i.length]);return S6({items:i,server:a||"",libraryId:(o==null?void 0:o.id)||0,startIndex:p,endIndex:x,offline:e}),E.jsx("div",{ref:t,className:"w-full virtual-container scroll-container",style:{height:"calc(100vh - 200px)",overflow:"auto",paddingBottom:"6rem"},children:E.jsx("div",{style:{height:`${f.getTotalSize()}px`,width:"100%",position:"relative"},className:"virtual-container",children:f.getVirtualItems().map(g=>{const y=c[g.index];return y?E.jsx("div",{"data-index":g.index,ref:f.measureElement,className:"virtual-item virtual-grid-row",style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${g.start}px)`},children:E.jsx(A6,{items:y,columnCount:r,offline:e})},g.key):null})})})}const k6=st.memo(function({entity:e,isLandscape:t,isEven:r,offline:n}){var c,h,f,m,p,x,g,y,b,_;const s=Br(),{libraryData:a}=Xr(Dt(S=>({libraryData:S.libraryData}))),o=T.useCallback(()=>{if(!a)return;const S=a.type==="manga"?`/manga/${n?e.series_id:e.id}${n?`?isLocal=true&server=${e.server}`:""}`:`/book/${n?e.file_id:e.id}${n?`?isLocal=true&server=${e.server}`:""}`;s(S)},[a,e.id,s]),l=T.useCallback(S=>{S.stopPropagation(),o()},[o]);return a?E.jsxs("div",{className:`flex items-center p-3 cursor-pointer hover:bg-opacity-80 virtual-table-row ${r?"bg-primary":"bg-input"} text-white text-sm`,onClick:o,style:{minHeight:"60px",marginBottom:"10px"},children:[E.jsxs("div",{className:"flex-1 flex items-center gap-2 min-w-0",children:[E.jsx("span",{className:"truncate",children:a.type==="book"?E.jsx(E.Fragment,{children:(h=(c=e.metadata)==null?void 0:c.epub)!=null&&h.title&&e.metadata.epub.title.length>0?e.metadata.epub.title:((f=e.metadata)==null?void 0:f.original_title)||e.title}):e.title}),a.type==="book"&&e.is_read&&E.jsx("div",{className:"bg-black/50 text-white p-1 rounded-full flex-shrink-0",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]}),t&&a.type==="book"&&E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"flex-1 px-3 min-w-0",children:E.jsx("span",{className:"truncate block",children:((p=(m=e.metadata)==null?void 0:m.authors)==null?void 0:p.join(", "))||""})}),E.jsx("div",{className:"flex-1 px-3 min-w-0",children:E.jsx("span",{className:"truncate block",children:((g=(x=e.metadata)==null?void 0:x.genres)==null?void 0:g.join(", "))||""})}),E.jsx("div",{className:"flex-1 px-3 min-w-0",children:E.jsx("span",{className:"truncate block",children:((b=(y=e.metadata)==null?void 0:y.publishers)==null?void 0:b.join(", "))||""})}),E.jsx("div",{className:"flex-1 px-3 min-w-0",children:E.jsx("span",{className:"truncate block",children:((_=e.metadata)==null?void 0:_.publish_date)||""})})]}),E.jsx("div",{className:"w-20 flex justify-end",children:E.jsx("button",{className:"bg-secondary px-2 py-1 rounded-lg text-sm text-white hover:bg-opacity-80 hover:cursor-pointer transition-colors",onClick:l,children:"View"})})]}):null});function T6({series:i,isLandscape:e,offline:t}){const{t:r}=ir(),n=T.useRef(null),s=T.useRef(new Map),a=T.useCallback(c=>{var x,g,y;const h=s.current.get(c);if(h)return h;const f=i[c];if(!f)return 60;let m=60;const p=((x=f.title)==null?void 0:x.length)||0;return p>50&&(m+=20),p>100&&(m+=20),e&&(y=(g=f.metadata)==null?void 0:g.authors)!=null&&y.some(_=>(typeof _=="string"?_:_.name||"").length>30)&&(m+=20),s.current.set(c,m),m},[i,e]),o=u5({count:i.length,getScrollElement:()=>n.current,estimateSize:a,overscan:8,measureElement:c=>{const h=c.getBoundingClientRect().height,f=parseInt(c.getAttribute("data-index")||"0",10);return s.current.set(f,h),h}}),l=T.useMemo(()=>{const c=[{key:"title",label:r("library.tableHeaders.title")}];return e&&c.push({key:"authors",label:r("library.tableHeaders.authors")},{key:"genres",label:r("library.tableHeaders.genres")},{key:"publishers",label:r("library.tableHeaders.publishers")},{key:"publishDate",label:r("library.tableHeaders.publishDate")}),c.push({key:"actions",label:""}),c},[e,r]);return E.jsxs("div",{className:"w-full",children:[E.jsx("div",{className:"bg-primary text-white text-sm sticky top-0 z-10 rounded-t-lg",children:E.jsxs("div",{className:"flex items-center p-3",children:[E.jsx("div",{className:"flex-1",children:l[0].label}),e&&l.slice(1,-1).map(c=>E.jsx("div",{className:"flex-1 px-3",children:c.label},c.key)),E.jsx("div",{className:"w-20 text-right",children:l[l.length-1].label})]})}),E.jsx("div",{ref:n,className:"w-full virtual-container scroll-container",style:{height:"calc(100vh - 300px)",overflow:"auto",paddingBottom:"6rem"},children:E.jsx("div",{style:{height:`${o.getTotalSize()}px`,width:"100%",position:"relative"},className:"virtual-container",children:o.getVirtualItems().map(c=>{const h=i[c.index];return h?E.jsx("div",{"data-index":c.index,ref:o.measureElement,className:"virtual-item virtual-table-row",style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${c.start}px)`},children:E.jsx(k6,{entity:h,isLandscape:e,isEven:c.index%2===0,offline:t})},c.key):null})})})]})}const R6=T.memo(({isOpen:i,onClose:e,onSubmit:t,libraryId:r})=>{const{t:n}=ir(),[s,a]=T.useState(!1),[o,l]=T.useState(null),[c,h]=T.useState({title:"",libraryId:r}),f=T.useCallback(async()=>{if(!c.title||c.title.length===0){l(n("library.collectionValidation"));return}if(!s){a(!0),l(null);try{await t(c)&&(h({title:"",libraryId:r}),l(null),a(!1),e())}catch(m){l(m instanceof Error?m.message:"An error occurred")}finally{a(!1)}}},[c,r,t,e,n]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:n("library.createCollection")}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"name",className:"font-semibold",children:n("libraries.name")}),E.jsx("input",{type:"text",id:"name",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:c.title,onChange:m=>h({...c,title:m.target.value})})]}),o&&E.jsx("div",{className:"mb-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:o}),E.jsx("div",{children:E.jsx("button",{className:`bg-secondary hover:bg-tertiary text-white w-full p-3 rounded-md font-semibold hover:cursor-pointer ${s?"opacity-50":""}`,disabled:s,onClick:f,children:n("library.createCollection")})})]})})})})});function Y5(i,e){const[t,r]=T.useState(""),[n,s]=T.useState("title"),{searchFields:a,minCharacters:o=3,caseSensitive:l=!1}=e,c=T.useMemo(()=>{if(!i||i.length===0)return[];if(t.length<o)return[...i];const f=l?t:t.toLowerCase();return i.filter(m=>{let p;if(n==="title")p=m.title||"";else if(n==="author"){const g=a.find(y=>typeof y=="function");g&&typeof g=="function"?p=g(m):p=""}else if(n==="genre"){const g=a[2];g&&typeof g=="function"?p=g(m):p=""}else return a.some(g=>{let y;return typeof g=="function"?y=g(m):y=m[g]||"",Array.isArray(y)?y.some(_=>{const S=typeof _=="string"?_:typeof _=="object"&&_!==null&&"name"in _&&_.name||"";return(l?S:S.toLowerCase()).includes(f)}):(l?y:y.toLowerCase()).includes(f)});return Array.isArray(p)?p.some(g=>{const y=typeof g=="string"?g:typeof g=="object"&&g!==null&&"name"in g&&g.name||"";return(l?y:y.toLowerCase()).includes(f)}):(l?p:p.toLowerCase()).includes(f)})},[i,t,n,a,o,l]),h=T.useCallback(()=>{r("")},[]);return{filter:t,setFilter:r,filterBy:n,setFilterBy:s,filteredItems:c,clearFilter:h}}const D_=fh()(ph(i=>({currentQueue:[],setCurrentQueue:e=>i({currentQueue:e}),processing:!1,setProcessing:e=>i({processing:e}),hasHydrated:!1,setHasHydrated:e=>i({hasHydrated:e})}),{name:"import-storage",storage:dc(()=>localStorage),onRehydrateStorage:i=>()=>i.setHasHydrated(!0),partialize:i=>({currentQueue:i.currentQueue,processing:i.processing})})),N6=2;function NS(){const{setCurrentQueue:i,setProcessing:e,currentQueue:t,processing:r}=D_(Dt(b=>({setCurrentQueue:b.setCurrentQueue,setProcessing:b.setProcessing,currentQueue:b.currentQueue,processing:b.processing}))),{libraryData:n}=Xr(Dt(b=>({libraryData:b.libraryData}))),{server:s}=Ln(Dt(b=>({server:b.server}))),a=async()=>{if(r)return;e(!0),console.info("Processing queue",t);const _=t.slice(0,N6);await Promise.all(_.map(k=>o(k))),await new Promise(k=>setTimeout(k,50)),i(t.filter(k=>!_.includes(k))),await new Promise(k=>setTimeout(k,50)),D_.getState().currentQueue.length>0?(e(!1),await new Promise(k=>setTimeout(k,50)),await a()):e(!1)},o=async b=>(console.info("Processing item",b),b.type==="book"?l(b.entity,b.server):b.type==="series"?c(b.entity,b.server):b.type==="file"?h(b.entity,b.server):!1),l=async(b,_)=>{console.info("Processing book",b);try{const S=await nr.select("SELECT * FROM BookFile WHERE file_id = ? AND server = ?",[b.id,_]);if(S&&S.length>0)return!0;console.info("Inserting book",b),console.info([b.id,b.title,b.path,b.file_name,b.file_format,b.total_pages,"0",b.is_read,n==null?void 0:n.id,JSON.stringify(b.metadata),_]),await nr.execute("INSERT INTO BookFile (file_id, title, path, file_name, file_format, total_pages, current_page, is_read, library_id, metadata, server) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",[b.id,b.title,b.path,b.file_name,b.file_format,b.total_pages,"0",b.is_read,n==null?void 0:n.id,JSON.stringify(b.metadata),_]);const k=await Dl(),C=_.replace(/[/:?&]/g,"_");await f("book",b.id);const R=await Gi(k,String(hr.AppLocalData),C,"books",String(b.id),"files",b.file_name);return await fi("download_file",{url:`${_}/stream/${n==null?void 0:n.id}/${b.id}`,path:R}),await p("book",n==null?void 0:n.id,b.id),console.info("processed book",b),!0}catch(S){return console.error("Error processing book",S),!1}},c=async(b,_)=>{console.info("Processing series",b,_)},h=async(b,_)=>{console.info("Attempting to process manga file",b);try{console.info("Checking if file exists",b.id,_);const S=await nr.select("SELECT * FROM MangaFile WHERE file_id = ? AND server = ?",[b.id,_]);if(S&&S.length>0)return console.info("File already exists",S),!0;console.info("Inserting file",b),await nr.execute("INSERT INTO MangaFile (file_id, path, file_name, file_format, volume, chapter, total_pages, current_page, is_read, series_id, metadata, server) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",[b.id,b.path,b.file_name,b.file_format,b.volume,b.chapter,b.total_pages,b.current_page??0,b.is_read,b.series_id,JSON.stringify(b.metadata),_]);const k=await Dl(),C=_.replace(/[/:?&]/g,"_"),R=await Gi(k,String(hr.AppLocalData),C,"series",String(b.series_id),"files",b.file_name);await fi("download_file",{url:`${_}/stream/${n==null?void 0:n.id}/${b.id}`,path:R});const N=await Gi(k,String(hr.AppLocalData),C,"series",String(b.series_id),"files",`${b.id}.jpg`);return await fi("download_file",{url:`${_}/preview-image/${n==null?void 0:n.id}/${b.series_id}/${b.id}.jpg`,path:N}),!0}catch(S){return console.error("Error processing file",S),!1}},f=async(b,_)=>{const S=s.replace(/[/:?&]/g,"_");let k=null;if(b==="series"?k=`${hr.AppLocalData}/${S}/series/${_}/files`:b==="book"&&(k=`${hr.AppLocalData}/${S}/books/${_}/files`),!k)return!1;try{await B5(k,{baseDir:hr.AppLocalData,recursive:!0})}catch(C){console.error("mkdir",C)}},m=T.useCallback(async(b,_,S)=>{try{if(!n)return!1;if(console.info("Adding to queue",n.id,b,_,S),b==="file"&&S){const k={type:"file",entity:_,series:S,server:s};i([...t,k])}else if(b==="book"&&_){const k={type:"book",entity:_,server:s};i([...t,k])}return!0}catch(k){return console.error("Error adding to queue",k),!1}},[t,n,s,i]),p=async(b,_,S)=>{let k=null;try{const C=await Dl(),R=s.replace(/[/:?&]/g,"_");return b==="book"?k=await Gi(C,String(hr.AppLocalData),R,"books",String(S),"files","cover.webp"):k=await Gi(C,String(hr.AppLocalData),R,"series",String(S),"cover.webp"),k?(await fi("download_file",{url:`${s}/cover-image/${_}/${S}.webp`,path:k}),!0):!1}catch(C){return console.error("Error downloading cover image",C),!1}};return{addToQueue:m,processQueue:a,removeBook:async(b,_)=>{try{const S=_.replace(/[/:?&]/g,"_");await nr.execute("DELETE FROM BookFile WHERE file_id = ? AND server = ?",[b,_]);try{await Um(`${hr.AppLocalData}/${S}/books/${b}`,{baseDir:hr.AppLocalData,recursive:!0})}catch(k){console.error("Error removing folder",k)}return!0}catch(S){return console.error("Error removing database entry",S),!1}},removeSeries:async(b,_)=>{try{const S=_.replace(/[/:?&]/g,"_"),k=await nr.select("SELECT * FROM MangaSeries WHERE series_id = ? AND server = ?",[b,_]);if(!k||k.length===0)return!1;await nr.execute("DELETE FROM MangaSeries WHERE series_id = ? AND server = ?",[b,_]);try{await Um(`${hr.AppLocalData}/${S}/series/${b}`,{baseDir:hr.AppLocalData,recursive:!0})}catch(C){console.error("Error removing folder",C)}return await nr.execute("DELETE FROM MangaFile WHERE series_id = ? AND server = ?",[b,_]),!0}catch(S){return console.error("Error removing database entry",S),!1}},removeFile:async(b,_)=>{try{const S=_.replace(/[/:?&]/g,"_"),k=await nr.select("SELECT * FROM MangaFile WHERE file_id = ? AND server = ?",[b,_]);if(!k||k.length===0)return!1;await nr.execute("DELETE FROM MangaFile WHERE file_id = ? AND server = ?",[b,_]);try{await Um(`${hr.AppLocalData}/${S}/series/${k[0].series_id}/files/${k[0].file_name}`,{baseDir:hr.AppLocalData})}catch(C){console.error("Error removing folder",C)}try{await Um(`${hr.AppLocalData}/${S}/series/${k[0].series_id}/files/${k[0].file_name}.jpg`,{baseDir:hr.AppLocalData})}catch(C){console.error("Error removing folder",C)}return!0}catch(S){return console.error("Error removing database entry",S),!1}},initializeFolder:f,downloadCoverImage:p}}function Up(){const{addToQueue:i,removeBook:e}=NS(),{makeRequest:t}=Wl(),{server:r}=Ln(Dt(k=>({server:k.server}))),{libraryData:n}=Xr(Dt(k=>({libraryData:k.libraryData}))),[s,a]=T.useState(null),[o,l]=T.useState(!1),{filter:c,setFilter:h,filterBy:f,setFilterBy:m,filteredItems:p}=Y5((n==null?void 0:n.series)||[],{searchFields:["title",k=>{var C;return((C=k.metadata)==null?void 0:C.authors)||[]},k=>{var C;return((C=k.metadata)==null?void 0:C.genres)||[]}],minCharacters:3}),x=T.useCallback(async(k,C)=>{if(C){const R=await g(k,r);return a(R),R}else{if(!n)return null;const{series:R}=await t(`/series/${n&&n.id}/${k}`,"GET",null,!0);if(!R)throw a(null),new Error("Failed to fetch book");return a(R),R}},[n]),g=T.useCallback(async(k,C)=>{const R=await nr.select("SELECT * FROM BookFile WHERE file_id = ? AND server = ?",[k,C]);if(R&&R.length>0){const N={...R[0],metadata:JSON.parse(R[0].metadata)};return a(N),N}else return null},[nr]);return{book:s,offlineAvailability:o,setOfflineAvailability:l,retrieveBook:x,retrieveLocalBook:g,filteredBookSeries:p,filterBook:c,filterBookBy:f,setFilterBook:h,setFilterBookBy:m,searchGoogleMetadata:async k=>{try{return(await(await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(k)}&printType=books&maxResults=25`)).json()).items}catch(C){return console.error(C),null}},selectGoogleResult:async(k,C)=>{var N,O,I;return{original_title:C.volumeInfo.title,epub:k.epub,title:C.volumeInfo.title||null,isbn_10:((N=C.volumeInfo.industryIdentifiers.find(F=>F.type==="ISBN_10"))==null?void 0:N.identifier)||null,isbn_13:((O=C.volumeInfo.industryIdentifiers.find(F=>F.type==="ISBN_13"))==null?void 0:O.identifier)||null,publish_date:C.volumeInfo.publishedDate,oclc_numbers:[],work_key:null,key:null,dewey_decimal_class:C.volumeInfo.dewey_decimal_class||null,description:C.volumeInfo.description||"No description available",authors:C.volumeInfo.authors||[],genres:C.volumeInfo.categories||[],publishers:C.volumeInfo.publishers?C.volumeInfo.publishers:C.volumeInfo.publisher?[C.volumeInfo.publisher]:[],identifiers:C.volumeInfo.industryIdentifiers||[],subtitle:C.volumeInfo.subtitle||null,number_of_pages:C.volumeInfo.pageCount||null,cover:((I=C.volumeInfo.imageLinks)==null?void 0:I.thumbnail)||null,subjects:C.volumeInfo.categories||[],provider:"google"}},makeBookAvailableOffline:async k=>{await rc("Are you sure you want to make this book available offline?",{title:"Devourer",kind:"info"})&&(await i("book",k)?wt.success("Book added to queue.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}):wt.error("Failed to add book to queue.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}))},makeBookUnavailableOffline:async k=>{await rc("Are you sure you want to remove this book from offline storage?",{title:"Devourer",kind:"warning"})&&(await e(k.id,k.server)?wt.success("Book removed from offline storage.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}):wt.error("Failed to remove book from offline storage.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}))}}}function D6(){const{server:i}=Ln(Dt(r=>({server:r.server}))),{library:e}=vn(),t=T.useCallback(async(r,n)=>{if(!i||!n||n===9999||n===9998)return;const s=[],a=[];r.forEach(o=>{const l=`${i}/cover-image/${n}/${o.id}.webp`,c=Ua.generateCacheKey(o.id,(e==null?void 0:e.type)||"book",n);Ua.getCachedImage(c)||(s.push(l),a.push(c))}),s.length>0&&await Ua.preloadImages(s,a,{batchSize:8,delayMs:200})},[i,e==null?void 0:e.type]);return T.useEffect(()=>{if(!e||!e.series||e.series.length===0)return;const r=setTimeout(()=>{t(e.series,e.id)},2e3);return()=>{clearTimeout(r)}},[e,t]),{preloadLibraryImages:t,getCacheStats:()=>Ua.getCacheStats(),clearCache:()=>Ua.clearCache()}}function Hp(){const[i,e]=T.useState(!1),[t,r]=T.useState(null),{makeRequest:n}=Wl(),{addToQueue:s,removeSeries:a,removeFile:o,initializeFolder:l,downloadCoverImage:c}=NS(),{server:h}=Ln(Dt(F=>({server:F.server}))),{libraryData:f,setFilesData:m}=Xr(Dt(F=>({libraryData:F.libraryData,setFilesData:F.setFilesData}))),{filter:p,setFilter:x,filterBy:g,setFilterBy:y,filteredItems:b}=Y5((f==null?void 0:f.series)||[],{searchFields:["title",F=>{var G;return((G=F.manga_data)==null?void 0:G.authors)||[]},F=>{var G;return((G=F.manga_data)==null?void 0:G.genres)||[]}],minCharacters:3}),_=T.useCallback(async F=>await R(F,h||"")!==null,[h]),S=T.useCallback(async(F,G)=>{if(G){const B=await N(F,h);return r(B),B}else{if(!f)return r(null),null;m(null),await new Promise(Y=>setTimeout(Y,50));const{series:B}=await n(`/series/${f&&f.id}/${F}`,"GET",null,!0);if(!B)throw m(null),r(null),new Error("Failed to fetch series");return r(B),k(F,G),B}},[f]),k=T.useCallback(async(F,G)=>{if(!G){const B=await n(`/series/${f&&f.id}/${F}/files`,"GET",null,!0);if(!B.status)throw m(null),new Error("Failed to fetch files");return m(B.files),B.files}},[f]),C=T.useCallback(async F=>{const G=await n(`/file/${f&&f.id}/${F}`,"GET",null,!0);return G.status?G.file:null},[]),R=T.useCallback(async(F,G)=>{const B=await nr.select("SELECT * FROM MangaFile WHERE file_id = ? AND server = ?",[F,G]);return B&&B.length>0?{...B[0],metadata:JSON.parse(B[0].metadata)}:null},[nr]),N=T.useCallback(async(F,G)=>{const B=await nr.select("SELECT * FROM MangaSeries WHERE series_id = ? AND server = ?",[F,G]);if(B&&B.length>0){const Y={...B[0],manga_data:JSON.parse(B[0].manga_data)},j=await nr.select("SELECT * FROM MangaFile WHERE series_id = ? AND server = ?",[F,G]);return m(j),r(Y),Y}else return null},[nr]);return{series:t,offlineAvailability:i,setOfflineAvailability:e,retrieveSeries:S,retrieveLocalSeries:N,retrieveFiles:k,retrieveFile:C,retrieveLocalFile:R,makeSeriesAvailableOffline:async(F,G)=>{if(await rc(G?"Are you sure you want to make this file available offline?":"Are you sure you want to make this series available offline?",{title:"Devourer",kind:"info"}))try{let Y=null,j=null;await l("series",F.id);const ae=await nr.select("SELECT * FROM MangaSeries WHERE series_id = ? AND server = ?",[F.id,h]);if(ae&&ae.length>0?(Y={...ae[0],manga_data:JSON.parse(ae[0].manga_data)},j=!0):(await nr.execute("INSERT INTO MangaSeries (series_id, title, path, cover, library_id, manga_data, server) VALUES (?, ?, ?, ?, ?, ?, ?)",[F.id,F.title,F.path,F.cover,f==null?void 0:f.id,JSON.stringify(F.manga_data),h]),Y=(await nr.select("SELECT * FROM MangaSeries WHERE series_id = ? AND server = ?",[F.id,h]))[0]),j||(console.log("Downloading cover image."),await c("series",Y.library_id,Y.series_id)),G)await s("file",G,Y);else{const he=await k(Y.series_id,!1);for(const ee of he)await s("file",ee,Y)}return wt.success(G?"File added to queue.":"Series added to queue.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!0}catch(Y){return console.error(Y),wt.error(G?"Failed to add file to queue.":"Failed to add series to queue.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1}},makeSeriesUnavailableOffline:async(F,G)=>{if(await rc(G?"Are you sure you want to remove this file from offline storage?":"Are you sure you want to remove this series from offline storage?",{title:"Devourer",kind:"warning"})){let Y=!1;G?Y=await o(G.file_id?G.file_id:G.id,h):Y=await a(F.series_id?F.series_id:F.id,h),Y?wt.success(G?"File removed from offline storage.":"Series removed from offline storage.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}):wt.error(G?"Failed to remove file from offline storage.":"Failed to remove series from offline storage.",{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}})}},filteredMangaSeries:b,filterManga:p,filterMangaBy:g,setFilterManga:x,setFilterMangaBy:y,isFileAvailableOffline:_}}function L6(){const{id:i}=cc(),[e]=Ul(),t=e.get("local"),r=e.get("tab"),{t:n}=ir(),{libraryViewMode:s,setLibraryViewMode:a}=c0(Dt(ee=>({libraryViewMode:ee.libraryViewMode,setLibraryViewMode:ee.setLibraryViewMode}))),{setLibraryId:o,libraryData:l}=Xr(Dt(ee=>({setLibraryId:ee.setLibraryId,libraryData:ee.libraryData}))),{createCollection:c,retrieveLibrary:h}=vn(),{filteredBookSeries:f,filterBook:m,setFilterBook:p,filterBookBy:x,setFilterBookBy:g}=Up(),{filteredMangaSeries:y,filterManga:b,setFilterManga:_,filterMangaBy:S,setFilterMangaBy:k}=Hp(),[C,R]=T.useState("files"),[N,O]=T.useState(""),[I,F]=T.useState(!1),[G,B]=T.useState(!1),Y=1,j=T.useMemo(()=>(l==null?void 0:l.type)==="book"?f:y,[l,f,y]),ae=T.useMemo(()=>j.length>Y,[j.length]);D6();const he=T.useMemo(()=>{if(!l)return[];if(!l.collections)return[];if(N.length<3)return l.collections;const ee=N.toLowerCase();return l.collections.filter(Z=>{var ie,ge;return(ge=(ie=Z.name)==null?void 0:ie.toLowerCase())==null?void 0:ge.includes(ee)})},[l,N]);return T.useEffect(()=>{t==="book"?o(9999):t==="manga"?o(9998):i&&o(Number(i))},[i,t]),T.useEffect(()=>{r&&R(r)},[r]),T.useEffect(()=>{const ee=window.matchMedia("(orientation: landscape)");F(ee.matches);const Z=ie=>{F(ie.matches)};return ee.addEventListener("change",Z),()=>{ee.removeEventListener("change",Z)}},[]),T.useEffect(()=>{l&&l.type==="manga"&&s==="table"&&a("grid")},[l]),E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:`${l?"":"flex-1"} px-5 pt-8`,children:E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full",children:l?E.jsxs("div",{className:"w-full",children:[E.jsx(u6,{activeTab:C,setActiveTab:R,isLocal:t==="book"||t==="manga",setDisplayCreateCollectionModal:B,libraryId:l.id}),C==="files"&&E.jsx("div",{className:"mt-5",children:E.jsx(tT,{filter:l.type==="book"?m:b,setFilter:l.type==="book"?p:_,filterBy:l.type==="book"?x:S,setFilterBy:l.type==="book"?g:k,placeholder:l.type==="book"?"Filter by title or author...":"Filter by title..."})}),C==="collections"&&E.jsx("div",{className:"mt-5",children:E.jsx(tT,{filter:N,filterBy:"title",setFilterBy:()=>{},setFilter:O,placeholder:"Filter by collection name...",collection:!0})}),l.type==="book"&&C==="files"&&E.jsx(_6,{}),E.jsx("div",{className:"mt-5",children:E.jsx(T.Fragment,{children:C==="files"?E.jsx(E.Fragment,{children:l&&l.id?E.jsx(T.Fragment,{children:s==="grid"?ae?E.jsx(C6,{items:j,offline:t==="book"||t==="manga"},`library-files-virtual-grid-${l.id}-${l.type}`):E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 2xl:grid-cols-8 gap-5 auto-rows-fr",children:j.map((ee,Z)=>E.jsx(RS,{entity:ee,offline:t==="book"||t==="manga"},`library-files-card-${ee.id}-${Z}-${l.id}`))}):ae?E.jsx(T6,{series:j,isLandscape:I,offline:t==="book"||t==="manga"}):E.jsx(h6,{series:j,isLandscape:I,offline:t==="book"||t==="manga"})},`library-files-${l.id}-${l.type}`):E.jsx("span",{children:n("library.noFiles")})}):E.jsx(E.Fragment,{children:l&&l.collections&&l.collections.length>0?E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 2xl:grid-cols-8 gap-5 auto-rows-fr",children:he.map(ee=>E.jsx(E6,{collection:ee},ee.id))}):E.jsx("span",{className:"text-white",children:n("library.noCollections")})})},`library-${l.id}-${l.type}`)})]}):E.jsx("div",{children:"Loading..."})})}),E.jsx(es,{})]}),E.jsx(R6,{isOpen:G,onClose:()=>B(!1),onSubmit:async ee=>{try{return await c(ee),await h((l==null?void 0:l.id)??0),wt.success("Collection created successfully.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),B(!1),!0}catch(Z){return console.error(Z),wt.error("Failed to create collection.",{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1}},libraryId:(l==null?void 0:l.id)??0})]})}const P6=T.memo(function({entity:e}){const t=Br(),{opdsUrl:r}=gh(Dt(l=>({opdsUrl:l.opdsUrl}))),[n,s]=T.useState(null),a=T.useCallback(()=>{const l=e.links.find(h=>h.rel==="http://opds-spec.org/acquisition");if(!l)return!1;const c=`/book/0/read?opdsType=${l.type==="application/pdf"?"opds-pdf":"opds-epub"}&opdsUrl=${encodeURIComponent(l.href)}`;t(c)},[e.id,t]),o=T.useMemo(()=>e.title,[e]);return T.useEffect(()=>{if(!r)return;let l={...e};const c=e.links.find(f=>f.rel==="http://opds-spec.org/image");c&&(l.image=new URL(c.href,r).toString());const h=e.links.find(f=>f.rel==="http://opds-spec.org/acquisition");h&&(l.file=new URL(h.href,r).toString()),s(l)},[e,r]),n?E.jsxs("button",{className:"bg-primary text-white rounded-xl flex flex-col hover:cursor-pointer h-full transition-transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":o,onClick:a,style:{contain:"layout style paint"},children:[E.jsx("div",{className:"h-[16rem] relative overflow-hidden",children:E.jsx("img",{src:n.image||"",alt:n.title,className:"w-full h-full object-cover rounded-t-xl",style:{transition:"opacity 0.2s ease-in-out"}})}),E.jsx("div",{className:"text-sm p-3 flex-1 flex items-center justify-center",children:E.jsx("span",{className:"line-clamp-3 text-center leading-relaxed",children:o})})]}):null},(i,e)=>i.entity.id===e.entity.id&&i.entity.title===e.entity.title);function O6(){const{opdsBooks:i,nextLink:e,prevLink:t}=gh(Dt(l=>({opdsBooks:l.opdsBooks,nextLink:l.nextLink,prevLink:l.prevLink}))),{getBooksByPage:r}=AS(),[n,s]=T.useState(!1),[a,o]=T.useState(!1);return T.useEffect(()=>{const l=window.matchMedia("(orientation: landscape)");s(l.matches);const c=h=>{s(h.matches)};return l.addEventListener("change",c),()=>{l.removeEventListener("change",c)}},[]),E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:`${i?"":"flex-1"} px-5 pt-8`,children:E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full",children:i?E.jsxs("div",{className:"w-full",children:[E.jsxs("div",{className:"fixed top-10 left-0 px-5 h-[3rem] w-full flex flex-col md:flex-row justify-between",children:[E.jsx(Yt,{onPress:async()=>{a||t&&(o(!0),await r(t),o(!1))},disabled:!t,children:"Prev Page"}),E.jsx(Yt,{className:"w-full md:w-auto",onPress:async()=>{a||e&&(o(!0),await r(e),o(!1))},disabled:!e,children:"Next Page"})]}),E.jsx("div",{className:"mt-[7.5rem] md:mt-[4.5rem] pb-[8rem] overflow-y-auto",style:{height:"calc(100vh - 7.5rem - 4rem)"},children:E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 2xl:grid-cols-8 gap-5 auto-rows-fr",children:i.books.map((l,c)=>E.jsx(P6,{entity:l},`library-files-card-${l.id}-${c}`))})})]}):E.jsx("div",{children:"Loading..."})})}),E.jsx(es,{})]})}function I6({book:i}){return i?E.jsx("div",{className:"text-sm mb-[1rem] bg-primary rounded-xl p-3 text-white",dangerouslySetInnerHTML:{__html:i.metadata.description&&i.metadata.description.length>0?i.metadata.description:"No description available."}}):null}function F6({book:i}){var t,r;const{t:e}=ir();return i?E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"text-sm mb-[1rem] bg-primary rounded-xl p-3 text-white mt-[1rem]",children:[E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("book.authors"),":"]})," ",(t=i.metadata.authors)==null?void 0:t.join(", ")]}),E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("book.genres"),":"]})," ",(r=i.metadata.genres)==null?void 0:r.join(", ")]})]}),E.jsxs("div",{className:"bg-primary rounded-xl p-3 text-white text-sm",children:[i.metadata.publishers&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("book.publisher"),":"]})," ",i.metadata.publishers.join(", ")]}),i.metadata.publish_date&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("book.published"),":"]})," ",i.metadata.publish_date]}),(()=>{var a,o;const s=((o=(a=i.metadata.identifiers)==null?void 0:a.find(l=>l.type==="ISBN_13"))==null?void 0:o.identifier)||i.metadata.isbn_13;return s&&s.length>0?E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("book.isbn"),":"]})," ",s]}):null})(),i.metadata.number_of_pages&&i.metadata.number_of_pages>0&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("book.pages"),":"]})," ",i.metadata.number_of_pages]})]})]}):null}const M6=T.memo(({entityId:i,displayModal:e,setDisplayModal:t})=>{var m;const{t:r}=ir(),[n,s]=T.useState(!1),[a,o]=T.useState(0),{libraryData:l}=Xr(Dt(p=>({libraryData:p.libraryData}))),{addToCollection:c,retrieveLibrary:h}=vn(),f=T.useCallback(async()=>{if(a!==0){s(!0);try{await c(a,i)&&(t(!1),await h(l.id),wt.success(r("common.addToCollectionSuccess"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}))}catch(p){wt.error(r("common.addToCollectionError"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),console.error(p)}finally{s(!1)}}},[a,r]);return E.jsx(ms,{open:e,as:"div",className:"relative z-10 focus:outline-none",onClose:()=>t(!1),style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:r("common.addToCollection")}),E.jsx("button",{className:"hover:cursor-pointer",onClick:()=>t(!1),children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"type",className:"font-semibold",children:r("common.collection")}),E.jsxs("select",{id:"collectionId",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:a,onChange:p=>{o(Number(p.target.value))},children:[E.jsx("option",{value:"0",children:r("common.selectCollection")}),(m=l.collections)==null?void 0:m.map(p=>E.jsx("option",{value:p.id,children:p.name},p.id))]})]}),E.jsx("div",{children:E.jsx(Yt,{className:"w-full",disabled:n||a===0,onPress:f,children:r("common.addToCollection")})})]})})})})});function Vl(){const{t:i}=ir(),[e,t]=T.useState(null),{makeRequest:r}=Wl(),{server:n}=Ln(Dt(p=>({server:p.server})));return{markAsRead:async(p,x,g)=>{if(g){if(!(await r(`/${p}/${g}/${x}/mark-as-read`,"POST")).status)throw new Error("Failed to update page");return!0}},getImagePath:async(p,x,g,y)=>{if(y){const b=await G5(p,p==="book"?x.file_id:x.series_id,p==="manga"?x.id:void 0);t(b||"")}else t(`${n}/cover-image/${g}/${x.id}.webp`)},imagePath:e,updateMetadata:async(p,x,g,y,b)=>{try{if(y)p===9999?await nr.execute("UPDATE BookFile SET metadata = ? WHERE file_id = ? AND server = ?",[JSON.stringify(g),x,b]):await nr.execute("UPDATE MangaSeries SET manga_data = ? WHERE series_id = ? AND server = ?",[JSON.stringify(g),x,b]);else if(!await r(`/series/${p}/${x}/metadata`,"PATCH",{metadata:g}))return wt.error(i("common.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1;return wt.success(i("series.metadataSaved"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!0}catch(_){return console.error(_),wt.error(i("common.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1}},pageEvent:async(p,x,g,y,b)=>{try{x&&b?g===9999?await nr.execute("UPDATE BookFile SET current_page = ? WHERE file_id = ? AND server = ?",[p,y,b]):await nr.execute("UPDATE MangaFile SET current_page = ? WHERE file_id = ? AND server = ?",[p,y,b]):r("/file/page-event","POST",{libraryId:g,fileId:y,page:p})}catch(_){console.error("pageEvent error:",_)}},rateEntity:async(p,x,g)=>await r(`/rate/${p}/${x}`,"POST",{rating:g})?!0:(wt.error(i("common.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1),addTag:async(p,x,g)=>await r(`/tag/${p}/${x}`,"POST",{tag:g})?!0:(wt.error(i("common.error"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),!1),deleteTag:async(p,x,g)=>!!await r(`/tag/${p}/${x}/${g}`,"DELETE"),sendToKindle:async(p,x,g,y)=>{try{const _=await(await fetch(`${n}/stream/${p}/${x}`)).blob();if(_.size>39e6)return{status:!1,message:"File is too large."};const S=new FormData;S.append("file",_,y);const C=await(await fetch(`https://kindle.devourer.app/send-to-kindle?email=${g}`,{method:"POST",body:S})).json();return console.log(C),C.status?{status:!0}:{status:!1,message:"Failed to send email."}}catch(b){return console.error("sendToKindle error:",b),{status:!1,message:"Failed to send email."}}}}}const j6=T.memo(({libraryId:i,entityId:e,tags:t,displayModal:r,setDisplayModal:n})=>{const{t:s}=ir(),[a,o]=T.useState(!1),{libraryData:l}=Xr(Dt(y=>({libraryData:y.libraryData}))),{retrieveLibrary:c}=vn(),{addTag:h,deleteTag:f}=Vl(),[m,p]=T.useState(""),x=T.useCallback(async()=>{if(!(m.length<3)){o(!0);try{await h(i,e,m)&&(await c(l.id),p(""),wt.success(s("common.addTagSuccess"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}))}catch(y){wt.error(s("common.addTagError"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),console.error(y)}finally{o(!1)}}},[m,i,e,s]),g=T.useCallback(async y=>{await f(i,e,y)?await c(l.id):wt.error(s("common.deleteTagError"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"})},[m,i,e,s]);return E.jsx(ms,{open:r,as:"div",className:"relative z-10 focus:outline-none",onClose:()=>n(!1),style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:s("common.manageTags")}),E.jsx("button",{className:"hover:cursor-pointer",onClick:()=>n(!1),children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"type",className:"font-semibold",children:s("common.tag")}),E.jsx("input",{type:"text",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:m,maxLength:32,onChange:y=>{p(y.target.value)},onKeyDown:y=>{y.key==="Enter"&&x()}})]}),E.jsx("div",{children:E.jsx(Yt,{className:"w-full",disabled:a||m.length<3,onPress:x,children:s("common.addTag")})}),E.jsx("hr",{className:"my-5"}),E.jsx("div",{className:`flex flex-row flex-wrap gap-2 ${t.length===0?"hidden":""}`,children:t.map(y=>E.jsxs("div",{className:"bg-primary text-white rounded-md px-2 py-1 text-sm font-semibold flex flex-row items-center gap-2",children:[y,E.jsx("button",{className:"bg-red-900 text-white rounded-md px-2 py-1 text-sm font-semibold hover:cursor-pointer",onClick:()=>g(y),children:E.jsx(Z8,{className:"w-4 h-4"})})]},y))})]})})})})}),B6=T.memo(({libraryId:i,entityId:e,displayModal:t,setDisplayModal:r,fileName:n})=>{const{t:s}=ir(),[a,o]=T.useState(!1),{sendToKindle:l}=Vl(),[c,h]=T.useState(""),f=T.useCallback(async()=>{if(c.includes("@")){o(!0);try{const{status:m,message:p}=await l(i,e,c,n);m?(h(""),r(!1),wt.success(s("common.sendToKindleSuccess"),{style:{backgroundColor:"#111827",color:"#fff",zIndex:99999},position:"bottom-right"})):wt.error(p,{style:{backgroundColor:"#111827",color:"#fff",zIndex:99999}})}catch(m){wt.error(s("common.sendToKindleError"),{style:{backgroundColor:"#111827",color:"#fff",zIndex:99999},position:"bottom-right"}),console.error(m)}finally{o(!1)}}},[c,i,e,s]);return E.jsx(ms,{open:t,as:"div",className:"relative z-10 focus:outline-none",onClose:()=>r(!1),style:{zIndex:9e4},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:s("common.sendToKindle")}),E.jsx("button",{className:"hover:cursor-pointer",onClick:()=>r(!1),children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsx("p",{className:"text-sm text-gray-400 mt-5",children:s("common.kindleDescription")}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"type",className:"font-semibold",children:s("common.kindleEmail")}),E.jsx("input",{type:"text",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:c,maxLength:32,onChange:m=>{h(m.target.value)},onKeyDown:m=>{m.key==="Enter"&&f()}})]}),E.jsx("div",{children:E.jsx(Yt,{className:"w-full",disabled:a||!c.includes("@"),onPress:f,children:s("common.sendToKindle")})})]})})})})}),z6=T.memo(({isOpen:i,onClose:e,libraryId:t,seriesId:r})=>{const{t:n}=ir(),{libraryData:s}=Xr(Dt(g=>({libraryData:g.libraryData}))),{retrieveLibrary:a}=vn(),{makeRequest:o}=Wl(),[l,c]=T.useState(null),[h,f]=T.useState(null),[m,p]=T.useState(!1),x=T.useCallback(async()=>{if(!h){c(n("libraries.createErrorFile"));return}p(!0),c(null);try{const{status:g,message:y}=await o(`/series/${t}/${r}/file`,"PUT",void 0,void 0,void 0,h);g?(await a(s.id),e()):c(y)}catch(g){c(g instanceof Error?g.message:"An error occurred")}finally{p(!1)}},[h,e,n,s]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-row items-center justify-between",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:"Upload file to series"}),E.jsx("button",{className:"hover:cursor-pointer",onClick:e,children:E.jsx(Oo,{className:"w-6 h-6 text-white"})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"file",className:"font-semibold",children:"File"}),E.jsx("input",{type:"file",id:"file",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",multiple:!1,onChange:g=>{const y=["zip","cbz","rar","cbr"];g.target.files&&g.target.files.length>0&&y.includes(g.target.files[0].name.split(".").pop())?f(g.target.files[0]):c("File must be a zip, cbz, rar, or cbr.")}})]}),l&&E.jsx("div",{className:"mt-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:l}),E.jsx("div",{className:"mt-5",children:E.jsx("button",{className:`bg-secondary hover:bg-tertiary text-white w-full p-3 rounded-md font-semibold hover:cursor-pointer ${m?"opacity-50":""}`,disabled:m,onClick:x,children:"Upload file"})})]})})})})});function X5({type:i,entity:e,libraryId:t,offlineAvailability:r,isLocal:n,localServer:s}){const a=Br(),{t:o}=ir(),{server:l}=Ln(Dt(O=>({server:O.server}))),{roles:c}=zs(Dt(O=>({roles:O.roles})));vn(),Up();const h=T.useRef(null);Hp();const[f,m]=T.useState(!1),[p,x]=T.useState(!1),[g,y]=T.useState(!1),[b,_]=T.useState(!1),[S,k]=T.useState(!1),[C,R]=T.useState(!1);T.useEffect(()=>{const O=I=>{f&&h.current&&!h.current.contains(I.target)&&m(!1)};return document.addEventListener("mousedown",O),()=>{document.removeEventListener("mousedown",O)}},[f]);const N=()=>{if(!e)return"";if(e.manga_data&&e.manga_data.title)return e.manga_data.title;if(e.manga_data&&e.manga_data.titles){const O=e.manga_data.titles.find(F=>F.type==="English");if(O)return O.title;const I=e.manga_data.titles.find(F=>F.type==="Default");if(I)return I.title}return e.title};return e?E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-start mb-[1rem] gap-3",children:[E.jsxs("div",{className:"flex flex-row gap-3 md:gap-2 w-full md:max-w-[calc(100vw-20rem)] items-start md:items-center",children:[E.jsx(Yt,{"aria-label":o("common.returnToLibrary"),onPress:()=>{a(n?i==="book"?"/library/9999?local=book":"/library/9998?local=manga":`/library/${t}`)},children:E.jsx(q5,{className:"w-4 h-4"})}),E.jsxs("div",{children:[E.jsx("h1",{className:"font-bold text-start text-xl text-white",children:i==="book"?E.jsx(E.Fragment,{children:e.metadata&&e.metadata.title?e.metadata.title:e.title}):E.jsx(E.Fragment,{children:N()})}),i==="book"&&E.jsx(E.Fragment,{children:e.metadata&&e.metadata.subtitle&&e.metadata.subtitle.length>0&&E.jsx("div",{className:"text-[16px] text-white",children:e.metadata.subtitle})})]})]}),E.jsx("div",{className:"relative w-full md:w-auto",children:E.jsxs("div",{ref:h,className:"w-full md:absolute md:top-0 md:-left-[17.5rem] md:w-[17.5rem] bg-[#090D16] rounded-lg text-white md:mb-[1rem]",style:{zIndex:1e3},children:[E.jsxs("button",{className:"flex flex-row w-full justify-center items-center gap-3 p-3",onClick:()=>{m(!f)},children:[f?E.jsx(k8,{className:"w-4 h-4"}):E.jsx(Ky,{className:"w-4 h-4"}),E.jsx("span",{children:f?"Hide actions":"View actions"})]}),f&&E.jsxs("div",{className:"mt-[0.5rem] p-3 pt-0",children:[c.edit_metadata&&E.jsxs(Yt,{className:"w-full",onPress:()=>{a(i==="book"?`/book/${n?e.file_id:e.id}/metadata${n?"?local=book":""}${s?`&localServer=${s}`:""}`:`/manga/${n?e.series_id:e.id}/metadata${n?"?local=manga":""}${s?`&localServer=${s}`:""}`)},children:[E.jsx(kS,{className:"w-4 h-4"}),o("common.editMetadata")]}),!n&&E.jsxs(Yt,{className:"mt-[0.5rem] w-full",onPress:()=>{R(!0)},children:[E.jsx(v6,{className:"w-4 h-4"}),o("common.addToCollection")]}),!1,!n&&E.jsxs(Yt,{className:"mt-[0.5rem] w-full",onPress:()=>{x(!0)},children:[E.jsx(X8,{className:"w-4 h-4"}),o("common.manageTags")]}),!n&&i==="book"&&E.jsxs(Yt,{className:"mt-[0.5rem] w-full",onPress:()=>{k(!0)},children:[E.jsx(H5,{className:"w-4 h-4"}),o("common.sendToKindle")]}),!n&&i!=="book"&&c.add_file&&E.jsxs(Yt,{className:"mt-[0.5rem] w-full",onPress:()=>{y(!0)},children:[E.jsx(m8,{className:"w-4 h-4"}),"Upload file"]})]})]})})]}),C&&E.jsx(M6,{entityId:e.id,displayModal:C,setDisplayModal:R}),p&&E.jsx(j6,{libraryId:t||0,entityId:e.id,tags:e.tags||[],displayModal:p,setDisplayModal:x}),S&&E.jsx(B6,{libraryId:t||0,entityId:e.id,fileName:e.file_name,displayModal:S,setDisplayModal:k}),g&&i==="series"&&E.jsx(z6,{libraryId:t||0,seriesId:e.id,isOpen:g,onClose:()=>y(!1)}),b&&i==="book"&&E.jsx(V5,{libraryId:t||0,isOpen:b,onClose:()=>_(!1)})]}):null}function K5({series:i,retrieveSeries:e}){const[t,r]=T.useState(null),{rateEntity:n}=Vl();return i?E.jsx("div",{className:"flex flex-row justify-between mb-[1rem]",children:[1,2,3,4,5].map(s=>E.jsx("div",{children:E.jsx("button",{onClick:async()=>{await n(i.library_id||0,i.id,s)&&e()},onMouseEnter:()=>r(s),onMouseLeave:()=>r(null),children:E.jsx(W5,{className:`w-8 h-8 cursor-pointer ${t!==null&&s<=t?"text-yellow-800":i.rating&&s<=(i.rating||0)?"text-yellow-500":"text-gray-600"}`})})},s))}):null}function $6(){const{t:i}=ir(),{id:e}=cc(),[t]=Ul(),r=t.get("isLocal")==="true",n=t.get("server"),{book:s,offlineAvailability:a,retrieveBook:o,retrieveLocalBook:l}=Up(),c=Br(),{libraryId:h}=Xr(Dt(x=>({libraryId:x.libraryId}))),f=s&&(r||h!=null),{imagePath:m,isLoading:p}=Pw({type:"book",entity:s||{id:-1,file_id:-1},libraryId:h||0,offline:r});return T.useEffect(()=>{r?l(Number(e),n||""):e&&o(Number(e))},[e,o,l,r,n]),E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-24 pt-8",children:s?E.jsx(E.Fragment,{children:E.jsxs("div",{className:"mt-[1rem]",children:[E.jsx(X5,{type:"book",entity:s,libraryId:h||0,offlineAvailability:a,isLocal:r,localServer:n||void 0}),E.jsxs("div",{className:"w-full grid grid-cols-1 md:grid-cols-4 gap-5",children:[E.jsxs("div",{children:[E.jsx("div",{className:"mb-[1rem]",children:!f||p?E.jsx("div",{className:"w-full h-64 bg-gray-300 rounded-xl animate-pulse flex items-center justify-center",children:E.jsx("span",{className:"text-gray-500",children:"Loading..."})}):E.jsx("img",{src:m||"",alt:"Book cover",className:"w-full h-auto rounded-xl"})}),E.jsx(K5,{series:s,retrieveSeries:()=>{r?l(Number(e),n||""):e&&o(Number(e))}}),E.jsx(F6,{book:s})]}),E.jsxs("div",{className:"w-full md:col-span-3",children:[E.jsx(I6,{book:s}),E.jsx("div",{className:"mb-[3rem]",children:E.jsxs(Yt,{onPress:()=>{c(r?`/book/${e}/read?isLocal=true&server=${n}`:`/book/${e}/read`)},className:"w-full md:text-lg",children:[E.jsx(kS,{className:"w-4 h-4"}),i("book.readNow")]})})]})]})]})}):E.jsx($p,{})}),E.jsx(es,{})]})}function U6({book:i,displayGoogle:e,setDisplayGoogle:t}){const{libraryId:r}=Xr(Dt(y=>({libraryId:y.libraryId}))),{retrieveLibraries:n}=vn(),{updateMetadata:s}=Vl(),{searchGoogleMetadata:a,selectGoogleResult:o}=Up(),[l,c]=T.useState([]),[h,f]=T.useState(!1),[m,p]=T.useState(i.metadata.title||""),x=async()=>{if(h)return;f(!0);const y=await a(m);c(y||[]),f(!1)},g=async y=>{if(h)return;f(!0);const b=await o(i.metadata,y);await s(r||0,i.id,b),await n(),f(!1),t(!1)};return E.jsx(ms,{open:e,as:"div",className:"relative z-10 focus:outline-none",onClose:()=>t(!1),children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen mt-[2rem] overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-6xl rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-2",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:"Search Google Books"}),E.jsx("div",{className:"flex items-center justify-center",children:E.jsx("button",{className:"bg-secondary p-3 rounded-full text-white hover:cursor-pointer",onClick:()=>t(!1),children:E.jsx(Oo,{className:"w-6 h-6"})})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"name",className:"font-semibold",children:"Query"}),E.jsx("input",{type:"text",id:"name",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:m,onChange:y=>p(y.target.value)})]}),E.jsx("div",{className:"mt-5",children:E.jsx(Yt,{className:"md:w-full",onPress:x,disabled:h,"aria-busy":h,children:"Search"})}),l.length>0&&E.jsx("div",{className:"mt-5",children:E.jsxs("table",{className:"w-full text-sm [&>tbody>*:nth-child(odd)]:bg-input [&>tbody>*:nth-child(even)]:bg-primary text-white rounded-lg overflow-hidden",children:[E.jsx("thead",{children:E.jsxs("tr",{className:"bg-primary text-left",children:[E.jsx("th",{className:"p-3",children:"Cover"}),E.jsx("th",{className:"p-3",children:"Title"}),E.jsx("th",{className:"p-3 text-right",children:" "})]})}),E.jsx("tbody",{children:l.map(y=>{var b,_;return E.jsxs("tr",{children:[E.jsx("td",{className:"p-3",children:((b=y.volumeInfo.imageLinks)==null?void 0:b.thumbnail)&&E.jsx("img",{src:(_=y.volumeInfo.imageLinks)==null?void 0:_.thumbnail,alt:y.volumeInfo.title,className:"h-[12rem] object-contain rounded-lg aspect-square"})}),E.jsx("td",{className:"p-3",children:y.volumeInfo.title}),E.jsx("td",{className:"p-3 text-right",children:E.jsx(Yt,{className:"ml-auto mr-0 text-xs",onPress:()=>{g(y)},children:"Select"})})]},y.id)})})]})})]})})})})}function H6(){var b,_,S,k,C,R,N,O,I,F,G,B,Y,j,ae,he,ee;const{t:i}=ir(),{id:e}=cc(),[t]=Ul(),r=t.get("isLocal")==="true",{book:n,retrieveBook:s}=Up(),{updateMetadata:a}=Vl(),o=Br(),{retrieveLibraries:l}=vn(),{libraryId:c}=Xr(Dt(Z=>({libraryId:Z.libraryId}))),[h,f]=T.useState(!1),[m,p]=T.useState(!1),[x,g]=T.useState({});T.useEffect(()=>{r||e&&y(e)},[e,s,r]);const y=async Z=>{const ie=await s(Number(Z));g(ie)};return E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-[8rem] pt-8",children:!x||!n||!c?E.jsx($p,{}):E.jsx(E.Fragment,{children:E.jsxs("div",{className:"mt-[1rem]",children:[E.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-[1rem] gap-3",children:[E.jsxs(Yt,{className:"w-full md:w-auto",onPress:()=>{o(r?`/book/${n.id}?isLocal=true`:`/book/${n.id}`)},children:[E.jsx(Pp,{className:"w-4 h-4"}),i("common.returnToBook")]}),E.jsxs(Yt,{className:"w-full md:w-auto",onPress:()=>{f(!0)},children:[E.jsx(CS,{className:"w-4 h-4"}),i("common.searchForMetadata")]})]}),E.jsxs("div",{className:"bg-primary rounded-xl p-3 text-white mb-[1rem]",children:[E.jsx("span",{className:"font-semibold",children:"File name:"})," ",n.file_name]}),E.jsxs("div",{className:"bg-primary rounded-xl p-3 text-white",children:[n.file_format==="epub"&&E.jsxs("div",{children:[E.jsx("label",{htmlFor:"epubTitle",className:"font-semibold",children:"ePub Title"}),E.jsx("input",{id:"epubTitle",type:"text",value:((_=(b=x.metadata)==null?void 0:b.epub)==null?void 0:_.title)||"",onChange:Z=>{g({...x,metadata:{...x.metadata,epub:{...x.metadata.epub,title:Z.target.value}}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"title",className:"font-semibold",children:"Title"}),E.jsx("input",{id:"title",type:"text",value:(S=x.metadata)!=null&&S.title?x.metadata.title:x.title||"",onChange:Z=>{g({...x,metadata:{...x.metadata,title:Z.target.value}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"subtitle",className:"font-semibold",children:"Subtitle"}),E.jsx("input",{id:"subtitle",type:"text",value:((k=x.metadata)==null?void 0:k.subtitle)||"",onChange:Z=>{g({...x,metadata:{...x.metadata,subtitle:Z.target.value}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsxs("label",{htmlFor:"authors",className:"font-semibold",children:["Authors"," ",E.jsx("span",{className:"text-xs",children:"(separated by comma)"})]}),E.jsx("input",{id:"authors",type:"text",value:((R=(C=x.metadata)==null?void 0:C.authors)==null?void 0:R.join(", "))||"",onChange:Z=>{g({...x,metadata:{...x.metadata,authors:Z.target.value.split(",").map(ie=>ie.trim())}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsxs("label",{htmlFor:"genres",className:"font-semibold",children:["Genres ",E.jsx("span",{className:"text-xs",children:"(separated by comma)"})]}),E.jsx("input",{id:"genres",type:"text",value:((O=(N=x.metadata)==null?void 0:N.genres)==null?void 0:O.join(", "))||"",onChange:Z=>{g({...x,metadata:{...x.metadata,genres:Z.target.value.split(",").map(ie=>ie.trim())}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsxs("label",{htmlFor:"publishers",className:"font-semibold",children:["Publishers"," ",E.jsx("span",{className:"text-xs",children:"(separated by comma)"})]}),E.jsx("input",{id:"publishers",type:"text",value:((F=(I=x.metadata)==null?void 0:I.publishers)==null?void 0:F.join(", "))||"",onChange:Z=>{g({...x,metadata:{...x.metadata,publishers:Z.target.value.split(",").map(ie=>ie.trim())}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"publishDate",className:"font-semibold",children:"Publish date"}),E.jsx("input",{id:"publishDate",type:"text",value:((G=x.metadata)==null?void 0:G.publish_date)||"",onChange:Z=>{g({...x,metadata:{...x.metadata,publish_date:Z.target.value}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"isbn13",className:"font-semibold",children:"ISBN 13"}),E.jsx("input",{id:"isbn13",type:"text",value:(j=(Y=(B=x.metadata)==null?void 0:B.identifiers)==null?void 0:Y.find(Z=>Z.type==="ISBN_13"))==null?void 0:j.identifier,onChange:Z=>{var ge,V;const ie=(V=(ge=x.metadata)==null?void 0:ge.identifiers)==null?void 0:V.filter(K=>K.type!=="ISBN_13");ie.push({type:"ISBN_13",identifier:Z.target.value}),g({...x,metadata:{...x.metadata,identifiers:ie}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"isbn10",className:"font-semibold",children:"ISBN 10"}),E.jsx("input",{id:"isbn10",type:"text",value:(ee=(he=(ae=x.metadata)==null?void 0:ae.identifiers)==null?void 0:he.find(Z=>Z.type==="ISBN_10"))==null?void 0:ee.identifier,onChange:Z=>{var ge,V;const ie=(V=(ge=x.metadata)==null?void 0:ge.identifiers)==null?void 0:V.filter(K=>K.type!=="ISBN_10");ie.push({type:"ISBN_10",identifier:Z.target.value}),g({...x,metadata:{...x.metadata,identifiers:ie}})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]})]}),E.jsx("div",{className:"mt-[1rem] mb-[3rem]",children:E.jsx(Yt,{onPress:async()=>{if(m)return;p(!0),await a(c,n.id,x.metadata)&&l(),p(!1)},disabled:m,className:"w-full md:text-lg",children:i("common.saveChanges")})})]})})}),n&&E.jsx(U6,{book:n,displayGoogle:h,setDisplayGoogle:f}),E.jsx(es,{})]})}var Py={exports:{}},tx={exports:{}},rx,rT;function Z5(){if(rT)return rx;rT=1;var i=void 0;return rx=function(e){return e!==i&&e!==null},rx}var nx,nT;function W6(){if(nT)return nx;nT=1;var i=Z5(),e={object:!0,function:!0,undefined:!0};return nx=function(t){return i(t)?hasOwnProperty.call(e,typeof t):!1},nx}var ix,iT;function V6(){if(iT)return ix;iT=1;var i=W6();return ix=function(e){if(!i(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}},ix}var sx,sT;function G6(){if(sT)return sx;sT=1;var i=V6();return sx=function(e){if(typeof e!="function"||!hasOwnProperty.call(e,"length"))return!1;try{if(typeof e.length!="number"||typeof e.call!="function"||typeof e.apply!="function")return!1}catch{return!1}return!i(e)},sx}var ax,aT;function q6(){if(aT)return ax;aT=1;var i=G6(),e=/^\s*class[\s{/}]/,t=Function.prototype.toString;return ax=function(r){return!(!i(r)||e.test(t.call(r)))},ax}var ox,oT;function Y6(){return oT||(oT=1,ox=function(){var i=Object.assign,e;return typeof i!="function"?!1:(e={foo:"raz"},i(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),ox}var lx,lT;function X6(){return lT||(lT=1,lx=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),lx}var ux,uT;function K6(){return uT||(uT=1,ux=function(){}),ux}var cx,cT;function DS(){if(cT)return cx;cT=1;var i=K6()();return cx=function(e){return e!==i&&e!==null},cx}var dx,dT;function Z6(){if(dT)return dx;dT=1;var i=DS(),e=Object.keys;return dx=function(t){return e(i(t)?Object(t):t)},dx}var hx,hT;function Q6(){return hT||(hT=1,hx=X6()()?Object.keys:Z6()),hx}var fx,fT;function J6(){if(fT)return fx;fT=1;var i=DS();return fx=function(e){if(!i(e))throw new TypeError("Cannot use null or undefined");return e},fx}var px,pT;function eB(){if(pT)return px;pT=1;var i=Q6(),e=J6(),t=Math.max;return px=function(r,n){var s,a,o=t(arguments.length,2),l;for(r=Object(e(r)),l=function(c){try{r[c]=n[c]}catch(h){s||(s=h)}},a=1;a<o;++a)n=arguments[a],i(n).forEach(l);if(s!==void 0)throw s;return r},px}var mx,mT;function tB(){return mT||(mT=1,mx=Y6()()?Object.assign:eB()),mx}var gx,gT;function rB(){if(gT)return gx;gT=1;var i=DS(),e=Array.prototype.forEach,t=Object.create,r=function(n,s){var a;for(a in n)s[a]=n[a]};return gx=function(n){var s=t(null);return e.call(arguments,function(a){i(a)&&r(Object(a),s)}),s},gx}var vx,vT;function nB(){if(vT)return vx;vT=1;var i="razdwatrzy";return vx=function(){return typeof i.contains!="function"?!1:i.contains("dwa")===!0&&i.contains("foo")===!1},vx}var yx,yT;function iB(){if(yT)return yx;yT=1;var i=String.prototype.indexOf;return yx=function(e){return i.call(this,e,arguments[1])>-1},yx}var bx,bT;function sB(){return bT||(bT=1,bx=nB()()?String.prototype.contains:iB()),bx}var wT;function aB(){if(wT)return tx.exports;wT=1;var i=Z5(),e=q6(),t=tB(),r=rB(),n=sB(),s=tx.exports=function(a,o){var l,c,h,f,m;return arguments.length<2||typeof a!="string"?(f=o,o=a,a=null):f=arguments[2],i(a)?(l=n.call(a,"c"),c=n.call(a,"e"),h=n.call(a,"w")):(l=h=!0,c=!1),m={value:o,configurable:l,enumerable:c,writable:h},f?t(r(f),m):m};return s.gs=function(a,o,l){var c,h,f,m;return typeof a!="string"?(f=l,l=o,o=a,a=null):f=arguments[3],i(o)?e(o)?i(l)?e(l)||(f=l,l=void 0):l=void 0:(f=o,o=l=void 0):o=void 0,i(a)?(c=n.call(a,"c"),h=n.call(a,"e")):(c=!0,h=!1),m={get:o,set:l,configurable:c,enumerable:h},f?t(r(f),m):m},tx.exports}var wx,xT;function oB(){return xT||(xT=1,wx=function(i){if(typeof i!="function")throw new TypeError(i+" is not a function");return i}),wx}var _T;function lB(){return _T||(_T=1,function(i,e){var t=aB(),r=oB(),n=Function.prototype.apply,s=Function.prototype.call,a=Object.create,o=Object.defineProperty,l=Object.defineProperties,c=Object.prototype.hasOwnProperty,h={configurable:!0,enumerable:!1,writable:!0},f,m,p,x,g,y,b;f=function(_,S){var k;return r(S),c.call(this,"__ee__")?k=this.__ee__:(k=h.value=a(null),o(this,"__ee__",h),h.value=null),k[_]?typeof k[_]=="object"?k[_].push(S):k[_]=[k[_],S]:k[_]=S,this},m=function(_,S){var k,C;return r(S),C=this,f.call(this,_,k=function(){p.call(C,_,k),n.call(S,this,arguments)}),k.__eeOnceListener__=S,this},p=function(_,S){var k,C,R,N;if(r(S),!c.call(this,"__ee__"))return this;if(k=this.__ee__,!k[_])return this;if(C=k[_],typeof C=="object")for(N=0;R=C[N];++N)(R===S||R.__eeOnceListener__===S)&&(C.length===2?k[_]=C[N?0:1]:C.splice(N,1));else(C===S||C.__eeOnceListener__===S)&&delete k[_];return this},x=function(_){var S,k,C,R,N;if(c.call(this,"__ee__")&&(R=this.__ee__[_],!!R))if(typeof R=="object"){for(k=arguments.length,N=new Array(k-1),S=1;S<k;++S)N[S-1]=arguments[S];for(R=R.slice(),S=0;C=R[S];++S)n.call(C,this,N)}else switch(arguments.length){case 1:s.call(R,this);break;case 2:s.call(R,this,arguments[1]);break;case 3:s.call(R,this,arguments[1],arguments[2]);break;default:for(k=arguments.length,N=new Array(k-1),S=1;S<k;++S)N[S-1]=arguments[S];n.call(R,this,N)}},g={on:f,once:m,off:p,emit:x},y={on:t(f),once:t(m),off:t(p),emit:t(x)},b=l({},y),i.exports=e=function(_){return _==null?a(b):l(Object(_),y)},e.methods=g}(Py,Py.exports)),Py.exports}var uB=lB();const Io=Do(uB);var Nm={},qo={},Qh={},ET;function Ow(){if(ET)return Qh;ET=1;function i(n,s,a){if(a===void 0&&(a=Array.prototype),n&&typeof a.find=="function")return a.find.call(n,s);for(var o=0;o<n.length;o++)if(Object.prototype.hasOwnProperty.call(n,o)){var l=n[o];if(s.call(void 0,l,o,n))return l}}function e(n,s){return s===void 0&&(s=Object),s&&typeof s.freeze=="function"?s.freeze(n):n}var t=e({HTML:"text/html",isHTML:function(n){return n===t.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return Qh.find=i,Qh.freeze=e,Qh.MIME_TYPE=t,Qh.NAMESPACE=r,Qh}var ST;function Q5(){if(ST)return qo;ST=1;var i=Ow(),e=i.find,t=i.NAMESPACE;function r(U){return U!==""}function n(U){return U?U.split(/[\t\n\f\r ]+/).filter(r):[]}function s(U,L){return U.hasOwnProperty(L)||(U[L]=!0),U}function a(U){if(!U)return[];var L=n(U);return Object.keys(L.reduce(s,{}))}function o(U){return function(L){return U&&U.indexOf(L)!==-1}}function l(U,L){for(var re in U)Object.prototype.hasOwnProperty.call(U,re)&&(L[re]=U[re])}function c(U,L){var re=U.prototype;if(!(re instanceof L)){let Ee=function(){};Ee.prototype=L.prototype,Ee=new Ee,l(re,Ee),U.prototype=re=Ee}re.constructor!=U&&(typeof U!="function"&&console.error("unknown Class:"+U),re.constructor=U)}var h={},f=h.ELEMENT_NODE=1,m=h.ATTRIBUTE_NODE=2,p=h.TEXT_NODE=3,x=h.CDATA_SECTION_NODE=4,g=h.ENTITY_REFERENCE_NODE=5,y=h.ENTITY_NODE=6,b=h.PROCESSING_INSTRUCTION_NODE=7,_=h.COMMENT_NODE=8,S=h.DOCUMENT_NODE=9,k=h.DOCUMENT_TYPE_NODE=10,C=h.DOCUMENT_FRAGMENT_NODE=11,R=h.NOTATION_NODE=12,N={},O={};N.INDEX_SIZE_ERR=(O[1]="Index size error",1),N.DOMSTRING_SIZE_ERR=(O[2]="DOMString size error",2);var I=N.HIERARCHY_REQUEST_ERR=(O[3]="Hierarchy request error",3);N.WRONG_DOCUMENT_ERR=(O[4]="Wrong document",4),N.INVALID_CHARACTER_ERR=(O[5]="Invalid character",5),N.NO_DATA_ALLOWED_ERR=(O[6]="No data allowed",6),N.NO_MODIFICATION_ALLOWED_ERR=(O[7]="No modification allowed",7);var F=N.NOT_FOUND_ERR=(O[8]="Not found",8);N.NOT_SUPPORTED_ERR=(O[9]="Not supported",9);var G=N.INUSE_ATTRIBUTE_ERR=(O[10]="Attribute in use",10);N.INVALID_STATE_ERR=(O[11]="Invalid state",11),N.SYNTAX_ERR=(O[12]="Syntax error",12),N.INVALID_MODIFICATION_ERR=(O[13]="Invalid modification",13),N.NAMESPACE_ERR=(O[14]="Invalid namespace",14),N.INVALID_ACCESS_ERR=(O[15]="Invalid access",15);function B(U,L){if(L instanceof Error)var re=L;else re=this,Error.call(this,O[U]),this.message=O[U],Error.captureStackTrace&&Error.captureStackTrace(this,B);return re.code=U,L&&(this.message=this.message+": "+L),re}B.prototype=Error.prototype,l(N,B);function Y(){}Y.prototype={length:0,item:function(U){return U>=0&&U<this.length?this[U]:null},toString:function(U,L){for(var re=[],Ee=0;Ee<this.length;Ee++)Ye(this[Ee],re,U,L);return re.join("")},filter:function(U){return Array.prototype.filter.call(this,U)},indexOf:function(U){return Array.prototype.indexOf.call(this,U)}};function j(U,L){this._node=U,this._refresh=L,ae(this)}function ae(U){var L=U._node._inc||U._node.ownerDocument._inc;if(U._inc!==L){var re=U._refresh(U._node);if(we(U,"length",re.length),!U.$$length||re.length<U.$$length)for(var Ee=re.length;Ee in U;Ee++)Object.prototype.hasOwnProperty.call(U,Ee)&&delete U[Ee];l(re,U),U._inc=L}}j.prototype.item=function(U){return ae(this),this[U]||null},c(j,Y);function he(){}function ee(U,L){for(var re=U.length;re--;)if(U[re]===L)return re}function Z(U,L,re,Ee){if(Ee?L[ee(L,Ee)]=re:L[L.length++]=re,U){re.ownerElement=U;var P=U.ownerDocument;P&&(Ee&&Pe(P,U,Ee),ce(P,U,re))}}function ie(U,L,re){var Ee=ee(L,re);if(Ee>=0){for(var P=L.length-1;Ee<P;)L[Ee]=L[++Ee];if(L.length=P,U){var Ce=U.ownerDocument;Ce&&(Pe(Ce,U,re),re.ownerElement=null)}}else throw new B(F,new Error(U.tagName+"@"+re))}he.prototype={length:0,item:Y.prototype.item,getNamedItem:function(U){for(var L=this.length;L--;){var re=this[L];if(re.nodeName==U)return re}},setNamedItem:function(U){var L=U.ownerElement;if(L&&L!=this._ownerElement)throw new B(G);var re=this.getNamedItem(U.nodeName);return Z(this._ownerElement,this,U,re),re},setNamedItemNS:function(U){var L=U.ownerElement,re;if(L&&L!=this._ownerElement)throw new B(G);return re=this.getNamedItemNS(U.namespaceURI,U.localName),Z(this._ownerElement,this,U,re),re},removeNamedItem:function(U){var L=this.getNamedItem(U);return ie(this._ownerElement,this,L),L},removeNamedItemNS:function(U,L){var re=this.getNamedItemNS(U,L);return ie(this._ownerElement,this,re),re},getNamedItemNS:function(U,L){for(var re=this.length;re--;){var Ee=this[re];if(Ee.localName==L&&Ee.namespaceURI==U)return Ee}return null}};function ge(){}ge.prototype={hasFeature:function(U,L){return!0},createDocument:function(U,L,re){var Ee=new Ae;if(Ee.implementation=this,Ee.childNodes=new Y,Ee.doctype=re||null,re&&Ee.appendChild(re),L){var P=Ee.createElementNS(U,L);Ee.appendChild(P)}return Ee},createDocumentType:function(U,L,re){var Ee=new Rt;return Ee.name=U,Ee.nodeName=U,Ee.publicId=L||"",Ee.systemId=re||"",Ee}};function V(){}V.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(U,L){return le(this,U,L)},replaceChild:function(U,L){le(this,U,L,oe),L&&this.removeChild(L)},removeChild:function(U){return $e(this,U)},appendChild:function(U){return this.insertBefore(U,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(U){return ft(this.ownerDocument||this,this,U)},normalize:function(){for(var U=this.firstChild;U;){var L=U.nextSibling;L&&L.nodeType==p&&U.nodeType==p?(this.removeChild(L),U.appendData(L.data)):(U.normalize(),U=L)}},isSupported:function(U,L){return this.ownerDocument.implementation.hasFeature(U,L)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(U){for(var L=this;L;){var re=L._nsMap;if(re){for(var Ee in re)if(Object.prototype.hasOwnProperty.call(re,Ee)&&re[Ee]===U)return Ee}L=L.nodeType==m?L.ownerDocument:L.parentNode}return null},lookupNamespaceURI:function(U){for(var L=this;L;){var re=L._nsMap;if(re&&U in re&&Object.prototype.hasOwnProperty.call(re,U))return re[U];L=L.nodeType==m?L.ownerDocument:L.parentNode}return null},isDefaultNamespace:function(U){var L=this.lookupPrefix(U);return L==null}};function K(U){return U=="<"&&"&lt;"||U==">"&&"&gt;"||U=="&"&&"&amp;"||U=='"'&&"&quot;"||"&#"+U.charCodeAt()+";"}l(h,V),l(h,V.prototype);function be(U,L){if(L(U))return!0;if(U=U.firstChild)do if(be(U,L))return!0;while(U=U.nextSibling)}function Ae(){this.ownerDocument=this}function ce(U,L,re){U&&U._inc++;var Ee=re.namespaceURI;Ee===t.XMLNS&&(L._nsMap[re.prefix?re.localName:""]=re.value)}function Pe(U,L,re,Ee){U&&U._inc++;var P=re.namespaceURI;P===t.XMLNS&&delete L._nsMap[re.prefix?re.localName:""]}function Ve(U,L,re){if(U&&U._inc){U._inc++;var Ee=L.childNodes;if(re)Ee[Ee.length++]=re;else{for(var P=L.firstChild,Ce=0;P;)Ee[Ce++]=P,P=P.nextSibling;Ee.length=Ce,delete Ee[Ee.length]}}}function $e(U,L){var re=L.previousSibling,Ee=L.nextSibling;return re?re.nextSibling=Ee:U.firstChild=Ee,Ee?Ee.previousSibling=re:U.lastChild=re,L.parentNode=null,L.previousSibling=null,L.nextSibling=null,Ve(U.ownerDocument,U),L}function qe(U){return U&&(U.nodeType===V.DOCUMENT_NODE||U.nodeType===V.DOCUMENT_FRAGMENT_NODE||U.nodeType===V.ELEMENT_NODE)}function Ze(U){return U&&(gt(U)||ut(U)||at(U)||U.nodeType===V.DOCUMENT_FRAGMENT_NODE||U.nodeType===V.COMMENT_NODE||U.nodeType===V.PROCESSING_INSTRUCTION_NODE)}function at(U){return U&&U.nodeType===V.DOCUMENT_TYPE_NODE}function gt(U){return U&&U.nodeType===V.ELEMENT_NODE}function ut(U){return U&&U.nodeType===V.TEXT_NODE}function z(U,L){var re=U.childNodes||[];if(e(re,gt)||at(L))return!1;var Ee=e(re,at);return!(L&&Ee&&re.indexOf(Ee)>re.indexOf(L))}function Le(U,L){var re=U.childNodes||[];function Ee(Ce){return gt(Ce)&&Ce!==L}if(e(re,Ee))return!1;var P=e(re,at);return!(L&&P&&re.indexOf(P)>re.indexOf(L))}function _e(U,L,re){if(!qe(U))throw new B(I,"Unexpected parent node type "+U.nodeType);if(re&&re.parentNode!==U)throw new B(F,"child not in parent");if(!Ze(L)||at(L)&&U.nodeType!==V.DOCUMENT_NODE)throw new B(I,"Unexpected node type "+L.nodeType+" for parent node type "+U.nodeType)}function ue(U,L,re){var Ee=U.childNodes||[],P=L.childNodes||[];if(L.nodeType===V.DOCUMENT_FRAGMENT_NODE){var Ce=P.filter(gt);if(Ce.length>1||e(P,ut))throw new B(I,"More than one element or text in fragment");if(Ce.length===1&&!z(U,re))throw new B(I,"Element in fragment can not be inserted before doctype")}if(gt(L)&&!z(U,re))throw new B(I,"Only one element can be added and only after doctype");if(at(L)){if(e(Ee,at))throw new B(I,"Only one doctype is allowed");var Ie=e(Ee,gt);if(re&&Ee.indexOf(Ie)<Ee.indexOf(re))throw new B(I,"Doctype can only be inserted before an element");if(!re&&Ie)throw new B(I,"Doctype can not be appended since element is present")}}function oe(U,L,re){var Ee=U.childNodes||[],P=L.childNodes||[];if(L.nodeType===V.DOCUMENT_FRAGMENT_NODE){var Ce=P.filter(gt);if(Ce.length>1||e(P,ut))throw new B(I,"More than one element or text in fragment");if(Ce.length===1&&!Le(U,re))throw new B(I,"Element in fragment can not be inserted before doctype")}if(gt(L)&&!Le(U,re))throw new B(I,"Only one element can be added and only after doctype");if(at(L)){if(e(Ee,function(me){return at(me)&&me!==re}))throw new B(I,"Only one doctype is allowed");var Ie=e(Ee,gt);if(re&&Ee.indexOf(Ie)<Ee.indexOf(re))throw new B(I,"Doctype can only be inserted before an element")}}function le(U,L,re,Ee){_e(U,L,re),U.nodeType===V.DOCUMENT_NODE&&(Ee||ue)(U,L,re);var P=L.parentNode;if(P&&P.removeChild(L),L.nodeType===C){var Ce=L.firstChild;if(Ce==null)return L;var Ie=L.lastChild}else Ce=Ie=L;var J=re?re.previousSibling:U.lastChild;Ce.previousSibling=J,Ie.nextSibling=re,J?J.nextSibling=Ce:U.firstChild=Ce,re==null?U.lastChild=Ie:re.previousSibling=Ie;do Ce.parentNode=U;while(Ce!==Ie&&(Ce=Ce.nextSibling));return Ve(U.ownerDocument||U,U),L.nodeType==C&&(L.firstChild=L.lastChild=null),L}function Oe(U,L){return L.parentNode&&L.parentNode.removeChild(L),L.parentNode=U,L.previousSibling=U.lastChild,L.nextSibling=null,L.previousSibling?L.previousSibling.nextSibling=L:U.firstChild=L,U.lastChild=L,Ve(U.ownerDocument,U,L),L}Ae.prototype={nodeName:"#document",nodeType:S,doctype:null,documentElement:null,_inc:1,insertBefore:function(U,L){if(U.nodeType==C){for(var re=U.firstChild;re;){var Ee=re.nextSibling;this.insertBefore(re,L),re=Ee}return U}return le(this,U,L),U.ownerDocument=this,this.documentElement===null&&U.nodeType===f&&(this.documentElement=U),U},removeChild:function(U){return this.documentElement==U&&(this.documentElement=null),$e(this,U)},replaceChild:function(U,L){le(this,U,L,oe),U.ownerDocument=this,L&&this.removeChild(L),gt(U)&&(this.documentElement=U)},importNode:function(U,L){return Qe(this,U,L)},getElementById:function(U){var L=null;return be(this.documentElement,function(re){if(re.nodeType==f&&re.getAttribute("id")==U)return L=re,!0}),L},getElementsByClassName:function(U){var L=a(U);return new j(this,function(re){var Ee=[];return L.length>0&&be(re.documentElement,function(P){if(P!==re&&P.nodeType===f){var Ce=P.getAttribute("class");if(Ce){var Ie=U===Ce;if(!Ie){var J=a(Ce);Ie=L.every(o(J))}Ie&&Ee.push(P)}}}),Ee})},createElement:function(U){var L=new Te;L.ownerDocument=this,L.nodeName=U,L.tagName=U,L.localName=U,L.childNodes=new Y;var re=L.attributes=new he;return re._ownerElement=L,L},createDocumentFragment:function(){var U=new wr;return U.ownerDocument=this,U.childNodes=new Y,U},createTextNode:function(U){var L=new rt;return L.ownerDocument=this,L.appendData(U),L},createComment:function(U){var L=new Ke;return L.ownerDocument=this,L.appendData(U),L},createCDATASection:function(U){var L=new yt;return L.ownerDocument=this,L.appendData(U),L},createProcessingInstruction:function(U,L){var re=new Ir;return re.ownerDocument=this,re.tagName=re.nodeName=re.target=U,re.nodeValue=re.data=L,re},createAttribute:function(U){var L=new ye;return L.ownerDocument=this,L.name=U,L.nodeName=U,L.localName=U,L.specified=!0,L},createEntityReference:function(U){var L=new cr;return L.ownerDocument=this,L.nodeName=U,L},createElementNS:function(U,L){var re=new Te,Ee=L.split(":"),P=re.attributes=new he;return re.childNodes=new Y,re.ownerDocument=this,re.nodeName=L,re.tagName=L,re.namespaceURI=U,Ee.length==2?(re.prefix=Ee[0],re.localName=Ee[1]):re.localName=L,P._ownerElement=re,re},createAttributeNS:function(U,L){var re=new ye,Ee=L.split(":");return re.ownerDocument=this,re.nodeName=L,re.name=L,re.namespaceURI=U,re.specified=!0,Ee.length==2?(re.prefix=Ee[0],re.localName=Ee[1]):re.localName=L,re}},c(Ae,V);function Te(){this._nsMap={}}Te.prototype={nodeType:f,hasAttribute:function(U){return this.getAttributeNode(U)!=null},getAttribute:function(U){var L=this.getAttributeNode(U);return L&&L.value||""},getAttributeNode:function(U){return this.attributes.getNamedItem(U)},setAttribute:function(U,L){var re=this.ownerDocument.createAttribute(U);re.value=re.nodeValue=""+L,this.setAttributeNode(re)},removeAttribute:function(U){var L=this.getAttributeNode(U);L&&this.removeAttributeNode(L)},appendChild:function(U){return U.nodeType===C?this.insertBefore(U,null):Oe(this,U)},setAttributeNode:function(U){return this.attributes.setNamedItem(U)},setAttributeNodeNS:function(U){return this.attributes.setNamedItemNS(U)},removeAttributeNode:function(U){return this.attributes.removeNamedItem(U.nodeName)},removeAttributeNS:function(U,L){var re=this.getAttributeNodeNS(U,L);re&&this.removeAttributeNode(re)},hasAttributeNS:function(U,L){return this.getAttributeNodeNS(U,L)!=null},getAttributeNS:function(U,L){var re=this.getAttributeNodeNS(U,L);return re&&re.value||""},setAttributeNS:function(U,L,re){var Ee=this.ownerDocument.createAttributeNS(U,L);Ee.value=Ee.nodeValue=""+re,this.setAttributeNode(Ee)},getAttributeNodeNS:function(U,L){return this.attributes.getNamedItemNS(U,L)},getElementsByTagName:function(U){return new j(this,function(L){var re=[];return be(L,function(Ee){Ee!==L&&Ee.nodeType==f&&(U==="*"||Ee.tagName==U)&&re.push(Ee)}),re})},getElementsByTagNameNS:function(U,L){return new j(this,function(re){var Ee=[];return be(re,function(P){P!==re&&P.nodeType===f&&(U==="*"||P.namespaceURI===U)&&(L==="*"||P.localName==L)&&Ee.push(P)}),Ee})}},Ae.prototype.getElementsByTagName=Te.prototype.getElementsByTagName,Ae.prototype.getElementsByTagNameNS=Te.prototype.getElementsByTagNameNS,c(Te,V);function ye(){}ye.prototype.nodeType=m,c(ye,V);function Ue(){}Ue.prototype={data:"",substringData:function(U,L){return this.data.substring(U,U+L)},appendData:function(U){U=this.data+U,this.nodeValue=this.data=U,this.length=U.length},insertData:function(U,L){this.replaceData(U,0,L)},appendChild:function(U){throw new Error(O[I])},deleteData:function(U,L){this.replaceData(U,L,"")},replaceData:function(U,L,re){var Ee=this.data.substring(0,U),P=this.data.substring(U+L);re=Ee+re+P,this.nodeValue=this.data=re,this.length=re.length}},c(Ue,V);function rt(){}rt.prototype={nodeName:"#text",nodeType:p,splitText:function(U){var L=this.data,re=L.substring(U);L=L.substring(0,U),this.data=this.nodeValue=L,this.length=L.length;var Ee=this.ownerDocument.createTextNode(re);return this.parentNode&&this.parentNode.insertBefore(Ee,this.nextSibling),Ee}},c(rt,Ue);function Ke(){}Ke.prototype={nodeName:"#comment",nodeType:_},c(Ke,Ue);function yt(){}yt.prototype={nodeName:"#cdata-section",nodeType:x},c(yt,Ue);function Rt(){}Rt.prototype.nodeType=k,c(Rt,V);function _t(){}_t.prototype.nodeType=R,c(_t,V);function ar(){}ar.prototype.nodeType=y,c(ar,V);function cr(){}cr.prototype.nodeType=g,c(cr,V);function wr(){}wr.prototype.nodeName="#document-fragment",wr.prototype.nodeType=C,c(wr,V);function Ir(){}Ir.prototype.nodeType=b,c(Ir,V);function Bt(){}Bt.prototype.serializeToString=function(U,L,re){return Xt.call(U,L,re)},V.prototype.toString=Xt;function Xt(U,L){var re=[],Ee=this.nodeType==9&&this.documentElement||this,P=Ee.prefix,Ce=Ee.namespaceURI;if(Ce&&P==null){var P=Ee.lookupPrefix(Ce);if(P==null)var Ie=[{namespace:Ce,prefix:null}]}return Ye(this,re,U,L,Ie),re.join("")}function Pn(U,L,re){var Ee=U.prefix||"",P=U.namespaceURI;if(!P||Ee==="xml"&&P===t.XML||P===t.XMLNS)return!1;for(var Ce=re.length;Ce--;){var Ie=re[Ce];if(Ie.prefix===Ee)return Ie.namespace!==P}return!0}function se(U,L,re){U.push(" ",L,'="',re.replace(/[<&"]/g,K),'"')}function Ye(U,L,re,Ee,P){if(P||(P=[]),Ee)if(U=Ee(U),U){if(typeof U=="string"){L.push(U);return}}else return;switch(U.nodeType){case f:var Ce=U.attributes,Ie=Ce.length,er=U.firstChild,J=U.tagName;re=t.isHTML(U.namespaceURI)||re;var me=J;if(!re&&!U.prefix&&U.namespaceURI){for(var Fe,vt=0;vt<Ce.length;vt++)if(Ce.item(vt).name==="xmlns"){Fe=Ce.item(vt).value;break}if(!Fe)for(var ct=P.length-1;ct>=0;ct--){var mt=P[ct];if(mt.prefix===""&&mt.namespace===U.namespaceURI){Fe=mt.namespace;break}}if(Fe!==U.namespaceURI)for(var ct=P.length-1;ct>=0;ct--){var mt=P[ct];if(mt.namespace===U.namespaceURI){mt.prefix&&(me=mt.prefix+":"+J);break}}}L.push("<",me);for(var Ft=0;Ft<Ie;Ft++){var vr=Ce.item(Ft);vr.prefix=="xmlns"?P.push({prefix:vr.localName,namespace:vr.value}):vr.nodeName=="xmlns"&&P.push({prefix:"",namespace:vr.value})}for(var Ft=0;Ft<Ie;Ft++){var vr=Ce.item(Ft);if(Pn(vr,re,P)){var Jt=vr.prefix||"",Vt=vr.namespaceURI;se(L,Jt?"xmlns:"+Jt:"xmlns",Vt),P.push({prefix:Jt,namespace:Vt})}Ye(vr,L,re,Ee,P)}if(J===me&&Pn(U,re,P)){var Jt=U.prefix||"",Vt=U.namespaceURI;se(L,Jt?"xmlns:"+Jt:"xmlns",Vt),P.push({prefix:Jt,namespace:Vt})}if(er||re&&!/^(?:meta|link|img|br|hr|input)$/i.test(J)){if(L.push(">"),re&&/^script$/i.test(J))for(;er;)er.data?L.push(er.data):Ye(er,L,re,Ee,P.slice()),er=er.nextSibling;else for(;er;)Ye(er,L,re,Ee,P.slice()),er=er.nextSibling;L.push("</",me,">")}else L.push("/>");return;case S:case C:for(var er=U.firstChild;er;)Ye(er,L,re,Ee,P.slice()),er=er.nextSibling;return;case m:return se(L,U.name,U.value);case p:return L.push(U.data.replace(/[<&]/g,K).replace(/]]>/g,"]]&gt;"));case x:return L.push("<![CDATA[",U.data,"]]>");case _:return L.push("<!--",U.data,"-->");case k:var Fr=U.publicId,Rr=U.systemId;if(L.push("<!DOCTYPE ",U.name),Fr)L.push(" PUBLIC ",Fr),Rr&&Rr!="."&&L.push(" ",Rr),L.push(">");else if(Rr&&Rr!=".")L.push(" SYSTEM ",Rr,">");else{var yn=U.internalSubset;yn&&L.push(" [",yn,"]"),L.push(">")}return;case b:return L.push("<?",U.target," ",U.data,"?>");case g:return L.push("&",U.nodeName,";");default:L.push("??",U.nodeName)}}function Qe(U,L,re){var Ee;switch(L.nodeType){case f:Ee=L.cloneNode(!1),Ee.ownerDocument=U;case C:break;case m:re=!0;break}if(Ee||(Ee=L.cloneNode(!1)),Ee.ownerDocument=U,Ee.parentNode=null,re)for(var P=L.firstChild;P;)Ee.appendChild(Qe(U,P,re)),P=P.nextSibling;return Ee}function ft(U,L,re){var Ee=new L.constructor;for(var P in L)if(Object.prototype.hasOwnProperty.call(L,P)){var Ce=L[P];typeof Ce!="object"&&Ce!=Ee[P]&&(Ee[P]=Ce)}switch(L.childNodes&&(Ee.childNodes=new Y),Ee.ownerDocument=U,Ee.nodeType){case f:var Ie=L.attributes,J=Ee.attributes=new he,me=Ie.length;J._ownerElement=Ee;for(var Fe=0;Fe<me;Fe++)Ee.setAttributeNode(ft(U,Ie.item(Fe),!0));break;case m:re=!0}if(re)for(var vt=L.firstChild;vt;)Ee.appendChild(ft(U,vt,re)),vt=vt.nextSibling;return Ee}function we(U,L,re){U[L]=re}try{if(Object.defineProperty){let U=function(L){switch(L.nodeType){case f:case C:var re=[];for(L=L.firstChild;L;)L.nodeType!==7&&L.nodeType!==8&&re.push(U(L)),L=L.nextSibling;return re.join("");default:return L.nodeValue}};Object.defineProperty(j.prototype,"length",{get:function(){return ae(this),this.$$length}}),Object.defineProperty(V.prototype,"textContent",{get:function(){return U(this)},set:function(L){switch(this.nodeType){case f:case C:for(;this.firstChild;)this.removeChild(this.firstChild);(L||String(L))&&this.appendChild(this.ownerDocument.createTextNode(L));break;default:this.data=L,this.value=L,this.nodeValue=L}}}),we=function(L,re,Ee){L["$$"+re]=Ee}}}catch{}return qo.DocumentType=Rt,qo.DOMException=B,qo.DOMImplementation=ge,qo.Element=Te,qo.Node=V,qo.NodeList=Y,qo.XMLSerializer=Bt,qo}var Jh={},xx={},AT;function cB(){return AT||(AT=1,function(i){var e=Ow().freeze;i.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),i.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),i.entityMap=i.HTML_ENTITIES}(xx)),xx}var Oy={},CT;function dB(){if(CT)return Oy;CT=1;var i=Ow().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),n=0,s=1,a=2,o=3,l=4,c=5,h=6,f=7;function m(I,F){this.message=I,this.locator=F,Error.captureStackTrace&&Error.captureStackTrace(this,m)}m.prototype=new Error,m.prototype.name=m.name;function p(){}p.prototype={parse:function(I,F,G){var B=this.domBuilder;B.startDocument(),k(F,F={}),x(I,F,G,B,this.errorHandler),B.endDocument()}};function x(I,F,G,B,Y){function j(Te){if(Te>65535){Te-=65536;var ye=55296+(Te>>10),Ue=56320+(Te&1023);return String.fromCharCode(ye,Ue)}else return String.fromCharCode(Te)}function ae(Te){var ye=Te.slice(1,-1);return ye in G?G[ye]:ye.charAt(0)==="#"?j(parseInt(ye.substr(1).replace("x","0x"))):(Y.error("entity not found:"+Te),Te)}function he(Te){if(Te>Ae){var ye=I.substring(Ae,Te).replace(/&#?\w+;/g,ae);V&&ee(Ae),B.characters(ye,0,Te-Ae),Ae=Te}}function ee(Te,ye){for(;Te>=ie&&(ye=ge.exec(I));)Z=ye.index,ie=Z+ye[0].length,V.lineNumber++;V.columnNumber=Te-Z+1}for(var Z=0,ie=0,ge=/.*(?:\r\n?|\n)|.*$/g,V=B.locator,K=[{currentNSMap:F}],be={},Ae=0;;){try{var ce=I.indexOf("<",Ae);if(ce<0){if(!I.substr(Ae).match(/^\s*$/)){var Pe=B.doc,Ve=Pe.createTextNode(I.substr(Ae));Pe.appendChild(Ve),B.currentElement=Ve}return}switch(ce>Ae&&he(ce),I.charAt(ce+1)){case"/":var _e=I.indexOf(">",ce+3),$e=I.substring(ce+2,_e).replace(/[ \t\n\r]+$/g,""),qe=K.pop();_e<0?($e=I.substring(ce+2).replace(/[\s<].*/,""),Y.error("end tag name: "+$e+" is not complete:"+qe.tagName),_e=ce+1+$e.length):$e.match(/\s</)&&($e=$e.replace(/[\s<].*/,""),Y.error("end tag name: "+$e+" maybe not complete"),_e=ce+1+$e.length);var Ze=qe.localNSMap,at=qe.tagName==$e,gt=at||qe.tagName&&qe.tagName.toLowerCase()==$e.toLowerCase();if(gt){if(B.endElement(qe.uri,qe.localName,$e),Ze)for(var ut in Ze)Object.prototype.hasOwnProperty.call(Ze,ut)&&B.endPrefixMapping(ut);at||Y.fatalError("end tag name: "+$e+" is not match the current start tagName:"+qe.tagName)}else K.push(qe);_e++;break;case"?":V&&ee(ce),_e=R(I,ce,B);break;case"!":V&&ee(ce),_e=C(I,ce,B,Y);break;default:V&&ee(ce);var z=new N,Le=K[K.length-1].currentNSMap,_e=y(I,ce,z,Le,ae,Y),ue=z.length;if(!z.closed&&S(I,_e,z.tagName,be)&&(z.closed=!0,G.nbsp||Y.warning("unclosed xml attribute")),V&&ue){for(var oe=g(V,{}),le=0;le<ue;le++){var Oe=z[le];ee(Oe.offset),Oe.locator=g(V,{})}B.locator=oe,b(z,B,Le)&&K.push(z),B.locator=V}else b(z,B,Le)&&K.push(z);i.isHTML(z.uri)&&!z.closed?_e=_(I,_e,z.tagName,ae,B):_e++}}catch(Te){if(Te instanceof m)throw Te;Y.error("element parse error: "+Te),_e=-1}_e>Ae?Ae=_e:he(Math.max(ce,Ae)+1)}}function g(I,F){return F.lineNumber=I.lineNumber,F.columnNumber=I.columnNumber,F}function y(I,F,G,B,Y,j){function ae(V,K,be){G.attributeNames.hasOwnProperty(V)&&j.fatalError("Attribute "+V+" redefined"),G.addValue(V,K,be)}for(var he,ee,Z=++F,ie=n;;){var ge=I.charAt(Z);switch(ge){case"=":if(ie===s)he=I.slice(F,Z),ie=o;else if(ie===a)ie=o;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(ie===o||ie===s)if(ie===s&&(j.warning('attribute value must after "="'),he=I.slice(F,Z)),F=Z+1,Z=I.indexOf(ge,F),Z>0)ee=I.slice(F,Z).replace(/&#?\w+;/g,Y),ae(he,ee,F-1),ie=c;else throw new Error("attribute value no end '"+ge+"' match");else if(ie==l)ee=I.slice(F,Z).replace(/&#?\w+;/g,Y),ae(he,ee,F),j.warning('attribute "'+he+'" missed start quot('+ge+")!!"),F=Z+1,ie=c;else throw new Error('attribute value must after "="');break;case"/":switch(ie){case n:G.setTagName(I.slice(F,Z));case c:case h:case f:ie=f,G.closed=!0;case l:case s:break;case a:G.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return j.error("unexpected end of input"),ie==n&&G.setTagName(I.slice(F,Z)),Z;case">":switch(ie){case n:G.setTagName(I.slice(F,Z));case c:case h:case f:break;case l:case s:ee=I.slice(F,Z),ee.slice(-1)==="/"&&(G.closed=!0,ee=ee.slice(0,-1));case a:ie===a&&(ee=he),ie==l?(j.warning('attribute "'+ee+'" missed quot(")!'),ae(he,ee.replace(/&#?\w+;/g,Y),F)):((!i.isHTML(B[""])||!ee.match(/^(?:disabled|checked|selected)$/i))&&j.warning('attribute "'+ee+'" missed value!! "'+ee+'" instead!!'),ae(ee,ee,F));break;case o:throw new Error("attribute value missed!!")}return Z;case"":ge=" ";default:if(ge<=" ")switch(ie){case n:G.setTagName(I.slice(F,Z)),ie=h;break;case s:he=I.slice(F,Z),ie=a;break;case l:var ee=I.slice(F,Z).replace(/&#?\w+;/g,Y);j.warning('attribute "'+ee+'" missed quot(")!!'),ae(he,ee,F);case c:ie=h;break}else switch(ie){case a:G.tagName,(!i.isHTML(B[""])||!he.match(/^(?:disabled|checked|selected)$/i))&&j.warning('attribute "'+he+'" missed value!! "'+he+'" instead2!!'),ae(he,he,F),F=Z,ie=s;break;case c:j.warning('attribute space is required"'+he+'"!!');case h:ie=s,F=Z;break;case o:ie=l,F=Z;break;case f:throw new Error("elements closed character '/' and '>' must be connected to")}}Z++}}function b(I,F,G){for(var B=I.tagName,Y=null,ge=I.length;ge--;){var j=I[ge],ae=j.qName,he=j.value,V=ae.indexOf(":");if(V>0)var ee=j.prefix=ae.slice(0,V),Z=ae.slice(V+1),ie=ee==="xmlns"&&Z;else Z=ae,ee=null,ie=ae==="xmlns"&&"";j.localName=Z,ie!==!1&&(Y==null&&(Y={},k(G,G={})),G[ie]=Y[ie]=he,j.uri=i.XMLNS,F.startPrefixMapping(ie,he))}for(var ge=I.length;ge--;){j=I[ge];var ee=j.prefix;ee&&(ee==="xml"&&(j.uri=i.XML),ee!=="xmlns"&&(j.uri=G[ee||""]))}var V=B.indexOf(":");V>0?(ee=I.prefix=B.slice(0,V),Z=I.localName=B.slice(V+1)):(ee=null,Z=I.localName=B);var K=I.uri=G[ee||""];if(F.startElement(K,Z,B,I),I.closed){if(F.endElement(K,Z,B),Y)for(ee in Y)Object.prototype.hasOwnProperty.call(Y,ee)&&F.endPrefixMapping(ee)}else return I.currentNSMap=G,I.localNSMap=Y,!0}function _(I,F,G,B,Y){if(/^(?:script|textarea)$/i.test(G)){var j=I.indexOf("</"+G+">",F),ae=I.substring(F+1,j);if(/[&<]/.test(ae))return/^script$/i.test(G)?(Y.characters(ae,0,ae.length),j):(ae=ae.replace(/&#?\w+;/g,B),Y.characters(ae,0,ae.length),j)}return F+1}function S(I,F,G,B){var Y=B[G];return Y==null&&(Y=I.lastIndexOf("</"+G+">"),Y<F&&(Y=I.lastIndexOf("</"+G)),B[G]=Y),Y<F}function k(I,F){for(var G in I)Object.prototype.hasOwnProperty.call(I,G)&&(F[G]=I[G])}function C(I,F,G,B){var Y=I.charAt(F+2);switch(Y){case"-":if(I.charAt(F+3)==="-"){var j=I.indexOf("-->",F+4);return j>F?(G.comment(I,F+4,j-F-4),j+3):(B.error("Unclosed comment"),-1)}else return-1;default:if(I.substr(F+3,6)=="CDATA["){var j=I.indexOf("]]>",F+9);return G.startCDATA(),G.characters(I,F+9,j-F-9),G.endCDATA(),j+3}var ae=O(I,F),he=ae.length;if(he>1&&/!doctype/i.test(ae[0][0])){var ee=ae[1][0],Z=!1,ie=!1;he>3&&(/^public$/i.test(ae[2][0])?(Z=ae[3][0],ie=he>4&&ae[4][0]):/^system$/i.test(ae[2][0])&&(ie=ae[3][0]));var ge=ae[he-1];return G.startDTD(ee,Z,ie),G.endDTD(),ge.index+ge[0].length}}return-1}function R(I,F,G){var B=I.indexOf("?>",F);if(B){var Y=I.substring(F,B).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return Y?(Y[0].length,G.processingInstruction(Y[1],Y[2]),B+2):-1}return-1}function N(){this.attributeNames={}}N.prototype={setTagName:function(I){if(!r.test(I))throw new Error("invalid tagName:"+I);this.tagName=I},addValue:function(I,F,G){if(!r.test(I))throw new Error("invalid attribute:"+I);this.attributeNames[I]=this.length,this[this.length++]={qName:I,value:F,offset:G}},length:0,getLocalName:function(I){return this[I].localName},getLocator:function(I){return this[I].locator},getQName:function(I){return this[I].qName},getURI:function(I){return this[I].uri},getValue:function(I){return this[I].value}};function O(I,F){var G,B=[],Y=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(Y.lastIndex=F,Y.exec(I);G=Y.exec(I);)if(B.push(G),G[1])return B}return Oy.XMLReader=p,Oy.ParseError=m,Oy}var kT;function hB(){if(kT)return Jh;kT=1;var i=Ow(),e=Q5(),t=cB(),r=dB(),n=e.DOMImplementation,s=i.NAMESPACE,a=r.ParseError,o=r.XMLReader;function l(g){this.options=g||{locator:{}}}l.prototype.parseFromString=function(g,y){var b=this.options,_=new o,S=b.domBuilder||new h,k=b.errorHandler,C=b.locator,R=b.xmlns||{},N=/\/x?html?$/.test(y),O=N?t.HTML_ENTITIES:t.XML_ENTITIES;return C&&S.setDocumentLocator(C),_.errorHandler=c(k,S,C),_.domBuilder=b.domBuilder||S,N&&(R[""]=s.HTML),R.xml=R.xml||s.XML,g&&typeof g=="string"?_.parse(g,R,O):_.errorHandler.error("invalid doc source"),S.doc};function c(g,y,b){if(!g){if(y instanceof h)return y;g=y}var _={},S=g instanceof Function;b=b||{};function k(C){var R=g[C];!R&&S&&(R=g.length==2?function(N){g(C,N)}:g),_[C]=R&&function(N){R("[xmldom "+C+"]	"+N+m(b))}||function(){}}return k("warning"),k("error"),k("fatalError"),_}function h(){this.cdata=!1}function f(g,y){y.lineNumber=g.lineNumber,y.columnNumber=g.columnNumber}h.prototype={startDocument:function(){this.doc=new n().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(g,y,b,_){var S=this.doc,k=S.createElementNS(g,b||y),C=_.length;x(this,k),this.currentElement=k,this.locator&&f(this.locator,k);for(var R=0;R<C;R++){var g=_.getURI(R),N=_.getValue(R),b=_.getQName(R),O=S.createAttributeNS(g,b);this.locator&&f(_.getLocator(R),O),O.value=O.nodeValue=N,k.setAttributeNode(O)}},endElement:function(g,y,b){var _=this.currentElement;_.tagName,this.currentElement=_.parentNode},startPrefixMapping:function(g,y){},endPrefixMapping:function(g){},processingInstruction:function(g,y){var b=this.doc.createProcessingInstruction(g,y);this.locator&&f(this.locator,b),x(this,b)},ignorableWhitespace:function(g,y,b){},characters:function(g,y,b){if(g=p.apply(this,arguments),g){if(this.cdata)var _=this.doc.createCDATASection(g);else var _=this.doc.createTextNode(g);this.currentElement?this.currentElement.appendChild(_):/^\s*$/.test(g)&&this.doc.appendChild(_),this.locator&&f(this.locator,_)}},skippedEntity:function(g){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(g){(this.locator=g)&&(g.lineNumber=0)},comment:function(g,y,b){g=p.apply(this,arguments);var _=this.doc.createComment(g);this.locator&&f(this.locator,_),x(this,_)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(g,y,b){var _=this.doc.implementation;if(_&&_.createDocumentType){var S=_.createDocumentType(g,y,b);this.locator&&f(this.locator,S),x(this,S),this.doc.doctype=S}},warning:function(g){console.warn("[xmldom warning]	"+g,m(this.locator))},error:function(g){console.error("[xmldom error]	"+g,m(this.locator))},fatalError:function(g){throw new a(g,this.locator)}};function m(g){if(g)return`
@`+(g.systemId||"")+"#[line:"+g.lineNumber+",col:"+g.columnNumber+"]"}function p(g,y,b){return typeof g=="string"?g.substr(y,b):g.length>=y+b||y?new java.lang.String(g,y,b)+"":g}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(g){h.prototype[g]=function(){return null}});function x(g,y){g.currentElement?g.currentElement.appendChild(y):g.doc.appendChild(y)}return Jh.__DOMHandler=h,Jh.DOMParser=l,Jh.DOMImplementation=e.DOMImplementation,Jh.XMLSerializer=e.XMLSerializer,Jh}var TT;function fB(){if(TT)return Nm;TT=1;var i=Q5();return Nm.DOMImplementation=i.DOMImplementation,Nm.XMLSerializer=i.XMLSerializer,Nm.DOMParser=hB().DOMParser,Nm}var J5=fB();const LS=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,pB=1,mB=3,eD=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function Iw(){var i=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(i+Math.random()*16)%16|0;return i=Math.floor(i/16),(t=="x"?r:r&7|8).toString(16)});return e}function gB(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function tD(i){return!!(i&&i.nodeType==1)}function gn(i){return!isNaN(parseFloat(i))&&isFinite(i)}function rD(i){let e=parseFloat(i);return gn(i)===!1?!1:typeof i=="string"&&i.indexOf(".")>-1?!0:Math.floor(e)!==e}function nf(i){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=i.toLowerCase(),n=e.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return i;for(var s=0;s<n;s++)if(typeof document.body.style[t[s]+r]<"u")return t[s]+r;return i}function nD(i){for(var e=1,t=arguments.length;e<t;e++){var r=arguments[e];for(var n in r)i[n]===void 0&&(i[n]=r[n])}return i}function mi(i){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}),i}function vB(i,e,t){var r=Op(i,e,t);return e.splice(r,0,i),r}function Op(i,e,t,r,n){var s=r||0,a=n||e.length,o=parseInt(s+(a-s)/2),l;return t||(t=function(c,h){if(c>h)return 1;if(c<h)return-1;if(c==h)return 0}),a-s<=0?o:(l=t(e[o],i),a-s===1?l>=0?o:o+1:l===0?o:l===-1?Op(i,e,t,o,a):Op(i,e,t,s,o))}function Pb(i,e,t,r,n){var s=r||0,a=n||e.length,o=parseInt(s+(a-s)/2),l;return t||(t=function(c,h){if(c>h)return 1;if(c<h)return-1;if(c==h)return 0}),a-s<=0?-1:(l=t(e[o],i),a-s===1?l===0?o:-1:l===0?o:l===-1?Pb(i,e,t,o,a):Pb(i,e,t,s,o))}function Zy(i){var e=window.getComputedStyle(i),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],n=0,s=0;return t.forEach(function(a){n+=parseFloat(e[a])||0}),r.forEach(function(a){s+=parseFloat(e[a])||0}),{height:s,width:n}}function Ob(i){var e=window.getComputedStyle(i),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],n=0,s=0;return t.forEach(function(a){n+=parseFloat(e[a])||0}),r.forEach(function(a){s+=parseFloat(e[a])||0}),{height:s,width:n}}function L_(i){let e,t=i.ownerDocument;if(i.nodeType==Node.TEXT_NODE){let r=t.createRange();r.selectNodeContents(i),e=r.getBoundingClientRect()}else e=i.getBoundingClientRect();return e}function Ib(){var i=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:i,bottom:e,width:i,height:e}}function PS(i,e){for(var t=i.parentNode,r=t.childNodes,n,s=-1,a=0;a<r.length&&(n=r[a],n.nodeType===e&&s++,n!=i);a++);return s}function yB(i){return PS(i,mB)}function iD(i){return PS(i,pB)}function vg(i){return["xml","opf","ncx"].indexOf(i)>-1}function sD(i,e){return new Blob([i],{type:e})}function Fb(i,e){var t,r=sD(i,e);return t=eD.createObjectURL(r),t}function aD(i){return eD.revokeObjectURL(i)}function P_(i,e){var t,r;if(typeof i=="string")return t=btoa(i),r="data:"+e+";base64,"+t,r}function oD(i){return Object.prototype.toString.call(i).slice(8,-1)}function Ro(i,e,t){var r,n;return typeof DOMParser>"u"||t?n=J5.DOMParser:n=DOMParser,i.charCodeAt(0)===65279&&(i=i.slice(1)),r=new n().parseFromString(i,e),r}function jr(i,e){var t;if(!i)throw new Error("No Element Provided");if(typeof i.querySelector<"u")return i.querySelector(e);if(t=i.getElementsByTagName(e),t.length)return t[0]}function Ml(i,e){return typeof i.querySelector<"u"?i.querySelectorAll(e):i.getElementsByTagName(e)}function sf(i,e,t){var r,n;if(typeof i.querySelector<"u"){e+="[";for(var s in t)e+=s+"~='"+t[s]+"'";return e+="]",i.querySelector(e)}else if(r=i.getElementsByTagName(e),n=Array.prototype.slice.call(r,0).filter(function(a){for(var o in t)if(a.getAttribute(o)===t[o])return!0;return!1}),n)return n[0]}function Mb(i,e){var t=i.ownerDocument||i;typeof t.createTreeWalker<"u"?lD(i,e,NodeFilter.SHOW_TEXT):OS(i,function(r){r&&r.nodeType===3&&e(r)})}function lD(i,e,t){var r=document.createTreeWalker(i,t,null,!1);let n;for(;n=r.nextNode();)e(n)}function OS(i,e){if(e(i))return!0;if(i=i.firstChild,i)do{if(OS(i,e))return!0;i=i.nextSibling}while(i)}function uD(i){return new Promise(function(e,t){var r=new FileReader;r.readAsDataURL(i),r.onloadend=function(){e(r.result)}})}function pr(){this.resolve=null,this.reject=null,this.id=Iw(),this.promise=new Promise((i,e)=>{this.resolve=i,this.reject=e}),Object.freeze(this)}function jb(i,e,t){var r;if(typeof i.querySelector<"u"&&(r=i.querySelector(`${e}[*|type="${t}"]`)),!r||r.length===0){r=Ml(i,e);for(var n=0;n<r.length;n++)if(r[n].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||r[n].getAttribute("epub:type")===t)return r[n]}else return r}function O_(i){for(var e=[],t=i.childNodes,r=0;r<t.length;r++){let n=t[r];n.nodeType===1&&e.push(n)}return e}function I_(i){for(var e=[i];i;i=i.parentNode)e.unshift(i);return e}function af(i,e,t){for(var r=[],n=i.childNodes,s=0;s<n.length;s++){let a=n[s];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(t)return a;r.push(a)}}if(!t)return r}function bB(i,e){let t;if(!(i===null||e===""))for(t=i.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class cD{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,r=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,r),this.setEnd(t,r+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var r=I_(e||this.startContainer),n=I_(t||this.endContainer);if(r[0]==n[0]){for(var s=0;s<r.length;s++)if(r[s]!=n[s])return r[s-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const wB=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:cD,blob2base64:uD,borders:Ob,bounds:Zy,createBase64Url:P_,createBlob:sD,createBlobUrl:Fb,defaults:nD,defer:pr,documentHeight:gB,extend:mi,filterChildren:af,findChildren:O_,getParentByTagName:bB,indexOfElementNode:iD,indexOfNode:PS,indexOfSorted:Pb,indexOfTextNode:yB,insert:vB,isElement:tD,isFloat:rD,isNumber:gn,isXml:vg,locationOf:Op,nodeBounds:L_,parents:I_,parse:Ro,prefixed:nf,qs:jr,qsa:Ml,qsp:sf,querySelectorByType:jb,requestAnimationFrame:LS,revokeBlobUrl:aD,sprint:Mb,treeWalker:lD,type:oD,uuid:Iw,walk:OS,windowBounds:Ib},Symbol.toStringTag,{value:"Module"}));var _x,RT;function xB(){if(RT)return _x;if(RT=1,!i)var i={cwd:function(){return"/"}};function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+s)}function t(s,a){for(var o="",l=-1,c=0,h,f=0;f<=s.length;++f){if(f<s.length)h=s.charCodeAt(f);else{if(h===47)break;h=47}if(h===47){if(!(l===f-1||c===1))if(l!==f-1&&c===2){if(o.length<2||o.charCodeAt(o.length-1)!==46||o.charCodeAt(o.length-2)!==46){if(o.length>2){for(var m=o.length-1,p=m;p>=0&&o.charCodeAt(p)!==47;--p);if(p!==m){p===-1?o="":o=o.slice(0,p),l=f,c=0;continue}}else if(o.length===2||o.length===1){o="",l=f,c=0;continue}}a&&(o.length>0?o+="/..":o="..")}else o.length>0?o+="/"+s.slice(l+1,f):o=s.slice(l+1,f);l=f,c=0}else h===46&&c!==-1?++c:c=-1}return o}function r(s,a){var o=a.dir||a.root,l=a.base||(a.name||"")+(a.ext||"");return o?o===a.root?o+l:o+s+l:l}var n={resolve:function(){for(var a="",o=!1,l,c=arguments.length-1;c>=-1&&!o;c--){var h;c>=0?h=arguments[c]:(l===void 0&&(l=i.cwd()),h=l),e(h),h.length!==0&&(a=h+"/"+a,o=h.charCodeAt(0)===47)}return a=t(a,!o),o?a.length>0?"/"+a:"/":a.length>0?a:"."},normalize:function(a){if(e(a),a.length===0)return".";var o=a.charCodeAt(0)===47,l=a.charCodeAt(a.length-1)===47;return a=t(a,!o),a.length===0&&!o&&(a="."),a.length>0&&l&&(a+="/"),o?"/"+a:a},isAbsolute:function(a){return e(a),a.length>0&&a.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var a,o=0;o<arguments.length;++o){var l=arguments[o];e(l),l.length>0&&(a===void 0?a=l:a+="/"+l)}return a===void 0?".":n.normalize(a)},relative:function(a,o){if(e(a),e(o),a===o||(a=n.resolve(a),o=n.resolve(o),a===o))return"";for(var l=1;l<a.length&&a.charCodeAt(l)===47;++l);for(var c=a.length,h=c-l,f=1;f<o.length&&o.charCodeAt(f)===47;++f);for(var m=o.length,p=m-f,x=h<p?h:p,g=-1,y=0;y<=x;++y){if(y===x){if(p>x){if(o.charCodeAt(f+y)===47)return o.slice(f+y+1);if(y===0)return o.slice(f+y)}else h>x&&(a.charCodeAt(l+y)===47?g=y:y===0&&(g=0));break}var b=a.charCodeAt(l+y),_=o.charCodeAt(f+y);if(b!==_)break;b===47&&(g=y)}var S="";for(y=l+g+1;y<=c;++y)(y===c||a.charCodeAt(y)===47)&&(S.length===0?S+="..":S+="/..");return S.length>0?S+o.slice(f+g):(f+=g,o.charCodeAt(f)===47&&++f,o.slice(f))},_makeLong:function(a){return a},dirname:function(a){if(e(a),a.length===0)return".";for(var o=a.charCodeAt(0),l=o===47,c=-1,h=!0,f=a.length-1;f>=1;--f)if(o=a.charCodeAt(f),o===47){if(!h){c=f;break}}else h=!1;return c===-1?l?"/":".":l&&c===1?"//":a.slice(0,c)},basename:function(a,o){if(o!==void 0&&typeof o!="string")throw new TypeError('"ext" argument must be a string');e(a);var l=0,c=-1,h=!0,f;if(o!==void 0&&o.length>0&&o.length<=a.length){if(o.length===a.length&&o===a)return"";var m=o.length-1,p=-1;for(f=a.length-1;f>=0;--f){var x=a.charCodeAt(f);if(x===47){if(!h){l=f+1;break}}else p===-1&&(h=!1,p=f+1),m>=0&&(x===o.charCodeAt(m)?--m===-1&&(c=f):(m=-1,c=p))}return l===c?c=p:c===-1&&(c=a.length),a.slice(l,c)}else{for(f=a.length-1;f>=0;--f)if(a.charCodeAt(f)===47){if(!h){l=f+1;break}}else c===-1&&(h=!1,c=f+1);return c===-1?"":a.slice(l,c)}},extname:function(a){e(a);for(var o=-1,l=0,c=-1,h=!0,f=0,m=a.length-1;m>=0;--m){var p=a.charCodeAt(m);if(p===47){if(!h){l=m+1;break}continue}c===-1&&(h=!1,c=m+1),p===46?o===-1?o=m:f!==1&&(f=1):o!==-1&&(f=-1)}return o===-1||c===-1||f===0||f===1&&o===c-1&&o===l+1?"":a.slice(o,c)},format:function(a){if(a===null||typeof a!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof a);return r("/",a)},parse:function(a){e(a);var o={root:"",dir:"",base:"",ext:"",name:""};if(a.length===0)return o;var l=a.charCodeAt(0),c=l===47,h;c?(o.root="/",h=1):h=0;for(var f=-1,m=0,p=-1,x=!0,g=a.length-1,y=0;g>=h;--g){if(l=a.charCodeAt(g),l===47){if(!x){m=g+1;break}continue}p===-1&&(x=!1,p=g+1),l===46?f===-1?f=g:y!==1&&(y=1):f!==-1&&(y=-1)}return f===-1||p===-1||y===0||y===1&&f===p-1&&f===m+1?p!==-1&&(m===0&&c?o.base=o.name=a.slice(1,p):o.base=o.name=a.slice(m,p)):(m===0&&c?(o.name=a.slice(1,f),o.base=a.slice(1,p)):(o.name=a.slice(m,f),o.base=a.slice(m,p)),o.ext=a.slice(f,p)),m>0?o.dir=a.slice(0,m-1):c&&(o.dir="/"),o},sep:"/",delimiter:":",posix:null};return _x=n,_x}var _B=xB();const Qu=Do(_B);class jl{constructor(e){var t,r;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),r=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(e){return Qu.parse(e)}isAbsolute(e){return Qu.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Qu.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:Qu.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class ka{constructor(e,t){var r=e.indexOf("://")>-1,n=e,s;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!r&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,n=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(s=new jl(this.base),n=s.resolve(n))}this.Path=new jl(n),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,r;return t?e:(r=Qu.resolve(this.directory,e),this.origin+r)}relative(e){return Qu.relative(e,this.directory)}toString(){return this.href}}const ef=1,Js=3,EB=9;class mr{constructor(e,t,r){var n;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof mr))return new mr(e,t,r);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),n=this.checkType(e),n==="string")return this.str=e,mi(this,this.parse(e));if(n==="range")return mi(this,this.fromRange(e,this.base,r));if(n==="node")return mi(this,this.fromNode(e,this.base,r));if(n==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(oD(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof mr?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,n,s;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),r=this.getChapterComponent(e),r?(t.base=this.parseComponent(r),n=this.getPathComponent(e),t.path=this.parseComponent(n),s=this.getRange(e),s&&(t.range=!0,t.start=this.parseComponent(s[0]),t.end=this.parseComponent(s[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),n=r[0].split("/"),s;return r.length>1&&(s=r[1],t.terminal=this.parseTerminal(s)),n[0]===""&&n.shift(),t.steps=n.map((function(a){return this.parseStep(a)}).bind(this)),t}parseStep(e){var t,r,n,s,a;if(s=e.match(/\[(.*)\]/),s&&s[1]&&(a=s[1]),r=parseInt(e),!isNaN(r))return r%2===0?(t="element",n=r/2-1):(t="text",n=(r-1)/2),{type:t,index:n,id:a||null}}parseTerminal(e){var t,r,n=e.match(/\[(.*)\]/);return n&&n[1]?(t=parseInt(e.split("[")[0]),r=n[1]):t=parseInt(e),gn(t)||(t=null),{offset:t,assertion:r}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var r="";return t.type==="element"&&(r+=(t.index+1)*2),t.type==="text"&&(r+=1+2*t.index),t.id&&(r+="["+t.id+"]"),r}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var r,n,s,a;if(typeof e=="string"&&(e=new mr(e)),typeof t=="string"&&(t=new mr(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),s=e.start.terminal):(r=e.path.steps,s=e.path.terminal),t.range?(n=t.path.steps.concat(t.start.steps),a=t.start.terminal):(n=t.path.steps,a=t.path.terminal);for(var o=0;o<r.length;o++){if(!r[o])return-1;if(!n[o]||r[o].index>n[o].index)return 1;if(r[o].index<n[o].index)return-1}return r.length<n.length?-1:s.offset>a.offset?1:s.offset<a.offset?-1:0}step(e){var t=e.nodeType===Js?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var r=this.filter(e,t),n;if(r)return n=r.nodeType===Js?"text":"element",{id:r.id,tagName:r.tagName,type:n,index:this.filteredPosition(r,t)}}pathTo(e,t,r){for(var n={steps:[],terminal:{offset:null,assertion:null}},s=e,a;s&&s.parentNode&&s.parentNode.nodeType!=EB;)r?a=this.filteredStep(s,r):a=this.step(s),a&&n.steps.unshift(a),s=s.parentNode;return t!=null&&t>=0&&(n.terminal.offset=t,n.steps[n.steps.length-1].type!="text"&&n.steps.push({type:"text",index:0})),n}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,r){var n={range:!1,base:{},path:{},start:null,end:null},s=e.startContainer,a=e.endContainer,o=e.startOffset,l=e.endOffset,c=!1;if(r&&(c=s.ownerDocument.querySelector("."+r)!=null),typeof t=="string"?(n.base=this.parseComponent(t),n.spinePos=n.base.steps[1].index):typeof t=="object"&&(n.base=t),e.collapsed)c&&(o=this.patchOffset(s,o,r)),n.path=this.pathTo(s,o,r);else{n.range=!0,c&&(o=this.patchOffset(s,o,r)),n.start=this.pathTo(s,o,r),c&&(l=this.patchOffset(a,l,r)),n.end=this.pathTo(a,l,r),n.path={steps:[],terminal:null};var h=n.start.steps.length,f;for(f=0;f<h&&this.equalStep(n.start.steps[f],n.end.steps[f]);f++)f===h-1?n.start.terminal===n.end.terminal&&(n.path.steps.push(n.start.steps[f]),n.range=!1):n.path.steps.push(n.start.steps[f]);n.start.steps=n.start.steps.slice(n.path.steps.length),n.end.steps=n.end.steps.slice(n.path.steps.length)}return n}fromNode(e,t,r){var n={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(n.base=this.parseComponent(t),n.spinePos=n.base.steps[1].index):typeof t=="object"&&(n.base=t),n.path=this.pathTo(e,null,r),n}filter(e,t){var r,n,s,a,o,l=!1;return e.nodeType===Js?(l=!0,s=e.parentNode,r=e.parentNode.classList.contains(t)):(l=!1,r=e.classList.contains(t)),r&&l?(a=s.previousSibling,o=s.nextSibling,a&&a.nodeType===Js?n=a:o&&o.nodeType===Js&&(n=o),n||e):r&&!l?!1:e}patchOffset(e,t,r){if(e.nodeType!=Js)throw new Error("Anchor must be a text node");var n=e,s=t;for(e.parentNode.classList.contains(r)&&(n=e.parentNode);n.previousSibling;){if(n.previousSibling.nodeType===ef)if(n.previousSibling.classList.contains(r))s+=n.previousSibling.textContent.length;else break;else s+=n.previousSibling.textContent.length;n=n.previousSibling}return s}normalizedMap(e,t,r){var n={},s=-1,a,o=e.length,l,c;for(a=0;a<o;a++)l=e[a].nodeType,l===ef&&e[a].classList.contains(r)&&(l=Js),a>0&&l===Js&&c===Js?n[a]=s:t===l&&(s=s+1,n[a]=s),c=l;return n}position(e){var t,r;return e.nodeType===ef?(t=e.parentNode.children,t||(t=O_(e.parentNode)),r=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),r=t.indexOf(e)),r}filteredPosition(e,t){var r,n,s;return e.nodeType===ef?(r=e.parentNode.children,s=this.normalizedMap(r,ef,t)):(r=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,r=e.parentNode.childNodes),s=this.normalizedMap(r,Js,t)),n=Array.prototype.indexOf.call(r,e),s[n]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(r){var n=r.index+1;r.id?t.push("*[position()="+n+" and @id='"+r.id+"']"):r.type==="text"?t.push("text()["+n+"]"):t.push("*["+n+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(r){var n=r.index+1;r.id?t.push("#"+r.id):r.type==="text"||t.push("*:nth-child("+n+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(r){return r.nodeType===Js?!0:!!(t&&r.classList.contains(t))})}walkToNode(e,t,r){var n=t||document,s=n.documentElement,a,o,l=e.length,c;for(c=0;c<l&&(o=e[c],o.type==="element"?o.id?s=n.getElementById(o.id):(a=s.children||O_(s),s=a[o.index]):o.type==="text"&&(s=this.textNodes(s,r)[o.index]),!!s);c++);return s}findNode(e,t,r){var n=t||document,s,a;return!r&&typeof n.evaluate<"u"?(a=this.stepsToXpath(e),s=n.evaluate(a,n,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?s=this.walkToNode(e,n,r):s=this.walkToNode(e,n),s}fixMiss(e,t,r,n){var s=this.findNode(e.slice(0,-1),r,n),a=s.childNodes,o=this.normalizedMap(a,Js,n),l,c,h=e[e.length-1].index;for(let f in o){if(!o.hasOwnProperty(f))return;if(o[f]===h)if(l=a[f],c=l.textContent.length,t>c)t=t-c;else{l.nodeType===ef?s=l.childNodes[0]:s=l;break}}return{container:s,offset:t}}toRange(e,t){var r=e||document,n,s,a,o,l,c=this,h,f,m=t?r.querySelector("."+t)!=null:!1,p;if(typeof r.createRange<"u"?n=r.createRange():n=new cD,c.range?(s=c.start,h=c.path.steps.concat(s.steps),o=this.findNode(h,r,m?t:null),a=c.end,f=c.path.steps.concat(a.steps),l=this.findNode(f,r,m?t:null)):(s=c.path,h=c.path.steps,o=this.findNode(c.path.steps,r,m?t:null)),o)try{s.terminal.offset!=null?n.setStart(o,s.terminal.offset):n.setStart(o,0)}catch{p=this.fixMiss(h,s.terminal.offset,r,m?t:null),n.setStart(p.container,p.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{a.terminal.offset!=null?n.setEnd(l,a.terminal.offset):n.setEnd(l,0)}catch{p=this.fixMiss(f,c.end.terminal.offset,r,m?t:null),n.setEnd(p.container,p.offset)}return n}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,r){var n=parseInt(t),s=(e+1)*2,a="/"+s+"/";return a+=(n+1)*2,r&&(a+="["+r+"]"),a}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class $a{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let r=0;r<this.hooks.length;r++)if(t=this.hooks[r],t===e){this.hooks.splice(r,1);break}}trigger(){var e=arguments,t=this.context,r=[];return this.hooks.forEach(function(n){try{var s=n.apply(t,e)}catch(a){console.log(a)}s&&typeof s.then=="function"&&r.push(s)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}function dD(i,e){var t,r,n=e.url,s=n.indexOf("://")>-1;i&&(r=jr(i,"head"),t=jr(r,"base"),t||(t=i.createElement("base"),r.insertBefore(t,r.firstChild)),!s&&window&&window.location&&(n=window.location.origin+n),t.setAttribute("href",n))}function SB(i,e){var t,r,n=e.canonical;i&&(t=jr(i,"head"),r=jr(t,"link[rel='canonical']"),r?r.setAttribute("href",n):(r=i.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",n),t.appendChild(r)))}function AB(i,e){var t,r,n=e.idref;i&&(t=jr(i,"head"),r=jr(t,"link[property='dc.identifier']"),r?r.setAttribute("content",n):(r=i.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",n),t.appendChild(r)))}function CB(i,e){var t=i.querySelectorAll("a[href]");if(t.length)for(var r=jr(i.ownerDocument,"base"),n=r?r.getAttribute("href"):void 0,s=(function(o){var l=o.getAttribute("href");if(l.indexOf("mailto:")!==0){var c=l.indexOf("://")>-1;if(c)o.setAttribute("target","_blank");else{var h;try{h=new ka(l,n)}catch{}o.onclick=function(){return h&&h.hash?e(h.Path.path+h.hash):e(h?h.Path.path:l),!1}}}}).bind(this),a=0;a<t.length;a++)s(t[a])}function NT(i,e,t){return e.forEach(function(r,n){r&&t[n]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i=i.replace(new RegExp(r,"g"),t[n]))}),i}function yg(i,e,t,r){var n=typeof window<"u"?window.URL:!1,s=n?"blob":"arraybuffer",a=new pr,o=new XMLHttpRequest,l=XMLHttpRequest.prototype,c;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(o.withCredentials=!0),o.onreadystatechange=f,o.onerror=h,o.open("GET",i,!0);for(c in r)o.setRequestHeader(c,r[c]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new jl(i).extension),e=="blob"&&(o.responseType=s),vg(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function h(m){a.reject(m)}function f(){if(this.readyState===XMLHttpRequest.DONE){var m=!1;if((this.responseType===""||this.responseType==="document")&&(m=this.responseXML),this.status===200||this.status===0||m){var p;if(!this.response&&!m)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;m?p=this.responseXML:vg(e)?p=Ro(this.response,"text/xml"):e=="xhtml"?p=Ro(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?p=Ro(this.response,"text/html"):e=="json"?p=JSON.parse(this.response):e=="blob"?n?p=this.response:p=new Blob([this.response]):p=this.response,a.resolve(p)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}class kB{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new $a(this),this.hooks.content=new $a(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||yg,r=new pr,n=r.promise;return this.contents?r.resolve(this.contents):t(this.url).then((function(s){return this.document=s,this.contents=s.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){r.resolve(this.contents)}).bind(this)).catch(function(s){r.reject(s)}),n}base(){return dD(this.document,this)}render(e){var t=new pr,r=t.promise;return this.output,this.load(e).then((function(n){var s=typeof navigator<"u"&&navigator.userAgent||"",a=s.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||a?o=J5.DOMParser:o=XMLSerializer;var l=new o;return this.output=l.serializeToString(n),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(n){t.reject(n)}),r}find(e){var t=this,r=[],n=e.toLowerCase(),s=function(a){for(var o=a.textContent.toLowerCase(),l=t.document.createRange(),c,h,f=-1,m,p=150;h!=-1;)h=o.indexOf(n,f+1),h!=-1&&(l=t.document.createRange(),l.setStart(a,h),l.setEnd(a,h+n.length),c=t.cfiFromRange(l),a.textContent.length<p?m=a.textContent:(m=a.textContent.substring(h-p/2,h+p/2),m="..."+m+"..."),r.push({cfi:c,excerpt:m})),f=h};return Mb(t.document,function(a){s(a)}),r}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let r=[];const n=150,s=this,a=e.toLowerCase(),o=function(f){const x=f.reduce((g,y)=>g+y.textContent,"").toLowerCase().indexOf(a);if(x!=-1){const y=x+a.length;let b=0,_=0;if(x<f[0].length){let S;for(;b<f.length-1&&(_+=f[b].length,!(y<=_));)b+=1;let k=f[0],C=f[b],R=s.document.createRange();R.setStart(k,x);let N=f.slice(0,b).reduce((I,F)=>I+F.textContent.length,0);R.setEnd(C,N>y?y:y-N),S=s.cfiFromRange(R);let O=f.slice(0,b+1).reduce((I,F)=>I+F.textContent,"");O.length>n&&(O=O.substring(x-n/2,x+n/2),O="..."+O+"..."),r.push({cfi:S,excerpt:O})}}},l=document.createTreeWalker(s.document,NodeFilter.SHOW_TEXT,null,!1);let c,h=[];for(;c=l.nextNode();)h.push(c),h.length==t&&(o(h.slice(0,t)),h=h.slice(1,t));return h.length>0&&o(h),r}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(r){var n=r.replace("rendition:",""),s=n.indexOf("-"),a,o;s!=-1&&(a=n.slice(0,s),o=n.slice(s+1),t[a]=o)}),t}cfiFromRange(e){return new mr(e,this.cfiBase).toString()}cfiFromElement(e){return new mr(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class TB{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new $a,this.hooks.content=new $a,this.hooks.content.register(dD),this.hooks.content.register(SB),this.hooks.content.register(AB),this.epubcfi=new mr,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,r){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((n,s)=>{var a=this.manifest[n.idref],o;n.index=s,n.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,n.index,n.id),n.href&&(n.url=t(n.href,!0),n.canonical=r(n.href)),a&&(n.href=a.href,n.url=t(n.href,!0),n.canonical=r(n.href),a.properties.length&&n.properties.push.apply(n.properties,a.properties)),n.linear==="yes"?(n.prev=(function(){let l=n.index;for(;l>0;){let c=this.get(l-1);if(c&&c.linear)return c;l-=1}}).bind(this),n.next=(function(){let l=n.index;for(;l<this.spineItems.length-1;){let c=this.get(l+1);if(c&&c.linear)return c;l+=1}}).bind(this)):(n.prev=function(){},n.next=function(){}),o=new kB(n,this.hooks),this.append(o)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let r=this.spineItems[t];if(r&&r.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new mr(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,r){t.index=r}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class IS{constructor(e){this._q=[],this.context=e,this.tick=LS,this.running=!1,this.paused=!1}enqueue(){var e,t,r,n=[].shift.call(arguments),s=arguments;if(!n)throw new Error("No Task Provided");return typeof n=="function"?(e=new pr,t=e.promise,r={task:n,args:s,deferred:e,promise:t}):r={promise:n},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var e,t,r;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return r=t.apply(this.context,e.args),r&&typeof r.then=="function"?r.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,r),e.promise);if(e.promise)return e.promise}else return e=new pr,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new pr),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const Fw="0.3",Qy=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],xt={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class hD{constructor(e,t,r){this.spine=e,this.request=t,this.pause=r||100,this.q=new IS(this),this.epubcfi=new mr,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var r=new pr,n=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(n),e.unload(),this.processingTimeout=setTimeout(()=>r.resolve(n),this.pause),r.promise}).bind(this))}parse(e,t,r){var n=[],s,a=e.ownerDocument,o=jr(a,"body"),l=0,c,h=r||this.break,f=function(m){var p=m.length,x,g=0;if(m.textContent.trim().length===0)return!1;for(l==0&&(s=this.createRange(),s.startContainer=m,s.startOffset=0),x=h-l,x>p&&(l+=p,g=p);g<p;)if(x=h-l,l===0&&(g+=1,s=this.createRange(),s.startContainer=m,s.startOffset=g),g+x>=p)l+=p-g,g=p;else{g+=x,s.endContainer=m,s.endOffset=g;let y=new mr(s,t).toString();n.push(y),l=0}c=m};if(Mb(o,f.bind(this)),s&&s.startContainer&&c){s.endContainer=c,s.endOffset=c.length;let m=new mr(s,t).toString();n.push(m),l=0}return n}generateFromWords(e,t,r){var n=e?new mr(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(s){s.linear&&(n?s.index>=n.spinePos&&this.q.enqueue(this.processWords.bind(this),s,t,n,r):this.q.enqueue(this.processWords.bind(this),s,t,n,r))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,r,n){return n&&this._locationsWords.length>=n?Promise.resolve():e.load(this.request).then((function(s){var a=new pr,o=this.parseWords(s,e,t,r),l=n-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=n?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,r,n){var s=t.cfiBase,a=[],o=e.ownerDocument,l=jr(o,"body"),c=r,h=n?n.spinePos!==t.index:!0,f;n&&t.index===n.spinePos&&(f=n.findNode(n.range?n.path.steps.concat(n.start.steps):n.path.steps,e.ownerDocument));var m=function(p){if(!h)if(p===f)h=!0;else return!1;if(p.textContent.length<10&&p.textContent.trim().length===0)return!1;var x=this.countWords(p.textContent),g,y=0;if(x===0)return!1;for(g=c-this._wordCounter,g>x&&(this._wordCounter+=x,y=x);y<x;)if(g=c-this._wordCounter,y+g>=x)this._wordCounter+=x-y,y=x;else{y+=g;let b=new mr(p,s);a.push({cfi:b.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return Mb(l,m.bind(this)),a}locationFromCfi(e){let t;return mr.prototype.isCfiString(e)&&(e=new mr(e)),this._locations.length===0?-1:(t=Op(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let r=new mr(this._locations[this.total]);return r.collapse(),r.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(xt.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}Io(hD.prototype);class RB{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=jr(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=Qu.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class DT{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,r,n;if(!e)throw new Error("Package File Not Found");if(t=jr(e,"metadata"),!t)throw new Error("No Metadata Found");if(r=jr(e,"manifest"),!r)throw new Error("No Manifest Found");if(n=jr(e,"spine"),!n)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,n),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=iD(n),this.spine=this.parseSpine(n,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=n.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},r=Ml(e,"item"),n=Array.prototype.slice.call(r);return n.forEach(function(s){var a=s.getAttribute("id"),o=s.getAttribute("href")||"",l=s.getAttribute("media-type")||"",c=s.getAttribute("media-overlay")||"",h=s.getAttribute("properties")||"";t[a]={href:o,type:l,overlay:c,properties:h.length?h.split(" "):[]}}),t}parseSpine(e,t){var r=[],n=Ml(e,"itemref"),s=Array.prototype.slice.call(n);return s.forEach(function(a,o){var l=a.getAttribute("idref"),c=a.getAttribute("properties")||"",h=c.length?c.split(" "):[],f={id:a.getAttribute("id"),idref:l,linear:a.getAttribute("linear")||"yes",properties:h,index:o};r.push(f)}),r}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var r=e.getElementById(t);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=sf(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var r=sf(e,"item",{"media-type":"application/x-dtbncx+xml"}),n;return r||(n=t.getAttribute("toc"),n&&(r=e.querySelector(`#${n}`))),r?r.getAttribute("href"):!1}findCoverPath(e){var t=jr(e,"package");t.getAttribute("version");var r=sf(e,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var n=sf(e,"meta",{name:"cover"});if(n){var s=n.getAttribute("content"),a=e.getElementById(s);return a?a.getAttribute("href"):""}else return!1}getElementText(e,t){var r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),n;return!r||r.length===0?"":(n=r[0],n.childNodes.length?n.childNodes[0].nodeValue:"")}getPropertyText(e,t){var r=sf(e,"meta",{property:t});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((r,n)=>(r.index=n,r.linear=r.linear||"yes",r)),e.resources.forEach((r,n)=>{this.manifest[n]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((r,n)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Ex{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,r,n;t&&(r=jr(e,"html"),n=jr(e,"ncx")),t?r?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):n&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,r=0;r<e.length;r++)t=e[r],t.href&&(this.tocByHref[t.href]=r),t.id&&(this.tocById[t.id]=r),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,r){if(r.length===0)return;const n=r[t];if(n&&(e===n.id||e===n.href))return n;{let s;for(let a=0;a<r.length&&(s=this.getByIndex(e,t,r[a].subitems),!s);++a);return s}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=jb(e,"nav","toc"),r=[];if(!t)return r;let n=af(t,"ol",!0);return n&&(r=this.parseNavList(n)),r}parseNavList(e,t){const r=[];if(!e||!e.children)return r;for(let n=0;n<e.children.length;n++){const s=this.navItem(e.children[n],t);s&&r.push(s)}return r}navItem(e,t){let r=e.getAttribute("id")||void 0,n=af(e,"a",!0)||af(e,"span",!0);if(!n)return;let s=n.getAttribute("href")||"";r||(r=s);let a=n.textContent||"",o=[],l=af(e,"ol",!0);return l&&(o=this.parseNavList(l,r)),{id:r,href:s,label:a,subitems:o,parent:t}}parseLandmarks(e){var t=jb(e,"nav","landmarks"),r=t?Ml(t,"li"):[],n=r.length,s,a=[],o;if(!r||n===0)return a;for(s=0;s<n;++s)o=this.landmarkItem(r[s]),o&&(a.push(o),this.landmarksByType[o.type]=s);return a}landmarkItem(e){let t=af(e,"a",!0);if(!t)return;let r=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,n=t.getAttribute("href")||"",s=t.textContent||"";return{href:n,label:s,type:r}}parseNcx(e){var t=Ml(e,"navPoint"),r=t.length,n,s={},a=[],o,l;if(!t||r===0)return a;for(n=0;n<r;++n)o=this.ncxItem(t[n]),s[o.id]=o,o.parent?(l=s[o.parent],l.subitems.push(o)):a.push(o);return a}ncxItem(e){var t=e.getAttribute("id")||!1,r=jr(e,"content"),n=r.getAttribute("src"),s=jr(e,"navLabel"),a=s.textContent?s.textContent:"",o=[],l=e.parentNode,c;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(c=l.getAttribute("id")),{id:t,href:n,label:a,subitems:o,parent:c}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var Dm={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},NB=function(){var i,e,t,r,n={};for(i in Dm)if(Dm.hasOwnProperty(i)){for(e in Dm[i])if(Dm[i].hasOwnProperty(e))if(t=Dm[i][e],typeof t=="string")n[t]=i+"/"+e;else for(r=0;r<t.length;r++)n[t[r]]=i+"/"+e}return n}(),DB="text/plain";function LB(i){return i&&NB[i.split(".").pop().toLowerCase()]||DB}const xf={lookup:LB};class PB{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new ka(e),r=xf.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(n=>uD(n)).then(n=>P_(n,r)):this.settings.request(e,"blob").then(n=>Fb(n,r))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var r=this.settings.resolver(t);return this.createUrl(r).catch(n=>(console.error(n),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(r=>typeof r=="string"),t))}replaceCss(e,t){var r=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(n){var s=this.createCssFile(n,e,t).then((function(a){var o=this.urls.indexOf(n);o>-1&&(this.replacementUrls[o]=a)}).bind(this));r.push(s)}).bind(this)),Promise.all(r)}createCssFile(e){var t;if(Qu.isAbsolute(e))return new Promise(function(a){a()});var r=this.settings.resolver(e),n;this.settings.archive?n=this.settings.archive.getText(r):n=this.settings.request(r,"text");var s=this.urls.map(a=>{var o=this.settings.resolver(a),l=new jl(r).relative(o);return l});return n?n.then(a=>(a=NT(a,s,this.replacementUrls),this.settings.replacements==="base64"?t=P_(a,"text/css"):t=Fb(a,"text/css"),t),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(r){var n=t(r),s=new jl(e).relative(n);return s}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(r,n){r(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var r;return t?r=this.relativeTo(t):r=this.urls,NT(e,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Sx{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new mr,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=jr(e,"html"),r=jr(e,"ncx");if(t)return this.parseNav(e);if(r)return this.parseNcx(e)}parseNav(e){var t=jb(e,"nav","page-list"),r=t?Ml(t,"li"):[],n=r.length,s,a=[],o;if(!r||n===0)return a;for(s=0;s<n;++s)o=this.item(r[s]),a.push(o);return a}parseNcx(e){var t=[],r=0,n,s,a,o=0;if(s=jr(e,"pageList"),!s||(a=Ml(s,"pageTarget"),o=a.length,!a||a.length===0))return t;for(r=0;r<o;++r)n=this.ncxItem(a[r]),t.push(n);return t}ncxItem(e){var t=jr(e,"navLabel"),r=jr(t,"text"),n=r.textContent,s=jr(e,"content"),a=s.getAttribute("src"),o=parseInt(n,10);return{href:a,page:o}}item(e){var t=jr(e,"a"),r=t.getAttribute("href")||"",n=t.textContent||"",s=parseInt(n),a=r.indexOf("epubcfi"),o,l,c;return a!=-1?(o=r.split("#"),l=o[0],c=o.length>1?o[1]:!1,{cfi:c,href:r,packageUrl:l,page:s}):{href:r,page:s}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var r=Pb(e,this.locations,this.epubcfi.compare);return r!=-1?t=this.pages[r]:(r=Op(e,this.locations,this.epubcfi.compare),t=r-1>=0?this.pages[r-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var r=this.pages.indexOf(e);return r!=-1&&(t=this.locations[r]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),r=this.percentageFromPage(t);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class fD{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,r){var n=1,s=r||0,a=e,o=t,l=Math.floor(a/12),c,h,f,m;this._spread&&a>=this._minSpreadWidth?n=2:n=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(s=l%2===0?l:l-1),this.name==="pre-paginated"&&(s=0),n>1?(c=a/n-s,f=c+s):(c=a,f=a),this.name==="pre-paginated"&&n>1&&(a=c),h=c*n+s,m=a,this.width=a,this.height=o,this.spreadWidth=h,this.pageWidth=f,this.delta=m,this.columnWidth=c,this.gap=s,this.divisor=n,this.update({width:a,height:o,spreadWidth:h,pageWidth:f,delta:m,columnWidth:c,gap:s,divisor:n})}format(e,t,r){var n;return this.name==="pre-paginated"?n=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?n=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?n=e.size(null,this.height):n=e.size(this.width,null),n}count(e,t){let r,n;return this.name==="pre-paginated"?(r=1,n=1):this._flow==="paginated"?(t=t||this.delta,r=Math.ceil(e/t),n=r*this.divisor):(t=t||this.height,r=Math.ceil(e/t),n=r),{spreads:r,pages:n}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=mi(this.props,e);this.emit(xt.LAYOUT.UPDATED,t,e)}}}Io(fD.prototype);class OB{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var r=new ka(t);this._themes[e]={url:r.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,r;this._current=e,this.update(e),r=this.rendition.getContents(),r.forEach(n=>{n.removeClass(t),n.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(r=>{this.add(e,r)})}inject(e){var t=[],r=this._themes,n;for(var s in r)r.hasOwnProperty(s)&&(s===this._current||s==="default")&&(n=r[s],(n.rules&&Object.keys(n.rules).length>0||n.url&&t.indexOf(n.url)===-1)&&this.add(s,e),this._injected.push(s));this._current!="default"&&e.addClass(this._current)}add(e,t){var r=this._themes[e];!r||!t||(r.url?t.addStylesheet(r.url):r.serialized?(t.addStylesheetCss(r.serialized,e),r.injected=!0):r.rules&&(t.addStylesheetRules(r.rules,e),r.injected=!0))}override(e,t,r){var n=this.rendition.getContents();this._overrides[e]={value:t,priority:r===!0},n.forEach(s=>{s.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(r=>{r.css(e)})}overrides(e){var t=this._overrides;for(var r in t)t.hasOwnProperty(r)&&e.css(r,t[r].value,t[r].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class Bb{constructor(e,t,r,n=!1){this.layout=e,this.horizontal=r==="horizontal",this.direction=t||"ltr",this._dev=n}section(e){var t=this.findRanges(e),r=this.rangeListToCfiList(e.section.cfiBase,t);return r}page(e,t,r,n){var s=e&&e.document?e.document.body:!1,a;if(s){if(a=this.rangePairToCfiPair(t,{start:this.findStart(s,r,n),end:this.findEnd(s,r,n)}),this._dev===!0){let o=e.document,l=new mr(a.start).toRange(o),c=new mr(a.end).toRange(o),h=o.defaultView.getSelection(),f=o.createRange();h.removeAllRanges(),f.setStart(l.startContainer,l.startOffset),f.setEnd(c.endContainer,c.endOffset),h.addRange(f)}return a}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},n=r.acceptNode;n.acceptNode=r.acceptNode;for(var s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,n,!1),a,o;(a=s.nextNode())&&(o=t(a),!o););return o}}findRanges(e){for(var t=[],r=e.contents.scrollWidth(),n=Math.ceil(r/this.layout.spreadWidth),s=n*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l,c,h=0;h<s.pages;h++)l=(a+o)*h,c=a*(h+1)+o*h,t.push({start:this.findStart(e.document.body,l,c),end:this.findEnd(e.document.body,l,c)});return t}findStart(e,t,r){for(var n=[e],s,a,o=e;n.length;)if(s=n.shift(),a=this.walk(s,l=>{var c,h,f,m,p;if(p=L_(l),this.horizontal&&this.direction==="ltr"){if(c=this.horizontal?p.left:p.top,h=this.horizontal?p.right:p.bottom,c>=t&&c<=r)return l;if(h>t)return l;o=l,n.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(c=p.left,h=p.right,h<=r&&h>=t)return l;if(c<r)return l;o=l,n.push(l)}else{if(f=p.top,m=p.bottom,f>=t&&f<=r)return l;if(m>t)return l;o=l,n.push(l)}}),a)return this.findTextStartRange(a,t,r);return this.findTextStartRange(o,t,r)}findEnd(e,t,r){for(var n=[e],s,a=e,o;n.length;)if(s=n.shift(),o=this.walk(s,l=>{var c,h,f,m,p;if(p=L_(l),this.horizontal&&this.direction==="ltr"){if(c=Math.round(p.left),h=Math.round(p.right),c>r&&a)return a;if(h>r)return l;a=l,n.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(c=Math.round(this.horizontal?p.left:p.top),h=Math.round(this.horizontal?p.right:p.bottom),h<t&&a)return a;if(c<t)return l;a=l,n.push(l)}else{if(f=Math.round(p.top),m=Math.round(p.bottom),f>r&&a)return a;if(m>r)return l;a=l,n.push(l)}}),o)return this.findTextEndRange(o,t,r);return this.findTextEndRange(a,t,r)}findTextStartRange(e,t,r){for(var n=this.splitTextNodeIntoRanges(e),s,a,o,l,c,h=0;h<n.length;h++)if(s=n[h],a=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=t)return s}else if(this.horizontal&&this.direction==="rtl"){if(c=a.right,c<=r)return s}else if(l=a.top,l>=t)return s;return n[0]}findTextEndRange(e,t,r){for(var n=this.splitTextNodeIntoRanges(e),s,a,o,l,c,h,f,m=0;m<n.length;m++){if(a=n[m],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=o.left,c=o.right,l>r&&s)return s;if(c>r)return a}else if(this.horizontal&&this.direction==="rtl"){if(l=o.left,c=o.right,c<t&&s)return s;if(l<t)return a}else{if(h=o.top,f=o.bottom,h>r&&s)return s;if(f>r)return a}s=a}return n[n.length-1]}splitTextNodeIntoRanges(e,t){var r=[],n=e.textContent||"",s=n.trim(),a,o=e.ownerDocument,l=t||" ",c=s.indexOf(l);if(c===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,c),r.push(a),a=!1;c!=-1;)c=s.indexOf(l,c+1),c>0&&(a&&(a.setEnd(e,c),r.push(a)),a=o.createRange(),a.setStart(e,c+1));return a&&(a.setEnd(e,s.length),r.push(a)),r}rangePairToCfiPair(e,t){var r=t.start,n=t.end;r.collapse(!0),n.collapse(!1);let s=new mr(r,e).toString(),a=new mr(n,e).toString();return{start:s,end:a}}rangeListToCfiList(e,t){for(var r=[],n,s=0;s<t.length;s++)n=this.rangePairToCfiPair(e,t[s]),r.push(n);return r}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const pD=typeof navigator<"u",IB=pD&&/Chrome/.test(navigator.userAgent),LT=pD&&!IB&&/AppleWebKit/.test(navigator.userAgent),FB=1;class FS{constructor(e,t,r,n){this.epubcfi=new mr,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=n||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",Fw),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Qy}width(e){var t=this.content;return e&&gn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&gn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&gn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&gn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,r=this.document.createRange(),n=this.content||this.document.body,s=Ob(n);return r.selectNodeContents(n),e=r.getBoundingClientRect(),t=e.width,s&&s.width&&(t+=s.width),Math.round(t)}textHeight(){let e,t,r=this.document.createRange(),n=this.content||this.document.body;return r.selectNodeContents(n),e=r.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,r){var n=this.content||this.document.body;return t?n.style.setProperty(e,t,r?"important":""):n.style.removeProperty(e),this.window.getComputedStyle(n)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},n=[],s={};if(t&&t.hasAttribute("content")){let a=t.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),l=a.match(/height\s*=\s*([^,]*)/),c=a.match(/initial-scale\s*=\s*([^,]*)/),h=a.match(/minimum-scale\s*=\s*([^,]*)/),f=a.match(/maximum-scale\s*=\s*([^,]*)/),m=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(r.width=o[1]),l&&l.length&&typeof l[1]<"u"&&(r.height=l[1]),c&&c.length&&typeof c[1]<"u"&&(r.scale=c[1]),h&&h.length&&typeof h[1]<"u"&&(r.minimum=h[1]),f&&f.length&&typeof f[1]<"u"&&(r.maximum=f[1]),m&&m.length&&typeof m[1]<"u"&&(r.scalable=m[1])}return s=nD(e||{},r),e&&(s.width&&n.push("width="+s.width),s.height&&n.push("height="+s.height),s.scale&&n.push("initial-scale="+s.scale),s.scalable==="no"?(n.push("minimum-scale="+s.scale),n.push("maximum-scale="+s.scale),n.push("user-scalable="+s.scalable)):(s.scalable&&n.push("user-scalable="+s.scalable),s.minimum&&n.push("minimum-scale="+s.minimum),s.maximum&&n.push("minimum-scale="+s.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",n.join(", ")),this.window.scrollTo(0,0)),s}expand(){this.emit(xt.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(xt.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<e.length;r+=1){var n;try{n=e[r].cssRules}catch{return}if(!n)return;for(var s=0;s<n.length;s+=1)if(n[s].media){var a=this.window.matchMedia(n[s].media.mediaText);a.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,r=0;r<e.length;r++)t=e[r],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var r,n={left:0,top:0};if(!this.document)return n;if(this.epubcfi.isCfiString(e)){let s=new mr(e).toRange(this.document,t);if(s){try{if(!s.endContainer||s.startContainer==s.endContainer&&s.startOffset==s.endOffset){let a=s.startContainer.textContent.indexOf(" ",s.startOffset);a==-1&&(a=s.startContainer.textContent.length),s.setEnd(s.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(s.startContainer.nodeType===Node.ELEMENT_NODE)r=s.startContainer.getBoundingClientRect(),n.left=r.left,n.top=r.top;else if(LT){let a=s.startContainer,o=new Range;try{a.nodeType===FB?r=a.getBoundingClientRect():s.startOffset+2<a.length?(o.setStart(a,s.startOffset),o.setEnd(a,s.startOffset+2),r=o.getBoundingClientRect()):s.startOffset-2>0?(o.setStart(a,s.startOffset-2),o.setEnd(a,s.startOffset),r=o.getBoundingClientRect()):r=a.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else r=s.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let s=e.substring(e.indexOf("#")+1),a=this.document.getElementById(s);if(a)if(LT){let o=new Range;o.selectNode(a),r=o.getBoundingClientRect()}else r=a.getBoundingClientRect()}return r&&(n.left=r.left,n.top=r.top),n}addStylesheet(e){return new Promise((function(t,r){var n,s=!1;if(!this.document){t(!1);return}if(n=this.document.querySelector("link[href='"+e+"']"),n){t(!0);return}n=this.document.createElement("link"),n.type="text/css",n.rel="stylesheet",n.href=e,n.onload=n.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(n)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var r;return r=this._getStylesheetNode(t),r.innerHTML=e,!0}addStylesheetRules(e,t){var r;if(!(!this.document||!e||e.length===0))if(r=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var n=0,s=e.length;n<s;n++){var a=1,o=e[n],l=e[n][0],c="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var h=o.length;a<h;a++){var f=o[a];c+=f[0]+":"+f[1]+(f[2]?" !important":"")+`;
`}r.insertRule(l+"{"+c+"}",r.cssRules.length)}else Object.keys(e).forEach(p=>{const x=e[p];if(Array.isArray(x))x.forEach(g=>{const b=Object.keys(g).map(_=>`${_}:${g[_]}`).join(";");r.insertRule(`${p}{${b}}`,r.cssRules.length)});else{const y=Object.keys(x).map(b=>`${b}:${x[b]}`).join(";");r.insertRule(`${p}{${y}}`,r.cssRules.length)}})}addScript(e){return new Promise((function(t,r){var n,s=!1;if(!this.document){t(!1);return}n=this.document.createElement("script"),n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(n)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),Qy.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(Qy.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,r;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(r=new mr(t,this.cfiBase).toString(),this.emit(xt.CONTENTS.SELECTED,r),this.emit(xt.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var r=new mr(e);return r.toRange(this.document,t)}cfiFromRange(e,t){return new mr(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new mr(e,this.cfiBase,t).toString()}map(e){var t=new Bb(e);return t.section()}size(e,t){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),r.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),r.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(e,t,r,n,s){let a=nf("column-axis"),o=nf("column-gap"),l=nf("column-width"),c=nf("column-fill"),f=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),s==="rtl"&&f==="horizontal"&&this.direction(s),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),f==="vertical"?(this.css("padding-top",n/2+"px",!0),this.css("padding-bottom",n/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",n/2+"px",!0),this.css("padding-right",n/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(c,"auto"),this.css(o,n+"px"),this.css(l,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,r){var n="scale("+e+")",s="";this.css("transform-origin","top left"),(t>=0||r>=0)&&(s=" translate("+(t||0)+"px, "+(r||0)+"px )"),this.css("transform",n+s)}fit(e,t,r){var n=this.viewport(),s=parseInt(n.width),a=parseInt(n.height),o=e/s,l=t/a,c=o<l?o:l;if(this.layoutStyle("paginated"),this.width(s),this.height(a),this.overflow("hidden"),this.scaler(c,0,0),this.css("background-size",s*c+"px "+a*c+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var h=e-s*c;this.css("margin-left",h+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,r,n,s){var a=new Bb(t,s);return a.page(this,e,r,n)}linksHandler(){CB(this.content,e=>{this.emit(xt.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=nf("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}Io(FS.prototype);class MB{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,r,n,s,a){let o=encodeURI(t+e),c=new mr(t).spinePos,h=new mD({type:e,cfiRange:t,data:r,sectionIndex:c,cb:n,className:s,styles:a});return this._annotations[o]=h,c in this._annotationsBySectionIndex?this._annotationsBySectionIndex[c].push(o):this._annotationsBySectionIndex[c]=[o],this.rendition.views().forEach(m=>{h.sectionIndex===m.index&&h.attach(m)}),h}remove(e,t){let r=encodeURI(e+t);if(r in this._annotations){let n=this._annotations[r];if(t&&n.type!==t)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(n.sectionIndex,r),n.sectionIndex===a.index&&n.detach(a)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(r=>r!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,r,n,s){return this.add("highlight",e,t,r,n,s)}underline(e,t,r,n,s){return this.add("underline",e,t,r,n,s)}mark(e,t,r){return this.add("mark",e,t,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(n=>{this._annotations[n].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(n=>{this._annotations[n].detach(e)})}show(){}hide(){}}class mD{constructor({type:e,cfiRange:t,data:r,sectionIndex:n,cb:s,className:a,styles:o}){this.type=e,this.cfiRange=t,this.data=r,this.sectionIndex=n,this.mark=void 0,this.cb=s,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:r,type:n,mark:s,cb:a,className:o,styles:l}=this,c;return n==="highlight"?c=e.highlight(t,r,a,o,l):n==="underline"?c=e.underline(t,r,a,o,l):n==="mark"&&(c=e.mark(t,r,a)),this.mark=c,this.emit(xt.ANNOTATION.ATTACH,c),c}detach(e){let{cfiRange:t,type:r}=this,n;return e&&(r==="highlight"?n=e.unhighlight(t):r==="underline"?n=e.ununderline(t):r==="mark"&&(n=e.unmark(t))),this.mark=void 0,this.emit(xt.ANNOTATION.DETACH,n),n}text(){}}Io(mD.prototype);var Ea={},Lm={},PT;function jB(){if(PT)return Lm;PT=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.createElement=i;function i(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}return Lm.default={createElement:i},Lm}var tf={},OT;function BB(){if(OT)return tf;OT=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.proxyMouse=i,tf.clone=e,tf.default={proxyMouse:i};function i(r,n){function s(c){for(var h=n.length-1;h>=0;h--){var f=n[h],m=c.clientX,p=c.clientY;if(c.touches&&c.touches.length&&(m=c.touches[0].clientX,p=c.touches[0].clientY),!!t(f,r,m,p)){f.dispatchEvent(e(c));break}}}if(r.nodeName==="iframe"||r.nodeName==="IFRAME")try{this.target=r.contentDocument}catch{this.target=r}else this.target=r;for(var a=["mouseup","mousedown","click","touchstart"],o=0;o<a.length;o++){var l=a[o];this.target.addEventListener(l,function(c){return s(c)},!1)}}function e(r){var n=Object.assign({},r,{bubbles:!1});try{return new MouseEvent(r.type,n)}catch{var s=document.createEvent("MouseEvents");return s.initMouseEvent(r.type,!1,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),s}}function t(r,n,s,a){var o=n.getBoundingClientRect();function l(p,x,g){var y=p.top-o.top,b=p.left-o.left,_=y+p.height,S=b+p.width;return y<=g&&b<=x&&_>g&&S>x}var c=r.getBoundingClientRect();if(!l(c,s,a))return!1;for(var h=r.getClientRects(),f=0,m=h.length;f<m;f++)if(l(h[f],s,a))return!0;return!1}return tf}var IT;function zB(){if(IT)return Ea;IT=1,Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.Underline=Ea.Highlight=Ea.Mark=Ea.Pane=void 0;var i=function g(y,b,_){y===null&&(y=Function.prototype);var S=Object.getOwnPropertyDescriptor(y,b);if(S===void 0){var k=Object.getPrototypeOf(y);return k===null?void 0:g(k,b,_)}else{if("value"in S)return S.value;var C=S.get;return C===void 0?void 0:C.call(_)}},e=function(){function g(y,b){for(var _=0;_<b.length;_++){var S=b[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(y,S.key,S)}}return function(y,b,_){return b&&g(y.prototype,b),_&&g(y,_),y}}(),t=jB(),r=a(t),n=BB(),s=a(n);function a(g){return g&&g.__esModule?g:{default:g}}function o(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function l(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}function c(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}Ea.Pane=function(){function g(y){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;c(this,g),this.target=y,this.element=r.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),s.default.proxyMouse(this.target,this.marks),this.container=b,this.container.appendChild(this.element),this.render()}return e(g,[{key:"addMark",value:function(b){var _=r.default.createElement("g");return this.element.appendChild(_),b.bind(_,this.container),this.marks.push(b),b.render(),b}},{key:"removeMark",value:function(b){var _=this.marks.indexOf(b);if(_!==-1){var S=b.unbind();this.element.removeChild(S),this.marks.splice(_,1)}}},{key:"render",value:function(){p(this.element,m(this.target,this.container));var b=!0,_=!1,S=void 0;try{for(var k=this.marks[Symbol.iterator](),C;!(b=(C=k.next()).done);b=!0){var R=C.value;R.render()}}catch(N){_=!0,S=N}finally{try{!b&&k.return&&k.return()}finally{if(_)throw S}}}}]),g}();var h=Ea.Mark=function(){function g(){c(this,g),this.element=null}return e(g,[{key:"bind",value:function(b,_){this.element=b,this.container=_}},{key:"unbind",value:function(){var b=this.element;return this.element=null,b}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(b){this.element&&this.element.dispatchEvent(b)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var b=[],_=this.element.firstChild;_;)b.push(_.getBoundingClientRect()),_=_.nextSibling;return b}},{key:"filteredRanges",value:function(){var b=Array.from(this.range.getClientRects());return b.filter(function(_){for(var S=0;S<b.length;S++){if(b[S]===_)return!0;var k=x(b[S],_);if(k)return!1}return!0})}}]),g}(),f=Ea.Highlight=function(g){l(y,g);function y(b,_,S,k){c(this,y);var C=o(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return C.range=b,C.className=_,C.data=S||{},C.attributes=k||{},C}return e(y,[{key:"bind",value:function(_,S){i(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"bind",this).call(this,_,S);for(var k in this.data)this.data.hasOwnProperty(k)&&(this.element.dataset[k]=this.data[k]);for(var k in this.attributes)this.attributes.hasOwnProperty(k)&&this.element.setAttribute(k,this.attributes[k]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var _=this.element.ownerDocument.createDocumentFragment(),S=this.filteredRanges(),k=this.element.getBoundingClientRect(),C=this.container.getBoundingClientRect(),R=0,N=S.length;R<N;R++){var O=S[R],I=r.default.createElement("rect");I.setAttribute("x",O.left-k.left+C.left),I.setAttribute("y",O.top-k.top+C.top),I.setAttribute("height",O.height),I.setAttribute("width",O.width),_.appendChild(I)}this.element.appendChild(_)}}]),y}(h);Ea.Underline=function(g){l(y,g);function y(b,_,S,k){return c(this,y),o(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,b,_,S,k))}return e(y,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var _=this.element.ownerDocument.createDocumentFragment(),S=this.filteredRanges(),k=this.element.getBoundingClientRect(),C=this.container.getBoundingClientRect(),R=0,N=S.length;R<N;R++){var O=S[R],I=r.default.createElement("rect");I.setAttribute("x",O.left-k.left+C.left),I.setAttribute("y",O.top-k.top+C.top),I.setAttribute("height",O.height),I.setAttribute("width",O.width),I.setAttribute("fill","none");var F=r.default.createElement("line");F.setAttribute("x1",O.left-k.left+C.left),F.setAttribute("x2",O.left-k.left+C.left+O.width),F.setAttribute("y1",O.top-k.top+C.top+O.height-1),F.setAttribute("y2",O.top-k.top+C.top+O.height-1),F.setAttribute("stroke-width",1),F.setAttribute("stroke","black"),F.setAttribute("stroke-linecap","square"),_.appendChild(I),_.appendChild(F)}this.element.appendChild(_)}}]),y}(f);function m(g,y){var b=y.getBoundingClientRect(),_=g.getBoundingClientRect();return{top:_.top-b.top,left:_.left-b.left,height:g.scrollHeight,width:g.scrollWidth}}function p(g,y){g.style.setProperty("top",y.top+"px","important"),g.style.setProperty("left",y.left+"px","important"),g.style.setProperty("height",y.height+"px","important"),g.style.setProperty("width",y.width+"px","important")}function x(g,y){return y.right<=g.right&&y.left>=g.left&&y.top>=g.top&&y.bottom<=g.bottom}return Ea}var Iy=zB();class gD{constructor(e,t){this.settings=mi({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+Iw(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new mr,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Zy(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(r){return this.load(r)}).bind(this)).then((function(){let r=this.contents.writingMode(),n;return this.settings.flow==="scrolled"?n=r.indexOf("vertical")===0?"horizontal":"vertical":n=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(n),this.emit(xt.VIEWS.AXIS,n),this.setWritingMode(r),this.emit(xt.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((s,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),s()})}).bind(this),(function(r){return this.emit(xt.VIEWS.LOAD_ERROR,r),new Promise((n,s)=>{s(r)})}).bind(this)).then((function(){this.emit(xt.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var r=e||this.settings.width,n=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,n):this.settings.axis==="horizontal"?this.lock("height",r,n):this.lock("width",r,n),this.settings.width=r,this.settings.height=n}lock(e,t,r){var n=Ob(this.element),s;this.iframe?s=Ob(this.iframe):s={width:0,height:0},e=="width"&&gn(t)&&(this.lockedWidth=t-n.width-s.width),e=="height"&&gn(r)&&(this.lockedHeight=r-n.height-s.height),e==="both"&&gn(t)&&gn(r)&&(this.lockedWidth=t-n.width-s.width,this.lockedHeight=r-n.height-s.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,r=this.lockedHeight,n;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(n=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&n%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||r!=this._height)&&this.reframe(t,r),this._expanding=!1)}reframe(e,t){var r;gn(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),gn(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let n=this.prevBounds?e-this.prevBounds.width:e,s=this.prevBounds?t-this.prevBounds.height:t;r={width:e,height:t,widthDelta:n,heightDelta:s},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,r),this.emit(xt.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=Zy(this.element)}load(e){var t=new pr,r=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=(function(s){this.onLoad(s,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=Fb(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var n=this;MSApp.execUnsafeLocalFunction(function(){n.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return r}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new FS(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(xt.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(xt.CONTENTS.RESIZE,n=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new pr;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(xt.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(r){t.reject(r,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(xt.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(xt.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=Zy(this.element)),this.elementBounds}highlight(e,t={},r,n="epubjs-hl",s={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},s);let o=this.contents.range(e),l=()=>{this.emit(xt.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Iy.Pane(this.iframe,this.element));let c=new Iy.Highlight(o,n,t,a),h=this.pane.addMark(c);return this.highlights[e]={mark:h,element:h.element,listeners:[l,r]},h.element.setAttribute("ref",n),h.element.addEventListener("click",l),h.element.addEventListener("touchstart",l),r&&(h.element.addEventListener("click",r),h.element.addEventListener("touchstart",r)),h}underline(e,t={},r,n="epubjs-ul",s={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},s);let o=this.contents.range(e),l=()=>{this.emit(xt.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Iy.Pane(this.iframe,this.element));let c=new Iy.Underline(o,n,t,a),h=this.pane.addMark(c);return this.underlines[e]={mark:h,element:h.element,listeners:[l,r]},h.element.setAttribute("ref",n),h.element.addEventListener("click",l),h.element.addEventListener("touchstart",l),r&&(h.element.addEventListener("click",r),h.element.addEventListener("touchstart",r)),h}mark(e,t={},r){if(!this.contents)return;if(e in this.marks)return this.marks[e];let n=this.contents.range(e);if(!n)return;let s=n.commonAncestorContainer,a=s.nodeType===1?s:s.parentNode,o=c=>{this.emit(xt.VIEWS.MARK_CLICKED,e,t)};n.collapsed&&s.nodeType===1?(n=new Range,n.selectNodeContents(s)):n.collapsed&&(n=new Range,n.selectNodeContents(a));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(c=>{l.dataset[c]=t[c]}),r&&(l.addEventListener("click",r),l.addEventListener("touchstart",r)),l.addEventListener("click",o),l.addEventListener("touchstart",o),this.placeMark(l,n),this.element.appendChild(l),this.marks[e]={element:l,range:n,listeners:[o,r]},a}placeMark(e,t){let r,n,s;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=t.getBoundingClientRect();r=o.top,n=o.right}else{let o=t.getClientRects(),l;for(var a=0;a!=o.length;a++)l=o[a],(!s||l.left<s)&&(s=l.left,n=Math.ceil(s/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=l.top)}e.style.top=`${r}px`,e.style.left=`${n}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&aD(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}Io(gD.prototype);function $B(){var i="reverse",e=UB();return document.body.appendChild(e),e.scrollLeft>0?i="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(i="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(i="negative")),document.body.removeChild(e),i}function UB(){var i=document.createElement("div");i.dir="rtl",i.style.position="fixed",i.style.width="1px",i.style.height="1px",i.style.top="0px",i.style.left="0px",i.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",e.appendChild(t),e.appendChild(r),i.appendChild(e),i}var Ax,FT;function MS(){if(FT)return Ax;FT=1;function i(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Ax=i,Ax}var Cx,MT;function HB(){if(MT)return Cx;MT=1;var i=typeof Li=="object"&&Li&&Li.Object===Object&&Li;return Cx=i,Cx}var kx,jT;function vD(){if(jT)return kx;jT=1;var i=HB(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=i||e||Function("return this")();return kx=t,kx}var Tx,BT;function WB(){if(BT)return Tx;BT=1;var i=vD(),e=function(){return i.Date.now()};return Tx=e,Tx}var Rx,zT;function VB(){if(zT)return Rx;zT=1;var i=/\s/;function e(t){for(var r=t.length;r--&&i.test(t.charAt(r)););return r}return Rx=e,Rx}var Nx,$T;function GB(){if($T)return Nx;$T=1;var i=VB(),e=/^\s+/;function t(r){return r&&r.slice(0,i(r)+1).replace(e,"")}return Nx=t,Nx}var Dx,UT;function yD(){if(UT)return Dx;UT=1;var i=vD(),e=i.Symbol;return Dx=e,Dx}var Lx,HT;function qB(){if(HT)return Lx;HT=1;var i=yD(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,n=i?i.toStringTag:void 0;function s(a){var o=t.call(a,n),l=a[n];try{a[n]=void 0;var c=!0}catch{}var h=r.call(a);return c&&(o?a[n]=l:delete a[n]),h}return Lx=s,Lx}var Px,WT;function YB(){if(WT)return Px;WT=1;var i=Object.prototype,e=i.toString;function t(r){return e.call(r)}return Px=t,Px}var Ox,VT;function XB(){if(VT)return Ox;VT=1;var i=yD(),e=qB(),t=YB(),r="[object Null]",n="[object Undefined]",s=i?i.toStringTag:void 0;function a(o){return o==null?o===void 0?n:r:s&&s in Object(o)?e(o):t(o)}return Ox=a,Ox}var Ix,GT;function KB(){if(GT)return Ix;GT=1;function i(e){return e!=null&&typeof e=="object"}return Ix=i,Ix}var Fx,qT;function ZB(){if(qT)return Fx;qT=1;var i=XB(),e=KB(),t="[object Symbol]";function r(n){return typeof n=="symbol"||e(n)&&i(n)==t}return Fx=r,Fx}var Mx,YT;function QB(){if(YT)return Mx;YT=1;var i=GB(),e=MS(),t=ZB(),r=NaN,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(t(c))return r;if(e(c)){var h=typeof c.valueOf=="function"?c.valueOf():c;c=e(h)?h+"":h}if(typeof c!="string")return c===0?c:+c;c=i(c);var f=s.test(c);return f||a.test(c)?o(c.slice(2),f?2:8):n.test(c)?r:+c}return Mx=l,Mx}var jx,XT;function bD(){if(XT)return jx;XT=1;var i=MS(),e=WB(),t=QB(),r="Expected a function",n=Math.max,s=Math.min;function a(o,l,c){var h,f,m,p,x,g,y=0,b=!1,_=!1,S=!0;if(typeof o!="function")throw new TypeError(r);l=t(l)||0,i(c)&&(b=!!c.leading,_="maxWait"in c,m=_?n(t(c.maxWait)||0,l):m,S="trailing"in c?!!c.trailing:S);function k(Y){var j=h,ae=f;return h=f=void 0,y=Y,p=o.apply(ae,j),p}function C(Y){return y=Y,x=setTimeout(O,l),b?k(Y):p}function R(Y){var j=Y-g,ae=Y-y,he=l-j;return _?s(he,m-ae):he}function N(Y){var j=Y-g,ae=Y-y;return g===void 0||j>=l||j<0||_&&ae>=m}function O(){var Y=e();if(N(Y))return I(Y);x=setTimeout(O,R(Y))}function I(Y){return x=void 0,S&&h?k(Y):(h=f=void 0,p)}function F(){x!==void 0&&clearTimeout(x),y=0,h=g=f=x=void 0}function G(){return x===void 0?p:I(e())}function B(){var Y=e(),j=N(Y);if(h=arguments,f=this,g=Y,j){if(x===void 0)return C(g);if(_)return clearTimeout(x),x=setTimeout(O,l),k(g)}return x===void 0&&(x=setTimeout(O,l)),p}return B.cancel=F,B.flush=G,B}return jx=a,jx}var Bx,KT;function JB(){if(KT)return Bx;KT=1;var i=bD(),e=MS(),t="Expected a function";function r(n,s,a){var o=!0,l=!0;if(typeof n!="function")throw new TypeError(t);return e(a)&&(o="leading"in a?!!a.leading:o,l="trailing"in a?!!a.trailing:l),i(n,s,{leading:o,maxWait:s,trailing:l})}return Bx=r,Bx}var ez=JB();const tz=Do(ez);class rz{constructor(e){this.settings=e||{},this.id="epubjs-container-"+Iw(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,r=e.width,n=e.overflow||!1,s=e.axis||"vertical",a=e.direction;mi(this.settings,e),e.height&&gn(e.height)&&(t=e.height+"px"),e.width&&gn(e.width)&&(r=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",s==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),r&&(o.style.width=r),t&&(o.style.height=t),n&&(n==="scroll"&&s==="vertical"?(o.style["overflow-y"]=n,o.style["overflow-x"]="hidden"):n==="scroll"&&s==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=n):o.style.overflow=n),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(tD(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),r;if(t)return this.settings.hidden?r=this.wrapper:r=this.container,t.appendChild(r),this.element=t,t}getContainer(){return this.container}onResize(e){(!gn(this.settings.width)||!gn(this.settings.height))&&(this.resizeFunc=tz(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var r;let n=e||this.settings.width,s=t||this.settings.height;e===null?(r=this.element.getBoundingClientRect(),r.width&&(e=Math.floor(r.width),this.container.style.width=e+"px")):gn(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(r=r||this.element.getBoundingClientRect(),r.height&&(t=r.height,this.container.style.height=t+"px")):gn(t)?this.container.style.height=t+"px":this.container.style.height=t,gn(e)||(e=this.container.clientWidth),gn(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=Ib(),o=window.getComputedStyle(document.body),l={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return n||(e=a.width-l.left-l.right),(this.settings.fullsize&&!s||!s)&&(t=a.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?Ib():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var r="#"+this.id+" ",n="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(s){for(var a in s)s.hasOwnProperty(a)&&(n+=a+":"+s[a]+";")}),this.sheet.insertRule(r+e+" {"+n+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class nz{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var r=0;r<t;r++)e=this._views[r],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,r=this.length,n=0;n<r;n++)if(t=this._views[n],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,r=this.length,n=0;n<r;n++)t=this._views[n],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.hide();this.hidden=!0}}class zb{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new IS(this),this.settings=mi(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),mi(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let r=e.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=$B(),this.stage=new rz({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new nz(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(xt.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,r){let n=this.stage.size(e,t);if(this.winBounds=Ib(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===n.width&&this._stageSize.height===n.height||(this._stageSize=n,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(xt.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(e,t){return new this.View(e,mi(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,r){let n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(n=t.next(),n&&!n.properties.includes("page-spread-left"))return r.call(this,n)}}display(e,t){var r=new pr,n=r.promise;(t===e.href||gn(t))&&(t=void 0);var s=this.views.find(e);if(s&&e&&this.layout.name!=="pre-paginated"){let o=s.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let l=s.width();this.scrollTo(o.left+l,o.top,!0)}if(t){let l=s.locationOf(t),c=s.width();this.moveTo(l,c)}return r.resolve(),n}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then((function(o){if(t){let l=o.locationOf(t),c=o.width();this.moveTo(l,c)}}).bind(this),o=>{r.reject(o)}).then((function(){return this.handleNextPrePaginated(a,e,this.add)}).bind(this)).then((function(){this.views.show(),r.resolve()}).bind(this)),n}afterDisplayed(e){this.emit(xt.MANAGERS.ADDED,e)}afterResized(e){this.emit(xt.MANAGERS.RESIZE,e.section)}moveTo(e,t){var r=0,n=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),n=Math.floor(e.top/this.layout.delta)*this.layout.delta,n+this.layout.delta>this.container.scrollHeight&&(n=this.container.scrollHeight-this.layout.delta)):n=e.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-t),this.scrollTo(r,n,!0)}add(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(xt.VIEWS.AXIS,n=>{this.updateAxis(n)}),r.on(xt.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),r.display(this.request)}append(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(xt.VIEWS.AXIS,n=>{this.updateAxis(n)}),r.on(xt.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),r.display(this.request)}prepend(e,t){var r=this.createView(e,t);return r.on(xt.VIEWS.RESIZED,n=>{this.counter(n)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(xt.VIEWS.AXIS,n=>{this.updateAxis(n)}),r.on(xt.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),r.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let n=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(n=!0),this.append(e,n).then((function(){return this.handleNextPrePaginated(n,e,this.append)}).bind(this),s=>s).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let n=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(n=!0),this.prepend(e,n).then((function(){var s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(s=e.prev(),s))return this.prepend(s)}).bind(this),s=>s).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=t.height<window.innerHeight?t.height:window.innerHeight,n=t.width<window.innerWidth?t.width:window.innerWidth,s=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=s?window.scrollY:window.scrollX),e.map(c=>{let{index:h,href:f}=c.section,m=c.position(),p=c.width(),x=c.height(),g,y,b,_;s?(g=a+t.top-m.top+o,y=g+r-o,_=this.layout.count(x,r).pages,b=r):(g=a+t.left-m.left+o,y=g+n-o,_=this.layout.count(p,n).pages,b=n);let S=Math.ceil(g/b),k=[],C=Math.ceil(y/b);if(this.settings.direction==="rtl"&&!s){let O=S;S=_-C,C=_-O}k=[];for(var R=S;R<=C;R++){let O=R+1;k.push(O)}let N=this.mapping.page(c.contents,c.section.cfiBase,g,y);return{index:h,href:f,pages:k,totalPages:_,mapping:N}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=0,n=0;return this.settings.fullsize&&(r=window.scrollX),e.map(a=>{let{index:o,href:l}=a.section,c,h=a.position(),f=a.width(),m,p,x;this.settings.direction==="rtl"?(c=t.right-r,x=Math.min(Math.abs(c-h.left),this.layout.width)-n,p=h.width-(h.right-c)-n,m=p-x):(c=t.left+r,x=Math.min(h.right-c,this.layout.width)-n,m=c-h.left+n,p=m+x),n+=x;let g=this.mapping.page(a.contents,a.section.cfiBase,m,p),y=this.layout.count(f).pages,b=Math.floor(m/this.layout.pageWidth),_=[],S=Math.floor(p/this.layout.pageWidth);if(b<0&&(b=0,S=S+1),this.settings.direction==="rtl"){let C=b;b=y-S,S=y-C}for(var k=b+1;k<=S;k++){let C=k;_.push(C)}return{index:o,href:l,pages:_,totalPages:y,mapping:g}})}isVisible(e,t,r,n){var s=e.position(),a=n||this.bounds();return this.settings.axis==="horizontal"&&s.right>a.left-t&&s.left<a.right+r?!0:this.settings.axis==="vertical"&&s.bottom>a.top-t&&s.top<a.bottom+r}visible(){for(var e=this.bounds(),t=this.views.displayed(),r=t.length,n=[],s,a,o=0;o<r;o++)a=t[o],s=this.isVisible(a,0,0,e),s===!0&&n.push(a);return n}scrollBy(e,t,r){let n=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*n,t*n):(e&&(this.container.scrollLeft+=e*n),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(xt.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(xt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Bb(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new Bb(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let r=e==="paginated"||e==="auto";this.isPaginated=r,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const r=t&&t.contents;r&&e.push(r)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}Io(zb.prototype);const iz={easeInCubic:function(i){return Math.pow(i,3)}};class F_{constructor(e,t){this.settings=mi({duration:80,minVelocity:.2,minDistance:10,easing:iz.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(xt.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(xt.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(r=>{t.on(r,n=>this.triggerViewEvent(n,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:r}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:r}=e.touches[0],n=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&n<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,r=Math.abs(t),n=this.endTime-this.startTime,s=t/n,a=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=e)return 0;if(s>a)return-1;if(s<-a)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,n=Math.round(t/r)*r;return e&&(n+=e*r),this.smoothScrollTo(n)}smoothScrollTo(e){const t=new pr,r=this.scrollLeft,n=this.now(),s=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const l=this.now(),c=Math.min(1,(l-n)/s);if(a(c),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}c<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(r+(e-r)*c,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}Io(F_.prototype);var sz=bD();const az=Do(sz);class oz extends zb{constructor(e){super(e),this.name="continuous",this.settings=mi(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),mi(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return zb.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new pr;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,r=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(r=e.top,e.top+this.settings.offsetDelta),(t>0||r>0)&&this.scrollBy(t,r,!0)}afterResized(e){this.emit(xt.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(xt.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(xt.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(xt.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(xt.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(xt.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(xt.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(xt.VIEWS.RESIZED,r=>{this.counter(r),t.expanded=!0}),t.on(xt.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(xt.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),r=this.views.all(),n=r.length,s=typeof e<"u"?e:this.settings.offset||0,a,o,l=new pr,c=[],h=0;h<n;h++)if(o=r[h],a=this.isVisible(o,s,s,t),a===!0)if(o.displayed)o.show();else{let f=o.display(this.request).then(function(m){m.show()},m=>{o.hide()});c.push(f)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return c.length?Promise.all(c).catch(f=>{l.reject(f)}):(l.resolve(),l.promise)}check(e,t){var r=new pr,n=[],s=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&s&&(a=e),t&&!s&&(a=t);var o=this._bounds;let l=s?this.scrollLeft:this.scrollTop,c=s?Math.floor(o.width):o.height,h=s?this.container.scrollWidth:this.container.scrollHeight,f=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",m=this.settings.rtlScrollType,p=this.settings.direction==="rtl";this.settings.fullsize?(s&&p&&m==="negative"||!s&&p&&m==="default")&&(l=l*-1):(p&&m==="default"&&f==="horizontal"&&(l=h-c-l),p&&m==="negative"&&f==="horizontal"&&(l=l*-1));let x=()=>{let S=this.views.first(),k=S&&S.section.prev();k&&n.push(this.prepend(k))},g=()=>{let S=this.views.last(),k=S&&S.section.next();k&&n.push(this.append(k))},y=l+c+a,b=l-a;y>=h&&g(),b<0&&x();let _=n.map(S=>S.display(this.request));return n.length?Promise.all(_).then(()=>this.check()).then(()=>this.update(a),S=>S):(this.q.enqueue((function(){this.update()}).bind(this)),r.resolve(!1),r.promise)}trim(){for(var e=new pr,t=this.views.displayed(),r=t[0],n=t[t.length-1],s=this.views.indexOf(r),a=this.views.indexOf(n),o=this.views.slice(0,s),l=this.views.slice(a+1),c=0;c<o.length-1;c++)this.erase(o[c],o);for(var h=1;h<l.length;h++)this.erase(l[h]);return e.resolve(),e.promise}erase(e,t){var r,n;this.settings.fullsize?(r=window.scrollY,n=window.scrollX):(r=this.container.scrollTop,n=this.container.scrollLeft);var s=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,r-s.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(n+Math.floor(s.width),0,!0):this.scrollTo(n,0,!0):this.scrollTo(n-Math.floor(s.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new F_(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=LS;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=az(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*r,t=window.scrollX*r):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(xt.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(xt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new F_(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class jS{constructor(e,t){this.settings=mi(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),mi(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new $a(this),this.hooks.serialize=new $a(this),this.hooks.content=new $a(this),this.hooks.unloaded=new $a(this),this.hooks.layout=new $a(this),this.hooks.render=new $a(this),this.hooks.show=new $a(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new OB(this),this.annotations=new MB(this),this.epubcfi=new mr,this.q=new IS(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new pr,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=zb:typeof e=="string"&&e==="continuous"?t=oz:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=gD:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(xt.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(xt.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(xt.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(xt.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(xt.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(xt.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(xt.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new pr,r=t.promise,n;return this.displaying=t,this.book.locations.length()&&rD(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),n=this.book.spine.get(e),n?(this.manager.display(n,e).then(()=>{t.resolve(n),this.displaying=void 0,this.emit(xt.RENDITION.DISPLAYED,n),this.reportLocation()},s=>{this.emit(xt.RENDITION.DISPLAY_ERROR,s)}),r):(t.reject(new Error("No Section Found")),r)}}afterDisplayed(e){e.on(xt.VIEWS.MARK_CLICKED,(t,r)=>this.triggerMarkEvent(t,r,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(xt.RENDITION.RENDERED,e.section,e)}):this.emit(xt.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(xt.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(xt.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(xt.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,r){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,r=this.settings.layout||e.layout||"reflowable",n=this.settings.spread||e.spread||"auto",s=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,c=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:r,spread:n,orientation:s,flow:a,viewport:o,minSpreadWidth:l,direction:c},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new fD(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(xt.LAYOUT.UPDATED,(t,r)=>{this.emit(xt.RENDITION.LAYOUT,t,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var r=this.manager.currentLocation();if(r&&r.then&&typeof r.then=="function")r.then((function(n){let s=this.located(n);!s||!s.start||!s.end||(this.location=s,this.emit(xt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(xt.RENDITION.RELOCATED,this.location))}).bind(this));else if(r){let n=this.located(r);if(!n||!n.start||!n.end)return;this.location=n,this.emit(xt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(xt.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],r=e[e.length-1],n={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},s=this.book.locations.locationFromCfi(t.mapping.start),a=this.book.locations.locationFromCfi(r.mapping.end);s!=null&&(n.start.location=s,n.start.percentage=this.book.locations.percentageFromLocation(s)),a!=null&&(n.end.location=a,n.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(r.mapping.end);return o!=-1&&(n.start.page=o),l!=-1&&(n.end.page=l),r.index===this.book.spine.last().index&&n.end.displayed.page>=n.end.displayed.total&&(n.atEnd=!0),t.index===this.book.spine.first().index&&n.start.displayed.page===1&&(n.atStart=!0),n}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Qy.forEach(t=>{e.on(t,r=>this.triggerViewEvent(r,e))}),e.on(xt.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(xt.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,r){this.emit(xt.RENDITION.MARK_CLICKED,e,t,r)}getRange(e,t){var r=new mr(e),n=this.manager.visible().filter(function(s){if(r.spinePos===s.index)return!0});if(n.length)return n[0].contents.range(r,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(s){s()});let t=e.window.getComputedStyle(e.content,null),r=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-n+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-n+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(s,a){setTimeout(function(){s()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(xt.CONTENTS.LINK_CLICKED,t=>{let r=this.book.path.relative(t);this.display(r)})}injectStylesheet(e,t){let r=e.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(r)}injectScript(e,t){let r=e.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",e.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(e,t){let r=this.book.packaging.metadata.identifier,n=e.createElement("meta");n.setAttribute("name","dc.relation.ispartof"),r&&n.setAttribute("content",r),e.getElementsByTagName("head")[0].appendChild(n)}}Io(jS.prototype);function da(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zx={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var ZT;function lz(){return ZT||(ZT=1,function(i,e){(function(t){i.exports=t()})(function(){return function t(r,n,s){function a(c,h){if(!n[c]){if(!r[c]){var f=typeof da=="function"&&da;if(!h&&f)return f(c,!0);if(o)return o(c,!0);var m=new Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m}var p=n[c]={exports:{}};r[c][0].call(p.exports,function(x){var g=r[c][1][x];return a(g||x)},p,p.exports,t,r,n,s)}return n[c].exports}for(var o=typeof da=="function"&&da,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,r,n){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(l){for(var c=[],h,f,m,p,x,g,y,b=0,_=l.length,S=_,k=s.getTypeOf(l)!=="string";b<l.length;)S=_-b,k?(h=l[b++],f=b<_?l[b++]:0,m=b<_?l[b++]:0):(h=l.charCodeAt(b++),f=b<_?l.charCodeAt(b++):0,m=b<_?l.charCodeAt(b++):0),p=h>>2,x=(h&3)<<4|f>>4,g=S>1?(f&15)<<2|m>>6:64,y=S>2?m&63:64,c.push(o.charAt(p)+o.charAt(x)+o.charAt(g)+o.charAt(y));return c.join("")},n.decode=function(l){var c,h,f,m,p,x,g,y=0,b=0,_="data:";if(l.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var S=l.length*3/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!==0)throw new Error("Invalid base64 input, bad content length.");var k;for(a.uint8array?k=new Uint8Array(S|0):k=new Array(S|0);y<l.length;)m=o.indexOf(l.charAt(y++)),p=o.indexOf(l.charAt(y++)),x=o.indexOf(l.charAt(y++)),g=o.indexOf(l.charAt(y++)),c=m<<2|p>>4,h=(p&15)<<4|x>>2,f=(x&3)<<6|g,k[b++]=c,x!==64&&(k[b++]=h),g!==64&&(k[b++]=f);return k}},{"./support":30,"./utils":32}],2:[function(t,r,n){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(h,f,m,p,x){this.compressedSize=h,this.uncompressedSize=f,this.crc32=m,this.compression=p,this.compressedContent=x}c.prototype={getContentWorker:function(){var h=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return h.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(h,f,m){return h.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(m)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,n){var s=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,n){var s=t("./utils");function a(){for(var h,f=[],m=0;m<256;m++){h=m;for(var p=0;p<8;p++)h=h&1?3988292384^h>>>1:h>>>1;f[m]=h}return f}var o=a();function l(h,f,m,p){var x=o,g=p+m;h=h^-1;for(var y=p;y<g;y++)h=h>>>8^x[(h^f[y])&255];return h^-1}function c(h,f,m,p){var x=o,g=p+m;h=h^-1;for(var y=p;y<g;y++)h=h>>>8^x[(h^f.charCodeAt(y))&255];return h^-1}r.exports=function(f,m){if(typeof f>"u"||!f.length)return 0;var p=s.getTypeOf(f)!=="string";return p?l(m|0,f,f.length,0):c(m|0,f,f.length,0)}},{"./utils":32}],5:[function(t,r,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,r,n){var s=null;typeof Promise<"u"?s=Promise:s=t("lie"),r.exports={Promise:s}},{lie:37}],7:[function(t,r,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=s?"uint8array":"array";n.magic="\b\0";function h(f,m){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=m,this.meta={}}o.inherits(h,l),h.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,f.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(m){f.push({data:m,meta:f.meta})}},n.compressWorker=function(f){return new h("Deflate",f)},n.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,n){var s=t("../utils"),a=t("../stream/GenericWorker"),o=t("../utf8"),l=t("../crc32"),c=t("../signature"),h=function(b,_){var S="",k;for(k=0;k<_;k++)S+=String.fromCharCode(b&255),b=b>>>8;return S},f=function(b,_){var S=b;return b||(S=_?16893:33204),(S&65535)<<16},m=function(b){return(b||0)&63},p=function(b,_,S,k,C,R){var N=b.file,O=b.compression,I=R!==o.utf8encode,F=s.transformTo("string",R(N.name)),G=s.transformTo("string",o.utf8encode(N.name)),B=N.comment,Y=s.transformTo("string",R(B)),j=s.transformTo("string",o.utf8encode(B)),ae=G.length!==N.name.length,he=j.length!==B.length,ee,Z,ie="",ge="",V="",K=N.dir,be=N.date,Ae={crc32:0,compressedSize:0,uncompressedSize:0};(!_||S)&&(Ae.crc32=b.crc32,Ae.compressedSize=b.compressedSize,Ae.uncompressedSize=b.uncompressedSize);var ce=0;_&&(ce|=8),!I&&(ae||he)&&(ce|=2048);var Pe=0,Ve=0;K&&(Pe|=16),C==="UNIX"?(Ve=798,Pe|=f(N.unixPermissions,K)):(Ve=20,Pe|=m(N.dosPermissions)),ee=be.getUTCHours(),ee=ee<<6,ee=ee|be.getUTCMinutes(),ee=ee<<5,ee=ee|be.getUTCSeconds()/2,Z=be.getUTCFullYear()-1980,Z=Z<<4,Z=Z|be.getUTCMonth()+1,Z=Z<<5,Z=Z|be.getUTCDate(),ae&&(ge=h(1,1)+h(l(F),4)+G,ie+="up"+h(ge.length,2)+ge),he&&(V=h(1,1)+h(l(Y),4)+j,ie+="uc"+h(V.length,2)+V);var $e="";$e+=`
\0`,$e+=h(ce,2),$e+=O.magic,$e+=h(ee,2),$e+=h(Z,2),$e+=h(Ae.crc32,4),$e+=h(Ae.compressedSize,4),$e+=h(Ae.uncompressedSize,4),$e+=h(F.length,2),$e+=h(ie.length,2);var qe=c.LOCAL_FILE_HEADER+$e+F+ie,Ze=c.CENTRAL_FILE_HEADER+h(Ve,2)+$e+h(Y.length,2)+"\0\0\0\0"+h(Pe,4)+h(k,4)+F+ie+Y;return{fileRecord:qe,dirRecord:Ze}},x=function(b,_,S,k,C){var R="",N=s.transformTo("string",C(k));return R=c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+h(b,2)+h(b,2)+h(_,4)+h(S,4)+h(N.length,2)+N,R},g=function(b){var _="";return _=c.DATA_DESCRIPTOR+h(b.crc32,4)+h(b.compressedSize,4)+h(b.uncompressedSize,4),_};function y(b,_,S,k){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=S,this.encodeFileName=k,this.streamFiles=b,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(y,a),y.prototype.push=function(b){var _=b.meta.percent||0,S=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(b):(this.bytesWritten+=b.data.length,a.prototype.push.call(this,{data:b.data,meta:{currentFile:this.currentFile,percent:S?(_+100*(S-k-1))/S:100}}))},y.prototype.openedSource=function(b){this.currentSourceOffset=this.bytesWritten,this.currentFile=b.file.name;var _=this.streamFiles&&!b.file.dir;if(_){var S=p(b,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:S.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(b){this.accumulate=!1;var _=this.streamFiles&&!b.file.dir,S=p(b,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(S.dirRecord),_)this.push({data:g(b),meta:{percent:100}});else for(this.push({data:S.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var b=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var S=this.bytesWritten-b,k=x(this.dirRecords.length,S,b,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(b){this._sources.push(b);var _=this;return b.on("data",function(S){_.processChunk(S)}),b.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),b.on("error",function(S){_.error(S)}),this},y.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},y.prototype.error=function(b){var _=this._sources;if(!a.prototype.error.call(this,b))return!1;for(var S=0;S<_.length;S++)try{_[S].error(b)}catch{}return!0},y.prototype.lock=function(){a.prototype.lock.call(this);for(var b=this._sources,_=0;_<b.length;_++)b[_].lock()},r.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,n){var s=t("../compressions"),a=t("./ZipFileWorker"),o=function(l,c){var h=l||c,f=s[h];if(!f)throw new Error(h+" is not a valid compression method !");return f};n.generateWorker=function(l,c,h){var f=new a(c.streamFiles,h,c.platform,c.encodeFileName),m=0;try{l.forEach(function(p,x){m++;var g=o(x.options.compression,c.compression),y=x.options.compressionOptions||c.compressionOptions||{},b=x.dir,_=x.date;x._compressWorker(g,y).withStreamInfo("file",{name:p,dir:b,date:_,comment:x.comment||"",unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions}).pipe(f)}),f.entriesCount=m}catch(p){f.error(p)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,n){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}s.prototype=t("./object"),s.prototype.loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,n){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),h=t("./nodejsUtils");function f(m){return new a.Promise(function(p,x){var g=m.decompressed.getContentWorker().pipe(new c);g.on("error",function(y){x(y)}).on("end",function(){g.streamInfo.crc32!==m.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}r.exports=function(m,p){var x=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",m,!0,p.optimizedBinaryString,p.base64).then(function(g){var y=new l(p);return y.load(g),y}).then(function(y){var b=[a.Promise.resolve(y)],_=y.files;if(p.checkCRC32)for(var S=0;S<_.length;S++)b.push(f(_[S]));return a.Promise.all(b)}).then(function(y){for(var b=y.shift(),_=b.files,S=0;S<_.length;S++){var k=_[S],C=k.fileNameStr,R=s.resolve(k.fileNameStr);x.file(R,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:p.createFolders}),k.dir||(x.file(R).unsafeOriginalName=C)}return b.zipComment.length&&(x.comment=b.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,n){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;this._stream=l,l.pause(),l.on("data",function(h){c.push({data:h,meta:{percent:0}})}).on("error",function(h){c.isPaused?this.generatedError=h:c.error(h)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,n){var s=t("readable-stream").Readable,a=t("../utils");a.inherits(o,s);function o(l,c,h){s.call(this,c),this._helper=l;var f=this;l.on("data",function(m,p){f.push(m)||f._helper.pause(),h&&h(p)}).on("error",function(m){f.emit("error",m)}).on("end",function(){f.push(null)})}o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,r,n){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,r,n){var s=t("./utf8"),a=t("./utils"),o=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),c=t("./defaults"),h=t("./compressedObject"),f=t("./zipObject"),m=t("./generate"),p=t("./nodejsUtils"),x=t("./nodejs/NodejsStreamInputAdapter"),g=function(C,R,N){var O=a.getTypeOf(R),I,F=a.extend(N||{},c);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&F.unixPermissions&16384&&(F.dir=!0),F.dosPermissions&&F.dosPermissions&16&&(F.dir=!0),F.dir&&(C=b(C)),F.createFolders&&(I=y(C))&&_.call(this,I,!0);var G=O==="string"&&F.binary===!1&&F.base64===!1;(!N||typeof N.binary>"u")&&(F.binary=!G);var B=R instanceof h&&R.uncompressedSize===0;(B||F.dir||!R||R.length===0)&&(F.base64=!1,F.binary=!0,R="",F.compression="STORE",O="string");var Y=null;R instanceof h||R instanceof o?Y=R:p.isNode&&p.isStream(R)?Y=new x(C,R):Y=a.prepareContent(C,R,F.binary,F.optimizedBinaryString,F.base64);var j=new f(C,Y,F);this.files[C]=j},y=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var R=C.lastIndexOf("/");return R>0?C.substring(0,R):""},b=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},_=function(C,R){return R=typeof R<"u"?R:c.createFolders,C=b(C),this.files[C]||g.call(this,C,null,{dir:!0,createFolders:R}),this.files[C]};function S(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var R,N,O;for(R in this.files)O=this.files[R],N=R.slice(this.root.length,R.length),N&&R.slice(0,this.root.length)===this.root&&C(N,O)},filter:function(C){var R=[];return this.forEach(function(N,O){C(N,O)&&R.push(O)}),R},file:function(C,R,N){if(arguments.length===1)if(S(C)){var O=C;return this.filter(function(F,G){return!G.dir&&O.test(F)})}else{var I=this.files[this.root+C];return I&&!I.dir?I:null}else C=this.root+C,g.call(this,C,R,N);return this},folder:function(C){if(!C)return this;if(S(C))return this.filter(function(I,F){return F.dir&&C.test(I)});var R=this.root+C,N=_.call(this,R),O=this.clone();return O.root=N.name,O},remove:function(C){C=this.root+C;var R=this.files[C];if(R||(C.slice(-1)!=="/"&&(C+="/"),R=this.files[C]),R&&!R.dir)delete this.files[C];else for(var N=this.filter(function(I,F){return F.name.slice(0,C.length)===C}),O=0;O<N.length;O++)delete this.files[N[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var R,N={};try{if(N=a.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode}),N.type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");a.checkSupport(N.type),(N.platform==="darwin"||N.platform==="freebsd"||N.platform==="linux"||N.platform==="sunos")&&(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var O=N.comment||this.comment||"";R=m.generateWorker(this,N,O)}catch(I){R=new o("error"),R.error(I)}return new l(R,N.type||"string",N.mimeType)},generateAsync:function(C,R){return this.generateInternalStream(C).accumulate(R)},generateNodeStream:function(C,R){return C=C||{},C.type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(R)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,n){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,n){var s=t("./DataReader"),a=t("../utils");function o(l){s.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=l[c]&255}a.inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),h=l.charCodeAt(1),f=l.charCodeAt(2),m=l.charCodeAt(3),p=this.length-4;p>=0;--p)if(this.data[p]===c&&this.data[p+1]===h&&this.data[p+2]===f&&this.data[p+3]===m)return p-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),h=l.charCodeAt(1),f=l.charCodeAt(2),m=l.charCodeAt(3),p=this.readData(4);return c===p[0]&&h===p[1]&&f===p[2]&&m===p[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,r,n){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l=0,c;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=o,l},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},r.exports=a},{"../utils":32}],19:[function(t,r,n){var s=t("./Uint8ArrayReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,n){var s=t("./DataReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){var c=this.readData(4);return l===c},o.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,r,n){var s=t("./ArrayReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,n){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");r.exports=function(f){var m=s.getTypeOf(f);return s.checkSupport(m),m==="string"&&!a.uint8array?new l(f):m==="nodebuffer"?new c(f):a.uint8array?new h(s.transformTo("uint8array",f)):new o(s.transformTo("array",f))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,n){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,n){var s=t("./GenericWorker"),a=t("../crc32"),o=t("../utils");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(l,s),l.prototype.processChunk=function(c){this.streamInfo.crc32=a(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,n){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,n){var s=t("../utils"),a=t("./GenericWorker"),o=16*1024;function l(c){a.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(f){h.dataIsReady=!0,h.data=f,h.max=f&&f.length||0,h.type=s.getTypeOf(f),h.isPaused||h._tickAndRepeat()},function(f){h.error(f)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=o,h=null,f=Math.min(this.max,this.index+c);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,f);break;case"uint8array":h=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":h=this.data.slice(this.index,f);break}return this.index=f,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,n){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(t,r,n){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),h=t("../external"),f=null;if(c.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(y,b,_){switch(y){case"blob":return s.newBlob(s.transformTo("arraybuffer",b),_);case"base64":return l.encode(b);default:return s.transformTo(y,b)}}function p(y,b){var _,S=0,k=null,C=0;for(_=0;_<b.length;_++)C+=b[_].length;switch(y){case"string":return b.join("");case"array":return Array.prototype.concat.apply([],b);case"uint8array":for(k=new Uint8Array(C),_=0;_<b.length;_++)k.set(b[_],S),S+=b[_].length;return k;case"nodebuffer":return Buffer.concat(b);default:throw new Error("concat : unsupported type '"+y+"'")}}function x(y,b){return new h.Promise(function(_,S){var k=[],C=y._internalType,R=y._outputType,N=y._mimeType;y.on("data",function(O,I){k.push(O),b&&b(I)}).on("error",function(O){k=[],S(O)}).on("end",function(){try{var O=m(R,p(C,k),N);_(O)}catch(I){S(I)}k=[]}).resume()})}function g(y,b,_){var S=b;switch(b){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string";break}try{this._internalType=S,this._outputType=b,this._mimeType=_,s.checkSupport(S),this._worker=y.pipe(new a(S)),y.lock()}catch(k){this._worker=new o("error"),this._worker.error(k)}}g.prototype={accumulate:function(y){return x(this,y)},on:function(y,b){var _=this;return y==="data"?this._worker.on(y,function(S){b.call(_,S.data,S.meta)}):this._worker.on(y,function(){s.delay(b,arguments,_)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var s=new ArrayBuffer(0);try{n.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(s),n.blob=o.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,n){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),h=0;h<256;h++)c[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;c[254]=c[254]=1;var f=function(y){var b,_,S,k,C,R=y.length,N=0;for(k=0;k<R;k++)_=y.charCodeAt(k),(_&64512)===55296&&k+1<R&&(S=y.charCodeAt(k+1),(S&64512)===56320&&(_=65536+(_-55296<<10)+(S-56320),k++)),N+=_<128?1:_<2048?2:_<65536?3:4;for(a.uint8array?b=new Uint8Array(N):b=new Array(N),C=0,k=0;C<N;k++)_=y.charCodeAt(k),(_&64512)===55296&&k+1<R&&(S=y.charCodeAt(k+1),(S&64512)===56320&&(_=65536+(_-55296<<10)+(S-56320),k++)),_<128?b[C++]=_:_<2048?(b[C++]=192|_>>>6,b[C++]=128|_&63):_<65536?(b[C++]=224|_>>>12,b[C++]=128|_>>>6&63,b[C++]=128|_&63):(b[C++]=240|_>>>18,b[C++]=128|_>>>12&63,b[C++]=128|_>>>6&63,b[C++]=128|_&63);return b},m=function(y,b){var _;for(b=b||y.length,b>y.length&&(b=y.length),_=b-1;_>=0&&(y[_]&192)===128;)_--;return _<0||_===0?b:_+c[y[_]]>b?_:b},p=function(y){var b,_,S,k,C=y.length,R=new Array(C*2);for(_=0,b=0;b<C;){if(S=y[b++],S<128){R[_++]=S;continue}if(k=c[S],k>4){R[_++]=65533,b+=k-1;continue}for(S&=k===2?31:k===3?15:7;k>1&&b<C;)S=S<<6|y[b++]&63,k--;if(k>1){R[_++]=65533;continue}S<65536?R[_++]=S:(S-=65536,R[_++]=55296|S>>10&1023,R[_++]=56320|S&1023)}return R.length!==_&&(R.subarray?R=R.subarray(0,_):R.length=_),s.applyFromCharCode(R)};n.utf8encode=function(b){return a.nodebuffer?o.newBufferFrom(b,"utf-8"):f(b)},n.utf8decode=function(b){return a.nodebuffer?s.transformTo("nodebuffer",b).toString("utf-8"):(b=s.transformTo(a.uint8array?"uint8array":"array",b),p(b))};function x(){l.call(this,"utf-8 decode"),this.leftOver=null}s.inherits(x,l),x.prototype.processChunk=function(y){var b=s.transformTo(a.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var _=b;b=new Uint8Array(_.length+this.leftOver.length),b.set(this.leftOver,0),b.set(_,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var S=m(b),k=b;S!==b.length&&(a.uint8array?(k=b.subarray(0,S),this.leftOver=b.subarray(S,b.length)):(k=b.slice(0,S),this.leftOver=b.slice(S,b.length))),this.push({data:n.utf8decode(k),meta:y.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=x;function g(){l.call(this,"utf-8 encode")}s.inherits(g,l),g.prototype.processChunk=function(y){this.push({data:n.utf8encode(y.data),meta:y.meta})},n.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,n){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");t("setimmediate");function c(y){var b=null;return s.uint8array?b=new Uint8Array(y.length):b=new Array(y.length),f(y,b)}n.newBlob=function(y,b){n.checkSupport("blob");try{return new Blob([y],{type:b})}catch{try{var _=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,S=new _;return S.append(y),S.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};function h(y){return y}function f(y,b){for(var _=0;_<y.length;++_)b[_]=y.charCodeAt(_)&255;return b}var m={stringifyByChunk:function(y,b,_){var S=[],k=0,C=y.length;if(C<=_)return String.fromCharCode.apply(null,y);for(;k<C;)b==="array"||b==="nodebuffer"?S.push(String.fromCharCode.apply(null,y.slice(k,Math.min(k+_,C)))):S.push(String.fromCharCode.apply(null,y.subarray(k,Math.min(k+_,C)))),k+=_;return S.join("")},stringifyByChar:function(y){for(var b="",_=0;_<y.length;_++)b+=String.fromCharCode(y[_]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function p(y){var b=65536,_=n.getTypeOf(y),S=!0;if(_==="uint8array"?S=m.applyCanBeUsed.uint8array:_==="nodebuffer"&&(S=m.applyCanBeUsed.nodebuffer),S)for(;b>1;)try{return m.stringifyByChunk(y,_,b)}catch{b=Math.floor(b/2)}return m.stringifyByChar(y)}n.applyFromCharCode=p;function x(y,b){for(var _=0;_<y.length;_++)b[_]=y[_];return b}var g={};g.string={string:h,array:function(y){return f(y,new Array(y.length))},arraybuffer:function(y){return g.string.uint8array(y).buffer},uint8array:function(y){return f(y,new Uint8Array(y.length))},nodebuffer:function(y){return f(y,o.allocBuffer(y.length))}},g.array={string:p,array:h,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(y)}},g.arraybuffer={string:function(y){return p(new Uint8Array(y))},array:function(y){return x(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:h,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(new Uint8Array(y))}},g.uint8array={string:p,array:function(y){return x(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:h,nodebuffer:function(y){return o.newBufferFrom(y)}},g.nodebuffer={string:p,array:function(y){return x(y,new Array(y.length))},arraybuffer:function(y){return g.nodebuffer.uint8array(y).buffer},uint8array:function(y){return x(y,new Uint8Array(y.length))},nodebuffer:h},n.transformTo=function(y,b){if(b||(b=""),!y)return b;n.checkSupport(y);var _=n.getTypeOf(b),S=g[_][y](b);return S},n.resolve=function(y){for(var b=y.split("/"),_=[],S=0;S<b.length;S++){var k=b[S];k==="."||k===""&&S!==0&&S!==b.length-1||(k===".."?_.pop():_.push(k))}return _.join("/")},n.getTypeOf=function(y){if(typeof y=="string")return"string";if(Object.prototype.toString.call(y)==="[object Array]")return"array";if(s.nodebuffer&&o.isBuffer(y))return"nodebuffer";if(s.uint8array&&y instanceof Uint8Array)return"uint8array";if(s.arraybuffer&&y instanceof ArrayBuffer)return"arraybuffer"},n.checkSupport=function(y){var b=s[y.toLowerCase()];if(!b)throw new Error(y+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(y){var b="",_,S;for(S=0;S<(y||"").length;S++)_=y.charCodeAt(S),b+="\\x"+(_<16?"0":"")+_.toString(16).toUpperCase();return b},n.delay=function(y,b,_){setImmediate(function(){y.apply(_||null,b||[])})},n.inherits=function(y,b){var _=function(){};_.prototype=b.prototype,y.prototype=new _},n.extend=function(){var y={},b,_;for(b=0;b<arguments.length;b++)for(_ in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],_)&&typeof y[_]>"u"&&(y[_]=arguments[b][_]);return y},n.prepareContent=function(y,b,_,S,k){var C=l.Promise.resolve(b).then(function(R){var N=s.blob&&(R instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(R))!==-1);return N&&typeof FileReader<"u"?new l.Promise(function(O,I){var F=new FileReader;F.onload=function(G){O(G.target.result)},F.onerror=function(G){I(G.target.error)},F.readAsArrayBuffer(R)}):R});return C.then(function(R){var N=n.getTypeOf(R);return N?(N==="arraybuffer"?R=n.transformTo("uint8array",R):N==="string"&&(k?R=a.decode(R):_&&S!==!0&&(R=c(R))),R):l.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,n){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function h(f){this.files=[],this.loadOptions=f}h.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(f)+")")}},isSignature:function(f,m){var p=this.reader.index;this.reader.setIndex(f);var x=this.reader.readString(4),g=x===m;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),m=c.uint8array?"uint8array":"array",p=a.transformTo(m,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f=this.zip64EndOfCentralSize-44,m=0,p,x,g;m<f;)p=this.reader.readInt(2),x=this.reader.readInt(4),g=this.reader.readData(x),this.zip64ExtensibleData[p]={id:p,length:x,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,m;for(f=0;f<this.files.length;f++)m=this.files[f],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)f=new l({zip64:this.zip64},this.loadOptions),f.readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0){var m=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw m?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(f);var p=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),f<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var x=this.centralDirOffset+this.centralDirSize;this.zip64&&(x+=20,x+=12+this.zip64EndOfCentralSize);var g=p-x;if(g>0)this.isSignature(p,o.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,n){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),h=t("./compressions"),f=t("./support"),m=0,p=3,x=function(y){for(var b in h)if(Object.prototype.hasOwnProperty.call(h,b)&&h[b].magic===y)return h[b];return null};function g(y,b){this.options=y,this.loadOptions=b}g.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(y){var b,_;if(y.skip(22),this.fileNameLength=y.readInt(2),_=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(b=x(this.compressionMethod),b===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,b,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var b=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(b),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),y===m&&(this.dosPermissions=this.externalFileAttributes&63),y===p&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var b=y.index+this.extraFieldsLength,_,S,k;for(this.extraFields||(this.extraFields={});y.index+4<b;)_=y.readInt(2),S=y.readInt(2),k=y.readData(S),this.extraFields[_]={id:_,length:S,value:k};y.setIndex(b)},handleUTF8:function(){var y=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var _=a.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var k=a.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(k)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var b=s(y.value);return b.readInt(1)!==1||l(this.fileName)!==b.readInt(4)?null:c.utf8decode(b.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var b=s(y.value);return b.readInt(1)!==1||l(this.fileComment)!==b.readInt(4)?null:c.utf8decode(b.readData(y.length-5))}return null}},r.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,n){var s=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),o=t("./utf8"),l=t("./compressedObject"),c=t("./stream/GenericWorker"),h=function(x,g,y){this.name=x,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=g,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}};h.prototype={internalStream:function(x){var g=null,y="string";try{if(!x)throw new Error("No output type specified.");y=x.toLowerCase();var b=y==="string"||y==="text";(y==="binarystring"||y==="text")&&(y="string"),g=this._decompressWorker();var _=!this._dataBinary;_&&!b&&(g=g.pipe(new o.Utf8EncodeWorker)),!_&&b&&(g=g.pipe(new o.Utf8DecodeWorker))}catch(S){g=new c("error"),g.error(S)}return new s(g,y,"")},async:function(x,g){return this.internalStream(x).accumulate(g)},nodeStream:function(x,g){return this.internalStream(x||"nodebuffer").toNodejsStream(g)},_compressWorker:function(x,g){if(this._data instanceof l&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(y,x,g)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)h.prototype[f[p]]=m;r.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,n){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,c=new a(x),h=s.document.createTextNode("");c.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var f=new s.MessageChannel;f.port1.onmessage=x,o=function(){f.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var y=s.document.createElement("script");y.onreadystatechange=function(){x(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},s.document.documentElement.appendChild(y)}:o=function(){setTimeout(x,0)};var m,p=[];function x(){m=!0;for(var y,b,_=p.length;_;){for(b=p,p=[],y=-1;++y<_;)b[y]();_=p.length}m=!1}r.exports=g;function g(y){p.push(y)===1&&!m&&o()}}).call(this,typeof Li<"u"?Li:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,n){var s=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],h=["PENDING"];r.exports=f;function f(C){if(typeof C!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,C!==a&&g(this,C)}f.prototype.finally=function(C){if(typeof C!="function")return this;var R=this.constructor;return this.then(N,O);function N(I){function F(){return I}return R.resolve(C()).then(F)}function O(I){function F(){throw I}return R.resolve(C()).then(F)}},f.prototype.catch=function(C){return this.then(null,C)},f.prototype.then=function(C,R){if(typeof C!="function"&&this.state===c||typeof R!="function"&&this.state===l)return this;var N=new this.constructor(a);if(this.state!==h){var O=this.state===c?C:R;p(N,O,this.outcome)}else this.queue.push(new m(N,C,R));return N};function m(C,R,N){this.promise=C,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}m.prototype.callFulfilled=function(C){o.resolve(this.promise,C)},m.prototype.otherCallFulfilled=function(C){p(this.promise,this.onFulfilled,C)},m.prototype.callRejected=function(C){o.reject(this.promise,C)},m.prototype.otherCallRejected=function(C){p(this.promise,this.onRejected,C)};function p(C,R,N){s(function(){var O;try{O=R(N)}catch(I){return o.reject(C,I)}O===C?o.reject(C,new TypeError("Cannot resolve promise with itself")):o.resolve(C,O)})}o.resolve=function(C,R){var N=y(x,R);if(N.status==="error")return o.reject(C,N.value);var O=N.value;if(O)g(C,O);else{C.state=c,C.outcome=R;for(var I=-1,F=C.queue.length;++I<F;)C.queue[I].callFulfilled(R)}return C},o.reject=function(C,R){C.state=l,C.outcome=R;for(var N=-1,O=C.queue.length;++N<O;)C.queue[N].callRejected(R);return C};function x(C){var R=C&&C.then;if(C&&(typeof C=="object"||typeof C=="function")&&typeof R=="function")return function(){R.apply(C,arguments)}}function g(C,R){var N=!1;function O(B){N||(N=!0,o.reject(C,B))}function I(B){N||(N=!0,o.resolve(C,B))}function F(){R(I,O)}var G=y(F);G.status==="error"&&O(G.value)}function y(C,R){var N={};try{N.value=C(R),N.status="success"}catch(O){N.status="error",N.value=O}return N}f.resolve=b;function b(C){return C instanceof this?C:o.resolve(new this(a),C)}f.reject=_;function _(C){var R=new this(a);return o.reject(R,C)}f.all=S;function S(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=C.length,O=!1;if(!N)return this.resolve([]);for(var I=new Array(N),F=0,G=-1,B=new this(a);++G<N;)Y(C[G],G);return B;function Y(j,ae){R.resolve(j).then(he,function(ee){O||(O=!0,o.reject(B,ee))});function he(ee){I[ae]=ee,++F===N&&!O&&(O=!0,o.resolve(B,I))}}}f.race=k;function k(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=C.length,O=!1;if(!N)return this.resolve([]);for(var I=-1,F=new this(a);++I<N;)G(C[I]);return F;function G(B){R.resolve(B).then(function(Y){O||(O=!0,o.resolve(F,Y))},function(Y){O||(O=!0,o.reject(F,Y))})}}},{immediate:36}],38:[function(t,r,n){var s=t("./lib/utils/common").assign,a=t("./lib/deflate"),o=t("./lib/inflate"),l=t("./lib/zlib/constants"),c={};s(c,a,o,l),r.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,n){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),h=Object.prototype.toString,f=0,m=4,p=0,x=1,g=2,y=-1,b=0,_=8;function S(N){if(!(this instanceof S))return new S(N);this.options=a.assign({level:y,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},N||{});var O=this.options;O.raw&&O.windowBits>0?O.windowBits=-O.windowBits:O.gzip&&O.windowBits>0&&O.windowBits<16&&(O.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var I=s.deflateInit2(this.strm,O.level,O.method,O.windowBits,O.memLevel,O.strategy);if(I!==p)throw new Error(l[I]);if(O.header&&s.deflateSetHeader(this.strm,O.header),O.dictionary){var F;if(typeof O.dictionary=="string"?F=o.string2buf(O.dictionary):h.call(O.dictionary)==="[object ArrayBuffer]"?F=new Uint8Array(O.dictionary):F=O.dictionary,I=s.deflateSetDictionary(this.strm,F),I!==p)throw new Error(l[I]);this._dict_set=!0}}S.prototype.push=function(N,O){var I=this.strm,F=this.options.chunkSize,G,B;if(this.ended)return!1;B=O===~~O?O:O===!0?m:f,typeof N=="string"?I.input=o.string2buf(N):h.call(N)==="[object ArrayBuffer]"?I.input=new Uint8Array(N):I.input=N,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new a.Buf8(F),I.next_out=0,I.avail_out=F),G=s.deflate(I,B),G!==x&&G!==p)return this.onEnd(G),this.ended=!0,!1;(I.avail_out===0||I.avail_in===0&&(B===m||B===g))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(I.output,I.next_out))):this.onData(a.shrinkBuf(I.output,I.next_out)))}while((I.avail_in>0||I.avail_out===0)&&G!==x);return B===m?(G=s.deflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===p):(B===g&&(this.onEnd(p),I.avail_out=0),!0)},S.prototype.onData=function(N){this.chunks.push(N)},S.prototype.onEnd=function(N){N===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg};function k(N,O){var I=new S(O);if(I.push(N,!0),I.err)throw I.msg||l[I.err];return I.result}function C(N,O){return O=O||{},O.raw=!0,k(N,O)}function R(N,O){return O=O||{},O.gzip=!0,k(N,O)}n.Deflate=S,n.deflate=k,n.deflateRaw=C,n.gzip=R},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,n){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),h=t("./zlib/zstream"),f=t("./zlib/gzheader"),m=Object.prototype.toString;function p(y){if(!(this instanceof p))return new p(y);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},y||{});var b=this.options;b.raw&&b.windowBits>=0&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),b.windowBits>=0&&b.windowBits<16&&!(y&&y.windowBits)&&(b.windowBits+=32),b.windowBits>15&&b.windowBits<48&&(b.windowBits&15)===0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var _=s.inflateInit2(this.strm,b.windowBits);if(_!==l.Z_OK)throw new Error(c[_]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}p.prototype.push=function(y,b){var _=this.strm,S=this.options.chunkSize,k=this.options.dictionary,C,R,N,O,I,F,G=!1;if(this.ended)return!1;R=b===~~b?b:b===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof y=="string"?_.input=o.binstring2buf(y):m.call(y)==="[object ArrayBuffer]"?_.input=new Uint8Array(y):_.input=y,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new a.Buf8(S),_.next_out=0,_.avail_out=S),C=s.inflate(_,l.Z_NO_FLUSH),C===l.Z_NEED_DICT&&k&&(typeof k=="string"?F=o.string2buf(k):m.call(k)==="[object ArrayBuffer]"?F=new Uint8Array(k):F=k,C=s.inflateSetDictionary(this.strm,F)),C===l.Z_BUF_ERROR&&G===!0&&(C=l.Z_OK,G=!1),C!==l.Z_STREAM_END&&C!==l.Z_OK)return this.onEnd(C),this.ended=!0,!1;_.next_out&&(_.avail_out===0||C===l.Z_STREAM_END||_.avail_in===0&&(R===l.Z_FINISH||R===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(N=o.utf8border(_.output,_.next_out),O=_.next_out-N,I=o.buf2string(_.output,N),_.next_out=O,_.avail_out=S-O,O&&a.arraySet(_.output,_.output,N,O,0),this.onData(I)):this.onData(a.shrinkBuf(_.output,_.next_out))),_.avail_in===0&&_.avail_out===0&&(G=!0)}while((_.avail_in>0||_.avail_out===0)&&C!==l.Z_STREAM_END);return C===l.Z_STREAM_END&&(R=l.Z_FINISH),R===l.Z_FINISH?(C=s.inflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===l.Z_OK):(R===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),_.avail_out=0),!0)},p.prototype.onData=function(y){this.chunks.push(y)},p.prototype.onEnd=function(y){y===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg};function x(y,b){var _=new p(b);if(_.push(y,!0),_.err)throw _.msg||c[_.err];return _.result}function g(y,b){return b=b||{},b.raw=!0,x(y,b)}n.Inflate=p,n.inflate=x,n.inflateRaw=g,n.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var h=c.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var f in h)h.hasOwnProperty(f)&&(l[f]=h[f])}}return l},n.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,h,f,m){if(c.subarray&&l.subarray){l.set(c.subarray(h,h+f),m);return}for(var p=0;p<f;p++)l[m+p]=c[h+p]},flattenChunks:function(l){var c,h,f,m,p,x;for(f=0,c=0,h=l.length;c<h;c++)f+=l[c].length;for(x=new Uint8Array(f),m=0,c=0,h=l.length;c<h;c++)p=l[c],x.set(p,m),m+=p.length;return x}},o={arraySet:function(l,c,h,f,m){for(var p=0;p<f;p++)l[m+p]=c[h+p]},flattenChunks:function(l){return[].concat.apply([],l)}};n.setTyped=function(l){l?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(s)},{}],42:[function(t,r,n){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;l[254]=l[254]=1,n.string2buf=function(f){var m,p,x,g,y,b=f.length,_=0;for(g=0;g<b;g++)p=f.charCodeAt(g),(p&64512)===55296&&g+1<b&&(x=f.charCodeAt(g+1),(x&64512)===56320&&(p=65536+(p-55296<<10)+(x-56320),g++)),_+=p<128?1:p<2048?2:p<65536?3:4;for(m=new s.Buf8(_),y=0,g=0;y<_;g++)p=f.charCodeAt(g),(p&64512)===55296&&g+1<b&&(x=f.charCodeAt(g+1),(x&64512)===56320&&(p=65536+(p-55296<<10)+(x-56320),g++)),p<128?m[y++]=p:p<2048?(m[y++]=192|p>>>6,m[y++]=128|p&63):p<65536?(m[y++]=224|p>>>12,m[y++]=128|p>>>6&63,m[y++]=128|p&63):(m[y++]=240|p>>>18,m[y++]=128|p>>>12&63,m[y++]=128|p>>>6&63,m[y++]=128|p&63);return m};function h(f,m){if(m<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,m));for(var p="",x=0;x<m;x++)p+=String.fromCharCode(f[x]);return p}n.buf2binstring=function(f){return h(f,f.length)},n.binstring2buf=function(f){for(var m=new s.Buf8(f.length),p=0,x=m.length;p<x;p++)m[p]=f.charCodeAt(p);return m},n.buf2string=function(f,m){var p,x,g,y,b=m||f.length,_=new Array(b*2);for(x=0,p=0;p<b;){if(g=f[p++],g<128){_[x++]=g;continue}if(y=l[g],y>4){_[x++]=65533,p+=y-1;continue}for(g&=y===2?31:y===3?15:7;y>1&&p<b;)g=g<<6|f[p++]&63,y--;if(y>1){_[x++]=65533;continue}g<65536?_[x++]=g:(g-=65536,_[x++]=55296|g>>10&1023,_[x++]=56320|g&1023)}return h(_,x)},n.utf8border=function(f,m){var p;for(m=m||f.length,m>f.length&&(m=f.length),p=m-1;p>=0&&(f[p]&192)===128;)p--;return p<0||p===0?m:p+l[f[p]]>m?p:m}},{"./common":41}],43:[function(t,r,n){function s(a,o,l,c){for(var h=a&65535|0,f=a>>>16&65535|0,m=0;l!==0;){m=l>2e3?2e3:l,l-=m;do h=h+o[c++]|0,f=f+h|0;while(--m);h%=65521,f%=65521}return h|f<<16|0}r.exports=s},{}],44:[function(t,r,n){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,n){function s(){for(var l,c=[],h=0;h<256;h++){l=h;for(var f=0;f<8;f++)l=l&1?3988292384^l>>>1:l>>>1;c[h]=l}return c}var a=s();function o(l,c,h,f){var m=a,p=f+h;l^=-1;for(var x=f;x<p;x++)l=l>>>8^m[(l^c[x])&255];return l^-1}r.exports=o},{}],46:[function(t,r,n){var s=t("../utils/common"),a=t("./trees"),o=t("./adler32"),l=t("./crc32"),c=t("./messages"),h=0,f=1,m=3,p=4,x=5,g=0,y=1,b=-2,_=-3,S=-5,k=-1,C=1,R=2,N=3,O=4,I=0,F=2,G=8,B=9,Y=15,j=8,ae=29,he=256,ee=he+1+ae,Z=30,ie=19,ge=2*ee+1,V=15,K=3,be=258,Ae=be+K+1,ce=32,Pe=42,Ve=69,$e=73,qe=91,Ze=103,at=113,gt=666,ut=1,z=2,Le=3,_e=4,ue=3;function oe(P,Ce){return P.msg=c[Ce],Ce}function le(P){return(P<<1)-(P>4?9:0)}function Oe(P){for(var Ce=P.length;--Ce>=0;)P[Ce]=0}function Te(P){var Ce=P.state,Ie=Ce.pending;Ie>P.avail_out&&(Ie=P.avail_out),Ie!==0&&(s.arraySet(P.output,Ce.pending_buf,Ce.pending_out,Ie,P.next_out),P.next_out+=Ie,Ce.pending_out+=Ie,P.total_out+=Ie,P.avail_out-=Ie,Ce.pending-=Ie,Ce.pending===0&&(Ce.pending_out=0))}function ye(P,Ce){a._tr_flush_block(P,P.block_start>=0?P.block_start:-1,P.strstart-P.block_start,Ce),P.block_start=P.strstart,Te(P.strm)}function Ue(P,Ce){P.pending_buf[P.pending++]=Ce}function rt(P,Ce){P.pending_buf[P.pending++]=Ce>>>8&255,P.pending_buf[P.pending++]=Ce&255}function Ke(P,Ce,Ie,J){var me=P.avail_in;return me>J&&(me=J),me===0?0:(P.avail_in-=me,s.arraySet(Ce,P.input,P.next_in,me,Ie),P.state.wrap===1?P.adler=o(P.adler,Ce,me,Ie):P.state.wrap===2&&(P.adler=l(P.adler,Ce,me,Ie)),P.next_in+=me,P.total_in+=me,me)}function yt(P,Ce){var Ie=P.max_chain_length,J=P.strstart,me,Fe,vt=P.prev_length,ct=P.nice_match,mt=P.strstart>P.w_size-Ae?P.strstart-(P.w_size-Ae):0,Ft=P.window,vr=P.w_mask,Jt=P.prev,Vt=P.strstart+be,er=Ft[J+vt-1],Fr=Ft[J+vt];P.prev_length>=P.good_match&&(Ie>>=2),ct>P.lookahead&&(ct=P.lookahead);do if(me=Ce,!(Ft[me+vt]!==Fr||Ft[me+vt-1]!==er||Ft[me]!==Ft[J]||Ft[++me]!==Ft[J+1])){J+=2,me++;do;while(Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&Ft[++J]===Ft[++me]&&J<Vt);if(Fe=be-(Vt-J),J=Vt-be,Fe>vt){if(P.match_start=Ce,vt=Fe,Fe>=ct)break;er=Ft[J+vt-1],Fr=Ft[J+vt]}}while((Ce=Jt[Ce&vr])>mt&&--Ie!==0);return vt<=P.lookahead?vt:P.lookahead}function Rt(P){var Ce=P.w_size,Ie,J,me,Fe,vt;do{if(Fe=P.window_size-P.lookahead-P.strstart,P.strstart>=Ce+(Ce-Ae)){s.arraySet(P.window,P.window,Ce,Ce,0),P.match_start-=Ce,P.strstart-=Ce,P.block_start-=Ce,J=P.hash_size,Ie=J;do me=P.head[--Ie],P.head[Ie]=me>=Ce?me-Ce:0;while(--J);J=Ce,Ie=J;do me=P.prev[--Ie],P.prev[Ie]=me>=Ce?me-Ce:0;while(--J);Fe+=Ce}if(P.strm.avail_in===0)break;if(J=Ke(P.strm,P.window,P.strstart+P.lookahead,Fe),P.lookahead+=J,P.lookahead+P.insert>=K)for(vt=P.strstart-P.insert,P.ins_h=P.window[vt],P.ins_h=(P.ins_h<<P.hash_shift^P.window[vt+1])&P.hash_mask;P.insert&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[vt+K-1])&P.hash_mask,P.prev[vt&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=vt,vt++,P.insert--,!(P.lookahead+P.insert<K)););}while(P.lookahead<Ae&&P.strm.avail_in!==0)}function _t(P,Ce){var Ie=65535;for(Ie>P.pending_buf_size-5&&(Ie=P.pending_buf_size-5);;){if(P.lookahead<=1){if(Rt(P),P.lookahead===0&&Ce===h)return ut;if(P.lookahead===0)break}P.strstart+=P.lookahead,P.lookahead=0;var J=P.block_start+Ie;if((P.strstart===0||P.strstart>=J)&&(P.lookahead=P.strstart-J,P.strstart=J,ye(P,!1),P.strm.avail_out===0)||P.strstart-P.block_start>=P.w_size-Ae&&(ye(P,!1),P.strm.avail_out===0))return ut}return P.insert=0,Ce===p?(ye(P,!0),P.strm.avail_out===0?Le:_e):(P.strstart>P.block_start&&(ye(P,!1),P.strm.avail_out===0),ut)}function ar(P,Ce){for(var Ie,J;;){if(P.lookahead<Ae){if(Rt(P),P.lookahead<Ae&&Ce===h)return ut;if(P.lookahead===0)break}if(Ie=0,P.lookahead>=K&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+K-1])&P.hash_mask,Ie=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart),Ie!==0&&P.strstart-Ie<=P.w_size-Ae&&(P.match_length=yt(P,Ie)),P.match_length>=K)if(J=a._tr_tally(P,P.strstart-P.match_start,P.match_length-K),P.lookahead-=P.match_length,P.match_length<=P.max_lazy_match&&P.lookahead>=K){P.match_length--;do P.strstart++,P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+K-1])&P.hash_mask,Ie=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart;while(--P.match_length!==0);P.strstart++}else P.strstart+=P.match_length,P.match_length=0,P.ins_h=P.window[P.strstart],P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+1])&P.hash_mask;else J=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++;if(J&&(ye(P,!1),P.strm.avail_out===0))return ut}return P.insert=P.strstart<K-1?P.strstart:K-1,Ce===p?(ye(P,!0),P.strm.avail_out===0?Le:_e):P.last_lit&&(ye(P,!1),P.strm.avail_out===0)?ut:z}function cr(P,Ce){for(var Ie,J,me;;){if(P.lookahead<Ae){if(Rt(P),P.lookahead<Ae&&Ce===h)return ut;if(P.lookahead===0)break}if(Ie=0,P.lookahead>=K&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+K-1])&P.hash_mask,Ie=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart),P.prev_length=P.match_length,P.prev_match=P.match_start,P.match_length=K-1,Ie!==0&&P.prev_length<P.max_lazy_match&&P.strstart-Ie<=P.w_size-Ae&&(P.match_length=yt(P,Ie),P.match_length<=5&&(P.strategy===C||P.match_length===K&&P.strstart-P.match_start>4096)&&(P.match_length=K-1)),P.prev_length>=K&&P.match_length<=P.prev_length){me=P.strstart+P.lookahead-K,J=a._tr_tally(P,P.strstart-1-P.prev_match,P.prev_length-K),P.lookahead-=P.prev_length-1,P.prev_length-=2;do++P.strstart<=me&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+K-1])&P.hash_mask,Ie=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart);while(--P.prev_length!==0);if(P.match_available=0,P.match_length=K-1,P.strstart++,J&&(ye(P,!1),P.strm.avail_out===0))return ut}else if(P.match_available){if(J=a._tr_tally(P,0,P.window[P.strstart-1]),J&&ye(P,!1),P.strstart++,P.lookahead--,P.strm.avail_out===0)return ut}else P.match_available=1,P.strstart++,P.lookahead--}return P.match_available&&(J=a._tr_tally(P,0,P.window[P.strstart-1]),P.match_available=0),P.insert=P.strstart<K-1?P.strstart:K-1,Ce===p?(ye(P,!0),P.strm.avail_out===0?Le:_e):P.last_lit&&(ye(P,!1),P.strm.avail_out===0)?ut:z}function wr(P,Ce){for(var Ie,J,me,Fe,vt=P.window;;){if(P.lookahead<=be){if(Rt(P),P.lookahead<=be&&Ce===h)return ut;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=K&&P.strstart>0&&(me=P.strstart-1,J=vt[me],J===vt[++me]&&J===vt[++me]&&J===vt[++me])){Fe=P.strstart+be;do;while(J===vt[++me]&&J===vt[++me]&&J===vt[++me]&&J===vt[++me]&&J===vt[++me]&&J===vt[++me]&&J===vt[++me]&&J===vt[++me]&&me<Fe);P.match_length=be-(Fe-me),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=K?(Ie=a._tr_tally(P,1,P.match_length-K),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(Ie=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),Ie&&(ye(P,!1),P.strm.avail_out===0))return ut}return P.insert=0,Ce===p?(ye(P,!0),P.strm.avail_out===0?Le:_e):P.last_lit&&(ye(P,!1),P.strm.avail_out===0)?ut:z}function Ir(P,Ce){for(var Ie;;){if(P.lookahead===0&&(Rt(P),P.lookahead===0)){if(Ce===h)return ut;break}if(P.match_length=0,Ie=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,Ie&&(ye(P,!1),P.strm.avail_out===0))return ut}return P.insert=0,Ce===p?(ye(P,!0),P.strm.avail_out===0?Le:_e):P.last_lit&&(ye(P,!1),P.strm.avail_out===0)?ut:z}function Bt(P,Ce,Ie,J,me){this.good_length=P,this.max_lazy=Ce,this.nice_length=Ie,this.max_chain=J,this.func=me}var Xt;Xt=[new Bt(0,0,0,0,_t),new Bt(4,4,8,4,ar),new Bt(4,5,16,8,ar),new Bt(4,6,32,32,ar),new Bt(4,4,16,16,cr),new Bt(8,16,32,32,cr),new Bt(8,16,128,128,cr),new Bt(8,32,128,256,cr),new Bt(32,128,258,1024,cr),new Bt(32,258,258,4096,cr)];function Pn(P){P.window_size=2*P.w_size,Oe(P.head),P.max_lazy_match=Xt[P.level].max_lazy,P.good_match=Xt[P.level].good_length,P.nice_match=Xt[P.level].nice_length,P.max_chain_length=Xt[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=K-1,P.match_available=0,P.ins_h=0}function se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=G,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(ge*2),this.dyn_dtree=new s.Buf16((2*Z+1)*2),this.bl_tree=new s.Buf16((2*ie+1)*2),Oe(this.dyn_ltree),Oe(this.dyn_dtree),Oe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(V+1),this.heap=new s.Buf16(2*ee+1),Oe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*ee+1),Oe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ye(P){var Ce;return!P||!P.state?oe(P,b):(P.total_in=P.total_out=0,P.data_type=F,Ce=P.state,Ce.pending=0,Ce.pending_out=0,Ce.wrap<0&&(Ce.wrap=-Ce.wrap),Ce.status=Ce.wrap?Pe:at,P.adler=Ce.wrap===2?0:1,Ce.last_flush=h,a._tr_init(Ce),g)}function Qe(P){var Ce=Ye(P);return Ce===g&&Pn(P.state),Ce}function ft(P,Ce){return!P||!P.state||P.state.wrap!==2?b:(P.state.gzhead=Ce,g)}function we(P,Ce,Ie,J,me,Fe){if(!P)return b;var vt=1;if(Ce===k&&(Ce=6),J<0?(vt=0,J=-J):J>15&&(vt=2,J-=16),me<1||me>B||Ie!==G||J<8||J>15||Ce<0||Ce>9||Fe<0||Fe>O)return oe(P,b);J===8&&(J=9);var ct=new se;return P.state=ct,ct.strm=P,ct.wrap=vt,ct.gzhead=null,ct.w_bits=J,ct.w_size=1<<ct.w_bits,ct.w_mask=ct.w_size-1,ct.hash_bits=me+7,ct.hash_size=1<<ct.hash_bits,ct.hash_mask=ct.hash_size-1,ct.hash_shift=~~((ct.hash_bits+K-1)/K),ct.window=new s.Buf8(ct.w_size*2),ct.head=new s.Buf16(ct.hash_size),ct.prev=new s.Buf16(ct.w_size),ct.lit_bufsize=1<<me+6,ct.pending_buf_size=ct.lit_bufsize*4,ct.pending_buf=new s.Buf8(ct.pending_buf_size),ct.d_buf=1*ct.lit_bufsize,ct.l_buf=3*ct.lit_bufsize,ct.level=Ce,ct.strategy=Fe,ct.method=Ie,Qe(P)}function U(P,Ce){return we(P,Ce,G,Y,j,I)}function L(P,Ce){var Ie,J,me,Fe;if(!P||!P.state||Ce>x||Ce<0)return P?oe(P,b):b;if(J=P.state,!P.output||!P.input&&P.avail_in!==0||J.status===gt&&Ce!==p)return oe(P,P.avail_out===0?S:b);if(J.strm=P,Ie=J.last_flush,J.last_flush=Ce,J.status===Pe)if(J.wrap===2)P.adler=0,Ue(J,31),Ue(J,139),Ue(J,8),J.gzhead?(Ue(J,(J.gzhead.text?1:0)+(J.gzhead.hcrc?2:0)+(J.gzhead.extra?4:0)+(J.gzhead.name?8:0)+(J.gzhead.comment?16:0)),Ue(J,J.gzhead.time&255),Ue(J,J.gzhead.time>>8&255),Ue(J,J.gzhead.time>>16&255),Ue(J,J.gzhead.time>>24&255),Ue(J,J.level===9?2:J.strategy>=R||J.level<2?4:0),Ue(J,J.gzhead.os&255),J.gzhead.extra&&J.gzhead.extra.length&&(Ue(J,J.gzhead.extra.length&255),Ue(J,J.gzhead.extra.length>>8&255)),J.gzhead.hcrc&&(P.adler=l(P.adler,J.pending_buf,J.pending,0)),J.gzindex=0,J.status=Ve):(Ue(J,0),Ue(J,0),Ue(J,0),Ue(J,0),Ue(J,0),Ue(J,J.level===9?2:J.strategy>=R||J.level<2?4:0),Ue(J,ue),J.status=at);else{var vt=G+(J.w_bits-8<<4)<<8,ct=-1;J.strategy>=R||J.level<2?ct=0:J.level<6?ct=1:J.level===6?ct=2:ct=3,vt|=ct<<6,J.strstart!==0&&(vt|=ce),vt+=31-vt%31,J.status=at,rt(J,vt),J.strstart!==0&&(rt(J,P.adler>>>16),rt(J,P.adler&65535)),P.adler=1}if(J.status===Ve)if(J.gzhead.extra){for(me=J.pending;J.gzindex<(J.gzhead.extra.length&65535)&&!(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>me&&(P.adler=l(P.adler,J.pending_buf,J.pending-me,me)),Te(P),me=J.pending,J.pending===J.pending_buf_size));)Ue(J,J.gzhead.extra[J.gzindex]&255),J.gzindex++;J.gzhead.hcrc&&J.pending>me&&(P.adler=l(P.adler,J.pending_buf,J.pending-me,me)),J.gzindex===J.gzhead.extra.length&&(J.gzindex=0,J.status=$e)}else J.status=$e;if(J.status===$e)if(J.gzhead.name){me=J.pending;do{if(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>me&&(P.adler=l(P.adler,J.pending_buf,J.pending-me,me)),Te(P),me=J.pending,J.pending===J.pending_buf_size)){Fe=1;break}J.gzindex<J.gzhead.name.length?Fe=J.gzhead.name.charCodeAt(J.gzindex++)&255:Fe=0,Ue(J,Fe)}while(Fe!==0);J.gzhead.hcrc&&J.pending>me&&(P.adler=l(P.adler,J.pending_buf,J.pending-me,me)),Fe===0&&(J.gzindex=0,J.status=qe)}else J.status=qe;if(J.status===qe)if(J.gzhead.comment){me=J.pending;do{if(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>me&&(P.adler=l(P.adler,J.pending_buf,J.pending-me,me)),Te(P),me=J.pending,J.pending===J.pending_buf_size)){Fe=1;break}J.gzindex<J.gzhead.comment.length?Fe=J.gzhead.comment.charCodeAt(J.gzindex++)&255:Fe=0,Ue(J,Fe)}while(Fe!==0);J.gzhead.hcrc&&J.pending>me&&(P.adler=l(P.adler,J.pending_buf,J.pending-me,me)),Fe===0&&(J.status=Ze)}else J.status=Ze;if(J.status===Ze&&(J.gzhead.hcrc?(J.pending+2>J.pending_buf_size&&Te(P),J.pending+2<=J.pending_buf_size&&(Ue(J,P.adler&255),Ue(J,P.adler>>8&255),P.adler=0,J.status=at)):J.status=at),J.pending!==0){if(Te(P),P.avail_out===0)return J.last_flush=-1,g}else if(P.avail_in===0&&le(Ce)<=le(Ie)&&Ce!==p)return oe(P,S);if(J.status===gt&&P.avail_in!==0)return oe(P,S);if(P.avail_in!==0||J.lookahead!==0||Ce!==h&&J.status!==gt){var mt=J.strategy===R?Ir(J,Ce):J.strategy===N?wr(J,Ce):Xt[J.level].func(J,Ce);if((mt===Le||mt===_e)&&(J.status=gt),mt===ut||mt===Le)return P.avail_out===0&&(J.last_flush=-1),g;if(mt===z&&(Ce===f?a._tr_align(J):Ce!==x&&(a._tr_stored_block(J,0,0,!1),Ce===m&&(Oe(J.head),J.lookahead===0&&(J.strstart=0,J.block_start=0,J.insert=0))),Te(P),P.avail_out===0))return J.last_flush=-1,g}return Ce!==p?g:J.wrap<=0?y:(J.wrap===2?(Ue(J,P.adler&255),Ue(J,P.adler>>8&255),Ue(J,P.adler>>16&255),Ue(J,P.adler>>24&255),Ue(J,P.total_in&255),Ue(J,P.total_in>>8&255),Ue(J,P.total_in>>16&255),Ue(J,P.total_in>>24&255)):(rt(J,P.adler>>>16),rt(J,P.adler&65535)),Te(P),J.wrap>0&&(J.wrap=-J.wrap),J.pending!==0?g:y)}function re(P){var Ce;return!P||!P.state?b:(Ce=P.state.status,Ce!==Pe&&Ce!==Ve&&Ce!==$e&&Ce!==qe&&Ce!==Ze&&Ce!==at&&Ce!==gt?oe(P,b):(P.state=null,Ce===at?oe(P,_):g))}function Ee(P,Ce){var Ie=Ce.length,J,me,Fe,vt,ct,mt,Ft,vr;if(!P||!P.state||(J=P.state,vt=J.wrap,vt===2||vt===1&&J.status!==Pe||J.lookahead))return b;for(vt===1&&(P.adler=o(P.adler,Ce,Ie,0)),J.wrap=0,Ie>=J.w_size&&(vt===0&&(Oe(J.head),J.strstart=0,J.block_start=0,J.insert=0),vr=new s.Buf8(J.w_size),s.arraySet(vr,Ce,Ie-J.w_size,J.w_size,0),Ce=vr,Ie=J.w_size),ct=P.avail_in,mt=P.next_in,Ft=P.input,P.avail_in=Ie,P.next_in=0,P.input=Ce,Rt(J);J.lookahead>=K;){me=J.strstart,Fe=J.lookahead-(K-1);do J.ins_h=(J.ins_h<<J.hash_shift^J.window[me+K-1])&J.hash_mask,J.prev[me&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=me,me++;while(--Fe);J.strstart=me,J.lookahead=K-1,Rt(J)}return J.strstart+=J.lookahead,J.block_start=J.strstart,J.insert=J.lookahead,J.lookahead=0,J.match_length=J.prev_length=K-1,J.match_available=0,P.next_in=mt,P.input=Ft,P.avail_in=ct,J.wrap=vt,g}n.deflateInit=U,n.deflateInit2=we,n.deflateReset=Qe,n.deflateResetKeep=Ye,n.deflateSetHeader=ft,n.deflate=L,n.deflateEnd=re,n.deflateSetDictionary=Ee,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,n){function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=s},{}],48:[function(t,r,n){var s=30,a=12;r.exports=function(l,c){var h,f,m,p,x,g,y,b,_,S,k,C,R,N,O,I,F,G,B,Y,j,ae,he,ee,Z;h=l.state,f=l.next_in,ee=l.input,m=f+(l.avail_in-5),p=l.next_out,Z=l.output,x=p-(c-l.avail_out),g=p+(l.avail_out-257),y=h.dmax,b=h.wsize,_=h.whave,S=h.wnext,k=h.window,C=h.hold,R=h.bits,N=h.lencode,O=h.distcode,I=(1<<h.lenbits)-1,F=(1<<h.distbits)-1;e:do{R<15&&(C+=ee[f++]<<R,R+=8,C+=ee[f++]<<R,R+=8),G=N[C&I];t:for(;;){if(B=G>>>24,C>>>=B,R-=B,B=G>>>16&255,B===0)Z[p++]=G&65535;else if(B&16){Y=G&65535,B&=15,B&&(R<B&&(C+=ee[f++]<<R,R+=8),Y+=C&(1<<B)-1,C>>>=B,R-=B),R<15&&(C+=ee[f++]<<R,R+=8,C+=ee[f++]<<R,R+=8),G=O[C&F];r:for(;;){if(B=G>>>24,C>>>=B,R-=B,B=G>>>16&255,B&16){if(j=G&65535,B&=15,R<B&&(C+=ee[f++]<<R,R+=8,R<B&&(C+=ee[f++]<<R,R+=8)),j+=C&(1<<B)-1,j>y){l.msg="invalid distance too far back",h.mode=s;break e}if(C>>>=B,R-=B,B=p-x,j>B){if(B=j-B,B>_&&h.sane){l.msg="invalid distance too far back",h.mode=s;break e}if(ae=0,he=k,S===0){if(ae+=b-B,B<Y){Y-=B;do Z[p++]=k[ae++];while(--B);ae=p-j,he=Z}}else if(S<B){if(ae+=b+S-B,B-=S,B<Y){Y-=B;do Z[p++]=k[ae++];while(--B);if(ae=0,S<Y){B=S,Y-=B;do Z[p++]=k[ae++];while(--B);ae=p-j,he=Z}}}else if(ae+=S-B,B<Y){Y-=B;do Z[p++]=k[ae++];while(--B);ae=p-j,he=Z}for(;Y>2;)Z[p++]=he[ae++],Z[p++]=he[ae++],Z[p++]=he[ae++],Y-=3;Y&&(Z[p++]=he[ae++],Y>1&&(Z[p++]=he[ae++]))}else{ae=p-j;do Z[p++]=Z[ae++],Z[p++]=Z[ae++],Z[p++]=Z[ae++],Y-=3;while(Y>2);Y&&(Z[p++]=Z[ae++],Y>1&&(Z[p++]=Z[ae++]))}}else if((B&64)===0){G=O[(G&65535)+(C&(1<<B)-1)];continue r}else{l.msg="invalid distance code",h.mode=s;break e}break}}else if((B&64)===0){G=N[(G&65535)+(C&(1<<B)-1)];continue t}else if(B&32){h.mode=a;break e}else{l.msg="invalid literal/length code",h.mode=s;break e}break}}while(f<m&&p<g);Y=R>>3,f-=Y,R-=Y<<3,C&=(1<<R)-1,l.next_in=f,l.next_out=p,l.avail_in=f<m?5+(m-f):5-(f-m),l.avail_out=p<g?257+(g-p):257-(p-g),h.hold=C,h.bits=R}},{}],49:[function(t,r,n){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),h=0,f=1,m=2,p=4,x=5,g=6,y=0,b=1,_=2,S=-2,k=-3,C=-4,R=-5,N=8,O=1,I=2,F=3,G=4,B=5,Y=6,j=7,ae=8,he=9,ee=10,Z=11,ie=12,ge=13,V=14,K=15,be=16,Ae=17,ce=18,Pe=19,Ve=20,$e=21,qe=22,Ze=23,at=24,gt=25,ut=26,z=27,Le=28,_e=29,ue=30,oe=31,le=32,Oe=852,Te=592,ye=15,Ue=ye;function rt(we){return(we>>>24&255)+(we>>>8&65280)+((we&65280)<<8)+((we&255)<<24)}function Ke(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function yt(we){var U;return!we||!we.state?S:(U=we.state,we.total_in=we.total_out=U.total=0,we.msg="",U.wrap&&(we.adler=U.wrap&1),U.mode=O,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new s.Buf32(Oe),U.distcode=U.distdyn=new s.Buf32(Te),U.sane=1,U.back=-1,y)}function Rt(we){var U;return!we||!we.state?S:(U=we.state,U.wsize=0,U.whave=0,U.wnext=0,yt(we))}function _t(we,U){var L,re;return!we||!we.state||(re=we.state,U<0?(L=0,U=-U):(L=(U>>4)+1,U<48&&(U&=15)),U&&(U<8||U>15))?S:(re.window!==null&&re.wbits!==U&&(re.window=null),re.wrap=L,re.wbits=U,Rt(we))}function ar(we,U){var L,re;return we?(re=new Ke,we.state=re,re.window=null,L=_t(we,U),L!==y&&(we.state=null),L):S}function cr(we){return ar(we,Ue)}var wr=!0,Ir,Bt;function Xt(we){if(wr){var U;for(Ir=new s.Buf32(512),Bt=new s.Buf32(32),U=0;U<144;)we.lens[U++]=8;for(;U<256;)we.lens[U++]=9;for(;U<280;)we.lens[U++]=7;for(;U<288;)we.lens[U++]=8;for(c(f,we.lens,0,288,Ir,0,we.work,{bits:9}),U=0;U<32;)we.lens[U++]=5;c(m,we.lens,0,32,Bt,0,we.work,{bits:5}),wr=!1}we.lencode=Ir,we.lenbits=9,we.distcode=Bt,we.distbits=5}function Pn(we,U,L,re){var Ee,P=we.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new s.Buf8(P.wsize)),re>=P.wsize?(s.arraySet(P.window,U,L-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):(Ee=P.wsize-P.wnext,Ee>re&&(Ee=re),s.arraySet(P.window,U,L-re,Ee,P.wnext),re-=Ee,re?(s.arraySet(P.window,U,L-re,re,0),P.wnext=re,P.whave=P.wsize):(P.wnext+=Ee,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=Ee))),0}function se(we,U){var L,re,Ee,P,Ce,Ie,J,me,Fe,vt,ct,mt,Ft,vr,Jt=0,Vt,er,Fr,Rr,yn,Hs,kr,nn,Kr=new s.Buf8(4),vi,On,Fo=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!we||!we.state||!we.output||!we.input&&we.avail_in!==0)return S;L=we.state,L.mode===ie&&(L.mode=ge),Ce=we.next_out,Ee=we.output,J=we.avail_out,P=we.next_in,re=we.input,Ie=we.avail_in,me=L.hold,Fe=L.bits,vt=Ie,ct=J,nn=y;e:for(;;)switch(L.mode){case O:if(L.wrap===0){L.mode=ge;break}for(;Fe<16;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(L.wrap&2&&me===35615){L.check=0,Kr[0]=me&255,Kr[1]=me>>>8&255,L.check=o(L.check,Kr,2,0),me=0,Fe=0,L.mode=I;break}if(L.flags=0,L.head&&(L.head.done=!1),!(L.wrap&1)||(((me&255)<<8)+(me>>8))%31){we.msg="incorrect header check",L.mode=ue;break}if((me&15)!==N){we.msg="unknown compression method",L.mode=ue;break}if(me>>>=4,Fe-=4,kr=(me&15)+8,L.wbits===0)L.wbits=kr;else if(kr>L.wbits){we.msg="invalid window size",L.mode=ue;break}L.dmax=1<<kr,we.adler=L.check=1,L.mode=me&512?ee:ie,me=0,Fe=0;break;case I:for(;Fe<16;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(L.flags=me,(L.flags&255)!==N){we.msg="unknown compression method",L.mode=ue;break}if(L.flags&57344){we.msg="unknown header flags set",L.mode=ue;break}L.head&&(L.head.text=me>>8&1),L.flags&512&&(Kr[0]=me&255,Kr[1]=me>>>8&255,L.check=o(L.check,Kr,2,0)),me=0,Fe=0,L.mode=F;case F:for(;Fe<32;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}L.head&&(L.head.time=me),L.flags&512&&(Kr[0]=me&255,Kr[1]=me>>>8&255,Kr[2]=me>>>16&255,Kr[3]=me>>>24&255,L.check=o(L.check,Kr,4,0)),me=0,Fe=0,L.mode=G;case G:for(;Fe<16;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}L.head&&(L.head.xflags=me&255,L.head.os=me>>8),L.flags&512&&(Kr[0]=me&255,Kr[1]=me>>>8&255,L.check=o(L.check,Kr,2,0)),me=0,Fe=0,L.mode=B;case B:if(L.flags&1024){for(;Fe<16;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}L.length=me,L.head&&(L.head.extra_len=me),L.flags&512&&(Kr[0]=me&255,Kr[1]=me>>>8&255,L.check=o(L.check,Kr,2,0)),me=0,Fe=0}else L.head&&(L.head.extra=null);L.mode=Y;case Y:if(L.flags&1024&&(mt=L.length,mt>Ie&&(mt=Ie),mt&&(L.head&&(kr=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Array(L.head.extra_len)),s.arraySet(L.head.extra,re,P,mt,kr)),L.flags&512&&(L.check=o(L.check,re,mt,P)),Ie-=mt,P+=mt,L.length-=mt),L.length))break e;L.length=0,L.mode=j;case j:if(L.flags&2048){if(Ie===0)break e;mt=0;do kr=re[P+mt++],L.head&&kr&&L.length<65536&&(L.head.name+=String.fromCharCode(kr));while(kr&&mt<Ie);if(L.flags&512&&(L.check=o(L.check,re,mt,P)),Ie-=mt,P+=mt,kr)break e}else L.head&&(L.head.name=null);L.length=0,L.mode=ae;case ae:if(L.flags&4096){if(Ie===0)break e;mt=0;do kr=re[P+mt++],L.head&&kr&&L.length<65536&&(L.head.comment+=String.fromCharCode(kr));while(kr&&mt<Ie);if(L.flags&512&&(L.check=o(L.check,re,mt,P)),Ie-=mt,P+=mt,kr)break e}else L.head&&(L.head.comment=null);L.mode=he;case he:if(L.flags&512){for(;Fe<16;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(me!==(L.check&65535)){we.msg="header crc mismatch",L.mode=ue;break}me=0,Fe=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),we.adler=L.check=0,L.mode=ie;break;case ee:for(;Fe<32;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}we.adler=L.check=rt(me),me=0,Fe=0,L.mode=Z;case Z:if(L.havedict===0)return we.next_out=Ce,we.avail_out=J,we.next_in=P,we.avail_in=Ie,L.hold=me,L.bits=Fe,_;we.adler=L.check=1,L.mode=ie;case ie:if(U===x||U===g)break e;case ge:if(L.last){me>>>=Fe&7,Fe-=Fe&7,L.mode=z;break}for(;Fe<3;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}switch(L.last=me&1,me>>>=1,Fe-=1,me&3){case 0:L.mode=V;break;case 1:if(Xt(L),L.mode=Ve,U===g){me>>>=2,Fe-=2;break e}break;case 2:L.mode=Ae;break;case 3:we.msg="invalid block type",L.mode=ue}me>>>=2,Fe-=2;break;case V:for(me>>>=Fe&7,Fe-=Fe&7;Fe<32;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if((me&65535)!==(me>>>16^65535)){we.msg="invalid stored block lengths",L.mode=ue;break}if(L.length=me&65535,me=0,Fe=0,L.mode=K,U===g)break e;case K:L.mode=be;case be:if(mt=L.length,mt){if(mt>Ie&&(mt=Ie),mt>J&&(mt=J),mt===0)break e;s.arraySet(Ee,re,P,mt,Ce),Ie-=mt,P+=mt,J-=mt,Ce+=mt,L.length-=mt;break}L.mode=ie;break;case Ae:for(;Fe<14;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(L.nlen=(me&31)+257,me>>>=5,Fe-=5,L.ndist=(me&31)+1,me>>>=5,Fe-=5,L.ncode=(me&15)+4,me>>>=4,Fe-=4,L.nlen>286||L.ndist>30){we.msg="too many length or distance symbols",L.mode=ue;break}L.have=0,L.mode=ce;case ce:for(;L.have<L.ncode;){for(;Fe<3;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}L.lens[Fo[L.have++]]=me&7,me>>>=3,Fe-=3}for(;L.have<19;)L.lens[Fo[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,vi={bits:L.lenbits},nn=c(h,L.lens,0,19,L.lencode,0,L.work,vi),L.lenbits=vi.bits,nn){we.msg="invalid code lengths set",L.mode=ue;break}L.have=0,L.mode=Pe;case Pe:for(;L.have<L.nlen+L.ndist;){for(;Jt=L.lencode[me&(1<<L.lenbits)-1],Vt=Jt>>>24,er=Jt>>>16&255,Fr=Jt&65535,!(Vt<=Fe);){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(Fr<16)me>>>=Vt,Fe-=Vt,L.lens[L.have++]=Fr;else{if(Fr===16){for(On=Vt+2;Fe<On;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(me>>>=Vt,Fe-=Vt,L.have===0){we.msg="invalid bit length repeat",L.mode=ue;break}kr=L.lens[L.have-1],mt=3+(me&3),me>>>=2,Fe-=2}else if(Fr===17){for(On=Vt+3;Fe<On;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}me>>>=Vt,Fe-=Vt,kr=0,mt=3+(me&7),me>>>=3,Fe-=3}else{for(On=Vt+7;Fe<On;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}me>>>=Vt,Fe-=Vt,kr=0,mt=11+(me&127),me>>>=7,Fe-=7}if(L.have+mt>L.nlen+L.ndist){we.msg="invalid bit length repeat",L.mode=ue;break}for(;mt--;)L.lens[L.have++]=kr}}if(L.mode===ue)break;if(L.lens[256]===0){we.msg="invalid code -- missing end-of-block",L.mode=ue;break}if(L.lenbits=9,vi={bits:L.lenbits},nn=c(f,L.lens,0,L.nlen,L.lencode,0,L.work,vi),L.lenbits=vi.bits,nn){we.msg="invalid literal/lengths set",L.mode=ue;break}if(L.distbits=6,L.distcode=L.distdyn,vi={bits:L.distbits},nn=c(m,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,vi),L.distbits=vi.bits,nn){we.msg="invalid distances set",L.mode=ue;break}if(L.mode=Ve,U===g)break e;case Ve:L.mode=$e;case $e:if(Ie>=6&&J>=258){we.next_out=Ce,we.avail_out=J,we.next_in=P,we.avail_in=Ie,L.hold=me,L.bits=Fe,l(we,ct),Ce=we.next_out,Ee=we.output,J=we.avail_out,P=we.next_in,re=we.input,Ie=we.avail_in,me=L.hold,Fe=L.bits,L.mode===ie&&(L.back=-1);break}for(L.back=0;Jt=L.lencode[me&(1<<L.lenbits)-1],Vt=Jt>>>24,er=Jt>>>16&255,Fr=Jt&65535,!(Vt<=Fe);){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(er&&(er&240)===0){for(Rr=Vt,yn=er,Hs=Fr;Jt=L.lencode[Hs+((me&(1<<Rr+yn)-1)>>Rr)],Vt=Jt>>>24,er=Jt>>>16&255,Fr=Jt&65535,!(Rr+Vt<=Fe);){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}me>>>=Rr,Fe-=Rr,L.back+=Rr}if(me>>>=Vt,Fe-=Vt,L.back+=Vt,L.length=Fr,er===0){L.mode=ut;break}if(er&32){L.back=-1,L.mode=ie;break}if(er&64){we.msg="invalid literal/length code",L.mode=ue;break}L.extra=er&15,L.mode=qe;case qe:if(L.extra){for(On=L.extra;Fe<On;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}L.length+=me&(1<<L.extra)-1,me>>>=L.extra,Fe-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=Ze;case Ze:for(;Jt=L.distcode[me&(1<<L.distbits)-1],Vt=Jt>>>24,er=Jt>>>16&255,Fr=Jt&65535,!(Vt<=Fe);){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if((er&240)===0){for(Rr=Vt,yn=er,Hs=Fr;Jt=L.distcode[Hs+((me&(1<<Rr+yn)-1)>>Rr)],Vt=Jt>>>24,er=Jt>>>16&255,Fr=Jt&65535,!(Rr+Vt<=Fe);){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}me>>>=Rr,Fe-=Rr,L.back+=Rr}if(me>>>=Vt,Fe-=Vt,L.back+=Vt,er&64){we.msg="invalid distance code",L.mode=ue;break}L.offset=Fr,L.extra=er&15,L.mode=at;case at:if(L.extra){for(On=L.extra;Fe<On;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}L.offset+=me&(1<<L.extra)-1,me>>>=L.extra,Fe-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){we.msg="invalid distance too far back",L.mode=ue;break}L.mode=gt;case gt:if(J===0)break e;if(mt=ct-J,L.offset>mt){if(mt=L.offset-mt,mt>L.whave&&L.sane){we.msg="invalid distance too far back",L.mode=ue;break}mt>L.wnext?(mt-=L.wnext,Ft=L.wsize-mt):Ft=L.wnext-mt,mt>L.length&&(mt=L.length),vr=L.window}else vr=Ee,Ft=Ce-L.offset,mt=L.length;mt>J&&(mt=J),J-=mt,L.length-=mt;do Ee[Ce++]=vr[Ft++];while(--mt);L.length===0&&(L.mode=$e);break;case ut:if(J===0)break e;Ee[Ce++]=L.length,J--,L.mode=$e;break;case z:if(L.wrap){for(;Fe<32;){if(Ie===0)break e;Ie--,me|=re[P++]<<Fe,Fe+=8}if(ct-=J,we.total_out+=ct,L.total+=ct,ct&&(we.adler=L.check=L.flags?o(L.check,Ee,ct,Ce-ct):a(L.check,Ee,ct,Ce-ct)),ct=J,(L.flags?me:rt(me))!==L.check){we.msg="incorrect data check",L.mode=ue;break}me=0,Fe=0}L.mode=Le;case Le:if(L.wrap&&L.flags){for(;Fe<32;){if(Ie===0)break e;Ie--,me+=re[P++]<<Fe,Fe+=8}if(me!==(L.total&4294967295)){we.msg="incorrect length check",L.mode=ue;break}me=0,Fe=0}L.mode=_e;case _e:nn=b;break e;case ue:nn=k;break e;case oe:return C;case le:default:return S}return we.next_out=Ce,we.avail_out=J,we.next_in=P,we.avail_in=Ie,L.hold=me,L.bits=Fe,(L.wsize||ct!==we.avail_out&&L.mode<ue&&(L.mode<z||U!==p))&&Pn(we,we.output,we.next_out,ct-we.avail_out),vt-=we.avail_in,ct-=we.avail_out,we.total_in+=vt,we.total_out+=ct,L.total+=ct,L.wrap&&ct&&(we.adler=L.check=L.flags?o(L.check,Ee,ct,we.next_out-ct):a(L.check,Ee,ct,we.next_out-ct)),we.data_type=L.bits+(L.last?64:0)+(L.mode===ie?128:0)+(L.mode===Ve||L.mode===K?256:0),(vt===0&&ct===0||U===p)&&nn===y&&(nn=R),nn}function Ye(we){if(!we||!we.state)return S;var U=we.state;return U.window&&(U.window=null),we.state=null,y}function Qe(we,U){var L;return!we||!we.state||(L=we.state,(L.wrap&2)===0)?S:(L.head=U,U.done=!1,y)}function ft(we,U){var L=U.length,re,Ee,P;return!we||!we.state||(re=we.state,re.wrap!==0&&re.mode!==Z)?S:re.mode===Z&&(Ee=1,Ee=a(Ee,U,L,0),Ee!==re.check)?k:(P=Pn(we,U,L,L),P?(re.mode=oe,C):(re.havedict=1,y))}n.inflateReset=Rt,n.inflateReset2=_t,n.inflateResetKeep=yt,n.inflateInit=cr,n.inflateInit2=ar,n.inflate=se,n.inflateEnd=Ye,n.inflateGetHeader=Qe,n.inflateSetDictionary=ft,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,n){var s=t("../utils/common"),a=15,o=852,l=592,c=0,h=1,f=2,m=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(b,_,S,k,C,R,N,O){var I=O.bits,F=0,G=0,B=0,Y=0,j=0,ae=0,he=0,ee=0,Z=0,ie=0,ge,V,K,be,Ae,ce=null,Pe=0,Ve,$e=new s.Buf16(a+1),qe=new s.Buf16(a+1),Ze=null,at=0,gt,ut,z;for(F=0;F<=a;F++)$e[F]=0;for(G=0;G<k;G++)$e[_[S+G]]++;for(j=I,Y=a;Y>=1&&$e[Y]===0;Y--);if(j>Y&&(j=Y),Y===0)return C[R++]=1<<24|64<<16|0,C[R++]=1<<24|64<<16|0,O.bits=1,0;for(B=1;B<Y&&$e[B]===0;B++);for(j<B&&(j=B),ee=1,F=1;F<=a;F++)if(ee<<=1,ee-=$e[F],ee<0)return-1;if(ee>0&&(b===c||Y!==1))return-1;for(qe[1]=0,F=1;F<a;F++)qe[F+1]=qe[F]+$e[F];for(G=0;G<k;G++)_[S+G]!==0&&(N[qe[_[S+G]]++]=G);if(b===c?(ce=Ze=N,Ve=19):b===h?(ce=m,Pe-=257,Ze=p,at-=257,Ve=256):(ce=x,Ze=g,Ve=-1),ie=0,G=0,F=B,Ae=R,ae=j,he=0,K=-1,Z=1<<j,be=Z-1,b===h&&Z>o||b===f&&Z>l)return 1;for(;;){gt=F-he,N[G]<Ve?(ut=0,z=N[G]):N[G]>Ve?(ut=Ze[at+N[G]],z=ce[Pe+N[G]]):(ut=96,z=0),ge=1<<F-he,V=1<<ae,B=V;do V-=ge,C[Ae+(ie>>he)+V]=gt<<24|ut<<16|z|0;while(V!==0);for(ge=1<<F-1;ie&ge;)ge>>=1;if(ge!==0?(ie&=ge-1,ie+=ge):ie=0,G++,--$e[F]===0){if(F===Y)break;F=_[S+N[G]]}if(F>j&&(ie&be)!==K){for(he===0&&(he=j),Ae+=B,ae=F-he,ee=1<<ae;ae+he<Y&&(ee-=$e[ae+he],!(ee<=0));)ae++,ee<<=1;if(Z+=1<<ae,b===h&&Z>o||b===f&&Z>l)return 1;K=ie&be,C[K]=j<<24|ae<<16|Ae-R|0}}return ie!==0&&(C[Ae+ie]=F-he<<24|64<<16|0),O.bits=j,0}},{"../utils/common":41}],51:[function(t,r,n){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,n){var s=t("../utils/common"),a=4,o=0,l=1,c=2;function h(se){for(var Ye=se.length;--Ye>=0;)se[Ye]=0}var f=0,m=1,p=2,x=3,g=258,y=29,b=256,_=b+1+y,S=30,k=19,C=2*_+1,R=15,N=16,O=7,I=256,F=16,G=17,B=18,Y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=512,Z=new Array((_+2)*2);h(Z);var ie=new Array(S*2);h(ie);var ge=new Array(ee);h(ge);var V=new Array(g-x+1);h(V);var K=new Array(y);h(K);var be=new Array(S);h(be);function Ae(se,Ye,Qe,ft,we){this.static_tree=se,this.extra_bits=Ye,this.extra_base=Qe,this.elems=ft,this.max_length=we,this.has_stree=se&&se.length}var ce,Pe,Ve;function $e(se,Ye){this.dyn_tree=se,this.max_code=0,this.stat_desc=Ye}function qe(se){return se<256?ge[se]:ge[256+(se>>>7)]}function Ze(se,Ye){se.pending_buf[se.pending++]=Ye&255,se.pending_buf[se.pending++]=Ye>>>8&255}function at(se,Ye,Qe){se.bi_valid>N-Qe?(se.bi_buf|=Ye<<se.bi_valid&65535,Ze(se,se.bi_buf),se.bi_buf=Ye>>N-se.bi_valid,se.bi_valid+=Qe-N):(se.bi_buf|=Ye<<se.bi_valid&65535,se.bi_valid+=Qe)}function gt(se,Ye,Qe){at(se,Qe[Ye*2],Qe[Ye*2+1])}function ut(se,Ye){var Qe=0;do Qe|=se&1,se>>>=1,Qe<<=1;while(--Ye>0);return Qe>>>1}function z(se){se.bi_valid===16?(Ze(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):se.bi_valid>=8&&(se.pending_buf[se.pending++]=se.bi_buf&255,se.bi_buf>>=8,se.bi_valid-=8)}function Le(se,Ye){var Qe=Ye.dyn_tree,ft=Ye.max_code,we=Ye.stat_desc.static_tree,U=Ye.stat_desc.has_stree,L=Ye.stat_desc.extra_bits,re=Ye.stat_desc.extra_base,Ee=Ye.stat_desc.max_length,P,Ce,Ie,J,me,Fe,vt=0;for(J=0;J<=R;J++)se.bl_count[J]=0;for(Qe[se.heap[se.heap_max]*2+1]=0,P=se.heap_max+1;P<C;P++)Ce=se.heap[P],J=Qe[Qe[Ce*2+1]*2+1]+1,J>Ee&&(J=Ee,vt++),Qe[Ce*2+1]=J,!(Ce>ft)&&(se.bl_count[J]++,me=0,Ce>=re&&(me=L[Ce-re]),Fe=Qe[Ce*2],se.opt_len+=Fe*(J+me),U&&(se.static_len+=Fe*(we[Ce*2+1]+me)));if(vt!==0){do{for(J=Ee-1;se.bl_count[J]===0;)J--;se.bl_count[J]--,se.bl_count[J+1]+=2,se.bl_count[Ee]--,vt-=2}while(vt>0);for(J=Ee;J!==0;J--)for(Ce=se.bl_count[J];Ce!==0;)Ie=se.heap[--P],!(Ie>ft)&&(Qe[Ie*2+1]!==J&&(se.opt_len+=(J-Qe[Ie*2+1])*Qe[Ie*2],Qe[Ie*2+1]=J),Ce--)}}function _e(se,Ye,Qe){var ft=new Array(R+1),we=0,U,L;for(U=1;U<=R;U++)ft[U]=we=we+Qe[U-1]<<1;for(L=0;L<=Ye;L++){var re=se[L*2+1];re!==0&&(se[L*2]=ut(ft[re]++,re))}}function ue(){var se,Ye,Qe,ft,we,U=new Array(R+1);for(Qe=0,ft=0;ft<y-1;ft++)for(K[ft]=Qe,se=0;se<1<<Y[ft];se++)V[Qe++]=ft;for(V[Qe-1]=ft,we=0,ft=0;ft<16;ft++)for(be[ft]=we,se=0;se<1<<j[ft];se++)ge[we++]=ft;for(we>>=7;ft<S;ft++)for(be[ft]=we<<7,se=0;se<1<<j[ft]-7;se++)ge[256+we++]=ft;for(Ye=0;Ye<=R;Ye++)U[Ye]=0;for(se=0;se<=143;)Z[se*2+1]=8,se++,U[8]++;for(;se<=255;)Z[se*2+1]=9,se++,U[9]++;for(;se<=279;)Z[se*2+1]=7,se++,U[7]++;for(;se<=287;)Z[se*2+1]=8,se++,U[8]++;for(_e(Z,_+1,U),se=0;se<S;se++)ie[se*2+1]=5,ie[se*2]=ut(se,5);ce=new Ae(Z,Y,b+1,_,R),Pe=new Ae(ie,j,0,S,R),Ve=new Ae(new Array(0),ae,0,k,O)}function oe(se){var Ye;for(Ye=0;Ye<_;Ye++)se.dyn_ltree[Ye*2]=0;for(Ye=0;Ye<S;Ye++)se.dyn_dtree[Ye*2]=0;for(Ye=0;Ye<k;Ye++)se.bl_tree[Ye*2]=0;se.dyn_ltree[I*2]=1,se.opt_len=se.static_len=0,se.last_lit=se.matches=0}function le(se){se.bi_valid>8?Ze(se,se.bi_buf):se.bi_valid>0&&(se.pending_buf[se.pending++]=se.bi_buf),se.bi_buf=0,se.bi_valid=0}function Oe(se,Ye,Qe,ft){le(se),Ze(se,Qe),Ze(se,~Qe),s.arraySet(se.pending_buf,se.window,Ye,Qe,se.pending),se.pending+=Qe}function Te(se,Ye,Qe,ft){var we=Ye*2,U=Qe*2;return se[we]<se[U]||se[we]===se[U]&&ft[Ye]<=ft[Qe]}function ye(se,Ye,Qe){for(var ft=se.heap[Qe],we=Qe<<1;we<=se.heap_len&&(we<se.heap_len&&Te(Ye,se.heap[we+1],se.heap[we],se.depth)&&we++,!Te(Ye,ft,se.heap[we],se.depth));)se.heap[Qe]=se.heap[we],Qe=we,we<<=1;se.heap[Qe]=ft}function Ue(se,Ye,Qe){var ft,we,U=0,L,re;if(se.last_lit!==0)do ft=se.pending_buf[se.d_buf+U*2]<<8|se.pending_buf[se.d_buf+U*2+1],we=se.pending_buf[se.l_buf+U],U++,ft===0?gt(se,we,Ye):(L=V[we],gt(se,L+b+1,Ye),re=Y[L],re!==0&&(we-=K[L],at(se,we,re)),ft--,L=qe(ft),gt(se,L,Qe),re=j[L],re!==0&&(ft-=be[L],at(se,ft,re)));while(U<se.last_lit);gt(se,I,Ye)}function rt(se,Ye){var Qe=Ye.dyn_tree,ft=Ye.stat_desc.static_tree,we=Ye.stat_desc.has_stree,U=Ye.stat_desc.elems,L,re,Ee=-1,P;for(se.heap_len=0,se.heap_max=C,L=0;L<U;L++)Qe[L*2]!==0?(se.heap[++se.heap_len]=Ee=L,se.depth[L]=0):Qe[L*2+1]=0;for(;se.heap_len<2;)P=se.heap[++se.heap_len]=Ee<2?++Ee:0,Qe[P*2]=1,se.depth[P]=0,se.opt_len--,we&&(se.static_len-=ft[P*2+1]);for(Ye.max_code=Ee,L=se.heap_len>>1;L>=1;L--)ye(se,Qe,L);P=U;do L=se.heap[1],se.heap[1]=se.heap[se.heap_len--],ye(se,Qe,1),re=se.heap[1],se.heap[--se.heap_max]=L,se.heap[--se.heap_max]=re,Qe[P*2]=Qe[L*2]+Qe[re*2],se.depth[P]=(se.depth[L]>=se.depth[re]?se.depth[L]:se.depth[re])+1,Qe[L*2+1]=Qe[re*2+1]=P,se.heap[1]=P++,ye(se,Qe,1);while(se.heap_len>=2);se.heap[--se.heap_max]=se.heap[1],Le(se,Ye),_e(Qe,Ee,se.bl_count)}function Ke(se,Ye,Qe){var ft,we=-1,U,L=Ye[0*2+1],re=0,Ee=7,P=4;for(L===0&&(Ee=138,P=3),Ye[(Qe+1)*2+1]=65535,ft=0;ft<=Qe;ft++)U=L,L=Ye[(ft+1)*2+1],!(++re<Ee&&U===L)&&(re<P?se.bl_tree[U*2]+=re:U!==0?(U!==we&&se.bl_tree[U*2]++,se.bl_tree[F*2]++):re<=10?se.bl_tree[G*2]++:se.bl_tree[B*2]++,re=0,we=U,L===0?(Ee=138,P=3):U===L?(Ee=6,P=3):(Ee=7,P=4))}function yt(se,Ye,Qe){var ft,we=-1,U,L=Ye[0*2+1],re=0,Ee=7,P=4;for(L===0&&(Ee=138,P=3),ft=0;ft<=Qe;ft++)if(U=L,L=Ye[(ft+1)*2+1],!(++re<Ee&&U===L)){if(re<P)do gt(se,U,se.bl_tree);while(--re!==0);else U!==0?(U!==we&&(gt(se,U,se.bl_tree),re--),gt(se,F,se.bl_tree),at(se,re-3,2)):re<=10?(gt(se,G,se.bl_tree),at(se,re-3,3)):(gt(se,B,se.bl_tree),at(se,re-11,7));re=0,we=U,L===0?(Ee=138,P=3):U===L?(Ee=6,P=3):(Ee=7,P=4)}}function Rt(se){var Ye;for(Ke(se,se.dyn_ltree,se.l_desc.max_code),Ke(se,se.dyn_dtree,se.d_desc.max_code),rt(se,se.bl_desc),Ye=k-1;Ye>=3&&se.bl_tree[he[Ye]*2+1]===0;Ye--);return se.opt_len+=3*(Ye+1)+5+5+4,Ye}function _t(se,Ye,Qe,ft){var we;for(at(se,Ye-257,5),at(se,Qe-1,5),at(se,ft-4,4),we=0;we<ft;we++)at(se,se.bl_tree[he[we]*2+1],3);yt(se,se.dyn_ltree,Ye-1),yt(se,se.dyn_dtree,Qe-1)}function ar(se){var Ye=4093624447,Qe;for(Qe=0;Qe<=31;Qe++,Ye>>>=1)if(Ye&1&&se.dyn_ltree[Qe*2]!==0)return o;if(se.dyn_ltree[9*2]!==0||se.dyn_ltree[10*2]!==0||se.dyn_ltree[13*2]!==0)return l;for(Qe=32;Qe<b;Qe++)if(se.dyn_ltree[Qe*2]!==0)return l;return o}var cr=!1;function wr(se){cr||(ue(),cr=!0),se.l_desc=new $e(se.dyn_ltree,ce),se.d_desc=new $e(se.dyn_dtree,Pe),se.bl_desc=new $e(se.bl_tree,Ve),se.bi_buf=0,se.bi_valid=0,oe(se)}function Ir(se,Ye,Qe,ft){at(se,(f<<1)+(ft?1:0),3),Oe(se,Ye,Qe)}function Bt(se){at(se,m<<1,3),gt(se,I,Z),z(se)}function Xt(se,Ye,Qe,ft){var we,U,L=0;se.level>0?(se.strm.data_type===c&&(se.strm.data_type=ar(se)),rt(se,se.l_desc),rt(se,se.d_desc),L=Rt(se),we=se.opt_len+3+7>>>3,U=se.static_len+3+7>>>3,U<=we&&(we=U)):we=U=Qe+5,Qe+4<=we&&Ye!==-1?Ir(se,Ye,Qe,ft):se.strategy===a||U===we?(at(se,(m<<1)+(ft?1:0),3),Ue(se,Z,ie)):(at(se,(p<<1)+(ft?1:0),3),_t(se,se.l_desc.max_code+1,se.d_desc.max_code+1,L+1),Ue(se,se.dyn_ltree,se.dyn_dtree)),oe(se),ft&&le(se)}function Pn(se,Ye,Qe){return se.pending_buf[se.d_buf+se.last_lit*2]=Ye>>>8&255,se.pending_buf[se.d_buf+se.last_lit*2+1]=Ye&255,se.pending_buf[se.l_buf+se.last_lit]=Qe&255,se.last_lit++,Ye===0?se.dyn_ltree[Qe*2]++:(se.matches++,Ye--,se.dyn_ltree[(V[Qe]+b+1)*2]++,se.dyn_dtree[qe(Ye)*2]++),se.last_lit===se.lit_bufsize-1}n._tr_init=wr,n._tr_stored_block=Ir,n._tr_flush_block=Xt,n._tr_tally=Pn,n._tr_align=Bt},{"../utils/common":41}],53:[function(t,r,n){function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=s},{}],54:[function(t,r,n){(function(s){(function(a,o){if(a.setImmediate)return;var l=1,c={},h=!1,f=a.document,m;function p(O){typeof O!="function"&&(O=new Function(""+O));for(var I=new Array(arguments.length-1),F=0;F<I.length;F++)I[F]=arguments[F+1];var G={callback:O,args:I};return c[l]=G,m(l),l++}function x(O){delete c[O]}function g(O){var I=O.callback,F=O.args;switch(F.length){case 0:I();break;case 1:I(F[0]);break;case 2:I(F[0],F[1]);break;case 3:I(F[0],F[1],F[2]);break;default:I.apply(o,F);break}}function y(O){if(h)setTimeout(y,0,O);else{var I=c[O];if(I){h=!0;try{g(I)}finally{x(O),h=!1}}}}function b(){m=function(O){process.nextTick(function(){y(O)})}}function _(){if(a.postMessage&&!a.importScripts){var O=!0,I=a.onmessage;return a.onmessage=function(){O=!1},a.postMessage("","*"),a.onmessage=I,O}}function S(){var O="setImmediate$"+Math.random()+"$",I=function(F){F.source===a&&typeof F.data=="string"&&F.data.indexOf(O)===0&&y(+F.data.slice(O.length))};a.addEventListener?a.addEventListener("message",I,!1):a.attachEvent("onmessage",I),m=function(F){a.postMessage(O+F,"*")}}function k(){var O=new MessageChannel;O.port1.onmessage=function(I){var F=I.data;y(F)},m=function(I){O.port2.postMessage(I)}}function C(){var O=f.documentElement;m=function(I){var F=f.createElement("script");F.onreadystatechange=function(){y(I),F.onreadystatechange=null,O.removeChild(F),F=null},O.appendChild(F)}}function R(){m=function(O){setTimeout(y,0,O)}}var N=Object.getPrototypeOf&&Object.getPrototypeOf(a);N=N&&N.setTimeout?N:a,{}.toString.call(a.process)==="[object process]"?b():_()?S():a.MessageChannel?k():f&&"onreadystatechange"in f.createElement("script")?C():R(),N.setImmediate=p,N.clearImmediate=x})(typeof self>"u"?typeof s>"u"?this:s:self)}).call(this,typeof Li<"u"?Li:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(zx)),zx.exports}var uz=lz();const cz=Do(uz);class dz{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new cz}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return yg(e,"binary").then((function(r){return this.zip.loadAsync(r,{base64:t})}).bind(this))}request(e,t){var r=new pr,n,s=new jl(e);return t||(t=s.extension),t=="blob"?n=this.getBlob(e):n=this.getText(e),n?n.then((function(a){let o=this.handleResponse(a,t);r.resolve(o)}).bind(this)):r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):vg(t)?r=Ro(e,"text/xml"):t=="xhtml"?r=Ro(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=Ro(e,"text/html"):r=e,r}getBlob(e,t){var r=window.decodeURIComponent(e.substr(1)),n=this.zip.file(r);if(n)return t=t||xf.lookup(n.name),n.async("uint8array").then(function(s){return new Blob([s],{type:t})})}getText(e,t){var r=window.decodeURIComponent(e.substr(1)),n=this.zip.file(r);if(n)return n.async("string").then(function(s){return s})}getBase64(e,t){var r=window.decodeURIComponent(e.substr(1)),n=this.zip.file(r);if(n)return t=t||xf.lookup(n.name),n.async("base64").then(function(s){return"data:"+t+";base64,"+s})}createUrl(e,t){var r=new pr,n=window.URL||window.webkitURL||window.mozURL,s,a,o=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(o?(a=this.getBase64(e),a&&a.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(a=this.getBlob(e),a&&a.then((function(l){s=n.createObjectURL(l),this.urlCache[e]=s,r.resolve(s)}).bind(this))),a||r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var $x={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var QT;function hz(){return QT||(QT=1,function(i,e){(function(t){i.exports=t()})(function(){return function t(r,n,s){function a(c,h){if(!n[c]){if(!r[c]){var f=typeof da=="function"&&da;if(!h&&f)return f(c,!0);if(o)return o(c,!0);var m=new Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m}var p=n[c]={exports:{}};r[c][0].call(p.exports,function(x){var g=r[c][1][x];return a(g||x)},p,p.exports,t,r,n,s)}return n[c].exports}for(var o=typeof da=="function"&&da,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,r,n){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,c=new a(x),h=s.document.createTextNode("");c.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var f=new s.MessageChannel;f.port1.onmessage=x,o=function(){f.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var y=s.document.createElement("script");y.onreadystatechange=function(){x(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},s.document.documentElement.appendChild(y)}:o=function(){setTimeout(x,0)};var m,p=[];function x(){m=!0;for(var y,b,_=p.length;_;){for(b=p,p=[],y=-1;++y<_;)b[y]();_=p.length}m=!1}r.exports=g;function g(y){p.push(y)===1&&!m&&o()}}).call(this,typeof Li<"u"?Li:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,n){var s=t(1);function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],h=["PENDING"];r.exports=f;function f(C){if(typeof C!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,C!==a&&g(this,C)}f.prototype.catch=function(C){return this.then(null,C)},f.prototype.then=function(C,R){if(typeof C!="function"&&this.state===c||typeof R!="function"&&this.state===l)return this;var N=new this.constructor(a);if(this.state!==h){var O=this.state===c?C:R;p(N,O,this.outcome)}else this.queue.push(new m(N,C,R));return N};function m(C,R,N){this.promise=C,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}m.prototype.callFulfilled=function(C){o.resolve(this.promise,C)},m.prototype.otherCallFulfilled=function(C){p(this.promise,this.onFulfilled,C)},m.prototype.callRejected=function(C){o.reject(this.promise,C)},m.prototype.otherCallRejected=function(C){p(this.promise,this.onRejected,C)};function p(C,R,N){s(function(){var O;try{O=R(N)}catch(I){return o.reject(C,I)}O===C?o.reject(C,new TypeError("Cannot resolve promise with itself")):o.resolve(C,O)})}o.resolve=function(C,R){var N=y(x,R);if(N.status==="error")return o.reject(C,N.value);var O=N.value;if(O)g(C,O);else{C.state=c,C.outcome=R;for(var I=-1,F=C.queue.length;++I<F;)C.queue[I].callFulfilled(R)}return C},o.reject=function(C,R){C.state=l,C.outcome=R;for(var N=-1,O=C.queue.length;++N<O;)C.queue[N].callRejected(R);return C};function x(C){var R=C&&C.then;if(C&&(typeof C=="object"||typeof C=="function")&&typeof R=="function")return function(){R.apply(C,arguments)}}function g(C,R){var N=!1;function O(B){N||(N=!0,o.reject(C,B))}function I(B){N||(N=!0,o.resolve(C,B))}function F(){R(I,O)}var G=y(F);G.status==="error"&&O(G.value)}function y(C,R){var N={};try{N.value=C(R),N.status="success"}catch(O){N.status="error",N.value=O}return N}f.resolve=b;function b(C){return C instanceof this?C:o.resolve(new this(a),C)}f.reject=_;function _(C){var R=new this(a);return o.reject(R,C)}f.all=S;function S(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=C.length,O=!1;if(!N)return this.resolve([]);for(var I=new Array(N),F=0,G=-1,B=new this(a);++G<N;)Y(C[G],G);return B;function Y(j,ae){R.resolve(j).then(he,function(ee){O||(O=!0,o.reject(B,ee))});function he(ee){I[ae]=ee,++F===N&&!O&&(O=!0,o.resolve(B,I))}}}f.race=k;function k(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=C.length,O=!1;if(!N)return this.resolve([]);for(var I=-1,F=new this(a);++I<N;)G(C[I]);return F;function G(B){R.resolve(B).then(function(Y){O||(O=!0,o.resolve(F,Y))},function(Y){O||(O=!0,o.reject(F,Y))})}}},{1:1}],3:[function(t,r,n){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof Li<"u"?Li:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,n){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne};function a(ne,ve){if(!(ne instanceof ve))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=o();function c(){try{if(!l||!l.open)return!1;var ne=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ve=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!ne||ve)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function h(ne,ve){ne=ne||[],ve=ve||{};try{return new Blob(ne,ve)}catch(Se){if(Se.name!=="TypeError")throw Se;for(var de=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,Re=new de,De=0;De<ne.length;De+=1)Re.append(ne[De]);return Re.getBlob(ve.type)}}typeof Promise>"u"&&t(3);var f=Promise;function m(ne,ve){ve&&ne.then(function(de){ve(null,de)},function(de){ve(de)})}function p(ne,ve,de){typeof ve=="function"&&ne.then(ve),typeof de=="function"&&ne.catch(de)}function x(ne){return typeof ne!="string"&&(console.warn(ne+" used as a key, but it is not a string."),ne=String(ne)),ne}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var y="local-forage-detect-blob-support",b=void 0,_={},S=Object.prototype.toString,k="readonly",C="readwrite";function R(ne){for(var ve=ne.length,de=new ArrayBuffer(ve),Re=new Uint8Array(de),De=0;De<ve;De++)Re[De]=ne.charCodeAt(De);return de}function N(ne){return new f(function(ve){var de=ne.transaction(y,C),Re=h([""]);de.objectStore(y).put(Re,"key"),de.onabort=function(De){De.preventDefault(),De.stopPropagation(),ve(!1)},de.oncomplete=function(){var De=navigator.userAgent.match(/Chrome\/(\d+)/),Se=navigator.userAgent.match(/Edge\//);ve(Se||!De||parseInt(De[1],10)>=43)}}).catch(function(){return!1})}function O(ne){return typeof b=="boolean"?f.resolve(b):N(ne).then(function(ve){return b=ve,b})}function I(ne){var ve=_[ne.name],de={};de.promise=new f(function(Re,De){de.resolve=Re,de.reject=De}),ve.deferredOperations.push(de),ve.dbReady?ve.dbReady=ve.dbReady.then(function(){return de.promise}):ve.dbReady=de.promise}function F(ne){var ve=_[ne.name],de=ve.deferredOperations.pop();if(de)return de.resolve(),de.promise}function G(ne,ve){var de=_[ne.name],Re=de.deferredOperations.pop();if(Re)return Re.reject(ve),Re.promise}function B(ne,ve){return new f(function(de,Re){if(_[ne.name]=_[ne.name]||K(),ne.db)if(ve)I(ne),ne.db.close();else return de(ne.db);var De=[ne.name];ve&&De.push(ne.version);var Se=l.open.apply(l,De);ve&&(Se.onupgradeneeded=function(Ge){var et=Se.result;try{et.createObjectStore(ne.storeName),Ge.oldVersion<=1&&et.createObjectStore(y)}catch(lt){if(lt.name==="ConstraintError")console.warn('The database "'+ne.name+'" has been upgraded from version '+Ge.oldVersion+" to version "+Ge.newVersion+', but the storage "'+ne.storeName+'" already exists.');else throw lt}}),Se.onerror=function(Ge){Ge.preventDefault(),Re(Se.error)},Se.onsuccess=function(){var Ge=Se.result;Ge.onversionchange=function(et){et.target.close()},de(Ge),F(ne)}})}function Y(ne){return B(ne,!1)}function j(ne){return B(ne,!0)}function ae(ne,ve){if(!ne.db)return!0;var de=!ne.db.objectStoreNames.contains(ne.storeName),Re=ne.version<ne.db.version,De=ne.version>ne.db.version;if(Re&&(ne.version!==ve&&console.warn('The database "'+ne.name+`" can't be downgraded from version `+ne.db.version+" to version "+ne.version+"."),ne.version=ne.db.version),De||de){if(de){var Se=ne.db.version+1;Se>ne.version&&(ne.version=Se)}return!0}return!1}function he(ne){return new f(function(ve,de){var Re=new FileReader;Re.onerror=de,Re.onloadend=function(De){var Se=btoa(De.target.result||"");ve({__local_forage_encoded_blob:!0,data:Se,type:ne.type})},Re.readAsBinaryString(ne)})}function ee(ne){var ve=R(atob(ne.data));return h([ve],{type:ne.type})}function Z(ne){return ne&&ne.__local_forage_encoded_blob}function ie(ne){var ve=this,de=ve._initReady().then(function(){var Re=_[ve._dbInfo.name];if(Re&&Re.dbReady)return Re.dbReady});return p(de,ne,ne),de}function ge(ne){I(ne);for(var ve=_[ne.name],de=ve.forages,Re=0;Re<de.length;Re++){var De=de[Re];De._dbInfo.db&&(De._dbInfo.db.close(),De._dbInfo.db=null)}return ne.db=null,Y(ne).then(function(Se){return ne.db=Se,ae(ne)?j(ne):Se}).then(function(Se){ne.db=ve.db=Se;for(var Ge=0;Ge<de.length;Ge++)de[Ge]._dbInfo.db=Se}).catch(function(Se){throw G(ne,Se),Se})}function V(ne,ve,de,Re){Re===void 0&&(Re=1);try{var De=ne.db.transaction(ne.storeName,ve);de(null,De)}catch(Se){if(Re>0&&(!ne.db||Se.name==="InvalidStateError"||Se.name==="NotFoundError"))return f.resolve().then(function(){if(!ne.db||Se.name==="NotFoundError"&&!ne.db.objectStoreNames.contains(ne.storeName)&&ne.version<=ne.db.version)return ne.db&&(ne.version=ne.db.version+1),j(ne)}).then(function(){return ge(ne).then(function(){V(ne,ve,de,Re-1)})}).catch(de);de(Se)}}function K(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function be(ne){var ve=this,de={db:null};if(ne)for(var Re in ne)de[Re]=ne[Re];var De=_[de.name];De||(De=K(),_[de.name]=De),De.forages.push(ve),ve._initReady||(ve._initReady=ve.ready,ve.ready=ie);var Se=[];function Ge(){return f.resolve()}for(var et=0;et<De.forages.length;et++){var lt=De.forages[et];lt!==ve&&Se.push(lt._initReady().catch(Ge))}var nt=De.forages.slice(0);return f.all(Se).then(function(){return de.db=De.db,Y(de)}).then(function(ht){return de.db=ht,ae(de,ve._defaultConfig.version)?j(de):ht}).then(function(ht){de.db=De.db=ht,ve._dbInfo=de;for(var Ct=0;Ct<nt.length;Ct++){var Wt=nt[Ct];Wt!==ve&&(Wt._dbInfo.db=de.db,Wt._dbInfo.version=de.version)}})}function Ae(ne,ve){var de=this;ne=x(ne);var Re=new f(function(De,Se){de.ready().then(function(){V(de._dbInfo,k,function(Ge,et){if(Ge)return Se(Ge);try{var lt=et.objectStore(de._dbInfo.storeName),nt=lt.get(ne);nt.onsuccess=function(){var ht=nt.result;ht===void 0&&(ht=null),Z(ht)&&(ht=ee(ht)),De(ht)},nt.onerror=function(){Se(nt.error)}}catch(ht){Se(ht)}})}).catch(Se)});return m(Re,ve),Re}function ce(ne,ve){var de=this,Re=new f(function(De,Se){de.ready().then(function(){V(de._dbInfo,k,function(Ge,et){if(Ge)return Se(Ge);try{var lt=et.objectStore(de._dbInfo.storeName),nt=lt.openCursor(),ht=1;nt.onsuccess=function(){var Ct=nt.result;if(Ct){var Wt=Ct.value;Z(Wt)&&(Wt=ee(Wt));var br=ne(Wt,Ct.key,ht++);br!==void 0?De(br):Ct.continue()}else De()},nt.onerror=function(){Se(nt.error)}}catch(Ct){Se(Ct)}})}).catch(Se)});return m(Re,ve),Re}function Pe(ne,ve,de){var Re=this;ne=x(ne);var De=new f(function(Se,Ge){var et;Re.ready().then(function(){return et=Re._dbInfo,S.call(ve)==="[object Blob]"?O(et.db).then(function(lt){return lt?ve:he(ve)}):ve}).then(function(lt){V(Re._dbInfo,C,function(nt,ht){if(nt)return Ge(nt);try{var Ct=ht.objectStore(Re._dbInfo.storeName);lt===null&&(lt=void 0);var Wt=Ct.put(lt,ne);ht.oncomplete=function(){lt===void 0&&(lt=null),Se(lt)},ht.onabort=ht.onerror=function(){var br=Wt.error?Wt.error:Wt.transaction.error;Ge(br)}}catch(br){Ge(br)}})}).catch(Ge)});return m(De,de),De}function Ve(ne,ve){var de=this;ne=x(ne);var Re=new f(function(De,Se){de.ready().then(function(){V(de._dbInfo,C,function(Ge,et){if(Ge)return Se(Ge);try{var lt=et.objectStore(de._dbInfo.storeName),nt=lt.delete(ne);et.oncomplete=function(){De()},et.onerror=function(){Se(nt.error)},et.onabort=function(){var ht=nt.error?nt.error:nt.transaction.error;Se(ht)}}catch(ht){Se(ht)}})}).catch(Se)});return m(Re,ve),Re}function $e(ne){var ve=this,de=new f(function(Re,De){ve.ready().then(function(){V(ve._dbInfo,C,function(Se,Ge){if(Se)return De(Se);try{var et=Ge.objectStore(ve._dbInfo.storeName),lt=et.clear();Ge.oncomplete=function(){Re()},Ge.onabort=Ge.onerror=function(){var nt=lt.error?lt.error:lt.transaction.error;De(nt)}}catch(nt){De(nt)}})}).catch(De)});return m(de,ne),de}function qe(ne){var ve=this,de=new f(function(Re,De){ve.ready().then(function(){V(ve._dbInfo,k,function(Se,Ge){if(Se)return De(Se);try{var et=Ge.objectStore(ve._dbInfo.storeName),lt=et.count();lt.onsuccess=function(){Re(lt.result)},lt.onerror=function(){De(lt.error)}}catch(nt){De(nt)}})}).catch(De)});return m(de,ne),de}function Ze(ne,ve){var de=this,Re=new f(function(De,Se){if(ne<0){De(null);return}de.ready().then(function(){V(de._dbInfo,k,function(Ge,et){if(Ge)return Se(Ge);try{var lt=et.objectStore(de._dbInfo.storeName),nt=!1,ht=lt.openKeyCursor();ht.onsuccess=function(){var Ct=ht.result;if(!Ct){De(null);return}ne===0||nt?De(Ct.key):(nt=!0,Ct.advance(ne))},ht.onerror=function(){Se(ht.error)}}catch(Ct){Se(Ct)}})}).catch(Se)});return m(Re,ve),Re}function at(ne){var ve=this,de=new f(function(Re,De){ve.ready().then(function(){V(ve._dbInfo,k,function(Se,Ge){if(Se)return De(Se);try{var et=Ge.objectStore(ve._dbInfo.storeName),lt=et.openKeyCursor(),nt=[];lt.onsuccess=function(){var ht=lt.result;if(!ht){Re(nt);return}nt.push(ht.key),ht.continue()},lt.onerror=function(){De(lt.error)}}catch(ht){De(ht)}})}).catch(De)});return m(de,ne),de}function gt(ne,ve){ve=g.apply(this,arguments);var de=this.config();ne=typeof ne!="function"&&ne||{},ne.name||(ne.name=ne.name||de.name,ne.storeName=ne.storeName||de.storeName);var Re=this,De;if(!ne.name)De=f.reject("Invalid arguments");else{var Se=ne.name===de.name&&Re._dbInfo.db,Ge=Se?f.resolve(Re._dbInfo.db):Y(ne).then(function(et){var lt=_[ne.name],nt=lt.forages;lt.db=et;for(var ht=0;ht<nt.length;ht++)nt[ht]._dbInfo.db=et;return et});ne.storeName?De=Ge.then(function(et){if(et.objectStoreNames.contains(ne.storeName)){var lt=et.version+1;I(ne);var nt=_[ne.name],ht=nt.forages;et.close();for(var Ct=0;Ct<ht.length;Ct++){var Wt=ht[Ct];Wt._dbInfo.db=null,Wt._dbInfo.version=lt}var br=new f(function(sr,zt){var zr=l.open(ne.name,lt);zr.onerror=function(ri){var va=zr.result;va.close(),zt(ri)},zr.onupgradeneeded=function(){var ri=zr.result;ri.deleteObjectStore(ne.storeName)},zr.onsuccess=function(){var ri=zr.result;ri.close(),sr(ri)}});return br.then(function(sr){nt.db=sr;for(var zt=0;zt<ht.length;zt++){var zr=ht[zt];zr._dbInfo.db=sr,F(zr._dbInfo)}}).catch(function(sr){throw(G(ne,sr)||f.resolve()).catch(function(){}),sr})}}):De=Ge.then(function(et){I(ne);var lt=_[ne.name],nt=lt.forages;et.close();for(var ht=0;ht<nt.length;ht++){var Ct=nt[ht];Ct._dbInfo.db=null}var Wt=new f(function(br,sr){var zt=l.deleteDatabase(ne.name);zt.onerror=function(){var zr=zt.result;zr&&zr.close(),sr(zt.error)},zt.onblocked=function(){console.warn('dropInstance blocked for database "'+ne.name+'" until all open connections are closed')},zt.onsuccess=function(){var zr=zt.result;zr&&zr.close(),br(zr)}});return Wt.then(function(br){lt.db=br;for(var sr=0;sr<nt.length;sr++){var zt=nt[sr];F(zt._dbInfo)}}).catch(function(br){throw(G(ne,br)||f.resolve()).catch(function(){}),br})})}return m(De,ve),De}var ut={_driver:"asyncStorage",_initStorage:be,_support:c(),iterate:ce,getItem:Ae,setItem:Pe,removeItem:Ve,clear:$e,length:qe,key:Ze,keys:at,dropInstance:gt};function z(){return typeof openDatabase=="function"}var Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_e="~~local_forage_type~",ue=/^~~local_forage_type~([^~]+)~/,oe="__lfsc__:",le=oe.length,Oe="arbf",Te="blob",ye="si08",Ue="ui08",rt="uic8",Ke="si16",yt="si32",Rt="ur16",_t="ui32",ar="fl32",cr="fl64",wr=le+Oe.length,Ir=Object.prototype.toString;function Bt(ne){var ve=ne.length*.75,de=ne.length,Re,De=0,Se,Ge,et,lt;ne[ne.length-1]==="="&&(ve--,ne[ne.length-2]==="="&&ve--);var nt=new ArrayBuffer(ve),ht=new Uint8Array(nt);for(Re=0;Re<de;Re+=4)Se=Le.indexOf(ne[Re]),Ge=Le.indexOf(ne[Re+1]),et=Le.indexOf(ne[Re+2]),lt=Le.indexOf(ne[Re+3]),ht[De++]=Se<<2|Ge>>4,ht[De++]=(Ge&15)<<4|et>>2,ht[De++]=(et&3)<<6|lt&63;return nt}function Xt(ne){var ve=new Uint8Array(ne),de="",Re;for(Re=0;Re<ve.length;Re+=3)de+=Le[ve[Re]>>2],de+=Le[(ve[Re]&3)<<4|ve[Re+1]>>4],de+=Le[(ve[Re+1]&15)<<2|ve[Re+2]>>6],de+=Le[ve[Re+2]&63];return ve.length%3===2?de=de.substring(0,de.length-1)+"=":ve.length%3===1&&(de=de.substring(0,de.length-2)+"=="),de}function Pn(ne,ve){var de="";if(ne&&(de=Ir.call(ne)),ne&&(de==="[object ArrayBuffer]"||ne.buffer&&Ir.call(ne.buffer)==="[object ArrayBuffer]")){var Re,De=oe;ne instanceof ArrayBuffer?(Re=ne,De+=Oe):(Re=ne.buffer,de==="[object Int8Array]"?De+=ye:de==="[object Uint8Array]"?De+=Ue:de==="[object Uint8ClampedArray]"?De+=rt:de==="[object Int16Array]"?De+=Ke:de==="[object Uint16Array]"?De+=Rt:de==="[object Int32Array]"?De+=yt:de==="[object Uint32Array]"?De+=_t:de==="[object Float32Array]"?De+=ar:de==="[object Float64Array]"?De+=cr:ve(new Error("Failed to get type for BinaryArray"))),ve(De+Xt(Re))}else if(de==="[object Blob]"){var Se=new FileReader;Se.onload=function(){var Ge=_e+ne.type+"~"+Xt(this.result);ve(oe+Te+Ge)},Se.readAsArrayBuffer(ne)}else try{ve(JSON.stringify(ne))}catch(Ge){console.error("Couldn't convert value into a JSON string: ",ne),ve(null,Ge)}}function se(ne){if(ne.substring(0,le)!==oe)return JSON.parse(ne);var ve=ne.substring(wr),de=ne.substring(le,wr),Re;if(de===Te&&ue.test(ve)){var De=ve.match(ue);Re=De[1],ve=ve.substring(De[0].length)}var Se=Bt(ve);switch(de){case Oe:return Se;case Te:return h([Se],{type:Re});case ye:return new Int8Array(Se);case Ue:return new Uint8Array(Se);case rt:return new Uint8ClampedArray(Se);case Ke:return new Int16Array(Se);case Rt:return new Uint16Array(Se);case yt:return new Int32Array(Se);case _t:return new Uint32Array(Se);case ar:return new Float32Array(Se);case cr:return new Float64Array(Se);default:throw new Error("Unkown type: "+de)}}var Ye={serialize:Pn,deserialize:se,stringToBuffer:Bt,bufferToString:Xt};function Qe(ne,ve,de,Re){ne.executeSql("CREATE TABLE IF NOT EXISTS "+ve.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],de,Re)}function ft(ne){var ve=this,de={db:null};if(ne)for(var Re in ne)de[Re]=typeof ne[Re]!="string"?ne[Re].toString():ne[Re];var De=new f(function(Se,Ge){try{de.db=openDatabase(de.name,String(de.version),de.description,de.size)}catch(et){return Ge(et)}de.db.transaction(function(et){Qe(et,de,function(){ve._dbInfo=de,Se()},function(lt,nt){Ge(nt)})},Ge)});return de.serializer=Ye,De}function we(ne,ve,de,Re,De,Se){ne.executeSql(de,Re,De,function(Ge,et){et.code===et.SYNTAX_ERR?Ge.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ve.storeName],function(lt,nt){nt.rows.length?Se(lt,et):Qe(lt,ve,function(){lt.executeSql(de,Re,De,Se)},Se)},Se):Se(Ge,et)},Se)}function U(ne,ve){var de=this;ne=x(ne);var Re=new f(function(De,Se){de.ready().then(function(){var Ge=de._dbInfo;Ge.db.transaction(function(et){we(et,Ge,"SELECT * FROM "+Ge.storeName+" WHERE key = ? LIMIT 1",[ne],function(lt,nt){var ht=nt.rows.length?nt.rows.item(0).value:null;ht&&(ht=Ge.serializer.deserialize(ht)),De(ht)},function(lt,nt){Se(nt)})})}).catch(Se)});return m(Re,ve),Re}function L(ne,ve){var de=this,Re=new f(function(De,Se){de.ready().then(function(){var Ge=de._dbInfo;Ge.db.transaction(function(et){we(et,Ge,"SELECT * FROM "+Ge.storeName,[],function(lt,nt){for(var ht=nt.rows,Ct=ht.length,Wt=0;Wt<Ct;Wt++){var br=ht.item(Wt),sr=br.value;if(sr&&(sr=Ge.serializer.deserialize(sr)),sr=ne(sr,br.key,Wt+1),sr!==void 0){De(sr);return}}De()},function(lt,nt){Se(nt)})})}).catch(Se)});return m(Re,ve),Re}function re(ne,ve,de,Re){var De=this;ne=x(ne);var Se=new f(function(Ge,et){De.ready().then(function(){ve===void 0&&(ve=null);var lt=ve,nt=De._dbInfo;nt.serializer.serialize(ve,function(ht,Ct){Ct?et(Ct):nt.db.transaction(function(Wt){we(Wt,nt,"INSERT OR REPLACE INTO "+nt.storeName+" (key, value) VALUES (?, ?)",[ne,ht],function(){Ge(lt)},function(br,sr){et(sr)})},function(Wt){if(Wt.code===Wt.QUOTA_ERR){if(Re>0){Ge(re.apply(De,[ne,lt,de,Re-1]));return}et(Wt)}})})}).catch(et)});return m(Se,de),Se}function Ee(ne,ve,de){return re.apply(this,[ne,ve,de,1])}function P(ne,ve){var de=this;ne=x(ne);var Re=new f(function(De,Se){de.ready().then(function(){var Ge=de._dbInfo;Ge.db.transaction(function(et){we(et,Ge,"DELETE FROM "+Ge.storeName+" WHERE key = ?",[ne],function(){De()},function(lt,nt){Se(nt)})})}).catch(Se)});return m(Re,ve),Re}function Ce(ne){var ve=this,de=new f(function(Re,De){ve.ready().then(function(){var Se=ve._dbInfo;Se.db.transaction(function(Ge){we(Ge,Se,"DELETE FROM "+Se.storeName,[],function(){Re()},function(et,lt){De(lt)})})}).catch(De)});return m(de,ne),de}function Ie(ne){var ve=this,de=new f(function(Re,De){ve.ready().then(function(){var Se=ve._dbInfo;Se.db.transaction(function(Ge){we(Ge,Se,"SELECT COUNT(key) as c FROM "+Se.storeName,[],function(et,lt){var nt=lt.rows.item(0).c;Re(nt)},function(et,lt){De(lt)})})}).catch(De)});return m(de,ne),de}function J(ne,ve){var de=this,Re=new f(function(De,Se){de.ready().then(function(){var Ge=de._dbInfo;Ge.db.transaction(function(et){we(et,Ge,"SELECT key FROM "+Ge.storeName+" WHERE id = ? LIMIT 1",[ne+1],function(lt,nt){var ht=nt.rows.length?nt.rows.item(0).key:null;De(ht)},function(lt,nt){Se(nt)})})}).catch(Se)});return m(Re,ve),Re}function me(ne){var ve=this,de=new f(function(Re,De){ve.ready().then(function(){var Se=ve._dbInfo;Se.db.transaction(function(Ge){we(Ge,Se,"SELECT key FROM "+Se.storeName,[],function(et,lt){for(var nt=[],ht=0;ht<lt.rows.length;ht++)nt.push(lt.rows.item(ht).key);Re(nt)},function(et,lt){De(lt)})})}).catch(De)});return m(de,ne),de}function Fe(ne){return new f(function(ve,de){ne.transaction(function(Re){Re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(De,Se){for(var Ge=[],et=0;et<Se.rows.length;et++)Ge.push(Se.rows.item(et).name);ve({db:ne,storeNames:Ge})},function(De,Se){de(Se)})},function(Re){de(Re)})})}function vt(ne,ve){ve=g.apply(this,arguments);var de=this.config();ne=typeof ne!="function"&&ne||{},ne.name||(ne.name=ne.name||de.name,ne.storeName=ne.storeName||de.storeName);var Re=this,De;return ne.name?De=new f(function(Se){var Ge;ne.name===de.name?Ge=Re._dbInfo.db:Ge=openDatabase(ne.name,"","",0),ne.storeName?Se({db:Ge,storeNames:[ne.storeName]}):Se(Fe(Ge))}).then(function(Se){return new f(function(Ge,et){Se.db.transaction(function(lt){function nt(br){return new f(function(sr,zt){lt.executeSql("DROP TABLE IF EXISTS "+br,[],function(){sr()},function(zr,ri){zt(ri)})})}for(var ht=[],Ct=0,Wt=Se.storeNames.length;Ct<Wt;Ct++)ht.push(nt(Se.storeNames[Ct]));f.all(ht).then(function(){Ge()}).catch(function(br){et(br)})},function(lt){et(lt)})})}):De=f.reject("Invalid arguments"),m(De,ve),De}var ct={_driver:"webSQLStorage",_initStorage:ft,_support:z(),iterate:L,getItem:U,setItem:Ee,removeItem:P,clear:Ce,length:Ie,key:J,keys:me,dropInstance:vt};function mt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ft(ne,ve){var de=ne.name+"/";return ne.storeName!==ve.storeName&&(de+=ne.storeName+"/"),de}function vr(){var ne="_localforage_support_test";try{return localStorage.setItem(ne,!0),localStorage.removeItem(ne),!1}catch{return!0}}function Jt(){return!vr()||localStorage.length>0}function Vt(ne){var ve=this,de={};if(ne)for(var Re in ne)de[Re]=ne[Re];return de.keyPrefix=Ft(ne,ve._defaultConfig),Jt()?(ve._dbInfo=de,de.serializer=Ye,f.resolve()):f.reject()}function er(ne){var ve=this,de=ve.ready().then(function(){for(var Re=ve._dbInfo.keyPrefix,De=localStorage.length-1;De>=0;De--){var Se=localStorage.key(De);Se.indexOf(Re)===0&&localStorage.removeItem(Se)}});return m(de,ne),de}function Fr(ne,ve){var de=this;ne=x(ne);var Re=de.ready().then(function(){var De=de._dbInfo,Se=localStorage.getItem(De.keyPrefix+ne);return Se&&(Se=De.serializer.deserialize(Se)),Se});return m(Re,ve),Re}function Rr(ne,ve){var de=this,Re=de.ready().then(function(){for(var De=de._dbInfo,Se=De.keyPrefix,Ge=Se.length,et=localStorage.length,lt=1,nt=0;nt<et;nt++){var ht=localStorage.key(nt);if(ht.indexOf(Se)===0){var Ct=localStorage.getItem(ht);if(Ct&&(Ct=De.serializer.deserialize(Ct)),Ct=ne(Ct,ht.substring(Ge),lt++),Ct!==void 0)return Ct}}});return m(Re,ve),Re}function yn(ne,ve){var de=this,Re=de.ready().then(function(){var De=de._dbInfo,Se;try{Se=localStorage.key(ne)}catch{Se=null}return Se&&(Se=Se.substring(De.keyPrefix.length)),Se});return m(Re,ve),Re}function Hs(ne){var ve=this,de=ve.ready().then(function(){for(var Re=ve._dbInfo,De=localStorage.length,Se=[],Ge=0;Ge<De;Ge++){var et=localStorage.key(Ge);et.indexOf(Re.keyPrefix)===0&&Se.push(et.substring(Re.keyPrefix.length))}return Se});return m(de,ne),de}function kr(ne){var ve=this,de=ve.keys().then(function(Re){return Re.length});return m(de,ne),de}function nn(ne,ve){var de=this;ne=x(ne);var Re=de.ready().then(function(){var De=de._dbInfo;localStorage.removeItem(De.keyPrefix+ne)});return m(Re,ve),Re}function Kr(ne,ve,de){var Re=this;ne=x(ne);var De=Re.ready().then(function(){ve===void 0&&(ve=null);var Se=ve;return new f(function(Ge,et){var lt=Re._dbInfo;lt.serializer.serialize(ve,function(nt,ht){if(ht)et(ht);else try{localStorage.setItem(lt.keyPrefix+ne,nt),Ge(Se)}catch(Ct){(Ct.name==="QuotaExceededError"||Ct.name==="NS_ERROR_DOM_QUOTA_REACHED")&&et(Ct),et(Ct)}})})});return m(De,de),De}function vi(ne,ve){if(ve=g.apply(this,arguments),ne=typeof ne!="function"&&ne||{},!ne.name){var de=this.config();ne.name=ne.name||de.name,ne.storeName=ne.storeName||de.storeName}var Re=this,De;return ne.name?De=new f(function(Se){ne.storeName?Se(Ft(ne,Re._defaultConfig)):Se(ne.name+"/")}).then(function(Se){for(var Ge=localStorage.length-1;Ge>=0;Ge--){var et=localStorage.key(Ge);et.indexOf(Se)===0&&localStorage.removeItem(et)}}):De=f.reject("Invalid arguments"),m(De,ve),De}var On={_driver:"localStorageWrapper",_initStorage:Vt,_support:mt(),iterate:Rr,getItem:Fr,setItem:Kr,removeItem:nn,clear:er,length:kr,key:yn,keys:Hs,dropInstance:vi},Fo=function(ve,de){return ve===de||typeof ve=="number"&&typeof de=="number"&&isNaN(ve)&&isNaN(de)},xh=function(ve,de){for(var Re=ve.length,De=0;De<Re;){if(Fo(ve[De],de))return!0;De++}return!1},In=Array.isArray||function(ne){return Object.prototype.toString.call(ne)==="[object Array]"},yr={},dr={},kn={INDEXEDDB:ut,WEBSQL:ct,LOCALSTORAGE:On},_h=[kn.INDEXEDDB._driver,kn.WEBSQL._driver,kn.LOCALSTORAGE._driver],ga=["dropInstance"],pc=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ga),Gl={description:"",driver:_h.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Xa(ne,ve){ne[ve]=function(){var de=arguments;return ne.ready().then(function(){return ne[ve].apply(ne,de)})}}function ti(){for(var ne=1;ne<arguments.length;ne++){var ve=arguments[ne];if(ve)for(var de in ve)ve.hasOwnProperty(de)&&(In(ve[de])?arguments[0][de]=ve[de].slice():arguments[0][de]=ve[de])}return arguments[0]}var Vp=function(){function ne(ve){a(this,ne);for(var de in kn)if(kn.hasOwnProperty(de)){var Re=kn[de],De=Re._driver;this[de]=De,yr[De]||this.defineDriver(Re)}this._defaultConfig=ti({},Gl),this._config=ti({},this._defaultConfig,ve),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return ne.prototype.config=function(de){if((typeof de>"u"?"undefined":s(de))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Re in de){if(Re==="storeName"&&(de[Re]=de[Re].replace(/\W/g,"_")),Re==="version"&&typeof de[Re]!="number")return new Error("Database version must be a number.");this._config[Re]=de[Re]}return"driver"in de&&de.driver?this.setDriver(this._config.driver):!0}else return typeof de=="string"?this._config[de]:this._config},ne.prototype.defineDriver=function(de,Re,De){var Se=new f(function(Ge,et){try{var lt=de._driver,nt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!de._driver){et(nt);return}for(var ht=pc.concat("_initStorage"),Ct=0,Wt=ht.length;Ct<Wt;Ct++){var br=ht[Ct],sr=!xh(ga,br);if((sr||de[br])&&typeof de[br]!="function"){et(nt);return}}var zt=function(){for(var va=function(Yl){return function(){var rs=new Error("Method "+Yl+" is not implemented by the current driver"),vs=f.reject(rs);return m(vs,arguments[arguments.length-1]),vs}},ql=0,gs=ga.length;ql<gs;ql++){var Mo=ga[ql];de[Mo]||(de[Mo]=va(Mo))}};zt();var zr=function(va){yr[lt]&&console.info("Redefining LocalForage driver: "+lt),yr[lt]=de,dr[lt]=va,Ge()};"_support"in de?de._support&&typeof de._support=="function"?de._support().then(zr,et):zr(!!de._support):zr(!0)}catch(ri){et(ri)}});return p(Se,Re,De),Se},ne.prototype.driver=function(){return this._driver||null},ne.prototype.getDriver=function(de,Re,De){var Se=yr[de]?f.resolve(yr[de]):f.reject(new Error("Driver not found."));return p(Se,Re,De),Se},ne.prototype.getSerializer=function(de){var Re=f.resolve(Ye);return p(Re,de),Re},ne.prototype.ready=function(de){var Re=this,De=Re._driverSet.then(function(){return Re._ready===null&&(Re._ready=Re._initDriver()),Re._ready});return p(De,de,de),De},ne.prototype.setDriver=function(de,Re,De){var Se=this;In(de)||(de=[de]);var Ge=this._getSupportedDrivers(de);function et(){Se._config.driver=Se.driver()}function lt(Ct){return Se._extend(Ct),et(),Se._ready=Se._initStorage(Se._config),Se._ready}function nt(Ct){return function(){var Wt=0;function br(){for(;Wt<Ct.length;){var sr=Ct[Wt];return Wt++,Se._dbInfo=null,Se._ready=null,Se.getDriver(sr).then(lt).catch(br)}et();var zt=new Error("No available storage method found.");return Se._driverSet=f.reject(zt),Se._driverSet}return br()}}var ht=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=ht.then(function(){var Ct=Ge[0];return Se._dbInfo=null,Se._ready=null,Se.getDriver(Ct).then(function(Wt){Se._driver=Wt._driver,et(),Se._wrapLibraryMethodsWithReady(),Se._initDriver=nt(Ge)})}).catch(function(){et();var Ct=new Error("No available storage method found.");return Se._driverSet=f.reject(Ct),Se._driverSet}),p(this._driverSet,Re,De),this._driverSet},ne.prototype.supports=function(de){return!!dr[de]},ne.prototype._extend=function(de){ti(this,de)},ne.prototype._getSupportedDrivers=function(de){for(var Re=[],De=0,Se=de.length;De<Se;De++){var Ge=de[De];this.supports(Ge)&&Re.push(Ge)}return Re},ne.prototype._wrapLibraryMethodsWithReady=function(){for(var de=0,Re=pc.length;de<Re;de++)Xa(this,pc[de])},ne.prototype.createInstance=function(de){return new ne(de)},ne}(),yi=new Vp;r.exports=yi},{3:3}]},{},[4])(4)})}($x)),$x.exports}var fz=hz();const JT=Do(fz);class wD{constructor(e,t,r){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||yg,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof JT>"u"&&(e=JT),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let r=e.resources.map(n=>{let{href:s}=n,a=this.resolver(s),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(l=>!l||t?this.requester(a,"binary").then(c=>this.storage.setItem(o,c)):l)});return Promise.all(r)}put(e,t,r){let n=window.encodeURIComponent(e);return this.storage.getItem(n).then(s=>s||this.requester(e,"binary",t,r).then(a=>this.storage.setItem(n,a)))}request(e,t,r,n){return this.online?this.requester(e,t,r,n).then(s=>(this.put(e),s)):this.retrieve(e,t)}retrieve(e,t){new pr;var r,n=new jl(e);return t||(t=n.extension),t=="blob"?r=this.getBlob(e):r=this.getText(e),r.then(s=>{var a=new pr,o;return s?(o=this.handleResponse(s,t),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):vg(t)?r=Ro(e,"text/xml"):t=="xhtml"?r=Ro(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=Ro(e,"text/html"):r=e,r}getBlob(e,t){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(function(n){if(n)return t=t||xf.lookup(e),new Blob([n],{type:t})})}getText(e,t){let r=window.encodeURIComponent(e);return t=t||xf.lookup(e),this.storage.getItem(r).then(function(n){var s=new pr,a=new FileReader,o;if(n)return o=new Blob([n],{type:t}),a.addEventListener("loadend",()=>{s.resolve(a.result)}),a.readAsText(o,t),s.promise})}getBase64(e,t){let r=window.encodeURIComponent(e);return t=t||xf.lookup(e),this.storage.getItem(r).then(n=>{var s=new pr,a=new FileReader,o;if(n)return o=new Blob([n],{type:t}),a.addEventListener("loadend",()=>{s.resolve(a.result)}),a.readAsDataURL(o,t),s.promise})}createUrl(e,t){var r=new pr,n=window.URL||window.webkitURL||window.mozURL,s,a,o=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(o?(a=this.getBase64(e),a&&a.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(a=this.getBlob(e),a&&a.then((function(l){s=n.createObjectURL(l),this.urlCache[e]=s,r.resolve(s)}).bind(this))),a||r.reject({message:"File not found in storage: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}Io(wD.prototype);class Ux{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=jr(e,"display_options");return t?(Ml(t,"option").forEach(n=>{let s="";switch(n.childNodes.length&&(s=n.childNodes[0].nodeValue),n.attributes.name.value){case"interactive":this.interactive=s;break;case"fixed-layout":this.fixedLayout=s;break;case"open-to-spread":this.openToSpread=s;break;case"orientation-lock":this.orientationLock=s;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const eR="META-INF/container.xml",pz="META-INF/com.apple.ibooks.display-options.xml",Sa={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class BS{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=mi(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),mi(this.settings,t),this.opening=new pr,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new pr,spine:new pr,metadata:new pr,cover:new pr,navigation:new pr,pageList:new pr,resources:new pr,displayOptions:new pr},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||yg,this.spine=new TB,this.locations=new hD(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(r=>{var n=new Error("Cannot load book at "+e);this.emit(xt.BOOK.OPEN_FAILED,n)})}open(e,t){var r,n=t||this.determineType(e);return n===Sa.BINARY?(this.archived=!0,this.url=new ka("/",""),r=this.openEpub(e)):n===Sa.BASE64?(this.archived=!0,this.url=new ka("/",""),r=this.openEpub(e,n)):n===Sa.EPUB?(this.archived=!0,this.url=new ka("/",""),r=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):n==Sa.OPF?(this.url=new ka(e),r=this.openPackaging(this.url.Path.toString())):n==Sa.MANIFEST?(this.url=new ka(e),r=this.openManifest(this.url.Path.toString())):(this.url=new ka(e),r=this.openContainer(eR).then(this.openPackaging.bind(this))),r}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(eR)).then(r=>this.openPackaging(r))}openContainer(e){return this.load(e).then(t=>(this.container=new RB(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new jl(e),this.load(e).then(t=>(this.packaging=new DT(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new jl(e),this.load(e).then(t=>(this.packaging=new DT,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var r=e,n=e.indexOf("://")>-1;return n?e:(this.path&&(r=this.path.resolve(e)),t!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,r,n;if(this.settings.encoding==="base64")return Sa.BASE64;if(typeof e!="string")return Sa.BINARY;if(t=new ka(e),r=t.path(),n=r.extension,n&&(n=n.replace(/\?.*$/,"")),!n)return Sa.DIRECTORY;if(n==="epub")return Sa.EPUB;if(n==="opf")return Sa.OPF;if(n==="json")return Sa.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(pz)).then(t=>{this.displayOptions=new Ux(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new Ux,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Ux,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new PB(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,r=e.toc;return r?new Promise((n,s)=>{this.navigation=new Ex(r),e.pageList&&(this.pageList=new Sx(e.pageList)),n(this.navigation)}):t?this.load(t,"xml").then(n=>(this.navigation=new Ex(n),this.pageList=new Sx(n),this.navigation)):new Promise((n,s)=>{this.navigation=new Ex,this.pageList=new Sx,n(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new jS(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new dz,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,n=this.settings.requestMethod||yg.bind(this);return this.storage=new wD(e,n,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let s=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new ka("/",""),this.spine.hooks.serialize.register(s)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(s)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new mr(e),r=this.spine.get(t.spinePos),n=this.load.bind(this);return r?r.load(n).then(function(s){var a=t.toRange(r.document);return a}):new Promise((s,a)=>{a("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${Fw}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}Io(BS.prototype);function vh(i,e){return new BS(i,e)}vh.VERSION=Fw;typeof global<"u"&&(global.EPUBJS_VERSION=Fw);vh.Book=BS;vh.Rendition=jS;vh.Contents=FS;vh.CFI=mr;vh.utils=wB;const mz="Left",gz="Right",vz="Up",yz="Down",pf={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},M_={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},tR="mousemove",rR="mouseup",bz="touchend",wz="touchmove",xz="touchstart";function _z(i,e,t,r){return i>e?t>0?gz:mz:r>0?yz:vz}function nR(i,e){if(e===0)return i;const t=Math.PI/180*e,r=i[0]*Math.cos(t)+i[1]*Math.sin(t),n=i[1]*Math.cos(t)-i[0]*Math.sin(t);return[r,n]}function Ez(i,e){const t=h=>{const f="touches"in h;f&&h.touches.length>1||i((m,p)=>{p.trackMouse&&!f&&(document.addEventListener(tR,r),document.addEventListener(rR,a));const{clientX:x,clientY:g}=f?h.touches[0]:h,y=nR([x,g],p.rotationAngle);return p.onTouchStartOrOnMouseDown&&p.onTouchStartOrOnMouseDown({event:h}),Object.assign(Object.assign(Object.assign({},m),M_),{initial:y.slice(),xy:y,start:h.timeStamp||0})})},r=h=>{i((f,m)=>{const p="touches"in h;if(p&&h.touches.length>1)return f;if(h.timeStamp-f.start>m.swipeDuration)return f.swiping?Object.assign(Object.assign({},f),{swiping:!1}):f;const{clientX:x,clientY:g}=p?h.touches[0]:h,[y,b]=nR([x,g],m.rotationAngle),_=y-f.xy[0],S=b-f.xy[1],k=Math.abs(_),C=Math.abs(S),R=(h.timeStamp||0)-f.start,N=Math.sqrt(k*k+C*C)/(R||1),O=[_/(R||1),S/(R||1)],I=_z(k,C,_,S),F=typeof m.delta=="number"?m.delta:m.delta[I.toLowerCase()]||pf.delta;if(k<F&&C<F&&!f.swiping)return f;const G={absX:k,absY:C,deltaX:_,deltaY:S,dir:I,event:h,first:f.first,initial:f.initial,velocity:N,vxvy:O};G.first&&m.onSwipeStart&&m.onSwipeStart(G),m.onSwiping&&m.onSwiping(G);let B=!1;return(m.onSwiping||m.onSwiped||m[`onSwiped${I}`])&&(B=!0),B&&m.preventScrollOnSwipe&&m.trackTouch&&h.cancelable&&h.preventDefault(),Object.assign(Object.assign({},f),{first:!1,eventData:G,swiping:!0})})},n=h=>{i((f,m)=>{let p;if(f.swiping&&f.eventData){if(h.timeStamp-f.start<m.swipeDuration){p=Object.assign(Object.assign({},f.eventData),{event:h}),m.onSwiped&&m.onSwiped(p);const x=m[`onSwiped${p.dir}`];x&&x(p)}}else m.onTap&&m.onTap({event:h});return m.onTouchEndOrOnMouseUp&&m.onTouchEndOrOnMouseUp({event:h}),Object.assign(Object.assign(Object.assign({},f),M_),{eventData:p})})},s=()=>{document.removeEventListener(tR,r),document.removeEventListener(rR,a)},a=h=>{s(),n(h)},o=(h,f)=>{let m=()=>{};if(h&&h.addEventListener){const p=Object.assign(Object.assign({},pf.touchEventOptions),f.touchEventOptions),x=[[xz,t,p],[wz,r,Object.assign(Object.assign({},p),f.preventScrollOnSwipe?{passive:!1}:{})],[bz,n,p]];x.forEach(([g,y,b])=>h.addEventListener(g,y,b)),m=()=>x.forEach(([g,y])=>h.removeEventListener(g,y))}return m},c={ref:h=>{h!==null&&i((f,m)=>{if(f.el===h)return f;const p={};return f.el&&f.el!==h&&f.cleanUpTouch&&(f.cleanUpTouch(),p.cleanUpTouch=void 0),m.trackTouch&&h&&(p.cleanUpTouch=o(h,m)),Object.assign(Object.assign(Object.assign({},f),{el:h}),p)})}};return e.trackMouse&&(c.onMouseDown=t),[c,o]}function Sz(i,e,t,r){return!e.trackTouch||!i.el?(i.cleanUpTouch&&i.cleanUpTouch(),Object.assign(Object.assign({},i),{cleanUpTouch:void 0})):i.cleanUpTouch?e.preventScrollOnSwipe!==t.preventScrollOnSwipe||e.touchEventOptions.passive!==t.touchEventOptions.passive?(i.cleanUpTouch(),Object.assign(Object.assign({},i),{cleanUpTouch:r(i.el,e)})):i:Object.assign(Object.assign({},i),{cleanUpTouch:r(i.el,e)})}function Az(i){const{trackMouse:e}=i,t=T.useRef(Object.assign({},M_)),r=T.useRef(Object.assign({},pf)),n=T.useRef(Object.assign({},r.current));n.current=Object.assign({},r.current),r.current=Object.assign(Object.assign({},pf),i);let s;for(s in pf)r.current[s]===void 0&&(r.current[s]=pf[s]);const[a,o]=T.useMemo(()=>Ez(l=>t.current=l(t.current,r.current),{trackMouse:e}),[e]);return t.current=Sz(t.current,r.current,n.current,o),a}var Cz=Object.defineProperty,kz=(i,e,t)=>e in i?Cz(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Hn=(i,e,t)=>kz(i,typeof e!="symbol"?e+"":e,t);const iR={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}};class Tz extends T.Component{constructor(e){super(e),Hn(this,"state",{isLoaded:!1,toc:[]}),Hn(this,"viewerRef",st.createRef()),Hn(this,"location"),Hn(this,"book"),Hn(this,"rendition"),Hn(this,"prevPage"),Hn(this,"nextPage"),Hn(this,"onLocationChange",t=>{const{location:r,locationChanged:n}=this.props,s=`${t.start}`;r!==s&&(this.location=s,n&&n(s))}),Hn(this,"handleKeyPress",t=>{t.key==="ArrowRight"&&this.nextPage&&this.nextPage(),t.key==="ArrowLeft"&&this.prevPage&&this.prevPage()}),this.location=e.location,this.book=this.rendition=this.prevPage=this.nextPage=void 0}componentDidMount(){this.initBook(),document.addEventListener("keyup",this.handleKeyPress,!1)}initBook(){const{url:e,tocChanged:t,epubInitOptions:r}=this.props;this.book&&this.book.destroy(),this.book=vh(e,r),this.book.loaded.navigation.then(({toc:n})=>{this.setState({isLoaded:!0,toc:n},()=>{t&&t(n),this.initReader()})})}componentWillUnmount(){this.book&&this.book.destroy(),this.book=this.rendition=this.prevPage=this.nextPage=void 0,document.removeEventListener("keyup",this.handleKeyPress,!1)}shouldComponentUpdate(e){return!this.state.isLoaded||e.location!==this.props.location||e.url!==this.props.url}componentDidUpdate(e){var t;e.location!==this.props.location&&this.location!==this.props.location&&((t=this.rendition)==null||t.display(this.props.location+"")),e.url!==this.props.url&&this.initBook()}initReader(){const{toc:e}=this.state,{location:t,epubOptions:r,getRendition:n}=this.props;if(this.viewerRef.current){const s=this.viewerRef.current;if(this.book){const a=this.book.renderTo(s,{width:"100%",height:"100%",...r});this.rendition=a,this.prevPage=()=>{a.prev()},this.nextPage=()=>{a.next()},this.registerEvents(),n&&n(a),typeof t=="string"||typeof t=="number"?a.display(t+""):e.length>0&&e[0].href?a.display(e[0].href):a.display()}}}registerEvents(){const{handleKeyPress:e,handleTextSelected:t}=this.props;this.rendition&&(this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",e||this.handleKeyPress),t&&this.rendition.on("selected",t))}renderBook(){const{epubViewStyles:e=iR}=this.props;return E.jsx("div",{ref:this.viewerRef,style:e.view})}render(){const{isLoaded:e}=this.state,{loadingView:t=null,epubViewStyles:r=iR}=this.props;return E.jsx("div",{style:r.viewHolder,children:e&&this.renderBook()||t})}}const dn={container:{overflow:"hidden",position:"relative",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},toc:{},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",marginTop:"-.5em"}},Rz=({children:i,swipeProps:e})=>{const t=Az(e);return E.jsx("div",{style:{height:"100%"},...t,children:i})},xD=({data:i,setLocation:e,styles:t})=>E.jsxs("div",{children:[E.jsx("button",{onClick:()=>e(i.href),style:t,children:i.label}),i.subitems&&i.subitems.length>0&&E.jsx("div",{style:{paddingLeft:10},children:i.subitems.map((r,n)=>E.jsx(xD,{data:r,styles:t,setLocation:e},n))})]});class Nz extends T.PureComponent{constructor(e){super(e),Hn(this,"state",{isLoaded:!1,expandedToc:!1,toc:[]}),Hn(this,"readerRef",st.createRef()),Hn(this,"toggleToc",()=>{this.setState({expandedToc:!this.state.expandedToc})}),Hn(this,"next",()=>{const t=this.readerRef.current;t&&t.nextPage&&t.nextPage()}),Hn(this,"prev",()=>{const t=this.readerRef.current;t&&t.prevPage&&t.prevPage()}),Hn(this,"onTocChange",t=>{const{tocChanged:r}=this.props;this.setState({toc:t},()=>r&&r(t))}),Hn(this,"setLocation",t=>{const{locationChanged:r}=this.props;this.setState({expandedToc:!1},()=>r&&r(t))}),Hn(this,"handleWheel",t=>{var r,n;t.preventDefault();const s=this.readerRef.current;s&&(t.deltaY>0?(r=s.nextPage)==null||r.call(s):t.deltaY<0&&((n=s.prevPage)==null||n.call(s)))}),Hn(this,"attachWheelListener",()=>{if(!this.readerRef.current)return;const t=this.readerRef.current.rendition;t&&t.hooks.content.register(r=>{const n=r.window.document;n.removeEventListener("wheel",this.handleWheel),n.addEventListener("wheel",this.handleWheel,{passive:!1})})}),Hn(this,"searchInBook",async t=>{var r,n,s,a,o;if(!this.readerRef.current)return;const l=(r=this.readerRef.current)==null?void 0:r.rendition,c=l==null?void 0:l.book;if(!c)return;if(!t){(s=(n=this.props).onSearchResults)==null||s.call(n,[]);return}await c.ready;const h=[],f=[];c.spine.each(m=>{const p=(async()=>{try{await m.load(c.load.bind(c));const x=m.document,g=[],y=x.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let b;for(;b=y.nextNode();)g.push(b);const _=g.map(C=>C.textContent).join("").toLowerCase(),S=t.toLowerCase();let k=_.indexOf(S);for(;k!==-1;){let C=0,R=k;for(;C<g.length;){const N=g[C].textContent||"";if(R<N.length)break;R-=N.length,C++}if(C<g.length){let N=x.createRange();try{N.setStart(g[C],R),N.setEnd(g[C],R+S.length);const O=m.cfiFromRange(N),I=`${_.substring(Math.max(0,k-(this.props.contextLength||15)),k+S.length+(this.props.contextLength||15))}`;h.push({cfi:O,excerpt:I})}catch(O){console.warn("Skipping invalid range:",O)}}k=_.indexOf(S,k+1)}m.unload()}catch(x){console.error("Error searching chapter:",x)}})();f.push(p)}),await Promise.all(f),t==this.props.searchQuery&&((o=(a=this.props).onSearchResults)==null||o.call(a,h))})}renderToc(){const{toc:e,expandedToc:t}=this.state,{readerStyles:r=dn}=this.props;return E.jsxs("div",{children:[E.jsx("div",{style:r.tocArea,children:E.jsx("div",{style:r.toc,children:e.map((n,s)=>E.jsx(xD,{data:n,setLocation:this.setLocation,styles:r.tocAreaButton},s))})}),t&&E.jsx("div",{style:r.tocBackground,onClick:this.toggleToc})]})}renderTocToggle(){const{expandedToc:e}=this.state,{readerStyles:t=dn}=this.props;return E.jsxs("button",{style:Object.assign({},t.tocButton,e?t.tocButtonExpanded:{}),onClick:this.toggleToc,children:[E.jsx("span",{style:Object.assign({},t.tocButtonBar,t.tocButtonBarTop)}),E.jsx("span",{style:Object.assign({},t.tocButtonBar,t.tocButtonBottom)})]})}componentDidUpdate(e){e.searchQuery!==this.props.searchQuery&&this.searchInBook(this.props.searchQuery),this.props.pageTurnOnScroll===!0&&this.attachWheelListener()}render(){const{title:e,showToc:t=!0,loadingView:r,readerStyles:n=dn,locationChanged:s,swipeable:a,epubViewStyles:o,isRTL:l=!1,pageTurnOnScroll:c=!1,searchQuery:h,contextLength:f,...m}=this.props,{toc:p,expandedToc:x}=this.state;return E.jsxs("div",{style:n.container,children:[E.jsxs("div",{style:Object.assign({},n.readerArea,x?n.containerExpanded:{}),children:[t&&this.renderTocToggle(),E.jsx("div",{style:n.titleArea,children:e}),E.jsx(Rz,{swipeProps:{onSwiped:g=>{const{dir:y}=g;y==="Left"&&(l?this.prev():this.next()),y==="Right"&&(l?this.next():this.prev())},onTouchStartOrOnMouseDown:({event:g})=>g.preventDefault(),touchEventOptions:{passive:!1},preventScrollOnSwipe:!0,trackMouse:!0},children:E.jsxs("div",{style:n.reader,children:[E.jsx(Tz,{ref:this.readerRef,loadingView:r===void 0?E.jsx("div",{style:n.loadingView,children:"Loading…"}):r,epubViewStyles:o,...m,tocChanged:this.onTocChange,locationChanged:s}),a&&E.jsx("div",{style:n.swipeWrapper})]})}),E.jsx("button",{style:Object.assign({},n.arrow,n.prev),onClick:l?this.next:this.prev,children:"‹"}),E.jsx("button",{style:Object.assign({},n.arrow,n.next),onClick:l?this.prev:this.next,children:"›"})]}),t&&p&&this.renderToc()]})}}const Vi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),j_=[.001,0,0,.001,0,0],Hx=1.35,Ms={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ao={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Dz="pdfjs_internal_editor_",Kt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},fr={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},_D={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Si={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},hg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},_n={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},of={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},d0={ERRORS:0,WARNINGS:1,INFOS:5},bg={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Fy={moveTo:0,lineTo:1,curveTo:2,closePath:3},ED={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Mw=d0.WARNINGS;function Lz(i){Number.isInteger(i)&&(Mw=i)}function Pz(){return Mw}function jw(i){Mw>=d0.INFOS&&console.log(`Info: ${i}`)}function Qt(i){Mw>=d0.WARNINGS&&console.log(`Warning: ${i}`)}function Pr(i){throw new Error(i)}function Nn(i,e){i||Pr(e)}function Oz(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function zS(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"){if(t.addDefaultProtocol&&i.startsWith("www.")){const n=i.match(/\./g);(n==null?void 0:n.length)>=2&&(i=`http://${i}`)}if(t.tryConvertEncoding)try{i=Bz(i)}catch{}}const r=e?URL.parse(i,e):URL.parse(i);return Oz(r)?r:null}function $S(i,e,t=!1){const r=URL.parse(i);return r?(r.hash=e,r.href):t&&zS(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ur(i,e,t,r=!1){return Object.defineProperty(i,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const yh=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class sR extends yh{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Wx extends yh{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class $b extends yh{constructor(e){super(e,"InvalidPDFException")}}class wg extends yh{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class Iz extends yh{constructor(e){super(e,"FormatError")}}class Bl extends yh{constructor(e){super(e,"AbortException")}}function SD(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&Pr("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const r=[];for(let n=0;n<e;n+=t){const s=Math.min(n+t,e),a=i.subarray(n,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function h0(i){typeof i!="string"&&Pr("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=i.charCodeAt(r)&255;return t}function Fz(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function Mz(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function jz(){try{return new Function(""),!0}catch{return!1}}class ei{static get isLittleEndian(){return ur(this,"isLittleEndian",Mz())}static get isEvalSupported(){return ur(this,"isEvalSupported",jz())}static get isOffscreenCanvasSupported(){return ur(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ur(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ur(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ur(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Vx=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var Ll,Jy,B_;class jt{static makeHexColor(e,t,r){return`#${Vx[e]}${Vx[t]}${Vx[r]}`}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,r=0){const n=e[r],s=e[r+1];e[r]=n*t[0]+s*t[2]+t[4],e[r+1]=n*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const n=t[0],s=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const f=e[r+h],m=e[r+h+1];e[r+h]=f*n+m*a+l,e[r+h+1]=f*s+m*o+c}}static applyInverseTransform(e,t){const r=e[0],n=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-n*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-r*t[1]+n*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,r){const n=t[0],s=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],f=e[1],m=e[2],p=e[3];let x=n*h+l,g=x,y=n*m+l,b=y,_=o*f+c,S=_,k=o*p+c,C=k;if(s!==0||a!==0){const R=s*h,N=s*m,O=a*f,I=a*p;x+=O,b+=O,y+=I,g+=I,_+=R,C+=R,k+=N,S+=N}r[0]=Math.min(r[0],x,y,g,b),r[1]=Math.min(r[1],_,k,S,C),r[2]=Math.max(r[2],x,y,g,b),r[3]=Math.max(r[3],_,k,S,C)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=r**2+n**2,l=r*s+n*a,c=s**2+a**2,h=(o+c)/2,f=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+f||1),t[1]=Math.sqrt(h-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>n)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[r,s,n,a]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,n,s){s[0]=Math.min(s[0],e,r),s[1]=Math.min(s[1],t,n),s[2]=Math.max(s[2],e,r),s[3]=Math.max(s[3],t,n)}static bezierBoundingBox(e,t,r,n,s,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),X(this,Ll,B_).call(this,e,r,s,o,t,n,a,l,3*(-e+3*(r-s)+o),6*(e-2*r+s),3*(r-e),c),X(this,Ll,B_).call(this,e,r,s,o,t,n,a,l,3*(-t+3*(n-a)+l),6*(t-2*n+a),3*(n-t),c)}}Ll=new WeakSet,Jy=function(e,t,r,n,s,a,o,l,c,h){if(c<=0||c>=1)return;const f=1-c,m=c*c,p=m*c,x=f*(f*(f*e+3*c*t)+3*m*r)+p*n,g=f*(f*(f*s+3*c*a)+3*m*o)+p*l;h[0]=Math.min(h[0],x),h[1]=Math.min(h[1],g),h[2]=Math.max(h[2],x),h[3]=Math.max(h[3],g)},B_=function(e,t,r,n,s,a,o,l,c,h,f,m){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&X(this,Ll,Jy).call(this,e,t,r,n,s,a,o,l,-f/h,m);return}const p=h**2-4*f*c;if(p<0)return;const x=Math.sqrt(p),g=2*c;X(this,Ll,Jy).call(this,e,t,r,n,s,a,o,l,(-h+x)/g,m),X(this,Ll,Jy).call(this,e,t,r,n,s,a,o,l,(-h-x)/g,m)},q(jt,Ll);function Bz(i){return decodeURIComponent(escape(i))}let Gx=null,aR=null;function AD(i){return Gx||(Gx=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,aR=new Map([["ﬅ","ſt"]])),i.replaceAll(Gx,(e,t,r)=>t?t.normalize("NFKC"):aR.get(r))}function US(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),SD(i)}const HS="pdfjs_internal_id_";function zz(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,n,...s]=t;if(!i(r)&&!Number.isInteger(r)||!e(n))return!1;const a=s.length;let o=!0;switch(n.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Ni(i,e,t){return Math.min(Math.max(i,e),t)}function CD(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(SD(i))}function $z(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):h0(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});const Yo="http://www.w3.org/2000/svg",Kc=class Kc{};it(Kc,"CSS",96),it(Kc,"PDF",72),it(Kc,"PDF_TO_CSS_UNITS",Kc.CSS/Kc.PDF);let zl=Kc;async function Wp(i,e="text"){if(Hm(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType=e,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(n.response);return}t(n.responseText);return}r(new Error(n.statusText))}},n.send(null)})}class f0{constructor({viewBox:e,userUnit:t,scale:r,rotation:n,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=n,this.offsetX=s,this.offsetY=a,r*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let h,f,m,p;switch(n%=360,n<0&&(n+=360),n){case 180:h=-1,f=0,m=0,p=1;break;case 90:h=0,f=1,m=1,p=0;break;case 270:h=0,f=-1,m=-1,p=0;break;case 0:h=1,f=0,m=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(m=-m,p=-p);let x,g,y,b;h===0?(x=Math.abs(c-e[1])*r+s,g=Math.abs(l-e[0])*r+a,y=(e[3]-e[1])*r,b=(e[2]-e[0])*r):(x=Math.abs(l-e[0])*r+s,g=Math.abs(c-e[1])*r+a,y=(e[2]-e[0])*r,b=(e[3]-e[1])*r),this.transform=[h*r,f*r,m*r,p*r,x-h*r*l-m*r*c,g-f*r*l-p*r*c],this.width=y,this.height=b}get rawDims(){const e=this.viewBox;return ur(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new f0({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:n,dontFlip:s})}convertToViewportPoint(e,t){const r=[e,t];return jt.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];jt.applyTransform(t,this.transform);const r=[e[2],e[3]];return jt.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return jt.applyInverseTransform(r,this.transform),r}}class Bw extends yh{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function p0(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function zw(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function kD(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function TD(i,e="document.pdf"){if(typeof i!="string")return e;if(p0(i))return Qt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=t.exec(i);let s=r.exec(n[1])||r.exec(n[2])||r.exec(n[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||e}class oR{constructor(){it(this,"started",Object.create(null));it(this,"times",[])}time(e){e in this.started&&Qt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Qt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:n,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-n}ms
`);return e.join("")}}function Hm(i,e){const t=e?URL.parse(i,e):URL.parse(i);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function ma(i){i.preventDefault()}function An(i){i.preventDefault(),i.stopPropagation()}function Uz(i){console.log("Deprecated API usage: "+i)}var Tg;class $w{static toDateObject(e){if(!e||typeof e!="string")return null;v(this,Tg)||H(this,Tg,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=v(this,Tg).exec(e);if(!t)return null;const r=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(a+=h,o+=f):c==="+"&&(a-=h,o-=f),new Date(Date.UTC(r,n,s,a,o,l))}}Tg=new WeakMap,q($w,Tg);function RD(i,{scale:e=1,rotation:t=0}){const{width:r,height:n}=i.attributes.style,s=[0,0,parseInt(r),parseInt(n)];return new f0({viewBox:s,userUnit:1,scale:e,rotation:t})}function WS(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Qt(`Not a valid color format: "${i}"`),[0,0,0])}function Hz(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;i.set(t,WS(r))}e.remove()}function cn(i){const{a:e,b:t,c:r,d:n,e:s,f:a}=i.getTransform();return[e,t,r,n,s,a]}function io(i){const{a:e,b:t,c:r,d:n,e:s,f:a}=i.getTransform().invertSelf();return[e,t,r,n,s,a]}function nc(i,e,t=!1,r=!0){if(e instanceof f0){const{pageWidth:n,pageHeight:s}=e.rawDims,{style:a}=i,o=ei.isCSSRoundSupported,l=`var(--total-scale-factor) * ${n}px`,c=`var(--total-scale-factor) * ${s}px`,h=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}r&&i.setAttribute("data-main-rotation",e.rotation)}class qa{constructor(){const{pixelRatio:e}=qa;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,n,s=-1){let a=1/0,o=1/0,l=1/0;r=qa.capPixels(r,s),r>0&&(a=Math.sqrt(r/(e*t))),n!==-1&&(o=n/e,l=n/t);const c=Math.min(a,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const Ub=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var pu,ed,ta,mu,Rg,Af,Ng,Jb,ND,pi,DD,LD,Wm,PD,eb;const Zo=class Zo{constructor(e){q(this,pi);q(this,pu,null);q(this,ed,null);q(this,ta);q(this,mu,null);q(this,Rg,null);q(this,Af,null);H(this,ta,e),v(Zo,Ng)||H(Zo,Ng,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=H(this,pu,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=v(this,ta)._uiManager._signal;e.addEventListener("contextmenu",ma,{signal:t}),e.addEventListener("pointerdown",X(Zo,Jb,ND),{signal:t});const r=H(this,mu,document.createElement("div"));r.className="buttons",e.append(r);const n=v(this,ta).toolbarPosition;if(n){const{style:s}=e,a=v(this,ta)._uiManager.direction==="ltr"?1-n[0]:n[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return X(this,pi,PD).call(this),e}get div(){return v(this,pu)}hide(){var e;v(this,pu).classList.add("hidden"),(e=v(this,ed))==null||e.hideDropdown()}show(){var e;v(this,pu).classList.remove("hidden"),(e=v(this,Rg))==null||e.shown()}async addAltText(e){const t=await e.render();X(this,pi,Wm).call(this,t),v(this,mu).prepend(t,v(this,pi,eb)),H(this,Rg,e)}addColorPicker(e){H(this,ed,e);const t=e.renderButton();X(this,pi,Wm).call(this,t),v(this,mu).prepend(t,v(this,pi,eb))}async addEditSignatureButton(e){const t=H(this,Af,await e.renderEditButton(v(this,ta)));X(this,pi,Wm).call(this,t),v(this,mu).prepend(t,v(this,pi,eb))}updateEditSignatureButton(e){v(this,Af)&&(v(this,Af).title=e)}remove(){var e;v(this,pu).remove(),(e=v(this,ed))==null||e.destroy(),H(this,ed,null)}};pu=new WeakMap,ed=new WeakMap,ta=new WeakMap,mu=new WeakMap,Rg=new WeakMap,Af=new WeakMap,Ng=new WeakMap,Jb=new WeakSet,ND=function(e){e.stopPropagation()},pi=new WeakSet,DD=function(e){v(this,ta)._focusEventsAllowed=!1,An(e)},LD=function(e){v(this,ta)._focusEventsAllowed=!0,An(e)},Wm=function(e){const t=v(this,ta)._uiManager._signal;e.addEventListener("focusin",X(this,pi,DD).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",X(this,pi,LD).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ma,{signal:t})},PD=function(){const{editorType:e,_uiManager:t}=v(this,ta),r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",v(Zo,Ng)[e]),X(this,pi,Wm).call(this,r),r.addEventListener("click",n=>{t.delete()},{signal:t._signal}),v(this,mu).append(r)},eb=function(){const e=document.createElement("div");return e.className="divider",e},q(Zo,Jb),q(Zo,Ng,null);let z_=Zo;var Dg,td,rd,ac,OD,ID,FD;class Wz{constructor(e){q(this,ac);q(this,Dg,null);q(this,td,null);q(this,rd);H(this,rd,e)}show(e,t,r){const[n,s]=X(this,ac,ID).call(this,t,r),{style:a}=v(this,td)||H(this,td,X(this,ac,OD).call(this));e.append(v(this,td)),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){v(this,td).remove()}}Dg=new WeakMap,td=new WeakMap,rd=new WeakMap,ac=new WeakSet,OD=function(){const e=H(this,td,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ma,{signal:v(this,rd)._signal});const t=H(this,Dg,document.createElement("div"));return t.className="buttons",e.append(t),X(this,ac,FD).call(this),e},ID=function(e,t){let r=0,n=0;for(const s of e){const a=s.y+s.height;if(a<r)continue;const o=s.x+(t?s.width:0);if(a>r){n=o,r=a;continue}t?o>n&&(n=o):o<n&&(n=o)}return[t?1-n:n,r]},FD=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=v(this,rd)._signal;e.addEventListener("contextmenu",ma,{signal:r}),e.addEventListener("click",()=>{v(this,rd).highlightSelection("floating_button")},{signal:r}),v(this,Dg).append(e)};function MD(i,e,t){for(const r of t)e.addEventListener(r,i[r].bind(i))}var ew;class Vz{constructor(){q(this,ew,0)}get id(){return`${Dz}${Bi(this,ew)._++}`}}ew=new WeakMap;var Cf,Lg,Ci,kf,tb;const lA=class lA{constructor(){q(this,kf);q(this,Cf,US());q(this,Lg,0);q(this,Ci,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=e;const s=n.decode().then(()=>(r.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return ur(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:r,size:n,type:s}=e;return X(this,kf,tb).call(this,`${t}_${r}_${n}_${s}`,e)}async getFromUrl(e){return X(this,kf,tb).call(this,e,e)}async getFromBlob(e,t){const r=await t;return X(this,kf,tb).call(this,e,r)}async getFromId(e){v(this,Ci)||H(this,Ci,new Map);const t=v(this,Ci).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){v(this,Ci)||H(this,Ci,new Map);let r=v(this,Ci).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),r={bitmap:n.transferToImageBitmap(),id:`image_${v(this,Cf)}_${Bi(this,Lg)._++}`,refCounter:1,isSvg:!1},v(this,Ci).set(e,r),v(this,Ci).set(r.id,r),r}getSvgUrl(e){const t=v(this,Ci).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var n;v(this,Ci)||H(this,Ci,new Map);const t=v(this,Ci).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=s.convertToBlob()}(n=r.close)==null||n.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${v(this,Cf)}_`)}};Cf=new WeakMap,Lg=new WeakMap,Ci=new WeakMap,kf=new WeakSet,tb=async function(e,t){v(this,Ci)||H(this,Ci,new Map);let r=v(this,Ci).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${v(this,Cf)}_${Bi(this,Lg)._++}`,refCounter:0,isSvg:!1});let n;if(typeof t=="string"?(r.url=t,n=await Wp(t,"blob")):t instanceof File?n=r.file=t:t instanceof Blob&&(n=t),n.type==="image/svg+xml"){const s=lA._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,c()},a.onload=async()=>{const f=r.svgUrl=a.result;o.src=await s?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=h});a.readAsDataURL(n),await l}else r.bitmap=await createImageBitmap(n);r.refCounter=1}catch(n){Qt(n),r=null}return v(this,Ci).set(e,r),r&&v(this,Ci).set(r.id,r),r};let $_=lA;var En,gu,Pg,un;class Gz{constructor(e=128){q(this,En,[]);q(this,gu,!1);q(this,Pg);q(this,un,-1);H(this,Pg,e)}add({cmd:e,undo:t,post:r,mustExec:n,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(n&&e(),v(this,gu))return;const l={cmd:e,undo:t,post:r,type:s};if(v(this,un)===-1){v(this,En).length>0&&(v(this,En).length=0),H(this,un,0),v(this,En).push(l);return}if(a&&v(this,En)[v(this,un)].type===s){o&&(l.undo=v(this,En)[v(this,un)].undo),v(this,En)[v(this,un)]=l;return}const c=v(this,un)+1;c===v(this,Pg)?v(this,En).splice(0,1):(H(this,un,c),c<v(this,En).length&&v(this,En).splice(c)),v(this,En).push(l)}undo(){if(v(this,un)===-1)return;H(this,gu,!0);const{undo:e,post:t}=v(this,En)[v(this,un)];e(),t==null||t(),H(this,gu,!1),H(this,un,v(this,un)-1)}redo(){if(v(this,un)<v(this,En).length-1){H(this,un,v(this,un)+1),H(this,gu,!0);const{cmd:e,post:t}=v(this,En)[v(this,un)];e(),t==null||t(),H(this,gu,!1)}}hasSomethingToUndo(){return v(this,un)!==-1}hasSomethingToRedo(){return v(this,un)<v(this,En).length-1}cleanType(e){if(v(this,un)!==-1){for(let t=v(this,un);t>=0;t--)if(v(this,En)[t].type!==e){v(this,En).splice(t+1,v(this,un)-t),H(this,un,t);return}v(this,En).length=0,H(this,un,-1)}}destroy(){H(this,En,null)}}En=new WeakMap,gu=new WeakMap,Pg=new WeakMap,un=new WeakMap;var tw,jD;class m0{constructor(e){q(this,tw);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=ei.platform;for(const[r,n,s={}]of e)for(const a of r){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(X(this,tw,jD).call(this,t));if(!r)return;const{callback:n,options:{bubbles:s=!1,args:a=[],checker:o=null}}=r;o&&!o(e,t)||(n.bind(e,...a,t)(),s||An(t))}}tw=new WeakSet,jD=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const rw=class rw{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Hz(e),ur(this,"_colors",e)}convert(e){const t=WS(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,n]of this._colors)if(n.every((s,a)=>s===t[a]))return rw._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?jt.makeHexColor(...t):e}};it(rw,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let U_=rw;var Tf,Ss,$n,ai,Rf,Jo,Nf,ra,vu,yu,Df,nd,lo,Ta,id,Og,Ig,Lf,Fg,uo,bu,Pf,wu,co,nw,xu,Mg,_u,sd,ad,Eu,jg,Yn,Nr,el,Su,od,Bg,zg,Au,ho,tl,$g,na,bt,rb,H_,BD,zD,nb,$D,UD,HD,W_,WD,V_,G_,VD,zi,Xo,GD,qD,q_,YD,Vm,Y_;const yf=class yf{constructor(e,t,r,n,s,a,o,l,c,h,f,m,p,x){q(this,bt);q(this,Tf,new AbortController);q(this,Ss,null);q(this,$n,new Map);q(this,ai,new Map);q(this,Rf,null);q(this,Jo,null);q(this,Nf,null);q(this,ra,new Gz);q(this,vu,null);q(this,yu,null);q(this,Df,0);q(this,nd,new Set);q(this,lo,null);q(this,Ta,null);q(this,id,new Set);it(this,"_editorUndoBar",null);q(this,Og,!1);q(this,Ig,!1);q(this,Lf,!1);q(this,Fg,null);q(this,uo,null);q(this,bu,null);q(this,Pf,null);q(this,wu,!1);q(this,co,null);q(this,nw,new Vz);q(this,xu,!1);q(this,Mg,!1);q(this,_u,null);q(this,sd,null);q(this,ad,null);q(this,Eu,null);q(this,jg,null);q(this,Yn,Kt.NONE);q(this,Nr,new Set);q(this,el,null);q(this,Su,null);q(this,od,null);q(this,Bg,null);q(this,zg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});q(this,Au,[0,0]);q(this,ho,null);q(this,tl,null);q(this,$g,null);q(this,na,null);const g=this._signal=v(this,Tf).signal;H(this,tl,e),H(this,$g,t),H(this,Rf,r),H(this,Su,n),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:g}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),s._on("setpreference",this.onSetPreference.bind(this),{signal:g}),s._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:g}),X(this,bt,$D).call(this),X(this,bt,VD).call(this),X(this,bt,W_).call(this),H(this,Jo,a.annotationStorage),H(this,Fg,a.filterFactory),H(this,od,o),H(this,Pf,l||null),H(this,Og,c),H(this,Ig,h),H(this,Lf,f),H(this,jg,m||null),this.viewParameters={realScale:zl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=x!==!1}static get _keyboardManager(){const e=yf.prototype,t=a=>v(a,tl).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return ur(this,"_keyboardManager",new m0([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&v(a,tl).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&v(a,tl).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,r,n,s,a,o,l;(e=v(this,na))==null||e.resolve(),H(this,na,null),(t=v(this,Tf))==null||t.abort(),H(this,Tf,null),this._signal=null;for(const c of v(this,ai).values())c.destroy();v(this,ai).clear(),v(this,$n).clear(),v(this,id).clear(),(r=v(this,Eu))==null||r.clear(),H(this,Ss,null),v(this,Nr).clear(),v(this,ra).destroy(),(n=v(this,Rf))==null||n.destroy(),(s=v(this,Su))==null||s.destroy(),(a=v(this,co))==null||a.hide(),H(this,co,null),(o=v(this,ad))==null||o.destroy(),H(this,ad,null),v(this,uo)&&(clearTimeout(v(this,uo)),H(this,uo,null)),v(this,ho)&&(clearTimeout(v(this,ho)),H(this,ho,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return v(this,jg)}get useNewAltTextFlow(){return v(this,Ig)}get useNewAltTextWhenAddingImage(){return v(this,Lf)}get hcmFilter(){return ur(this,"hcmFilter",v(this,od)?v(this,Fg).addHCMFilter(v(this,od).foreground,v(this,od).background):"none")}get direction(){return ur(this,"direction",getComputedStyle(v(this,tl)).direction)}get highlightColors(){return ur(this,"highlightColors",v(this,Pf)?new Map(v(this,Pf).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ur(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),H(this,yu,e)}setMainHighlightColorPicker(e){H(this,ad,e)}editAltText(e,t=!1){var r;(r=v(this,Rf))==null||r.editAltText(this,e,t)}getSignature(e){var t;(t=v(this,Su))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return v(this,Su)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":H(this,Lf,t);break}}onPageChanging({pageNumber:e}){H(this,Df,e-1)}focusMainContainer(){v(this,tl).focus()}findParent(e,t){for(const r of v(this,ai).values()){const{x:n,y:s,width:a,height:o}=r.div.getBoundingClientRect();if(e>=n&&e<=n+a&&t>=s&&t<=s+o)return r}return null}disableUserSelect(e=!1){v(this,$g).classList.toggle("noUserSelect",e)}addShouldRescale(e){v(this,id).add(e)}removeShouldRescale(e){v(this,id).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*zl.PDF_TO_CSS_UNITS;for(const r of v(this,id))r.onScaleChanging();(t=v(this,yu))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:a}=t,o=t.toString(),c=X(this,bt,rb).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const f=X(this,bt,H_).call(this,c),m=v(this,Yn)===Kt.NONE,p=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:a,text:o}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Kt.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&v(this,Jo)&&!v(this,Jo).has(e.id)&&v(this,Jo).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,v(this,wu)&&(H(this,wu,!1),X(this,bt,nb).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of v(this,Nr))if(t.div.contains(e)){H(this,sd,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!v(this,sd))return;const[e,t]=v(this,sd);H(this,sd,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){X(this,bt,W_).call(this),X(this,bt,V_).call(this)}removeEditListeners(){X(this,bt,WD).call(this),X(this,bt,G_).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of v(this,Ta))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of v(this,Ta))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=v(this,Ss))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of v(this,Nr)){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of v(this,Ta))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Qt(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const n=this.currentLayer;try{const s=[];for(const l of r){const c=await n.deserialize(l);if(!c)return;s.push(c)}const a=()=>{for(const l of s)X(this,bt,q_).call(this,l);X(this,bt,Y_).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){Qt(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),v(this,Yn)!==Kt.NONE&&!this.isEditorHandlingKeyboard&&yf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,v(this,wu)&&(H(this,wu,!1),X(this,bt,nb).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(X(this,bt,UD).call(this),X(this,bt,V_).call(this),X(this,bt,zi).call(this,{isEditing:v(this,Yn)!==Kt.NONE,isEmpty:X(this,bt,Vm).call(this),hasSomethingToUndo:v(this,ra).hasSomethingToUndo(),hasSomethingToRedo:v(this,ra).hasSomethingToRedo(),hasSelectedEditor:!1})):(X(this,bt,HD).call(this),X(this,bt,G_).call(this),X(this,bt,zi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!v(this,Ta)){H(this,Ta,e);for(const t of v(this,Ta))X(this,bt,Xo).call(this,t.defaultPropertiesToUpdate)}}getId(){return v(this,nw).id}get currentLayer(){return v(this,ai).get(v(this,Df))}getLayer(e){return v(this,ai).get(e)}get currentPageIndex(){return v(this,Df)}addLayer(e){v(this,ai).set(e.pageIndex,e),v(this,xu)?e.enable():e.disable()}removeLayer(e){v(this,ai).delete(e.pageIndex)}async updateMode(e,t=null,r=!1){var n,s,a;if(v(this,Yn)!==e&&!(v(this,na)&&(await v(this,na).promise,!v(this,na)))){if(H(this,na,Promise.withResolvers()),(n=v(this,yu))==null||n.commitOrRemove(),H(this,Yn,e),e===Kt.NONE){this.setEditingState(!1),X(this,bt,qD).call(this),(s=this._editorUndoBar)==null||s.hide(),v(this,na).resolve();return}e===Kt.SIGNATURE&&await((a=v(this,Su))==null?void 0:a.loadSignatures()),this.setEditingState(!0),await X(this,bt,GD).call(this),this.unselectAll();for(const o of v(this,ai).values())o.updateMode(e);if(!t){r&&this.addNewEditorFromKeyboard(),v(this,na).resolve();return}for(const o of v(this,$n).values())o.annotationElementId===t||o.id===t?(this.setSelected(o),o.enterInEditMode()):o.unselect();v(this,na).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==v(this,Yn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var r;if(v(this,Ta)){switch(e){case fr.CREATE:this.currentLayer.addNewEditor(t);return;case fr.HIGHLIGHT_DEFAULT_COLOR:(r=v(this,ad))==null||r.updateColor(t);break;case fr.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(v(this,Bg)||H(this,Bg,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const n of v(this,Nr))n.updateParams(e,t);for(const n of v(this,Ta))n.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var s;for(const a of v(this,$n).values())a.editorType===e&&a.show(t);(((s=v(this,Bg))==null?void 0:s.get(fr.HIGHLIGHT_SHOW_ALL))??!0)!==t&&X(this,bt,Xo).call(this,[[fr.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(v(this,Mg)!==e){H(this,Mg,e);for(const t of v(this,ai).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const r of v(this,$n).values())r.pageIndex===e&&t.push(r);return t}getEditor(e){return v(this,$n).get(e)}addEditor(e){v(this,$n).set(e.id,e)}removeEditor(e){var t,r;e.div.contains(document.activeElement)&&(v(this,uo)&&clearTimeout(v(this,uo)),H(this,uo,setTimeout(()=>{this.focusMainContainer(),H(this,uo,null)},0))),v(this,$n).delete(e.id),e.annotationElementId&&((t=v(this,Eu))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!v(this,nd).has(e.annotationElementId))&&((r=v(this,Jo))==null||r.remove(e.id))}addDeletedAnnotationElement(e){v(this,nd).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return v(this,nd).has(e)}removeDeletedAnnotationElement(e){v(this,nd).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){v(this,Ss)!==e&&(H(this,Ss,e),e&&X(this,bt,Xo).call(this,e.propertiesToUpdate))}updateUI(e){v(this,bt,YD)===e&&X(this,bt,Xo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){X(this,bt,Xo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(v(this,Nr).has(e)){v(this,Nr).delete(e),e.unselect(),X(this,bt,zi).call(this,{hasSelectedEditor:this.hasSelection});return}v(this,Nr).add(e),e.select(),X(this,bt,Xo).call(this,e.propertiesToUpdate),X(this,bt,zi).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=v(this,yu))==null||t.commitOrRemove();for(const r of v(this,Nr))r!==e&&r.unselect();v(this,Nr).clear(),v(this,Nr).add(e),e.select(),X(this,bt,Xo).call(this,e.propertiesToUpdate),X(this,bt,zi).call(this,{hasSelectedEditor:!0})}isSelected(e){return v(this,Nr).has(e)}get firstSelectedEditor(){return v(this,Nr).values().next().value}unselect(e){e.unselect(),v(this,Nr).delete(e),X(this,bt,zi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return v(this,Nr).size!==0}get isEnterHandled(){return v(this,Nr).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;v(this,ra).undo(),X(this,bt,zi).call(this,{hasSomethingToUndo:v(this,ra).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:X(this,bt,Vm).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){v(this,ra).redo(),X(this,bt,zi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:v(this,ra).hasSomethingToRedo(),isEmpty:X(this,bt,Vm).call(this)})}addCommands(e){v(this,ra).add(e),X(this,bt,zi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:X(this,bt,Vm).call(this)})}cleanUndoStack(e){v(this,ra).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...v(this,Nr)],r=()=>{var a;(a=this._editorUndoBar)==null||a.show(n,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},n=()=>{for(const a of t)X(this,bt,q_).call(this,a)};this.addCommands({cmd:r,undo:n,mustExec:!0})}commitOrRemove(){var e;(e=v(this,Ss))==null||e.commitOrRemove()}hasSomethingToControl(){return v(this,Ss)||this.hasSelection}selectAll(){for(const e of v(this,Nr))e.commit();X(this,bt,Y_).call(this,v(this,$n).values())}unselectAll(){var e;if(!(v(this,Ss)&&(v(this,Ss).commitOrRemove(),v(this,Yn)!==Kt.NONE))&&!((e=v(this,yu))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of v(this,Nr))t.unselect();v(this,Nr).clear(),X(this,bt,zi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;v(this,Au)[0]+=e,v(this,Au)[1]+=t;const[n,s]=v(this,Au),a=[...v(this,Nr)],o=1e3;v(this,ho)&&clearTimeout(v(this,ho)),H(this,ho,setTimeout(()=>{H(this,ho,null),v(this,Au)[0]=v(this,Au)[1]=0,this.addCommands({cmd:()=>{for(const l of a)v(this,$n).has(l.id)&&(l.translateInPage(n,s),l.translationDone())},undo:()=>{for(const l of a)v(this,$n).has(l.id)&&(l.translateInPage(-n,-s),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),H(this,lo,new Map);for(const e of v(this,Nr))v(this,lo).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!v(this,lo))return!1;this.disableUserSelect(!1);const e=v(this,lo);H(this,lo,null);let t=!1;for(const[{x:n,y:s,pageIndex:a},o]of e)o.newX=n,o.newY=s,o.newPageIndex=a,t||(t=n!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const r=(n,s,a,o)=>{if(v(this,$n).has(n.id)){const l=v(this,ai).get(o);l?n._setParentAndPosition(l,s,a):(n.pageIndex=o,n.x=s,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:s,newY:a,newPageIndex:o}]of e)r(n,s,a,o)},undo:()=>{for(const[n,{savedX:s,savedY:a,savedPageIndex:o}]of e)r(n,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(v(this,lo))for(const r of v(this,lo).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||v(this,Nr).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return v(this,Ss)===e}getActive(){return v(this,Ss)}getMode(){return v(this,Yn)}get imageManager(){return ur(this,"imageManager",new $_)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:r,y:n,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,f,m)=>({x:(h-n)/a,y:1-(c+f-r)/s,width:m/a,height:f/s});break;case"180":o=(c,h,f,m)=>({x:1-(c+f-r)/s,y:1-(h+m-n)/a,width:f/s,height:m/a});break;case"270":o=(c,h,f,m)=>({x:1-(h+m-n)/a,y:(c-r)/s,width:m/a,height:f/s});break;default:o=(c,h,f,m)=>({x:(c-r)/s,y:(h-n)/a,width:f/s,height:m/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const f=t.getRangeAt(c);if(!f.collapsed)for(const{x:m,y:p,width:x,height:g}of f.getClientRects())x===0||g===0||l.push(o(m,p,x,g))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(v(this,Nf)||H(this,Nf,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=v(this,Nf))==null||t.delete(e)}renderAnnotationElement(e){var n;const t=(n=v(this,Nf))==null?void 0:n.get(e.data.id);if(!t)return;const r=v(this,Jo).getRawValue(t);r&&(v(this,Yn)===Kt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){var s;const n=(s=v(this,Eu))==null?void 0:s.get(e);n&&(n.setCanvas(t,r),v(this,Eu).delete(e))}addMissingCanvas(e,t){(v(this,Eu)||H(this,Eu,new Map)).set(e,t)}};Tf=new WeakMap,Ss=new WeakMap,$n=new WeakMap,ai=new WeakMap,Rf=new WeakMap,Jo=new WeakMap,Nf=new WeakMap,ra=new WeakMap,vu=new WeakMap,yu=new WeakMap,Df=new WeakMap,nd=new WeakMap,lo=new WeakMap,Ta=new WeakMap,id=new WeakMap,Og=new WeakMap,Ig=new WeakMap,Lf=new WeakMap,Fg=new WeakMap,uo=new WeakMap,bu=new WeakMap,Pf=new WeakMap,wu=new WeakMap,co=new WeakMap,nw=new WeakMap,xu=new WeakMap,Mg=new WeakMap,_u=new WeakMap,sd=new WeakMap,ad=new WeakMap,Eu=new WeakMap,jg=new WeakMap,Yn=new WeakMap,Nr=new WeakMap,el=new WeakMap,Su=new WeakMap,od=new WeakMap,Bg=new WeakMap,zg=new WeakMap,Au=new WeakMap,ho=new WeakMap,tl=new WeakMap,$g=new WeakMap,na=new WeakMap,bt=new WeakSet,rb=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},H_=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of v(this,ai).values())if(r.hasTextLayer(e))return r;return null},BD=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=X(this,bt,rb).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(r);n&&(v(this,co)||H(this,co,new Wz(this)),v(this,co).show(r,n,this.direction==="ltr"))},zD=function(){var s,a,o;const e=document.getSelection();if(!e||e.isCollapsed){v(this,el)&&((s=v(this,co))==null||s.hide(),H(this,el,null),X(this,bt,zi).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===v(this,el))return;const n=X(this,bt,rb).call(this,e).closest(".textLayer");if(!n){v(this,el)&&((a=v(this,co))==null||a.hide(),H(this,el,null),X(this,bt,zi).call(this,{hasSelectedText:!1}));return}if((o=v(this,co))==null||o.hide(),H(this,el,t),X(this,bt,zi).call(this,{hasSelectedText:!0}),!(v(this,Yn)!==Kt.HIGHLIGHT&&v(this,Yn)!==Kt.NONE)&&(v(this,Yn)===Kt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),H(this,wu,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=v(this,Yn)===Kt.HIGHLIGHT?X(this,bt,H_).call(this,n):null;l==null||l.toggleDrawing();const c=new AbortController,h=this.combinedSignal(c),f=m=>{m.type==="pointerup"&&m.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),m.type==="pointerup"&&X(this,bt,nb).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("blur",f,{signal:h})}},nb=function(e=""){v(this,Yn)===Kt.HIGHLIGHT?this.highlightSelection(e):v(this,Og)&&X(this,bt,BD).call(this)},$D=function(){document.addEventListener("selectionchange",X(this,bt,zD).bind(this),{signal:this._signal})},UD=function(){if(v(this,bu))return;H(this,bu,new AbortController);const e=this.combinedSignal(v(this,bu));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},HD=function(){var e;(e=v(this,bu))==null||e.abort(),H(this,bu,null)},W_=function(){if(v(this,_u))return;H(this,_u,new AbortController);const e=this.combinedSignal(v(this,_u));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},WD=function(){var e;(e=v(this,_u))==null||e.abort(),H(this,_u,null)},V_=function(){if(v(this,vu))return;H(this,vu,new AbortController);const e=this.combinedSignal(v(this,vu));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},G_=function(){var e;(e=v(this,vu))==null||e.abort(),H(this,vu,null)},VD=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},zi=function(e){Object.entries(e).some(([r,n])=>v(this,zg)[r]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(v(this,zg),e)}),v(this,Yn)===Kt.HIGHLIGHT&&e.hasSelectedEditor===!1&&X(this,bt,Xo).call(this,[[fr.HIGHLIGHT_FREE,!0]]))},Xo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},GD=async function(){if(!v(this,xu)){H(this,xu,!0);const e=[];for(const t of v(this,ai).values())e.push(t.enable());await Promise.all(e);for(const t of v(this,$n).values())t.enable()}},qD=function(){if(this.unselectAll(),v(this,xu)){H(this,xu,!1);for(const e of v(this,ai).values())e.disable();for(const e of v(this,$n).values())e.disable()}},q_=function(e){const t=v(this,ai).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},YD=function(){let e=null;for(e of v(this,Nr));return e},Vm=function(){if(v(this,$n).size===0)return!0;if(v(this,$n).size===1)for(const e of v(this,$n).values())return e.isEmpty();return!1},Y_=function(e){for(const t of v(this,Nr))t.unselect();v(this,Nr).clear();for(const t of e)t.isEmpty()||(v(this,Nr).add(t),t.select());X(this,bt,zi).call(this,{hasSelectedEditor:this.hasSelection})},it(yf,"TRANSLATE_SMALL",1),it(yf,"TRANSLATE_BIG",10);let ic=yf;var Xn,fo,Ra,Of,po,As,If,mo,ds,rl,ld,go,Cu,Wa,Gm,ib;const $i=class $i{constructor(e){q(this,Wa);q(this,Xn,null);q(this,fo,!1);q(this,Ra,null);q(this,Of,null);q(this,po,null);q(this,As,null);q(this,If,!1);q(this,mo,null);q(this,ds,null);q(this,rl,null);q(this,ld,null);q(this,go,!1);H(this,ds,e),H(this,go,e._uiManager.useNewAltTextFlow),v($i,Cu)||H($i,Cu,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){$i._l10n??($i._l10n=e)}async render(){const e=H(this,Ra,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=H(this,Of,document.createElement("span"));e.append(t),v(this,go)?(e.classList.add("new"),e.setAttribute("data-l10n-id",v($i,Cu).missing),t.setAttribute("data-l10n-id",v($i,Cu)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=v(this,ds)._uiManager._signal;e.addEventListener("contextmenu",ma,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const n=s=>{s.preventDefault(),v(this,ds)._uiManager.editAltText(v(this,ds)),v(this,go)&&v(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:v(this,Wa,Gm)}})};return e.addEventListener("click",n,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(H(this,If,!0),n(s))},{signal:r}),await X(this,Wa,ib).call(this),e}finish(){v(this,Ra)&&(v(this,Ra).focus({focusVisible:v(this,If)}),H(this,If,!1))}isEmpty(){return v(this,go)?v(this,Xn)===null:!v(this,Xn)&&!v(this,fo)}hasData(){return v(this,go)?v(this,Xn)!==null||!!v(this,rl):this.isEmpty()}get guessedText(){return v(this,rl)}async setGuessedText(e){v(this,Xn)===null&&(H(this,rl,e),H(this,ld,await $i._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),X(this,Wa,ib).call(this))}toggleAltTextBadge(e=!1){var t;if(!v(this,go)||v(this,Xn)){(t=v(this,mo))==null||t.remove(),H(this,mo,null);return}if(!v(this,mo)){const r=H(this,mo,document.createElement("div"));r.className="noAltTextBadge",v(this,ds).div.append(r)}v(this,mo).classList.toggle("hidden",!e)}serialize(e){let t=v(this,Xn);return!e&&v(this,rl)===t&&(t=v(this,ld)),{altText:t,decorative:v(this,fo),guessedText:v(this,rl),textWithDisclaimer:v(this,ld)}}get data(){return{altText:v(this,Xn),decorative:v(this,fo)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:n,cancel:s=!1}){r&&(H(this,rl,r),H(this,ld,n)),!(v(this,Xn)===e&&v(this,fo)===t)&&(s||(H(this,Xn,e),H(this,fo,t)),X(this,Wa,ib).call(this))}toggle(e=!1){v(this,Ra)&&(!e&&v(this,As)&&(clearTimeout(v(this,As)),H(this,As,null)),v(this,Ra).disabled=!e)}shown(){v(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:v(this,Wa,Gm)}})}destroy(){var e,t;(e=v(this,Ra))==null||e.remove(),H(this,Ra,null),H(this,Of,null),H(this,po,null),(t=v(this,mo))==null||t.remove(),H(this,mo,null)}};Xn=new WeakMap,fo=new WeakMap,Ra=new WeakMap,Of=new WeakMap,po=new WeakMap,As=new WeakMap,If=new WeakMap,mo=new WeakMap,ds=new WeakMap,rl=new WeakMap,ld=new WeakMap,go=new WeakMap,Cu=new WeakMap,Wa=new WeakSet,Gm=function(){return v(this,Xn)&&"added"||v(this,Xn)===null&&this.guessedText&&"review"||"missing"},ib=async function(){var n,s,a;const e=v(this,Ra);if(!e)return;if(v(this,go)){if(e.classList.toggle("done",!!v(this,Xn)),e.setAttribute("data-l10n-id",v($i,Cu)[v(this,Wa,Gm)]),(n=v(this,Of))==null||n.setAttribute("data-l10n-id",v($i,Cu)[`${v(this,Wa,Gm)}-label`]),!v(this,Xn)){(s=v(this,po))==null||s.remove();return}}else{if(!v(this,Xn)&&!v(this,fo)){e.classList.remove("done"),(a=v(this,po))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=v(this,po);if(!t){H(this,po,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${v(this,ds).id}`;const o=100,l=v(this,ds)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(v(this,As)),H(this,As,null)},{once:!0}),e.addEventListener("mouseenter",()=>{H(this,As,setTimeout(()=>{H(this,As,null),v(this,po).classList.add("show"),v(this,ds)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;v(this,As)&&(clearTimeout(v(this,As)),H(this,As,null)),(c=v(this,po))==null||c.classList.remove("show")},{signal:l})}v(this,fo)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=v(this,Xn)),t.parentNode||e.append(t);const r=v(this,ds).getElementForAltText();r==null||r.setAttribute("aria-describedby",t.id)},q($i,Cu,null),it($i,"_l10n",null);let Hb=$i;var Ff,ud,Ug,Hg,Wg,Vg,Gg,nl,cd,il,dd,sl,oc,XD,KD,ZD;const uA=class uA{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:n=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){q(this,oc);q(this,Ff);q(this,ud,!1);q(this,Ug,null);q(this,Hg);q(this,Wg);q(this,Vg);q(this,Gg);q(this,nl,null);q(this,cd);q(this,il,null);q(this,dd);q(this,sl,null);H(this,Ff,e),H(this,Ug,r),H(this,Hg,t),H(this,Wg,n),H(this,Vg,s),H(this,Gg,a),H(this,dd,new AbortController),H(this,cd,AbortSignal.any([o,v(this,dd).signal])),e.addEventListener("touchstart",X(this,oc,XD).bind(this),{passive:!1,signal:v(this,cd)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/qa.pixelRatio}destroy(){var e,t;(e=v(this,dd))==null||e.abort(),H(this,dd,null),(t=v(this,nl))==null||t.abort(),H(this,nl,null)}};Ff=new WeakMap,ud=new WeakMap,Ug=new WeakMap,Hg=new WeakMap,Wg=new WeakMap,Vg=new WeakMap,Gg=new WeakMap,nl=new WeakMap,cd=new WeakMap,il=new WeakMap,dd=new WeakMap,sl=new WeakMap,oc=new WeakSet,XD=function(e){var n,s,a;if((n=v(this,Hg))!=null&&n.call(this))return;if(e.touches.length===1){if(v(this,nl))return;const o=H(this,nl,new AbortController),l=AbortSignal.any([v(this,cd),o.signal]),c=v(this,Ff),h={capture:!0,signal:l,passive:!1},f=m=>{var p;m.pointerType==="touch"&&((p=v(this,nl))==null||p.abort(),H(this,nl,null))};c.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(An(m),f(m))},h),c.addEventListener("pointerup",f,h),c.addEventListener("pointercancel",f,h);return}if(!v(this,sl)){H(this,sl,new AbortController);const o=AbortSignal.any([v(this,cd),v(this,sl).signal]),l=v(this,Ff),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",X(this,oc,KD).bind(this),c);const h=X(this,oc,ZD).bind(this);l.addEventListener("touchend",h,c),l.addEventListener("touchcancel",h,c),c.capture=!0,l.addEventListener("pointerdown",An,c),l.addEventListener("pointermove",An,c),l.addEventListener("pointercancel",An,c),l.addEventListener("pointerup",An,c),(s=v(this,Wg))==null||s.call(this)}if(An(e),e.touches.length!==2||(a=v(this,Ug))!=null&&a.call(this)){H(this,il,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),H(this,il,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},KD=function(e){var k;if(!v(this,il)||e.touches.length!==2)return;An(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:n,screenY:s}=t,{screenX:a,screenY:o}=r,l=v(this,il),{touch0X:c,touch0Y:h,touch1X:f,touch1Y:m}=l,p=f-c,x=m-h,g=a-n,y=o-s,b=Math.hypot(g,y)||1,_=Math.hypot(p,x)||1;if(!v(this,ud)&&Math.abs(_-b)<=uA.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=n,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,!v(this,ud)){H(this,ud,!0);return}const S=[(n+a)/2,(s+o)/2];(k=v(this,Vg))==null||k.call(this,S,_,b)},ZD=function(e){var t;e.touches.length>=2||(v(this,sl)&&(v(this,sl).abort(),H(this,sl,null),(t=v(this,Gg))==null||t.call(this)),v(this,il)&&(An(e),H(this,il,null),H(this,ud,!1)))};let xg=uA;var hd,Na,Yr,Mf,ku,qg,fd,oi,pd,al,Tu,Yg,md,Cs,Xg,gd,ol,vo,jf,Bf,ia,vd,Kg,iw,Ht,X_,Zg,K_,sb,QD,JD,Z_,ab,Q_,eL,tL,rL,J_,nL,eE,iL,sL,aL,tE,qm;const rr=class rr{constructor(e){q(this,Ht);q(this,hd,null);q(this,Na,null);q(this,Yr,null);q(this,Mf,!1);q(this,ku,null);q(this,qg,"");q(this,fd,!1);q(this,oi,null);q(this,pd,null);q(this,al,null);q(this,Tu,null);q(this,Yg,"");q(this,md,!1);q(this,Cs,null);q(this,Xg,!1);q(this,gd,!1);q(this,ol,!1);q(this,vo,null);q(this,jf,0);q(this,Bf,0);q(this,ia,null);q(this,vd,null);it(this,"isSelected",!1);it(this,"_isCopy",!1);it(this,"_editToolbar",null);it(this,"_initialOptions",Object.create(null));it(this,"_initialData",null);it(this,"_isVisible",!0);it(this,"_uiManager",null);it(this,"_focusEventsAllowed",!0);q(this,Kg,!1);q(this,iw,rr._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:r,pageHeight:n,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,n],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=rr.prototype._resizeWithKeyboard,t=ic.TRANSLATE_SMALL,r=ic.TRANSLATE_BIG;return ur(this,"_resizerKeyboardManager",new m0([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],rr.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ur(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new qz({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(rr._l10n??(rr._l10n=e),rr._l10nResizer||(rr._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),rr._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);rr._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Pr("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return v(this,Kg)}set _isDraggable(e){var t;H(this,Kg,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=v(this,iw)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):X(this,Ht,qm).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(v(this,md)?H(this,md,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,n){const[s,a]=this.parentDimensions;[r,n]=this.screenToPageTranslation(r,n),this.x=(e+r)/s,this.y=(t+n)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,n]=this.parentDimensions;this.setAt(e*r,t*n,this.width*r,this.height*n),this._onTranslated()}translate(e,t){X(this,Ht,X_).call(this,this.parentDimensions,e,t)}translateInPage(e,t){v(this,Cs)||H(this,Cs,[this.x,this.y,this.width,this.height]),X(this,Ht,X_).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){v(this,Cs)||H(this,Cs,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[n,s]}=this;if(this.x+=e/n,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=r;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!v(this,Cs)&&(v(this,Cs)[0]!==this.x||v(this,Cs)[1]!==this.y)}get _hasBeenResized(){return!!v(this,Cs)&&(v(this,Cs)[2]!==this.width||v(this,Cs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=rr,n=r/e,s=r/t;switch(this.rotation){case 90:return[-n,s];case 180:return[n,s];case 270:return[n,-s];default:return[-n,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,n]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=r,l*=n,s*=r,a*=n,this._mustFixPosition)switch(e){case 0:s=Ni(s,0,r-o),a=Ni(a,0,n-l);break;case 90:s=Ni(s,0,r-l),a=Ni(a,o,n);break;case 180:s=Ni(s,o,r),a=Ni(a,l,n);break;case 270:s=Ni(s,l,r),a=Ni(a,0,n-o);break}this.x=s/=r,this.y=a/=n;const[c,h]=this.getBaseTranslation();s+=c,a+=h,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return X(r=rr,Zg,K_).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return X(r=rr,Zg,K_).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(e,t){const[r,n]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*e/r).toFixed(2)}%`,v(this,fd)||(s.height=`${(100*t/n).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:r}=e,n=r.endsWith("%"),s=!v(this,fd)&&t.endsWith("%");if(n&&s)return;const[a,o]=this.parentDimensions;n||(e.width=`${(100*parseFloat(r)/a).toFixed(2)}%`),!v(this,fd)&&!s&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=v(this,Yr))==null||e.finish()}async addEditToolbar(){return this._editToolbar||v(this,gd)?this._editToolbar:(this._editToolbar=new z_(this),this.div.append(this._editToolbar.render()),v(this,Yr)&&await this._editToolbar.addAltText(v(this,Yr)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=v(this,Yr))==null||e.destroy())}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){v(this,Yr)||(Hb.initialize(rr._l10n),H(this,Yr,new Hb(this)),v(this,hd)&&(v(this,Yr).data=v(this,hd),H(this,hd,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=v(this,Yr))==null?void 0:e.data}set altTextData(e){v(this,Yr)&&(v(this,Yr).data=e)}get guessedAltText(){var e;return(e=v(this,Yr))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=v(this,Yr))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=v(this,Yr))==null?void 0:t.serialize(e)}hasAltText(){return!!v(this,Yr)&&!v(this,Yr).isEmpty()}hasAltTextData(){var e;return((e=v(this,Yr))==null?void 0:e.hasData())??!1}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=v(this,Mf)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),X(this,Ht,eE).call(this);const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[n,s]=this.getInitialTranslation();return this.translate(n,s),MD(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(v(this,vd)||H(this,vd,new xg({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:X(this,Ht,eL).bind(this),onPinching:X(this,Ht,tL).bind(this),onPinchEnd:X(this,Ht,rL).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=ei.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(H(this,md,!0),this._isDraggable){X(this,Ht,nL).call(this,e);return}X(this,Ht,J_).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){v(this,vo)&&clearTimeout(v(this,vo)),H(this,vo,setTimeout(()=>{var e;H(this,vo,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const n=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/n,h=t/n,f=this.x*s,m=this.y*a,p=this.width*s,x=this.height*a;switch(r){case 0:return[f+c+o,a-m-h-x+l,f+c+p+o,a-m-h+l];case 90:return[f+h+o,a-m+c+l,f+h+x+o,a-m+c+p+l];case 180:return[f-c-p+o,a-m+h+l,f-c+o,a-m+h+x+l];case 270:return[f-h-x+o,a-m-c-p+l,f-h+o,a-m-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,n,s,a]=e,o=s-r,l=a-n;switch(this.rotation){case 0:return[r,t-a,o,l];case 90:return[r,t-n,l,o];case 180:return[s,t-n,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),H(this,gd,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),H(this,gd,!1),!0):!1}isInEditMode(){return v(this,gd)}shouldGetKeyboardEvents(){return v(this,ol)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:n}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&n>0&&e<s&&r>0}rebuild(){X(this,Ht,eE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Pr("An editor must be serializable")}static async deserialize(e,t,r){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r});n.rotation=e.rotation,H(n,hd,e.accessibilityData),n._isCopy=e.isCopy||!1;const[s,a]=n.pageDimensions,[o,l,c,h]=n.getRectInCurrentCoords(e.rect,a);return n.x=o/s,n.y=l/a,n.width=c/s,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=v(this,Tu))==null||e.abort(),H(this,Tu,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),v(this,vo)&&(clearTimeout(v(this,vo)),H(this,vo,null)),X(this,Ht,qm).call(this),this.removeEditToolbar(),v(this,ia)){for(const r of v(this,ia).values())clearTimeout(r);H(this,ia,null)}this.parent=null,(t=v(this,vd))==null||t.destroy(),H(this,vd,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(X(this,Ht,QD).call(this),v(this,oi).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),H(this,al,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=v(this,oi).children;if(!v(this,Na)){H(this,Na,Array.from(t));const a=X(this,Ht,iL).bind(this),o=X(this,Ht,sL).bind(this),l=this._uiManager._signal;for(const c of v(this,Na)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",X(this,Ht,aL).bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",rr._l10nResizer[h])}}const r=v(this,Na)[0];let n=0;for(const a of t){if(a===r)break;n++}const s=(360-this.rotation+this.parentRotation)%360/90*(v(this,Na).length/4);if(s!==n){if(s<n)for(let o=0;o<n-s;o++)v(this,oi).append(v(this,oi).firstChild);else if(s>n)for(let o=0;o<s-n;o++)v(this,oi).firstChild.before(v(this,oi).lastChild);let a=0;for(const o of t){const c=v(this,Na)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",rr._l10nResizer[c])}}X(this,Ht,tE).call(this,0),H(this,ol,!0),v(this,oi).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){v(this,ol)&&X(this,Ht,Q_).call(this,v(this,Yg),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){X(this,Ht,qm).call(this),this.div.focus()}select(){var e,t,r;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,s;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(r=v(this,Yr))==null||r.toggleAltTextBadge(!1)}}unselect(){var e,t,r,n,s;this.isSelected&&(this.isSelected=!1,(e=v(this,oi))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(s=v(this,Yr))==null||s.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return v(this,Xg)}set isEditing(e){H(this,Xg,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){H(this,fd,!0);const r=e/t,{style:n}=this.div;n.aspectRatio=r,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){v(this,ia)||H(this,ia,new Map);const{action:r}=e;let n=v(this,ia).get(r);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),v(this,ia).delete(r),v(this,ia).size===0&&H(this,ia,null)},rr._telemetryTimeout),v(this,ia).set(r,n);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),H(this,Mf,!1)}disable(){this.div&&(this.div.tabIndex=-1),H(this,Mf,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};hd=new WeakMap,Na=new WeakMap,Yr=new WeakMap,Mf=new WeakMap,ku=new WeakMap,qg=new WeakMap,fd=new WeakMap,oi=new WeakMap,pd=new WeakMap,al=new WeakMap,Tu=new WeakMap,Yg=new WeakMap,md=new WeakMap,Cs=new WeakMap,Xg=new WeakMap,gd=new WeakMap,ol=new WeakMap,vo=new WeakMap,jf=new WeakMap,Bf=new WeakMap,ia=new WeakMap,vd=new WeakMap,Kg=new WeakMap,iw=new WeakMap,Ht=new WeakSet,X_=function([e,t],r,n){[r,n]=this.screenToPageTranslation(r,n),this.x+=r/e,this.y+=n/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Zg=new WeakSet,K_=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},sb=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},QD=function(){if(v(this,oi))return;H(this,oi,document.createElement("div")),v(this,oi).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const n=document.createElement("div");v(this,oi).append(n),n.classList.add("resizer",r),n.setAttribute("data-resizer-name",r),n.addEventListener("pointerdown",X(this,Ht,JD).bind(this,r),{signal:t}),n.addEventListener("contextmenu",ma,{signal:t}),n.tabIndex=-1}this.div.prepend(v(this,oi))},JD=function(e,t){var h;t.preventDefault();const{isMac:r}=ei.platform;if(t.button!==0||t.ctrlKey&&r)return;(h=v(this,Yr))==null||h.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,H(this,pd,[t.screenX,t.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",X(this,Ht,Q_).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",An,{passive:!1,signal:a}),window.addEventListener("contextmenu",ma,{signal:a}),H(this,al,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var f;s.abort(),this.parent.togglePointerEvents(!0),(f=v(this,Yr))==null||f.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=o,this.div.style.cursor=l,X(this,Ht,ab).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},Z_=function(e,t,r,n){this.width=r,this.height=n,this.x=e,this.y=t;const[s,a]=this.parentDimensions;this.setDims(s*r,a*n),this.fixAndSetPosition(),this._onResized()},ab=function(){if(!v(this,al))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:n}=v(this,al);H(this,al,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===r&&l===n||this.addCommands({cmd:X(this,Ht,Z_).bind(this,s,a,o,l),undo:X(this,Ht,Z_).bind(this,e,t,r,n),mustExec:!0})},Q_=function(e,t){const[r,n]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,c=rr.MIN_SIZE/r,h=rr.MIN_SIZE/n,f=X(this,Ht,sb).call(this,this.rotation),m=(he,ee)=>[f[0]*he+f[2]*ee,f[1]*he+f[3]*ee],p=X(this,Ht,sb).call(this,360-this.rotation),x=(he,ee)=>[p[0]*he+p[2]*ee,p[1]*he+p[3]*ee];let g,y,b=!1,_=!1;switch(e){case"topLeft":b=!0,g=(he,ee)=>[0,0],y=(he,ee)=>[he,ee];break;case"topMiddle":g=(he,ee)=>[he/2,0],y=(he,ee)=>[he/2,ee];break;case"topRight":b=!0,g=(he,ee)=>[he,0],y=(he,ee)=>[0,ee];break;case"middleRight":_=!0,g=(he,ee)=>[he,ee/2],y=(he,ee)=>[0,ee/2];break;case"bottomRight":b=!0,g=(he,ee)=>[he,ee],y=(he,ee)=>[0,0];break;case"bottomMiddle":g=(he,ee)=>[he/2,ee],y=(he,ee)=>[he/2,0];break;case"bottomLeft":b=!0,g=(he,ee)=>[0,ee],y=(he,ee)=>[he,0];break;case"middleLeft":_=!0,g=(he,ee)=>[0,ee/2],y=(he,ee)=>[he,ee/2];break}const S=g(o,l),k=y(o,l);let C=m(...k);const R=rr._round(s+C[0]),N=rr._round(a+C[1]);let O=1,I=1,F,G;if(t.fromKeyboard)({deltaX:F,deltaY:G}=t);else{const{screenX:he,screenY:ee}=t,[Z,ie]=v(this,pd);[F,G]=this.screenToPageTranslation(he-Z,ee-ie),v(this,pd)[0]=he,v(this,pd)[1]=ee}if([F,G]=x(F/r,G/n),b){const he=Math.hypot(o,l);O=I=Math.max(Math.min(Math.hypot(k[0]-S[0]-F,k[1]-S[1]-G)/he,1/o,1/l),c/o,h/l)}else _?O=Ni(Math.abs(k[0]-S[0]-F),c,1)/o:I=Ni(Math.abs(k[1]-S[1]-G),h,1)/l;const B=rr._round(o*O),Y=rr._round(l*I);C=m(...y(B,Y));const j=R-C[0],ae=N-C[1];v(this,Cs)||H(this,Cs,[this.x,this.y,this.width,this.height]),this.width=B,this.height=Y,this.x=j,this.y=ae,this.setDims(r*B,n*Y),this.fixAndSetPosition(),this._onResizing()},eL=function(){var e;H(this,al,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=v(this,Yr))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},tL=function(e,t,r){let s=.7*(r/t)+1-.7;if(s===1)return;const a=X(this,Ht,sb).call(this,this.rotation),o=(R,N)=>[a[0]*R+a[2]*N,a[1]*R+a[3]*N],[l,c]=this.parentDimensions,h=this.x,f=this.y,m=this.width,p=this.height,x=rr.MIN_SIZE/l,g=rr.MIN_SIZE/c;s=Math.max(Math.min(s,1/m,1/p),x/m,g/p);const y=rr._round(m*s),b=rr._round(p*s);if(y===m&&b===p)return;v(this,Cs)||H(this,Cs,[h,f,m,p]);const _=o(m/2,p/2),S=rr._round(h+_[0]),k=rr._round(f+_[1]),C=o(y/2,b/2);this.x=S-C[0],this.y=k-C[1],this.width=y,this.height=b,this.setDims(l*y,c*b),this.fixAndSetPosition(),this._onResizing()},rL=function(){var e;(e=v(this,Yr))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),X(this,Ht,ab).call(this)},J_=function(e){const{isMac:t}=ei.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},nL=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const n=new AbortController,s=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:s},o=c=>{n.abort(),H(this,ku,null),H(this,md,!1),this._uiManager.endDragSession()||X(this,Ht,J_).call(this,c),r&&this._onStopDragging()};t&&(H(this,jf,e.clientX),H(this,Bf,e.clientY),H(this,ku,e.pointerId),H(this,qg,e.pointerType),window.addEventListener("pointermove",c=>{r||(r=!0,this._onStartDragging());const{clientX:h,clientY:f,pointerId:m}=c;if(m!==v(this,ku)){An(c);return}const[p,x]=this.screenToPageTranslation(h-v(this,jf),f-v(this,Bf));H(this,jf,h),H(this,Bf,f),this._uiManager.dragSelectedEditors(p,x)},a),window.addEventListener("touchmove",An,a),window.addEventListener("pointerdown",c=>{c.pointerType===v(this,qg)&&(v(this,vd)||c.isPrimary)&&o(c),An(c)},a));const l=c=>{if(!v(this,ku)||v(this,ku)===c.pointerId){o(c);return}An(c)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},eE=function(){if(v(this,Tu)||!this.div)return;H(this,Tu,new AbortController);const e=this._uiManager.combinedSignal(v(this,Tu));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},iL=function(e){rr._resizerKeyboardManager.exec(this,e)},sL=function(e){var t;v(this,ol)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==v(this,oi)&&X(this,Ht,qm).call(this)},aL=function(e){H(this,Yg,v(this,ol)?e:"")},tE=function(e){if(v(this,Na))for(const t of v(this,Na))t.tabIndex=e},qm=function(){H(this,ol,!1),X(this,Ht,tE).call(this,-1),X(this,Ht,ab).call(this)},q(rr,Zg),it(rr,"_l10n",null),it(rr,"_l10nResizer",null),it(rr,"_borderLineWidth",-1),it(rr,"_colorManager",new U_),it(rr,"_zIndex",1),it(rr,"_telemetryTimeout",1e3);let Vr=rr;class qz extends Vr{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const lR=3285377520,ea=4294901760,so=65535;class oL{constructor(e){this.h1=e?e&4294967295:lR,this.h2=e?e&4294967295:lR}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let g=0,y=e.length;g<y;g++){const b=e.charCodeAt(g);b<=255?t[r++]=b:(t[r++]=b>>>8,t[r++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=r>>2,s=r-n*4,a=new Uint32Array(t.buffer,0,n);let o=0,l=0,c=this.h1,h=this.h2;const f=3432918353,m=461845907,p=f&so,x=m&so;for(let g=0;g<n;g++)g&1?(o=a[g],o=o*f&ea|o*p&so,o=o<<15|o>>>17,o=o*m&ea|o*x&so,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[g],l=l*f&ea|l*p&so,l=l<<15|l>>>17,l=l*m&ea|l*x&so,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,s){case 3:o^=t[n*4+2]<<16;case 2:o^=t[n*4+1]<<8;case 1:o^=t[n*4],o=o*f&ea|o*p&so,o=o<<15|o>>>17,o=o*m&ea|o*x&so,n&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ea|e*36045&so,t=t*4283543511&ea|((t<<16|e>>>16)*2950163797&ea)>>>16,e^=t>>>1,e=e*444984403&ea|e*60499&so,t=t*3301882366&ea|((t<<16|e>>>16)*3120437893&ea)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const rE=Object.freeze({map:null,hash:"",transfer:void 0});var yd,bd,li,sw,lL;class VS{constructor(){q(this,sw);q(this,yd,!1);q(this,bd,null);q(this,li,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=v(this,li).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return v(this,li).get(e)}remove(e){if(v(this,li).delete(e),v(this,li).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of v(this,li).values())if(t instanceof Vr)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=v(this,li).get(e);let n=!1;if(r!==void 0)for(const[s,a]of Object.entries(t))r[s]!==a&&(n=!0,r[s]=a);else n=!0,v(this,li).set(e,t);n&&X(this,sw,lL).call(this),t instanceof Vr&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return v(this,li).has(e)}get size(){return v(this,li).size}resetModified(){v(this,yd)&&(H(this,yd,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new uL(this)}get serializable(){if(v(this,li).size===0)return rE;const e=new Map,t=new oL,r=[],n=Object.create(null);let s=!1;for(const[a,o]of v(this,li)){const l=o instanceof Vr?o.serialize(!1,n):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:rE}get editorStats(){let e=null;const t=new Map;for(const r of v(this,li).values()){if(!(r instanceof Vr))continue;const n=r.telemetryFinalData;if(!n)continue;const{type:s}=n;t.has(s)||t.set(s,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const a=e[s]||(e[s]=new Map);for(const[o,l]of Object.entries(n)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[r,n]of t)e[r]=n.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){H(this,bd,null)}get modifiedIds(){if(v(this,bd))return v(this,bd);const e=[];for(const t of v(this,li).values())!(t instanceof Vr)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return H(this,bd,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return v(this,li).entries()}}yd=new WeakMap,bd=new WeakMap,li=new WeakMap,sw=new WeakSet,lL=function(){v(this,yd)||(H(this,yd,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Qg;class uL extends VS{constructor(t){super();q(this,Qg);const{map:r,hash:n,transfer:s}=t.serializable,a=structuredClone(r,s?{transfer:s}:null);H(this,Qg,{map:a,hash:n,transfer:s})}get print(){Pr("Should not call PrintAnnotationStorage.print")}get serializable(){return v(this,Qg)}get modifiedIds(){return ur(this,"modifiedIds",{ids:new Set,hash:""})}}Qg=new WeakMap;var zf;class Yz{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){q(this,zf,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),v(this,zf).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||v(this,zf).has(e.loadedName))){if(Nn(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:s,style:a}=e,o=new FontFace(n,s,a);this.addNativeFontFace(o);try{await o.load(),v(this,zf).add(n),r==null||r(e)}catch{Qt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Pr("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(n){throw Qt(`Failed to load font '${r.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const n=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ur(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ur(this,"isSyncFontLoadingSupported",Vi||ei.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Nn(!n.done,"completeRequest() cannot be called twice."),n.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,n={done:!1,complete:t,callback:e};return r.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ur(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(k,C){return k.charCodeAt(C)<<24|k.charCodeAt(C+1)<<16|k.charCodeAt(C+2)<<8|k.charCodeAt(C+3)&255}function n(k,C,R,N){const O=k.substring(0,C),I=k.substring(C+R);return O+N+I}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(k,C){if(++c>30){Qt("Load test font never loaded."),C();return}if(l.font="30px "+k,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,k,C))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=n(m,976,f.length,f);const x=16,g=1482184792;let y=r(m,x);for(s=0,a=f.length-3;s<a;s+=4)y=y-g+r(f,s)|0;s<f.length&&(y=y-g+r(f+"XXX",s)|0),m=n(m,x,4,Fz(y));const b=`url(data:font/opentype;base64,${btoa(m)});`,_=`@font-face {font-family:"${f}";src:${b}}`;this.insertRule(_);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const k of[e.loadedName,f]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=k,S.append(C)}this._document.body.append(S),h(f,()=>{S.remove(),t.complete()})}}zf=new WeakMap;class Xz{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${CD(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let n;try{n=e.get(r)}catch(a){Qt(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(n||"");return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=s}}function Kz(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Vi)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Zz(i){if(Vi&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return h0(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function My(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const nE=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,Qz=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",cL=zz.bind(null,nE,Qz);var ll,aw;class Jz{constructor(){q(this,ll,new Map);q(this,aw,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};v(this,aw).then(()=>{for(const[n]of v(this,ll))n.call(this,r)})}addEventListener(e,t,r=null){let n=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Qt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);n=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}v(this,ll).set(t,n)}removeEventListener(e,t){const r=v(this,ll).get(t);r==null||r(),v(this,ll).delete(t)}terminate(){for(const[,e]of v(this,ll))e==null||e();v(this,ll).clear()}}ll=new WeakMap,aw=new WeakMap;const jy={DATA:1,ERROR:2},Rn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function uR(){}function us(i){if(i instanceof Bl||i instanceof $b||i instanceof sR||i instanceof wg||i instanceof Wx)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||Pr('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Bl(i.message);case"InvalidPDFException":return new $b(i.message);case"PasswordException":return new sR(i.message,i.code);case"ResponseException":return new wg(i.message,i.status,i.missing);case"UnknownErrorException":return new Wx(i.message,i.details)}return new Wx(i.message,i.toString())}var $f,fa,dL,hL,fL,ob;class Ym{constructor(e,t,r){q(this,fa);q(this,$f,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",X(this,fa,dL).bind(this),{signal:v(this,$f).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const n=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[n]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,r,n){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:c.desiredSize},n),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[s].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Rn.PULL,streamId:s,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Nn(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[s].cancelCall=h,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Rn.CANCEL,streamId:s,reason:us(c)}),h.promise}},r)}destroy(){var e;(e=v(this,$f))==null||e.abort(),H(this,$f,null)}}$f=new WeakMap,fa=new WeakSet,dL=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){X(this,fa,fL).call(this,e);return}if(e.callback){const r=e.callbackId,n=this.callbackCapabilities[r];if(!n)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===jy.DATA)n.resolve(e.data);else if(e.callback===jy.ERROR)n.reject(us(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,n=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(a){s.postMessage({sourceName:r,targetName:n,callback:jy.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:n,callback:jy.ERROR,callbackId:e.callbackId,reason:us(a)})});return}if(e.streamId){X(this,fa,hL).call(this,e);return}t(e.data)},hL=function(e){const t=e.streamId,r=this.sourceName,n=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,f){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=h,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:n,stream:Rn.ENQUEUE,streamId:t,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:n,stream:Rn.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Nn(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:n,stream:Rn.ERROR,streamId:t,reason:us(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:n,stream:Rn.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:n,stream:Rn.START_COMPLETE,streamId:t,reason:us(c)})})},fL=function(e){const t=e.streamId,r=this.sourceName,n=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Rn.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(us(e.reason));break;case Rn.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(us(e.reason));break;case Rn.PULL:if(!o){s.postMessage({sourceName:r,targetName:n,stream:Rn.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||uR).then(function(){s.postMessage({sourceName:r,targetName:n,stream:Rn.PULL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:n,stream:Rn.PULL_COMPLETE,streamId:t,reason:us(c)})});break;case Rn.ENQUEUE:if(Nn(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Rn.CLOSE:if(Nn(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),X(this,fa,ob).call(this,a,t);break;case Rn.ERROR:Nn(a,"error should have stream controller"),a.controller.error(us(e.reason)),X(this,fa,ob).call(this,a,t);break;case Rn.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(us(e.reason)),X(this,fa,ob).call(this,a,t);break;case Rn.CANCEL:if(!o)break;const l=us(e.reason);Promise.try(o.onCancel||uR,l).then(function(){s.postMessage({sourceName:r,targetName:n,stream:Rn.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:n,stream:Rn.CANCEL_COMPLETE,streamId:t,reason:us(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},ob=async function(e,t){var r,n,s;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(n=e.pullCall)==null?void 0:n.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var Jg;class pL{constructor({enableHWA:e=!1}){q(this,Jg,!1);H(this,Jg,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!v(this,Jg)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Pr("Abstract method `_createCanvas` called.")}}Jg=new WeakMap;class e7 extends pL{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class mL{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Pr("Abstract method `_fetch` called.")}}class cR extends mL{async _fetch(e){const t=await Wp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):h0(t)}}class gL{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,n,s){return"none"}destroy(e=!1){}}var wd,Uf,ul,cl,ki,xd,_d,St,Ai,Xm,lf,lb,uf,vL,iE,cf,Km,Zm,sE,Qm;class t7 extends gL{constructor({docId:t,ownerDocument:r=globalThis.document}){super();q(this,St);q(this,wd);q(this,Uf);q(this,ul);q(this,cl);q(this,ki);q(this,xd);q(this,_d,0);H(this,cl,t),H(this,ki,r)}addFilter(t){if(!t)return"none";let r=v(this,St,Ai).get(t);if(r)return r;const[n,s,a]=X(this,St,lb).call(this,t),o=t.length===1?n:`${n}${s}${a}`;if(r=v(this,St,Ai).get(o),r)return v(this,St,Ai).set(t,r),r;const l=`g_${v(this,cl)}_transfer_map_${Bi(this,_d)._++}`,c=X(this,St,uf).call(this,l);v(this,St,Ai).set(t,c),v(this,St,Ai).set(o,c);const h=X(this,St,cf).call(this,l);return X(this,St,Zm).call(this,n,s,a,h),c}addHCMFilter(t,r){var x;const n=`${t}-${r}`,s="base";let a=v(this,St,Xm).get(s);if((a==null?void 0:a.key)===n||(a?((x=a.filter)==null||x.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},v(this,St,Xm).set(s,a)),!t||!r))return a.url;const o=X(this,St,Qm).call(this,t);t=jt.makeHexColor(...o);const l=X(this,St,Qm).call(this,r);if(r=jt.makeHexColor(...l),v(this,St,lf).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return a.url;const c=new Array(256);for(let g=0;g<=255;g++){const y=g/255;c[g]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const h=c.join(","),f=`g_${v(this,cl)}_hcm_filter`,m=a.filter=X(this,St,cf).call(this,f);X(this,St,Zm).call(this,h,h,h,m),X(this,St,iE).call(this,m);const p=(g,y)=>{const b=o[g]/255,_=l[g]/255,S=new Array(y+1);for(let k=0;k<=y;k++)S[k]=b+k/y*(_-b);return S.join(",")};return X(this,St,Zm).call(this,p(0,5),p(1,5),p(2,5),m),a.url=X(this,St,uf).call(this,f),a.url}addAlphaFilter(t){let r=v(this,St,Ai).get(t);if(r)return r;const[n]=X(this,St,lb).call(this,[t]),s=`alpha_${n}`;if(r=v(this,St,Ai).get(s),r)return v(this,St,Ai).set(t,r),r;const a=`g_${v(this,cl)}_alpha_map_${Bi(this,_d)._++}`,o=X(this,St,uf).call(this,a);v(this,St,Ai).set(t,o),v(this,St,Ai).set(s,o);const l=X(this,St,cf).call(this,a);return X(this,St,sE).call(this,n,l),o}addLuminosityFilter(t){let r=v(this,St,Ai).get(t||"luminosity");if(r)return r;let n,s;if(t?([n]=X(this,St,lb).call(this,[t]),s=`luminosity_${n}`):s="luminosity",r=v(this,St,Ai).get(s),r)return v(this,St,Ai).set(t,r),r;const a=`g_${v(this,cl)}_luminosity_map_${Bi(this,_d)._++}`,o=X(this,St,uf).call(this,a);v(this,St,Ai).set(t,o),v(this,St,Ai).set(s,o);const l=X(this,St,cf).call(this,a);return X(this,St,vL).call(this,l),t&&X(this,St,sE).call(this,n,l),o}addHighlightHCMFilter(t,r,n,s,a){var _;const o=`${r}-${n}-${s}-${a}`;let l=v(this,St,Xm).get(t);if((l==null?void 0:l.key)===o||(l?((_=l.filter)==null||_.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},v(this,St,Xm).set(t,l)),!r||!n))return l.url;const[c,h]=[r,n].map(X(this,St,Qm).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[p,x]=[s,a].map(X(this,St,Qm).bind(this));m<f&&([f,m,p,x]=[m,f,x,p]),v(this,St,lf).style.color="";const g=(S,k,C)=>{const R=new Array(256),N=(m-f)/C,O=S/255,I=(k-S)/(255*C);let F=0;for(let G=0;G<=C;G++){const B=Math.round(f+G*N),Y=O+G*I;for(let j=F;j<=B;j++)R[j]=Y;F=B+1}for(let G=F;G<256;G++)R[G]=R[F-1];return R.join(",")},y=`g_${v(this,cl)}_hcm_${t}_filter`,b=l.filter=X(this,St,cf).call(this,y);return X(this,St,iE).call(this,b),X(this,St,Zm).call(this,g(p[0],x[0],5),g(p[1],x[1],5),g(p[2],x[2],5),b),l.url=X(this,St,uf).call(this,y),l.url}destroy(t=!1){var r,n,s,a;t&&((r=v(this,xd))!=null&&r.size)||((n=v(this,ul))==null||n.parentNode.parentNode.remove(),H(this,ul,null),(s=v(this,Uf))==null||s.clear(),H(this,Uf,null),(a=v(this,xd))==null||a.clear(),H(this,xd,null),H(this,_d,0))}}wd=new WeakMap,Uf=new WeakMap,ul=new WeakMap,cl=new WeakMap,ki=new WeakMap,xd=new WeakMap,_d=new WeakMap,St=new WeakSet,Ai=function(){return v(this,Uf)||H(this,Uf,new Map)},Xm=function(){return v(this,xd)||H(this,xd,new Map)},lf=function(){if(!v(this,ul)){const t=v(this,ki).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const n=v(this,ki).createElementNS(Yo,"svg");n.setAttribute("width",0),n.setAttribute("height",0),H(this,ul,v(this,ki).createElementNS(Yo,"defs")),t.append(n),n.append(v(this,ul)),v(this,ki).body.append(t)}return v(this,ul)},lb=function(t){if(t.length===1){const c=t[0],h=new Array(256);for(let m=0;m<256;m++)h[m]=c[m]/255;const f=h.join(",");return[f,f,f]}const[r,n,s]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=r[c]/255,o[c]=n[c]/255,l[c]=s[c]/255;return[a.join(","),o.join(","),l.join(",")]},uf=function(t){if(v(this,wd)===void 0){H(this,wd,"");const r=v(this,ki).URL;r!==v(this,ki).baseURI&&(p0(r)?Qt('#createUrl: ignore "data:"-URL for performance reasons.'):H(this,wd,$S(r,"")))}return`url(${v(this,wd)}#${t})`},vL=function(t){const r=v(this,ki).createElementNS(Yo,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},iE=function(t){const r=v(this,ki).createElementNS(Yo,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},cf=function(t){const r=v(this,ki).createElementNS(Yo,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),v(this,St,lf).append(r),r},Km=function(t,r,n){const s=v(this,ki).createElementNS(Yo,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),t.append(s)},Zm=function(t,r,n,s){const a=v(this,ki).createElementNS(Yo,"feComponentTransfer");s.append(a),X(this,St,Km).call(this,a,"feFuncR",t),X(this,St,Km).call(this,a,"feFuncG",r),X(this,St,Km).call(this,a,"feFuncB",n)},sE=function(t,r){const n=v(this,ki).createElementNS(Yo,"feComponentTransfer");r.append(n),X(this,St,Km).call(this,n,"feFuncA",t)},Qm=function(t){return v(this,St,lf).style.color=t,WS(getComputedStyle(v(this,St,lf)).getPropertyValue("color"))};class yL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Pr("Abstract method `_fetch` called.")}}class dR extends yL{async _fetch(e){const t=await Wp(e,"arraybuffer");return new Uint8Array(t)}}class bL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Pr("Abstract method `_fetch` called.")}}class hR extends bL{async _fetch(e){const t=await Wp(e,"arraybuffer");return new Uint8Array(t)}}Vi&&Qt("Please use the `legacy` build in Node.js environments.");async function GS(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class r7 extends gL{}class n7 extends pL{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class i7 extends mL{async _fetch(e){return GS(e)}}class s7 extends yL{async _fetch(e){return GS(e)}}class a7 extends bL{async _fetch(e){return GS(e)}}const di={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function aE(i,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],n=new Path2D;n.rect(e[0],e[1],t,r),i.clip(n)}class qS{isModifyingCurrentTransform(){return!1}getPattern(){Pr("Abstract method `getPattern` called.")}}class o7 extends qS{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,n){let s;if(n===di.STROKE||n===di.FILL){const a=t.current.getClippedPathBoundingBox(n,cn(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),r=jt.transform(r,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),aE(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),s=e.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(r);s.setTransform(f)}else aE(e,this._bbox),s=this._createGradient(e);return s}}function qx(i,e,t,r,n,s,a,o){const l=e.coords,c=e.colors,h=i.data,f=i.width*4;let m;l[t+1]>l[r+1]&&(m=t,t=r,r=m,m=s,s=a,a=m),l[r+1]>l[n+1]&&(m=r,r=n,n=m,m=a,a=o,o=m),l[t+1]>l[r+1]&&(m=t,t=r,r=m,m=s,s=a,a=m);const p=(l[t]+e.offsetX)*e.scaleX,x=(l[t+1]+e.offsetY)*e.scaleY,g=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY,b=(l[n]+e.offsetX)*e.scaleX,_=(l[n+1]+e.offsetY)*e.scaleY;if(x>=_)return;const S=c[s],k=c[s+1],C=c[s+2],R=c[a],N=c[a+1],O=c[a+2],I=c[o],F=c[o+1],G=c[o+2],B=Math.round(x),Y=Math.round(_);let j,ae,he,ee,Z,ie,ge,V;for(let K=B;K<=Y;K++){if(K<y){const Ve=K<x?0:(x-K)/(x-y);j=p-(p-g)*Ve,ae=S-(S-R)*Ve,he=k-(k-N)*Ve,ee=C-(C-O)*Ve}else{let Ve;K>_?Ve=1:y===_?Ve=0:Ve=(y-K)/(y-_),j=g-(g-b)*Ve,ae=R-(R-I)*Ve,he=N-(N-F)*Ve,ee=O-(O-G)*Ve}let be;K<x?be=0:K>_?be=1:be=(x-K)/(x-_),Z=p-(p-b)*be,ie=S-(S-I)*be,ge=k-(k-F)*be,V=C-(C-G)*be;const Ae=Math.round(Math.min(j,Z)),ce=Math.round(Math.max(j,Z));let Pe=f*K+Ae*4;for(let Ve=Ae;Ve<=ce;Ve++)be=(j-Ve)/(j-Z),be<0?be=0:be>1&&(be=1),h[Pe++]=ae-(ae-ie)*be|0,h[Pe++]=he-(he-ge)*be|0,h[Pe++]=ee-(ee-V)*be|0,h[Pe++]=255}}function l7(i,e,t){const r=e.coords,n=e.colors;let s,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(r.length/o)-1,c=o-1;for(s=0;s<l;s++){let h=s*o;for(let f=0;f<c;f++,h++)qx(i,t,r[h],r[h+1],r[h+o],n[h],n[h+1],n[h+o]),qx(i,t,r[h+o+1],r[h+1],r[h+o],n[h+o+1],n[h+1],n[h+o])}break;case"triangles":for(s=0,a=r.length;s<a;s+=3)qx(i,t,r[s],r[s+1],r[s+2],n[s],n[s+1],n[s+2]);break;default:throw new Error("illegal figure")}}class u7 extends qS{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),p=c/f,x=h/m,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/x},y=f+2*2,b=m+2*2,_=r.getCanvas("mesh",y,b),S=_.context,k=S.createImageData(f,m);if(t){const R=k.data;for(let N=0,O=R.length;N<O;N+=4)R[N]=t[0],R[N+1]=t[1],R[N+2]=t[2],R[N+3]=255}for(const R of this._figures)l7(k,R,g);return S.putImageData(k,2,2),{canvas:_.canvas,offsetX:o-2*p,offsetY:l-2*x,scaleX:p,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,n){aE(e,this._bbox);const s=new Float32Array(2);if(n===di.SHADING)jt.singularValueDecompose2dScale(cn(e),s);else if(this.matrix){jt.singularValueDecompose2dScale(this.matrix,s);const[o,l]=s;jt.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=o,s[1]*=l}else jt.singularValueDecompose2dScale(t.baseTransform,s);const a=this._createMeshCanvas(s,n===di.SHADING?null:this._background,t.cachedCanvases);return n!==di.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class c7 extends qS{getPattern(){return"hotpink"}}function d7(i){switch(i[0]){case"RadialAxial":return new o7(i);case"Mesh":return new u7(i);case"Dummy":return new c7}throw new Error(`Unknown IR type: ${i[0]}`)}const fR={COLORED:1,UNCOLORED:2},ow=class ow{constructor(e,t,r,n){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=n}createPatternCanvas(e){const{bbox:t,operatorList:r,paintType:n,tilingType:s,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),jw("TilingType: "+s);const h=t[0],f=t[1],m=t[2],p=t[3],x=m-h,g=p-f,y=new Float32Array(2);jt.singularValueDecompose2dScale(this.matrix,y);const[b,_]=y;jt.singularValueDecompose2dScale(this.baseTransform,y);const S=b*y[0],k=_*y[1];let C=x,R=g,N=!1,O=!1;const I=Math.ceil(l*S),F=Math.ceil(c*k),G=Math.ceil(x*S),B=Math.ceil(g*k);I>=G?C=l:N=!0,F>=B?R=c:O=!0;const Y=this.getSizeAndScale(C,this.ctx.canvas.width,S),j=this.getSizeAndScale(R,this.ctx.canvas.height,k),ae=e.cachedCanvases.getCanvas("pattern",Y.size,j.size),he=ae.context,ee=o.createCanvasGraphics(he);if(ee.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ee,n,a),he.translate(-Y.scale*h,-j.scale*f),ee.transform(Y.scale,0,0,j.scale,0,0),he.save(),this.clipBbox(ee,h,f,m,p),ee.baseTransform=cn(ee.ctx),ee.executeOperatorList(r),ee.endDrawing(),he.restore(),N||O){const Z=ae.canvas;N&&(C=l),O&&(R=c);const ie=this.getSizeAndScale(C,this.ctx.canvas.width,S),ge=this.getSizeAndScale(R,this.ctx.canvas.height,k),V=ie.size,K=ge.size,be=e.cachedCanvases.getCanvas("pattern-workaround",V,K),Ae=be.context,ce=N?Math.floor(x/l):0,Pe=O?Math.floor(g/c):0;for(let Ve=0;Ve<=ce;Ve++)for(let $e=0;$e<=Pe;$e++)Ae.drawImage(Z,V*Ve,K*$e,V,K,0,0,V,K);return{canvas:be.canvas,scaleX:ie.scale,scaleY:ge.scale,offsetX:h,offsetY:f}}return{canvas:ae.canvas,scaleX:Y.scale,scaleY:j.scale,offsetX:h,offsetY:f}}getSizeAndScale(e,t,r){const n=Math.max(ow.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*r);return s>=n?s=n:r=s/e,{scale:r,size:s}}clipBbox(e,t,r,n,s){const a=n-t,o=s-r;e.ctx.rect(t,r,a,o),jt.axialAlignedBoundingBox([t,r,n,s],cn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const n=e.ctx,s=e.current;switch(t){case fR.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;n.fillStyle=s.fillColor=a,n.strokeStyle=s.strokeColor=o;break;case fR.UNCOLORED:n.fillStyle=n.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new Iz(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,n){let s=r;n!==di.SHADING&&(s=jt.transform(s,t.baseTransform),this.matrix&&(s=jt.transform(s,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(s);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};it(ow,"MAX_PATTERN_SIZE",3e3);let oE=ow;function h7({src:i,srcPos:e=0,dest:t,width:r,height:n,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=ei.isLittleEndian?4278190080:255,[l,c]=a?[s,o]:[o,s],h=r>>3,f=r&7,m=i.length;t=new Uint32Array(t.buffer);let p=0;for(let x=0;x<n;x++){for(const y=e+h;e<y;e++){const b=e<m?i[e]:255;t[p++]=b&128?c:l,t[p++]=b&64?c:l,t[p++]=b&32?c:l,t[p++]=b&16?c:l,t[p++]=b&8?c:l,t[p++]=b&4?c:l,t[p++]=b&2?c:l,t[p++]=b&1?c:l}if(f===0)continue;const g=e<m?i[e++]:255;for(let y=0;y<f;y++)t[p++]=g&1<<7-y?c:l}return{srcPos:e,destPos:p}}const pR=16,mR=100,f7=15,gR=10,ps=16,Yx=new DOMMatrix,js=new Float32Array(2),mf=new Float32Array([1/0,1/0,-1/0,-1/0]);function p7(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},i.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},i.transform=function(t,r,n,s,a,o){e.transform(t,r,n,s,a,o),this.__originalTransform(t,r,n,s,a,o)},i.setTransform=function(t,r,n,s,a,o){e.setTransform(t,r,n,s,a,o),this.__originalSetTransform(t,r,n,s,a,o)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},i.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},i.bezierCurveTo=function(t,r,n,s,a,o){e.bezierCurveTo(t,r,n,s,a,o),this.__originalBezierCurveTo(t,r,n,s,a,o)},i.rect=function(t,r,n,s){e.rect(t,r,n,s),this.__originalRect(t,r,n,s)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class m7{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let n;return this.cache[e]!==void 0?(n=this.cache[e],this.canvasFactory.reset(n,t,r)):(n=this.canvasFactory.create(t,r),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function By(i,e,t,r,n,s,a,o,l,c){const[h,f,m,p,x,g]=cn(i);if(f===0&&m===0){const _=a*h+x,S=Math.round(_),k=o*p+g,C=Math.round(k),R=(a+l)*h+x,N=Math.abs(Math.round(R)-S)||1,O=(o+c)*p+g,I=Math.abs(Math.round(O)-C)||1;return i.setTransform(Math.sign(h),0,0,Math.sign(p),S,C),i.drawImage(e,t,r,n,s,0,0,N,I),i.setTransform(h,f,m,p,x,g),[N,I]}if(h===0&&p===0){const _=o*m+x,S=Math.round(_),k=a*f+g,C=Math.round(k),R=(o+c)*m+x,N=Math.abs(Math.round(R)-S)||1,O=(a+l)*f+g,I=Math.abs(Math.round(O)-C)||1;return i.setTransform(0,Math.sign(f),Math.sign(m),0,S,C),i.drawImage(e,t,r,n,s,0,0,I,N),i.setTransform(h,f,m,p,x,g),[I,N]}i.drawImage(e,t,r,n,s,a,o,l,c);const y=Math.hypot(h,f),b=Math.hypot(m,p);return[y*l,b*c]}class vR{constructor(e,t){it(this,"alphaIsShape",!1);it(this,"fontSize",0);it(this,"fontSizeScale",1);it(this,"textMatrix",null);it(this,"textMatrixScale",1);it(this,"fontMatrix",j_);it(this,"leading",0);it(this,"x",0);it(this,"y",0);it(this,"lineX",0);it(this,"lineY",0);it(this,"charSpacing",0);it(this,"wordSpacing",0);it(this,"textHScale",1);it(this,"textRenderingMode",Si.FILL);it(this,"textRise",0);it(this,"fillColor","#000000");it(this,"strokeColor","#000000");it(this,"patternFill",!1);it(this,"patternStroke",!1);it(this,"fillAlpha",1);it(this,"strokeAlpha",1);it(this,"lineWidth",1);it(this,"activeSMask",null);it(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=mf.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=di.FILL,t=null){const r=this.minMax.slice();if(e===di.STROKE){t||Pr("Stroke bounding box must include transform."),jt.singularValueDecompose2dScale(t,js);const n=js[0]*this.lineWidth/2,s=js[1]*this.lineWidth/2;r[0]-=n,r[1]-=s,r[2]+=n,r[3]+=s}return r}updateClipFromPath(){const e=jt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(mf,0)}getClippedPathBoundingBox(e=di.FILL,t=null){return jt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function yR(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,r=e.width,n=t%ps,s=(t-n)/ps,a=n===0?s:s+1,o=i.createImageData(r,ps);let l=0,c;const h=e.data,f=o.data;let m,p,x,g;if(e.kind===hg.GRAYSCALE_1BPP){const y=h.byteLength,b=new Uint32Array(f.buffer,0,f.byteLength>>2),_=b.length,S=r+7>>3,k=4294967295,C=ei.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(x=m<s?ps:n,c=0,p=0;p<x;p++){const R=y-l;let N=0;const O=R>S?r:R*8-7,I=O&-8;let F=0,G=0;for(;N<I;N+=8)G=h[l++],b[c++]=G&128?k:C,b[c++]=G&64?k:C,b[c++]=G&32?k:C,b[c++]=G&16?k:C,b[c++]=G&8?k:C,b[c++]=G&4?k:C,b[c++]=G&2?k:C,b[c++]=G&1?k:C;for(;N<O;N++)F===0&&(G=h[l++],F=128),b[c++]=G&F?k:C,F>>=1}for(;c<_;)b[c++]=0;i.putImageData(o,0,m*ps)}}else if(e.kind===hg.RGBA_32BPP){for(p=0,g=r*ps*4,m=0;m<s;m++)f.set(h.subarray(l,l+g)),l+=g,i.putImageData(o,0,p),p+=ps;m<a&&(g=r*n*4,f.set(h.subarray(l,l+g)),i.putImageData(o,0,p))}else if(e.kind===hg.RGB_24BPP)for(x=ps,g=r*x,m=0;m<a;m++){for(m>=s&&(x=n,g=r*x),c=0,p=g;p--;)f[c++]=h[l++],f[c++]=h[l++],f[c++]=h[l++],f[c++]=255;i.putImageData(o,0,m*ps)}else throw new Error(`bad image kind: ${e.kind}`)}function bR(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,n=t%ps,s=(t-n)/ps,a=n===0?s:s+1,o=i.createImageData(r,ps);let l=0;const c=e.data,h=o.data;for(let f=0;f<a;f++){const m=f<s?ps:n;({srcPos:l}=h7({src:c,srcPos:l,dest:h,width:r,height:m,nonBlackColor:0})),i.putImageData(o,0,f*ps)}}function Pm(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)i[r]!==void 0&&(e[r]=i[r]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function zy(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function wR(i,e){if(e)return!0;jt.singularValueDecompose2dScale(i,js);const t=Math.fround(qa.pixelRatio*zl.PDF_TO_CSS_UNITS);return js[0]<=t&&js[1]<=t}const g7=["butt","round","square"],v7=["miter","round","bevel"],y7={},xR={};var Ya,lE,uE,cE;const cA=class cA{constructor(e,t,r,n,s,{optionalContentConfig:a,markedContentStack:o=null},l,c){q(this,Ya);this.ctx=e,this.current=new vR(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=n,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new m7(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:n=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,r){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...cn(this.compositeCtx))}this.ctx.save(),zy(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=cn(this.ctx)}executeOperatorList(e,t,r,n){const s=e.argsArray,a=e.fnArray;let o=t||0;const l=s.length;if(l===o)return o;const c=l-o>gR&&typeof r=="function",h=c?Date.now()+f7:0;let f=0;const m=this.commonObjs,p=this.objs;let x;for(;;){if(n!==void 0&&o===n.nextBreakPoint)return n.breakIt(o,r),o;if(x=a[o],x!==bg.dependency)this[x].apply(this,s[o]);else for(const g of s[o]){const y=g.startsWith("g_")?m:p;if(!y.has(g))return y.get(g,r),o}if(o++,o===l)return o;if(c&&++f>gR){if(Date.now()>h)return r(),o;f=0}}}endDrawing(){X(this,Ya,lE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),X(this,Ya,uE).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,n=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=r,l=n,c="prescale1",h,f;for(;s>2&&o>1||a>2&&l>1;){let m=o,p=l;s>2&&o>1&&(m=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/m),a>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/p),h=this.cachedCanvases.getCanvas(c,m,p),f=h.context,f.clearRect(0,0,m,p),f.drawImage(e,0,0,o,l,0,0,m,p),e=h.canvas,o=m,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:r,height:n}=e,s=this.current.fillColor,a=this.current.patternFill,o=cn(t);let l,c,h,f;if((e.bitmap||e.data)&&e.count>1){const I=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(I),l||(l=new Map,this._cachedBitmapsMap.set(I,l));const F=l.get(c);if(F&&!a){const G=Math.round(Math.min(o[0],o[2])+o[4]),B=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:F,offsetX:G,offsetY:B}}h=F}h||(f=this.cachedCanvases.getCanvas("maskCanvas",r,n),bR(f.context,e));let m=jt.transform(o,[1/r,0,0,-1/n,0,0]);m=jt.transform(m,[1,0,0,1,0,-n]);const p=mf.slice();jt.axialAlignedBoundingBox([0,0,r,n],m,p);const[x,g,y,b]=p,_=Math.round(y-x)||1,S=Math.round(b-g)||1,k=this.cachedCanvases.getCanvas("fillCanvas",_,S),C=k.context,R=x,N=g;C.translate(-R,-N),C.transform(...m),h||(h=this._scaleImage(f.canvas,io(C)),h=h.img,l&&a&&l.set(c,h)),C.imageSmoothingEnabled=wR(cn(C),e.interpolate),By(C,h,0,0,h.width,h.height,0,0,r,n),C.globalCompositeOperation="source-in";const O=jt.transform(io(C),[1,0,0,1,-R,-N]);return C.fillStyle=a?s.getPattern(t,this,O,di.FILL):s,C.fillRect(0,0,r,n),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,k.canvas)),{canvas:k.canvas,offsetX:Math.round(R),offsetY:Math.round(N)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=g7[e]}setLineJoin(e){this.ctx.lineJoin=v7[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(r,e,t);this.suspendedCtx=this.ctx;const s=this.ctx=n.context;s.setTransform(this.suspendedCtx.getTransform()),Pm(this.suspendedCtx,s),p7(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pm(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,n){const s=n[0],a=n[1],o=n[2]-s,l=n[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,r,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,n,s,a,o,l,c,h,f){let m=e.canvas,p=l-h,x=c-f;if(a)if(p<0||x<0||p+r>m.width||x+n>m.height){const y=this.cachedCanvases.getCanvas("maskExtension",r,n),b=y.context;b.drawImage(m,-p,-x),b.globalCompositeOperation="destination-atop",b.fillStyle=a,b.fillRect(0,0,r,n),b.globalCompositeOperation="source-over",m=y.canvas,p=x=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(p,x,r,n),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(p,x,r,n),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const g=new Path2D;g.rect(l,c,r,n),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(m,p,x,r,n,l,c,r,n),t.restore()}save(){this.inSMaskMode&&Pm(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Pm(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,n,s,a){this.ctx.transform(e,t,r,n,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r){let[n]=t;if(!r){n||(n=t[0]=new Path2D),this[e](n);return}if(!(n instanceof Path2D)){const s=t[0]=new Path2D;for(let a=0,o=n.length;a<o;)switch(n[a++]){case Fy.moveTo:s.moveTo(n[a++],n[a++]);break;case Fy.lineTo:s.lineTo(n[a++],n[a++]);break;case Fy.curveTo:s.bezierCurveTo(n[a++],n[a++],n[a++],n[a++],n[a++],n[a++]);break;case Fy.closePath:s.closePath();break;default:Qt(`Unrecognized drawing path operator: ${n[a-1]}`);break}n=s}jt.axialAlignedBoundingBox(r,cn(this.ctx),this.current.minMax),this[e](n)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const r=this.ctx,n=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof n=="object"&&(n!=null&&n.getPattern)){const s=n.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=n.getPattern(r,this,io(r),di.STROKE),s){const a=new Path2D;a.addPath(e,r.getTransform().invertSelf().multiplySelf(s)),e=a}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(di.STROKE,cn(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const r=this.ctx,n=this.current.fillColor,s=this.current.patternFill;let a=!1;if(s){const l=n.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.fillStyle=n.getPattern(r,this,io(r),di.FILL),l){const c=new Path2D;c.addPath(e,r.getTransform().invertSelf().multiplySelf(l)),e=c}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),a&&r.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=y7}eoClip(){this.pendingClip=xR}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const r=new Path2D,n=t.getTransform().invertSelf();for(const{transform:s,x:a,y:o,fontSize:l,path:c}of e)r.addPath(c,new DOMMatrix(s).preMultiplySelf(n).translate(a,o).scale(l,-l));t.clip(r),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const r=this.commonObjs.get(e),n=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(n.fontMatrix=r.fontMatrix||j_,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&Qt("Invalid font matrix for font "+e),t<0?(t=-t,n.fontDirection=-1):n.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;const s=r.loadedName||"sans-serif",a=((h=r.systemFontInfo)==null?void 0:h.css)||`"${s}", ${r.fallbackName}`;let o="normal";r.black?o="900":r.bold&&(o="bold");const l=r.italic?"italic":"normal";let c=t;t<pR?c=pR:t>mR&&(c=mR),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,r,n,s){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,f=c&Si.FILL_STROKE_MASK,m=!!(c&Si.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile,x=o.patternStroke&&!l.missingFile;let g;if((l.disableFontFace||m||p||x)&&(g=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p||x){a.save(),a.translate(t,r),a.scale(h,-h);let y;if((f===Si.FILL||f===Si.FILL_STROKE)&&(n?(y=a.getTransform(),a.setTransform(...n),a.fill(X(this,Ya,cE).call(this,g,y,n))):a.fill(g)),f===Si.STROKE||f===Si.FILL_STROKE)if(s){y||(y=a.getTransform()),a.setTransform(...s);const{a:b,b:_,c:S,d:k}=y,C=jt.inverseTransform(s),R=jt.transform([b,_,S,k,0,0],C);jt.singularValueDecompose2dScale(R,js),a.lineWidth*=Math.max(js[0],js[1])/h,a.stroke(X(this,Ya,cE).call(this,g,y,s))}else a.lineWidth/=h,a.stroke(g);a.restore()}else(f===Si.FILL||f===Si.FILL_STROKE)&&a.fillText(e,t,r),(f===Si.STROKE||f===Si.FILL_STROKE)&&a.strokeText(e,t,r);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:cn(a),x:t,y:r,fontSize:h,path:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){r=!0;break}return ur(this,"isFontSubpixelAAEnabled",r)}showText(e){const t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);const n=t.fontSize;if(n===0)return;const s=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,f=e.length,m=r.vertical,p=m?1:-1,x=r.defaultVMetrics,g=n*t.fontMatrix[0],y=t.textRenderingMode===Si.FILL&&!r.disableFontFace&&!t.patternFill;s.save(),t.textMatrix&&s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),c>0?s.scale(h,-1):s.scale(h,1);let b,_;if(t.patternFill){s.save();const N=t.fillColor.getPattern(s,this,io(s),di.FILL);b=cn(s),s.restore(),s.fillStyle=N}if(t.patternStroke){s.save();const N=t.strokeColor.getPattern(s,this,io(s),di.STROKE);_=cn(s),s.restore(),s.strokeStyle=N}let S=t.lineWidth;const k=t.textMatrixScale;if(k===0||S===0){const N=t.textRenderingMode&Si.FILL_STROKE_MASK;(N===Si.STROKE||N===Si.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=k;if(a!==1&&(s.scale(a,a),S/=a),s.lineWidth=S,r.isInvalidPDFjsFont){const N=[];let O=0;for(const I of e)N.push(I.unicode),O+=I.width;s.fillText(N.join(""),0,0),t.x+=O*g*h,s.restore(),this.compose();return}let C=0,R;for(R=0;R<f;++R){const N=e[R];if(typeof N=="number"){C+=p*N*n/1e3;continue}let O=!1;const I=(N.isSpace?l:0)+o,F=N.fontChar,G=N.accent;let B,Y,j=N.width;if(m){const he=N.vmetric||x,ee=-(N.vmetric?he[1]:j*.5)*g,Z=he[2]*g;j=he?-he[0]:j,B=ee/a,Y=(C+Z)/a}else B=C/a,Y=0;if(r.remeasure&&j>0){const he=s.measureText(F).width*1e3/n*a;if(j<he&&this.isFontSubpixelAAEnabled){const ee=j/he;O=!0,s.save(),s.scale(ee,1),B/=ee}else j!==he&&(B+=(j-he)/2e3*n/a)}if(this.contentVisible&&(N.isInFont||r.missingFile)){if(y&&!G)s.fillText(F,B,Y);else if(this.paintChar(F,B,Y,b,_),G){const he=B+n*G.offset.x/a,ee=Y-n*G.offset.y/a;this.paintChar(G.fontChar,he,ee,b,_)}}const ae=m?j*g-I*c:j*g+I*c;C+=ae,O&&s.restore()}m?t.y-=C:t.x+=C*h,s.restore(),this.compose()}showType3Text(e){const t=this.ctx,r=this.current,n=r.font,s=r.fontSize,a=r.fontDirection,o=n.vertical?1:-1,l=r.charSpacing,c=r.wordSpacing,h=r.textHScale*a,f=r.fontMatrix||j_,m=e.length,p=r.textRenderingMode===Si.INVISIBLE;let x,g,y,b;if(!(p||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),r.textMatrix&&t.transform(...r.textMatrix),t.translate(r.x,r.y+r.textRise),t.scale(h,a),x=0;x<m;++x){if(g=e[x],typeof g=="number"){b=o*g*s/1e3,this.ctx.translate(b,0),r.x+=b*h;continue}const _=(g.isSpace?c:0)+l,S=n.charProcOperatorList[g.operatorListId];S?this.contentVisible&&(this.save(),t.scale(s,s),t.transform(...f),this.executeOperatorList(S),this.restore()):Qt(`Type3 character "${g.operatorListId}" is not available.`);const k=[g.width,0];jt.applyTransform(k,f),y=k[0]*s+_,t.translate(y,0),r.x+=y*h}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,r,n,s,a){const o=new Path2D;o.rect(r,n,s-r,a-n),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const r=this.baseTransform||cn(this.ctx),n={createCanvasGraphics:s=>new cA(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new oE(e,this.ctx,n,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=d7(this.getObject(e)),this.cachedPatterns.set(e,r)),t&&(r.matrix=t),r}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const r=this._getPattern(e);t.fillStyle=r.getPattern(t,this,io(t),di.SHADING);const n=io(t);if(n){const{width:s,height:a}=t.canvas,o=mf.slice();jt.axialAlignedBoundingBox([0,0,s,a],n,o);const[l,c,h,f]=o;this.ctx.fillRect(l,c,h-l,f-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Pr("Should not call beginInlineImage")}beginImageData(){Pr("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=cn(this.ctx),t)){jt.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[r,n,s,a]=t,o=new Path2D;o.rect(r,n,s-r,a-n),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||jw("TODO: Support non-isolated groups."),e.knockout&&Qt("Knockout groups not supported.");const r=cn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let n=mf.slice();jt.axialAlignedBoundingBox(e.bbox,cn(t),n);const s=[0,0,t.canvas.width,t.canvas.height];n=jt.intersect(n,s)||[0,0,0,0];const a=Math.floor(n[0]),o=Math.floor(n[1]),l=Math.max(Math.ceil(n[2])-a,1),c=Math.max(Math.ceil(n[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,l,c),m=f.context;m.translate(-a,-o),m.transform(...r);let p=new Path2D;const[x,g,y,b]=e.bbox;if(p.rect(x,g,y-x,b-g),e.matrix){const _=new Path2D;_.addPath(p,new DOMMatrix(e.matrix)),p=_}m.clip(p),e.smask?this.smaskStack.push({canvas:f.canvas,context:m,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Pm(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=cn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const s=mf.slice();jt.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],n,s),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,r,n,s){if(X(this,Ya,lE).call(this),zy(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=t[0],r[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o,jt.singularValueDecompose2dScale(cn(this.ctx),js);const{viewportScale:l}=this,c=Math.ceil(a*this.outputScaleX*l),h=Math.ceil(o*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:f,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(js[0],0,0,-js[1],0,o*js[1]),zy(this.ctx)}else{zy(this.ctx),this.endPath();const l=new Path2D;l.rect(t[0],t[1],a,o),this.ctx.clip(l)}}this.current=new vR(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),X(this,Ya,uE).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const r=this.ctx,n=this._createMaskCanvas(e),s=n.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(s,n.offsetX,n.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r=0,n=0,s,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=cn(o);o.transform(t,r,n,s,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,f=a.length;h<f;h+=2){const m=jt.transform(l,[t,r,n,s,a[h],a[h+1]]);o.drawImage(c.canvas,m[4],m[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,r=this.current.fillColor,n=this.current.patternFill;for(const s of e){const{data:a,width:o,height:l,transform:c}=s,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=h.context;f.save();const m=this.getObject(a,s);bR(f,m),f.globalCompositeOperation="source-in",f.fillStyle=n?r.getPattern(f,this,io(t),di.FILL):r,f.fillRect(0,0,o,l),f.restore(),t.save(),t.transform(...c),t.scale(1,-1),By(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Qt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,r,n){if(!this.contentVisible)return;const s=this.getObject(e);if(!s){Qt("Dependent image isn't ready yet");return}const a=s.width,o=s.height,l=[];for(let c=0,h=n.length;c<h;c+=2)l.push({transform:[t,0,0,r,n[c],n[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:n}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,n),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,r=e.height,n=this.ctx;this.save();const{filter:s}=n;s!=="none"&&s!==""&&(n.filter="none"),n.scale(1/t,-1/r);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,r).context;yR(c,e),a=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(a,io(n));n.imageSmoothingEnabled=wR(cn(n),e.interpolate),By(n,o.img,0,0,o.paintWidth,o.paintHeight,0,-r,t,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const r=this.ctx;let n;if(e.bitmap)n=e.bitmap;else{const s=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;yR(l,e),n=this.applyTransferMapsToCanvas(l)}for(const s of t)r.save(),r.transform(...s.transform),r.scale(1,-1),By(r,n,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(r||(this.pendingClip===xR?n.clip(e,"evenodd"):n.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=cn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:n,d:s}=this.ctx.getTransform();let a,o;if(r===0&&n===0){const l=Math.abs(t),c=Math.abs(s);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,f=c*e;a=h<1?1/h:1,o=f<1?1/f:1}}else{const l=Math.abs(t*s-r*n),c=Math.hypot(t,r),h=Math.hypot(n,s);if(e===0)a=h/l,o=c/l;else{const f=e*l;a=h>f?h/f:1,o=c>f?c/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:n}}=this,[s,a]=this.getScaleForStroking();if(s===a){r.lineWidth=(n||1)*s,r.stroke(e);return}const o=r.getLineDash();t&&r.save(),r.scale(s,a),Yx.a=1/s,Yx.d=1/a;const l=new Path2D;if(l.addPath(e,Yx),o.length>0){const c=Math.max(s,a);r.setLineDash(o.map(h=>h/c)),r.lineDashOffset/=c}r.lineWidth=n||1,r.stroke(l),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ya=new WeakSet,lE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},uE=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},cE=function(e,t,r){const n=new Path2D;return n.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),n};let _f=cA;for(const i in bg)_f.prototype[i]!==void 0&&(_f.prototype[bg[i]]=_f.prototype[i]);var ev,tv;class ua{static get workerPort(){return v(this,ev)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");H(this,ev,e)}static get workerSrc(){return v(this,tv)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");H(this,tv,e)}}ev=new WeakMap,tv=new WeakMap,q(ua,ev,null),q(ua,tv,"");var Hf,rv;class b7{constructor({parsedData:e,rawData:t}){q(this,Hf);q(this,rv);H(this,Hf,e),H(this,rv,t)}getRaw(){return v(this,rv)}get(e){return v(this,Hf).get(e)??null}[Symbol.iterator](){return v(this,Hf).entries()}}Hf=new WeakMap,rv=new WeakMap;const df=Symbol("INTERNAL");var nv,iv,sv,Wf;class w7{constructor(e,{name:t,intent:r,usage:n,rbGroups:s}){q(this,nv,!1);q(this,iv,!1);q(this,sv,!1);q(this,Wf,!0);H(this,nv,!!(e&Ms.DISPLAY)),H(this,iv,!!(e&Ms.PRINT)),this.name=t,this.intent=r,this.usage=n,this.rbGroups=s}get visible(){if(v(this,sv))return v(this,Wf);if(!v(this,Wf))return!1;const{print:e,view:t}=this.usage;return v(this,nv)?(t==null?void 0:t.viewState)!=="OFF":v(this,iv)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==df&&Pr("Internal method `_setVisible` called."),H(this,sv,r),H(this,Wf,t)}}nv=new WeakMap,iv=new WeakMap,sv=new WeakMap,Wf=new WeakMap;var Ru,Dr,Vf,Gf,av,dE;class x7{constructor(e,t=Ms.DISPLAY){q(this,av);q(this,Ru,null);q(this,Dr,new Map);q(this,Vf,null);q(this,Gf,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,H(this,Gf,e.order);for(const r of e.groups)v(this,Dr).set(r.id,new w7(t,r));if(e.baseState==="OFF")for(const r of v(this,Dr).values())r._setVisible(df,!1);for(const r of e.on)v(this,Dr).get(r)._setVisible(df,!0);for(const r of e.off)v(this,Dr).get(r)._setVisible(df,!1);H(this,Vf,this.getHash())}}isVisible(e){if(v(this,Dr).size===0)return!0;if(!e)return jw("Optional content group not defined."),!0;if(e.type==="OCG")return v(this,Dr).has(e.id)?v(this,Dr).get(e.id).visible:(Qt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return X(this,av,dE).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!v(this,Dr).has(t))return Qt(`Optional content group not found: ${t}`),!0;if(v(this,Dr).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!v(this,Dr).has(t))return Qt(`Optional content group not found: ${t}`),!0;if(!v(this,Dr).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!v(this,Dr).has(t))return Qt(`Optional content group not found: ${t}`),!0;if(!v(this,Dr).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!v(this,Dr).has(t))return Qt(`Optional content group not found: ${t}`),!0;if(v(this,Dr).get(t).visible)return!1}return!0}return Qt(`Unknown optional content policy ${e.policy}.`),!0}return Qt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var s;const n=v(this,Dr).get(e);if(!n){Qt(`Optional content group not found: ${e}`);return}if(r&&t&&n.rbGroups.length)for(const a of n.rbGroups)for(const o of a)o!==e&&((s=v(this,Dr).get(o))==null||s._setVisible(df,!1,!0));n._setVisible(df,!!t,!0),H(this,Ru,null)}setOCGState({state:e,preserveRB:t}){let r;for(const n of e){switch(n){case"ON":case"OFF":case"Toggle":r=n;continue}const s=v(this,Dr).get(n);if(s)switch(r){case"ON":this.setVisibility(n,!0,t);break;case"OFF":this.setVisibility(n,!1,t);break;case"Toggle":this.setVisibility(n,!s.visible,t);break}}H(this,Ru,null)}get hasInitialVisibility(){return v(this,Vf)===null||this.getHash()===v(this,Vf)}getOrder(){return v(this,Dr).size?v(this,Gf)?v(this,Gf).slice():[...v(this,Dr).keys()]:null}getGroup(e){return v(this,Dr).get(e)||null}getHash(){if(v(this,Ru)!==null)return v(this,Ru);const e=new oL;for(const[t,r]of v(this,Dr))e.update(`${t}:${r.visible}`);return H(this,Ru,e.hexdigest())}[Symbol.iterator](){return v(this,Dr).entries()}}Ru=new WeakMap,Dr=new WeakMap,Vf=new WeakMap,Gf=new WeakMap,av=new WeakSet,dE=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let n=1;n<t;n++){const s=e[n];let a;if(Array.isArray(s))a=X(this,av,dE).call(this,s);else if(v(this,Dr).has(s))a=v(this,Dr).get(s).visible;else return Qt(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"};class _7{constructor(e,{disableRange:t=!1,disableStream:r=!1}){Nn(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const n=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});Nn(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,n,s;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(s=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||s.call(n,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Nn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new E7(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new S7(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class E7{constructor(e,t,r=!1,n=null){this._stream=e,this._done=r||!1,this._filename=zw(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class S7{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function A7(i){let e=!0,t=r("filename\\*","i").exec(i);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),s(h)}if(t=a(i),t){const h=c(t);return s(h)}if(t=r("filename","i").exec(i),t){t=t[1];let h=o(t);return h=c(h),s(h)}function r(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function n(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const m=new TextDecoder(h,{fatal:!0}),p=h0(f);f=m.decode(p),e=!1}catch{}}return f}function s(h){return e&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),e&&(h=n("iso-8859-1",h))),h}function a(h){const f=[];let m;const p=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=p.exec(h))!==null;){let[,g,y,b]=m;if(g=parseInt(g,10),g in f){if(g===0)break;continue}f[g]=[y,b]}const x=[];for(let g=0;g<f.length&&g in f;++g){let[y,b]=f[g];b=o(b),y&&(b=unescape(b),g===0&&(b=l(b))),x.push(b)}return x.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let m=0;m<f.length;++m){const p=f[m].indexOf('"');p!==-1&&(f[m]=f[m].slice(0,p),f.length=m+1),f[m]=f[m].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function l(h){const f=h.indexOf("'");if(f===-1)return h;const m=h.slice(0,f),x=h.slice(f+1).replace(/^[^']*'/,"");return n(m,x)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,m,p,x){if(p==="q"||p==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,y){return String.fromCharCode(parseInt(y,16))}),n(m,x);try{x=atob(x)}catch{}return n(m,x)})}return""}function wL(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const r in e){const n=e[r];n!==void 0&&t.append(r,n)}return t}function Uw(i){var e;return((e=URL.parse(i))==null?void 0:e.origin)??null}function xL({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:r}){const n={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(i.get("Content-Length"),10);return!Number.isInteger(s)||(n.suggestedLength=s,s<=2*t)||r||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function _L(i){const e=i.get("Content-Disposition");if(e){let t=A7(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(zw(t))return t}return null}function g0(i,e){return new wg(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function EL(i){return i===200||i===206}function SL(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function AL(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Qt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class C7{constructor(e){it(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=wL(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Nn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new k7(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new T7(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class k7{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),n=t.url;fetch(n,SL(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=Uw(s.url),!EL(s.status))throw g0(s.status,n);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=xL({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=_L(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Bl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:AL(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class T7{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);const a=n.url;fetch(a,SL(s,this._withCredentials,this._abortController)).then(o=>{const l=Uw(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!EL(o.status))throw g0(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:AL(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Xx=200,Kx=206;function R7(i){const e=i.response;return typeof e!="string"?e:h0(e).buffer}class N7{constructor({url:e,httpHeaders:t,withCredentials:r}){it(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=wL(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,n=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=Kx):n.expectedStatus=Xx,t.responseType="arraybuffer",Nn(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var n;const r=this.pendingRequests[e];r&&((n=r.onProgress)==null||n.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const n=r.xhr;if(n.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),n.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],n.status===0&&this.isHttp){r.onError(n.status);return}const s=n.status||Xx;if(!(s===Xx&&r.expectedStatus===Kx)&&s!==r.expectedStatus){r.onError(n.status);return}const o=R7(n);if(s===Kx){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?r.onDone({begin:parseInt(c[1],10),chunk:o}):(Qt('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone({begin:0,chunk:o}):r.onError(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class D7{constructor(e){this._source=e,this._manager=new N7(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Nn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new L7(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new P7(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class L7{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Uw(t.responseURL);const r=t.getAllResponseHeaders(),n=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=xL({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=_L(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=g0(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class P7{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Uw((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=g0(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const O7=/^[a-z][a-z0-9\-+.]+:/i;function I7(i){if(O7.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class F7{constructor(e){this.source=e,this.url=I7(e.url),Nn(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Nn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new M7(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new j7(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class M7{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=g0(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Bl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class j7{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Om=Symbol("INITIAL_DATA");var ks,ov,hE;class CL{constructor(){q(this,ov);q(this,ks,Object.create(null))}get(e,t=null){if(t){const n=X(this,ov,hE).call(this,e);return n.promise.then(()=>t(n.data)),null}const r=v(this,ks)[e];if(!r||r.data===Om)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=v(this,ks)[e];return!!t&&t.data!==Om}delete(e){const t=v(this,ks)[e];return!t||t.data===Om?!1:(delete v(this,ks)[e],!0)}resolve(e,t=null){const r=X(this,ov,hE).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in v(this,ks)){const{data:r}=v(this,ks)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}H(this,ks,Object.create(null))}*[Symbol.iterator](){for(const e in v(this,ks)){const{data:t}=v(this,ks)[e];t!==Om&&(yield[e,t])}}}ks=new WeakMap,ov=new WeakSet,hE=function(e){var t;return(t=v(this,ks))[e]||(t[e]={...Promise.withResolvers(),data:Om})};const B7=1e5,_R=30;var hN,Nu,hs,lv,uv,Ed,dl,cv,dv,Sd,qf,Yf,Du,Xf,hv,Kf,Ad,fv,pv,mn,Zf,Cd,mv,Lu,Qf,$l,kL,TL,fE,$s,ub,pE,RL,NL;let _g=(mn=class{constructor({textContentSource:e,container:t,viewport:r}){q(this,$l);q(this,Nu,Promise.withResolvers());q(this,hs,null);q(this,lv,!1);q(this,uv,!!((hN=globalThis.FontInspector)!=null&&hN.enabled));q(this,Ed,null);q(this,dl,null);q(this,cv,0);q(this,dv,0);q(this,Sd,null);q(this,qf,null);q(this,Yf,0);q(this,Du,0);q(this,Xf,Object.create(null));q(this,hv,[]);q(this,Kf,null);q(this,Ad,[]);q(this,fv,new WeakMap);q(this,pv,null);var l;if(e instanceof ReadableStream)H(this,Kf,e);else if(typeof e=="object")H(this,Kf,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');H(this,hs,H(this,qf,t)),H(this,Du,r.scale*qa.pixelRatio),H(this,Yf,r.rotation),H(this,dl,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:s,pageX:a,pageY:o}=r.rawDims;H(this,pv,[1,0,0,-1,-a,o+s]),H(this,dv,n),H(this,cv,s),X(l=mn,$s,RL).call(l),nc(t,r),v(this,Nu).promise.finally(()=>{v(mn,Qf).delete(this),H(this,dl,null),H(this,Xf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=ei.platform;return ur(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{v(this,Sd).read().then(({value:t,done:r})=>{if(r){v(this,Nu).resolve();return}v(this,Ed)??H(this,Ed,t.lang),Object.assign(v(this,Xf),t.styles),X(this,$l,kL).call(this,t.items),e()},v(this,Nu).reject)};return H(this,Sd,v(this,Kf).getReader()),v(mn,Qf).add(this),e(),v(this,Nu).promise}update({viewport:e,onBefore:t=null}){var s;const r=e.scale*qa.pixelRatio,n=e.rotation;if(n!==v(this,Yf)&&(t==null||t(),H(this,Yf,n),nc(v(this,qf),{rotation:n})),r!==v(this,Du)){t==null||t(),H(this,Du,r);const a={div:null,properties:null,ctx:X(s=mn,$s,ub).call(s,v(this,Ed))};for(const o of v(this,Ad))a.properties=v(this,fv).get(o),a.div=o,X(this,$l,fE).call(this,a)}}cancel(){var t;const e=new Bl("TextLayer task cancelled.");(t=v(this,Sd))==null||t.cancel(e).catch(()=>{}),H(this,Sd,null),v(this,Nu).reject(e)}get textDivs(){return v(this,Ad)}get textContentItemsStr(){return v(this,hv)}static cleanup(){if(!(v(this,Qf).size>0)){v(this,Zf).clear();for(const{canvas:e}of v(this,Cd).values())e.remove();v(this,Cd).clear()}}},Nu=new WeakMap,hs=new WeakMap,lv=new WeakMap,uv=new WeakMap,Ed=new WeakMap,dl=new WeakMap,cv=new WeakMap,dv=new WeakMap,Sd=new WeakMap,qf=new WeakMap,Yf=new WeakMap,Du=new WeakMap,Xf=new WeakMap,hv=new WeakMap,Kf=new WeakMap,Ad=new WeakMap,fv=new WeakMap,pv=new WeakMap,Zf=new WeakMap,Cd=new WeakMap,mv=new WeakMap,Lu=new WeakMap,Qf=new WeakMap,$l=new WeakSet,kL=function(e){var n,s;if(v(this,lv))return;(s=v(this,dl)).ctx??(s.ctx=X(n=mn,$s,ub).call(n,v(this,Ed)));const t=v(this,Ad),r=v(this,hv);for(const a of e){if(t.length>B7){Qt("Ignoring additional textDivs for performance reasons."),H(this,lv,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=v(this,hs);H(this,hs,document.createElement("span")),v(this,hs).classList.add("markedContent"),a.id!==null&&v(this,hs).setAttribute("id",`${a.id}`),o.append(v(this,hs))}else a.type==="endMarkedContent"&&H(this,hs,v(this,hs).parentNode);continue}r.push(a.str),X(this,$l,TL).call(this,a)}},TL=function(e){var g;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};v(this,Ad).push(t);const n=jt.transform(v(this,pv),e.transform);let s=Math.atan2(n[1],n[0]);const a=v(this,Xf)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=v(this,uv)&&a.fontSubstitution||a.fontFamily;o=mn.fontFamilyMap.get(o)||o;const l=Math.hypot(n[2],n[3]),c=l*X(g=mn,$s,NL).call(g,o,a,v(this,Ed));let h,f;s===0?(h=n[4],f=n[5]-c):(h=n[4]+c*Math.sin(s),f=n[5]-c*Math.cos(s));const m="calc(var(--total-scale-factor) *",p=t.style;v(this,hs)===v(this,qf)?(p.left=`${(100*h/v(this,dv)).toFixed(2)}%`,p.top=`${(100*f/v(this,cv)).toFixed(2)}%`):(p.left=`${m}${h.toFixed(2)}px)`,p.top=`${m}${f.toFixed(2)}px)`),p.fontSize=`${m}${(v(mn,Lu)*l).toFixed(2)}px)`,p.fontFamily=o,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,v(this,uv)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let x=!1;if(e.str.length>1)x=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),b=Math.abs(e.transform[3]);y!==b&&Math.max(y,b)/Math.min(y,b)>1.5&&(x=!0)}if(x&&(r.canvasWidth=a.vertical?e.height:e.width),v(this,fv).set(t,r),v(this,dl).div=t,v(this,dl).properties=r,X(this,$l,fE).call(this,v(this,dl)),r.hasText&&v(this,hs).append(t),r.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),v(this,hs).append(y)}},fE=function(e){var o;const{div:t,properties:r,ctx:n}=e,{style:s}=t;let a="";if(v(mn,Lu)>1&&(a=`scale(${1/v(mn,Lu)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:c,fontSize:h}=r;X(o=mn,$s,pE).call(o,n,h*v(this,Du),l);const{width:f}=n.measureText(t.textContent);f>0&&(a=`scaleX(${c*v(this,Du)/f}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)},$s=new WeakSet,ub=function(e=null){let t=v(this,Cd).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),v(this,Cd).set(e,t),v(this,mv).set(t,{size:0,family:""})}return t},pE=function(e,t,r){const n=v(this,mv).get(e);t===n.size&&r===n.family||(e.font=`${t}px ${r}`,n.size=t,n.family=r)},RL=function(){if(v(this,Lu)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),H(this,Lu,e.getBoundingClientRect().height),e.remove()},NL=function(e,t,r){const n=v(this,Zf).get(e);if(n)return n;const s=X(this,$s,ub).call(this,r);s.canvas.width=s.canvas.height=_R,X(this,$s,pE).call(this,s,_R,e);const a=s.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let c=.8;return o?c=o/(o+l):(ei.platform.isFirefox&&Qt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),v(this,Zf).set(e,c),c},q(mn,$s),q(mn,Zf,new Map),q(mn,Cd,new Map),q(mn,mv,new WeakMap),q(mn,Lu,null),q(mn,Qf,new Set),mn);class Eg{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function n(s){var l;if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(Eg.shouldBuildText(o))(l=s==null?void 0:s.attributes)!=null&&l.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const c of s.children)n(c)}return n(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const z7=100;function YS(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new mE,{docId:t}=e,r=i.url?Kz(i.url):null,n=i.data?Zz(i.data):null,s=i.httpHeaders||null,a=i.withCredentials===!0,o=i.password??null,l=i.range instanceof XS?i.range:null,c=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let h=i.worker instanceof Ip?i.worker:null;const f=i.verbosity,m=typeof i.docBaseUrl=="string"&&!p0(i.docBaseUrl)?i.docBaseUrl:null,p=My(i.cMapUrl),x=i.cMapPacked!==!1,g=i.CMapReaderFactory||(Vi?i7:cR),y=My(i.iccUrl),b=My(i.standardFontDataUrl),_=i.StandardFontDataFactory||(Vi?s7:dR),S=My(i.wasmUrl),k=i.WasmFactory||(Vi?a7:hR),C=i.stopAtErrors!==!0,R=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,N=i.isEvalSupported!==!1,O=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Vi,I=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Vi&&(ei.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,G=typeof i.disableFontFace=="boolean"?i.disableFontFace:Vi,B=i.fontExtraProperties===!0,Y=i.enableXfa===!0,j=i.ownerDocument||globalThis.document,ae=i.disableRange===!0,he=i.disableStream===!0,ee=i.disableAutoFetch===!0,Z=i.pdfBug===!0,ie=i.CanvasFactory||(Vi?n7:e7),ge=i.FilterFactory||(Vi?r7:t7),V=i.enableHWA===!0,K=i.useWasm!==!1,be=l?l.length:i.length??NaN,Ae=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Vi&&!G,ce=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(g===cR&&_===dR&&k===hR&&p&&b&&S&&Hm(p,document.baseURI)&&Hm(b,document.baseURI)&&Hm(S,document.baseURI)),Pe=null;Lz(f);const Ve={canvasFactory:new ie({ownerDocument:j,enableHWA:V}),filterFactory:new ge({docId:t,ownerDocument:j}),cMapReaderFactory:ce?null:new g({baseUrl:p,isCompressed:x}),standardFontDataFactory:ce?null:new _({baseUrl:b}),wasmFactory:ce?null:new k({baseUrl:S})};h||(h=Ip.create({verbosity:f,port:ua.workerPort}),e._worker=h);const $e={docId:t,apiVersion:"5.3.31",data:n,password:o,disableAutoFetch:ee,rangeChunkSize:c,length:be,docBaseUrl:m,enableXfa:Y,evaluatorOptions:{maxImageSize:R,disableFontFace:G,ignoreErrors:C,isEvalSupported:N,isOffscreenCanvasSupported:O,isImageDecoderSupported:I,canvasMaxAreaInBytes:F,fontExtraProperties:B,useSystemFonts:Ae,useWasm:K,useWorkerFetch:ce,cMapUrl:p,iccUrl:y,standardFontDataUrl:b,wasmUrl:S}},qe={ownerDocument:j,pdfBug:Z,styleElement:Pe,loadingParams:{disableAutoFetch:ee,enableXfa:Y}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ze=h.messageHandler.sendWithPromise("GetDocRequest",$e,n?[n.buffer]:null);let at;if(l)at=new _7(l,{disableRange:ae,disableStream:he});else if(!n){if(!r)throw new Error("getDocument - no `url` parameter provided.");const gt=Hm(r)?C7:Vi?F7:D7;at=new gt({url:r,length:be,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:ae,disableStream:he})}return Ze.then(gt=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ut=new Ym(t,gt,h.port),z=new H7(ut,e,at,qe,Ve);e._transport=z,ut.send("Ready",null)})}).catch(e._capability.reject),e}var lw;const uw=class uw{constructor(){it(this,"_capability",Promise.withResolvers());it(this,"_transport",null);it(this,"_worker",null);it(this,"docId",`d${Bi(uw,lw)._++}`);it(this,"destroyed",!1);it(this,"onPassword",null);it(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,r,n;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(n=this._worker)==null||n.destroy(),this._worker=null}async getData(){return this._transport.getData()}};lw=new WeakMap,q(uw,lw,0);let mE=uw;var kd,gv,vv,yv,bv,fN;let XS=(fN=class{constructor(e,t,r=!1,n=null){q(this,kd,Promise.withResolvers());q(this,gv,[]);q(this,vv,[]);q(this,yv,[]);q(this,bv,[]);this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=n}addRangeListener(e){v(this,bv).push(e)}addProgressListener(e){v(this,yv).push(e)}addProgressiveReadListener(e){v(this,vv).push(e)}addProgressiveDoneListener(e){v(this,gv).push(e)}onDataRange(e,t){for(const r of v(this,bv))r(e,t)}onDataProgress(e,t){v(this,kd).promise.then(()=>{for(const r of v(this,yv))r(e,t)})}onDataProgressiveRead(e){v(this,kd).promise.then(()=>{for(const t of v(this,vv))t(e)})}onDataProgressiveDone(){v(this,kd).promise.then(()=>{for(const e of v(this,gv))e()})}transportReady(){v(this,kd).resolve()}requestDataRange(e,t){Pr("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},kd=new WeakMap,gv=new WeakMap,vv=new WeakMap,yv=new WeakMap,bv=new WeakMap,fN);class $7{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ur(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var hl,Td,Jm;class U7{constructor(e,t,r,n=!1){q(this,Td);q(this,hl,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=n?new oR:null,this._pdfBug=n,this.commonObjs=r.commonObjs,this.objs=new CL,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:n=0,dontFlip:s=!1}={}){return new f0({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:n,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ur(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:r="display",annotationMode:n=Ao.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:f=!1}){var k,C;(k=this._stats)==null||k.time("Overall");const m=this._transport.getRenderingIntent(r,n,h,f),{renderingIntent:p,cacheKey:x}=m;H(this,hl,!1),o||(o=this._transport.getOptionalContentConfig(p));let g=this._intentStates.get(x);g||(g=Object.create(null),this._intentStates.set(x,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const y=!!(p&Ms.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(m));const b=R=>{var N;g.renderTasks.delete(_),y&&H(this,hl,!0),X(this,Td,Jm).call(this),R?(_.capability.reject(R),this._abortOperatorList({intentState:g,reason:R instanceof Error?R:new Error(R)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(N=globalThis.Stats)!=null&&N.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new gE({callback:b,params:{canvasContext:e,viewport:t,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!y,pdfBug:this._pdfBug,pageColors:c});(g.renderTasks||(g.renderTasks=new Set)).add(_);const S=_.task;return Promise.all([g.displayReadyCapability.promise,o]).then(([R,N])=>{var O;if(this.destroyed){b();return}if((O=this._stats)==null||O.time("Rendering"),!(N.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:R,optionalContentConfig:N}),_.operatorListChanged()}).catch(b),S}getOperatorList({intent:e="display",annotationMode:t=Ao.ENABLE,printAnnotationStorage:r=null,isEditing:n=!1}={}){var c;function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,r,n,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Eg.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,n){function s(){a.read().then(function({value:l,done:c}){if(c){r(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},n)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),H(this,hl,!1),Promise.all(e)}cleanup(e=!1){H(this,hl,!0);const t=X(this,Td,Jm).call(this);return e&&t&&this._stats&&(this._stats=new oR),t}_startRenderPage(e,t){var n,s;const r=this._intentStates.get(t);r&&((n=this._stats)==null||n.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let r=0,n=e.length;r<n;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&X(this,Td,Jm).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:n}){const{map:s,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:n},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:f,done:m})=>{if(m){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,c),h())},f=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const m of c.renderTasks)m.operatorListChanged();X(this,Td,Jm).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(f);else if(c.opListReadCapability)c.opListReadCapability.reject(f);else throw f}})};h()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof Bw){let n=z7;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new Bl(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[n,s]of this._intentStates)if(s===e){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}hl=new WeakMap,Td=new WeakSet,Jm=function(){if(!v(this,hl)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),H(this,hl,!1),!0};var Pu,Da,fl,Rd,cw,Nd,Dd,Xi,cb,DL,LL,eg,Jf,db;const Jr=class Jr{constructor({name:e=null,port:t=null,verbosity:r=Pz()}={}){q(this,Xi);q(this,Pu,Promise.withResolvers());q(this,Da,null);q(this,fl,null);q(this,Rd,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(v(Jr,Dd).has(t))throw new Error("Cannot use more than one PDFWorker per port.");v(Jr,Dd).set(t,this),X(this,Xi,DL).call(this,t)}else X(this,Xi,LL).call(this)}get promise(){return v(this,Pu).promise}get port(){return v(this,fl)}get messageHandler(){return v(this,Da)}destroy(){var e,t;this.destroyed=!0,(e=v(this,Rd))==null||e.terminate(),H(this,Rd,null),v(Jr,Dd).delete(v(this,fl)),H(this,fl,null),(t=v(this,Da))==null||t.destroy(),H(this,Da,null)}static create(e){const t=v(this,Dd).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Jr(e)}static get workerSrc(){if(ua.workerSrc)return ua.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ur(this,"_setupFakeWorkerGlobal",(async()=>v(this,Jf,db)?v(this,Jf,db):(await import(this.workerSrc)).WorkerMessageHandler)())}};Pu=new WeakMap,Da=new WeakMap,fl=new WeakMap,Rd=new WeakMap,cw=new WeakMap,Nd=new WeakMap,Dd=new WeakMap,Xi=new WeakSet,cb=function(){v(this,Pu).resolve(),v(this,Da).send("configure",{verbosity:this.verbosity})},DL=function(e){H(this,fl,e),H(this,Da,new Ym("main","worker",e)),v(this,Da).on("ready",()=>{}),X(this,Xi,cb).call(this)},LL=function(){if(v(Jr,Nd)||v(Jr,Jf,db)){X(this,Xi,eg).call(this);return}let{workerSrc:e}=Jr;try{Jr._isSameOrigin(window.location,e)||(e=Jr._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new Ym("main","worker",t),n=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?v(this,Pu).reject(new Error("Worker was destroyed")):X(this,Xi,eg).call(this)},s=new AbortController;t.addEventListener("error",()=>{v(this,Rd)||n()},{signal:s.signal}),r.on("test",o=>{if(s.abort(),this.destroyed||!o){n();return}H(this,Da,r),H(this,fl,t),H(this,Rd,t),X(this,Xi,cb).call(this)}),r.on("ready",o=>{if(s.abort(),this.destroyed){n();return}try{a()}catch{X(this,Xi,eg).call(this)}});const a=()=>{const o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{jw("The worker has been disabled.")}X(this,Xi,eg).call(this)},eg=function(){v(Jr,Nd)||(Qt("Setting up fake worker."),H(Jr,Nd,!0)),Jr._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){v(this,Pu).reject(new Error("Worker was destroyed"));return}const t=new Jz;H(this,fl,t);const r=`fake${Bi(Jr,cw)._++}`,n=new Ym(r+"_worker",r,t);e.setup(n,t),H(this,Da,new Ym(r,r+"_worker",t)),X(this,Xi,cb).call(this)}).catch(e=>{v(this,Pu).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Jf=new WeakSet,db=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},q(Jr,Jf),q(Jr,cw,0),q(Jr,Nd,!1),q(Jr,Dd,new WeakMap),Vi&&(H(Jr,Nd,!0),ua.workerSrc||(ua.workerSrc="./pdf.worker.mjs")),Jr._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const n=new URL(t,r);return r.origin===n.origin},Jr._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Jr.fromPort=e=>{if(Uz("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Jr.create(e)};let Ip=Jr;var pl,yo,ep,tp,ml,Ld,tg;class H7{constructor(e,t,r,n,s){q(this,Ld);q(this,pl,new Map);q(this,yo,new Map);q(this,ep,new Map);q(this,tp,new Map);q(this,ml,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new CL,this.fontLoader=new Yz({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ur(this,"annotationStorage",new VS)}getRenderingIntent(e,t=Ao.ENABLE,r=null,n=!1,s=!1){let a=Ms.DISPLAY,o=rE;switch(e){case"any":a=Ms.ANY;break;case"display":break;case"print":a=Ms.PRINT;break;default:Qt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Ms.PRINT&&r instanceof uL?r:this.annotationStorage;switch(t){case Ao.DISABLE:a+=Ms.ANNOTATIONS_DISABLE;break;case Ao.ENABLE:break;case Ao.ENABLE_FORMS:a+=Ms.ANNOTATIONS_FORMS;break;case Ao.ENABLE_STORAGE:a+=Ms.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Qt(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(a+=Ms.IS_EDITING),s&&(a+=Ms.OPLIST);const{ids:c,hash:h}=l.modifiedIds,f=[a,o.hash,h];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=v(this,ml))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of v(this,yo).values())e.push(n._destroy());v(this,yo).clear(),v(this,ep).clear(),v(this,tp).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var n,s;this.commonObjs.clear(),this.fontLoader.clear(),v(this,pl).clear(),this.filterFactory.destroy(),_g.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new Bl("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,n)=>{Nn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},n.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){n.close();return}Nn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{n.error(s)})},n.onCancel=s=>{this._fullReader.cancel(s),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async r=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:s,contentLength:a}=this._fullReader;return(!n||!s)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:n,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(r,n)=>{Nn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){n.close();return}n.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){n.close();return}Nn(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{s.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new $7(r,this))}),e.on("DocException",r=>{t._capability.reject(us(r))}),e.on("PasswordRequest",r=>{H(this,ml,Promise.withResolvers());try{if(!t.onPassword)throw us(r);const n=s=>{s instanceof Error?v(this,ml).reject(s):v(this,ml).resolve({password:s})};t.onPassword(n,r.code)}catch(n){v(this,ml).reject(n)}return v(this,ml).promise}),e.on("DataLoaded",r=>{var n;(n=t.onProgress)==null||n.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;v(this,yo).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,n,s])=>{var a;if(this.destroyed||this.commonObjs.has(r))return null;switch(n){case"Font":if("error"in s){const h=s.error;Qt(`Error during font loading: ${h}`),this.commonObjs.resolve(r,h);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(h,f)=>globalThis.FontInspector.fontAdded(h,f):null,l=new Xz(s,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(r,l)});break;case"CopyLocalImage":const{imageRef:c}=s;Nn(c,"The imageRef must be defined.");for(const h of v(this,yo).values())for(const[,f]of h.objs)if((f==null?void 0:f.ref)===c)return f.dataLen?(this.commonObjs.resolve(r,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([r,n,s,a])=>{var l;if(this.destroyed)return;const o=v(this,yo).get(n);if(!o.objs.has(r)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{var n;this.destroyed||(n=t.onProgress)==null||n.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[r.type];if(!n)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Qt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=v(this,ep).get(t);if(r)return r;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&v(this,tp).set(s.refStr,e);const a=new U7(t,s,this,this._params.pdfBug);return v(this,yo).set(t,a),a});return v(this,ep).set(t,n),n}getPageIndex(e){return nE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return X(this,Ld,tg).call(this,"GetFieldObjects")}hasJSActions(){return X(this,Ld,tg).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return X(this,Ld,tg).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return X(this,Ld,tg).call(this,"GetOptionalContentConfig").then(t=>new x7(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=v(this,pl).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(n=>{var s,a;return{info:n[0],metadata:n[1]?new b7(n[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return v(this,pl).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of v(this,yo).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),v(this,pl).clear(),this.filterFactory.destroy(!0),_g.cleanup()}}cachedPageNumber(e){if(!nE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return v(this,tp).get(t)??null}}pl=new WeakMap,yo=new WeakMap,ep=new WeakMap,tp=new WeakMap,ml=new WeakMap,Ld=new WeakSet,tg=function(e,t=null){const r=v(this,pl).get(e);if(r)return r;const n=this.messageHandler.sendWithPromise(e,t);return v(this,pl).set(e,n),n};var Ou;class W7{constructor(e){q(this,Ou,null);it(this,"onContinue",null);it(this,"onError",null);H(this,Ou,e)}get promise(){return v(this,Ou).capability.promise}cancel(e=0){v(this,Ou).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=v(this,Ou).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=v(this,Ou);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Ou=new WeakMap;var Iu,Pd;const Zc=class Zc{constructor({callback:e,params:t,objs:r,commonObjs:n,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:m=null}){q(this,Iu,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=n,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new W7(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(v(Zc,Pd).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");v(Zc,Pd).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:n,transform:s,background:a}=this.params;this.gfx=new _f(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var r,n,s;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),v(this,Iu)&&(window.cancelAnimationFrame(v(this,Iu)),H(this,Iu,null)),v(Zc,Pd).delete(this._canvas),e||(e=new Bw(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(n=this.task).onError)==null||s.call(n,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?H(this,Iu,window.requestAnimationFrame(()=>{H(this,Iu,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),v(Zc,Pd).delete(this._canvas),this.callback())))}};Iu=new WeakMap,Pd=new WeakMap,q(Zc,Pd,new WeakSet);let gE=Zc;const PL="5.3.31",OL="47ad820d9";function ER(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Im(i){return Math.max(0,Math.min(255,255*i))}class SR{static CMYK_G([e,t,r,n]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+n)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Im(e),[e,e,e]}static G_HTML([e]){const t=ER(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(Im)}static RGB_HTML(e){return`#${e.map(ER).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,n]){return["RGB",1-Math.min(1,e+n),1-Math.min(1,r+n),1-Math.min(1,t+n)]}static CMYK_rgb([e,t,r,n]){return[Im(1-Math.min(1,e+n)),Im(1-Math.min(1,r+n)),Im(1-Math.min(1,t+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const n=1-e,s=1-t,a=1-r,o=Math.min(n,s,a);return["CMYK",n,s,a,o]}}class V7{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),r||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Pr("Abstract method `_createSVG` called.")}}class Sg extends V7{_createSVG(e){return document.createElementNS(Yo,e)}}class KS{static setupStorage(e,t,r,n,s){const a=n.getValue(t,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{n.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:n,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&s.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,t,r)}static render(e){var f,m;const t=e.annotationStorage,r=e.linkService,n=e.xfaHtml,s=e.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:s,linkService:r});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=p}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const p=document.createTextNode(n.value);a.append(p),o&&Eg.shouldBuildText(n.name)&&c.push(p)}return{textDivs:c}}const h=[[n,-1,a]];for(;h.length>0;){const[p,x,g]=h.at(-1);if(x+1===p.children.length){h.pop();continue}const y=p.children[++h.at(-1)[1]];if(y===null)continue;const{name:b}=y;if(b==="#text"){const S=document.createTextNode(y.value);c.push(S),g.append(S);continue}const _=(f=y==null?void 0:y.attributes)!=null&&f.xmlns?document.createElementNS(y.attributes.xmlns,b):document.createElement(b);if(g.append(_),y.attributes&&this.setAttributes({html:_,element:y,storage:t,intent:s,linkService:r}),((m=y.children)==null?void 0:m.length)>0)h.push([y,-1,_]);else if(y.value){const S=document.createTextNode(y.value);o&&Eg.shouldBuildText(b)&&c.push(S),_.append(S)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const v0=1e3,G7=9,dh=new WeakSet;class AR{static create(e){switch(e.data.annotationType){case _n.LINK:return new IL(e);case _n.TEXT:return new q7(e);case _n.WIDGET:switch(e.data.fieldType){case"Tx":return new Y7(e);case"Btn":return e.data.radioButton?new jL(e):e.data.checkBox?new K7(e):new Z7(e);case"Ch":return new Q7(e);case"Sig":return new X7(e)}return new bh(e);case _n.POPUP:return new yE(e);case _n.FREETEXT:return new HL(e);case _n.LINE:return new e$(e);case _n.SQUARE:return new t$(e);case _n.CIRCLE:return new r$(e);case _n.POLYLINE:return new WL(e);case _n.CARET:return new i$(e);case _n.INK:return new ZS(e);case _n.POLYGON:return new n$(e);case _n.HIGHLIGHT:return new VL(e);case _n.UNDERLINE:return new s$(e);case _n.SQUIGGLY:return new a$(e);case _n.STRIKEOUT:return new o$(e);case _n.STAMP:return new GL(e);case _n.FILEATTACHMENT:return new l$(e);default:return new Cn(e)}}}var Od,rp,np,wv,vE;const dA=class dA{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:n=!1}={}){q(this,wv);q(this,Od,null);q(this,rp,!1);q(this,np,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:r}){return!!(e!=null&&e.str||t!=null&&t.str||r!=null&&r.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return dA._hasPopupData(this.data)}updateEdited(e){var r;if(!this.container)return;v(this,Od)||H(this,Od,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&X(this,wv,vE).call(this,t),(r=v(this,np))==null||r.popup.updateEdited(e)}resetEdited(){var e;v(this,Od)&&(X(this,wv,vE).call(this,v(this,Od).rect),(e=v(this,np))==null||e.popup.resetEdited(),H(this,Od,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:n}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof bh||(s.tabIndex=v0);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof yE){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,s),s}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,y=t.borderStyle.verticalCornerRadius;if(g>0||y>0){const _=`calc(${g}px * var(--total-scale-factor)) / calc(${y}px * var(--total-scale-factor))`;a.borderRadius=_}else if(this instanceof jL){const _=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=_}switch(t.borderStyle.style){case of.SOLID:a.borderStyle="solid";break;case of.DASHED:a.borderStyle="dashed";break;case of.BEVELED:Qt("Unimplemented border style: beveled");break;case of.INSET:Qt("Unimplemented border style: inset");break;case of.UNDERLINE:a.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(H(this,rp,!0),a.borderColor=jt.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):a.borderWidth=0}const c=jt.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:h,pageHeight:f,pageX:m,pageY:p}=n.rawDims;a.left=`${100*(c[0]-m)/h}%`,a.top=`${100*(c[1]-p)/f}%`;const{rotation:x}=t;return t.hasOwnCanvas||x===0?(a.width=`${100*o/h}%`,a.height=`${100*l/f}%`):this.setRotation(x,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:n}=this.parent.viewport.rawDims;let{width:s,height:a}=this;e%180!==0&&([s,a]=[a,s]),t.style.width=`${100*s/r}%`,t.style.height=`${100*a/n}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,n)=>{const s=n.detail[t],a=s[0],o=s.slice(1);n.target.style[r]=SR[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:SR[`${a}_rgb`](o)})};return ur(this,"_commonActions",{display:t=>{const{display:r}=t.detail,n=r%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const n of Object.keys(t.detail)){const s=e[n]||r[n];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[n,s]of Object.entries(t)){const a=r[n];if(a){const o={detail:{[n]:s},target:e};a(o),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,n,s]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,y,b,_]=e.subarray(2,6);if(n===g&&s===y&&t===b&&r===_)return}const{style:a}=this.container;let o;if(v(this,rp)){const{borderColor:g,borderWidth:y}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=n-t,c=s-r,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const m=h.createElement("defs");f.append(m);const p=h.createElement("clipPath"),x=`clippath_${this.data.id}`;p.setAttribute("id",x),p.setAttribute("clipPathUnits","objectBoundingBox"),m.append(p);for(let g=2,y=e.length;g<y;g+=8){const b=e[g],_=e[g+1],S=e[g+2],k=e[g+3],C=h.createElement("rect"),R=(S-t)/l,N=(s-_)/c,O=(b-S)/l,I=(_-k)/c;C.setAttribute("x",R),C.setAttribute("y",N),C.setAttribute("width",O),C.setAttribute("height",I),p.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${N}" width="${O}" height="${I}"/>`)}v(this,rp)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${x})`}_createPopup(){const{data:e}=this,t=H(this,np,new yE({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Pr("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:s,id:a,exportValues:o}of n){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!dh.has(c)){Qt(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:c})}return r}for(const n of document.getElementsByName(e)){const{exportValue:s}=n,a=n.getAttribute("data-element-id");a!==t&&dh.has(n)&&r.push({id:a,exportValue:s,domElement:n})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Od=new WeakMap,rp=new WeakMap,np=new WeakMap,wv=new WeakSet,vE=function(e){const{container:{style:t},data:{rect:r,rotation:n},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;r==null||r.splice(0,4,...e),t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,n===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(n)};let Cn=dA;var Bs,Hc,FL,ML;class IL extends Cn{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});q(this,Bs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let s=!1;return t.url?(r.addLinkAttributes(n,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(n,t.action),s=!0):t.attachment?(X(this,Bs,FL).call(this,n,t.attachment,t.attachmentDest),s=!0):t.setOCGState?(X(this,Bs,ML).call(this,n,t.setOCGState),s=!0):t.dest?(this._bindLink(n,t.dest),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),s=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&X(this,Bs,Hc).call(this)}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),X(this,Bs,Hc).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const a=n.get(s);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}t.onclick||(t.onclick=()=>!1),X(this,Bs,Hc).call(this)}_bindResetFormAction(t,r){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),X(this,Bs,Hc).call(this),!this._fieldObjects){Qt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{var f;n==null||n();const{fields:s,refs:a,include:o}=r,l=[];if(s.length!==0||a.length!==0){const m=new Set(a);for(const p of s){const x=this._fieldObjects[p]||[];for(const{id:g}of x)m.add(g)}for(const p of Object.values(this._fieldObjects))for(const x of p)m.has(x.id)===o&&l.push(x)}else for(const m of Object.values(this._fieldObjects))l.push(...m);const c=this.annotationStorage,h=[];for(const m of l){const{id:p}=m;switch(h.push(p),m.type){case"text":{const g=m.defaultValue||"";c.setValue(p,{value:g});break}case"checkbox":case"radiobutton":{const g=m.defaultValue===m.exportValues;c.setValue(p,{value:g});break}case"combobox":case"listbox":{const g=m.defaultValue||"";c.setValue(p,{value:g});break}default:continue}const x=document.querySelector(`[data-element-id="${p}"]`);if(x){if(!dh.has(x)){Qt(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;x.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Bs=new WeakSet,Hc=function(){this.container.setAttribute("data-internal-link","")},FL=function(t,r,n=null){t.href=this.linkService.getAnchorUrl(""),r.description&&(t.title=r.description),t.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(r.content,r.filename,n),!1},X(this,Bs,Hc).call(this)},ML=function(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),X(this,Bs,Hc).call(this)};class q7 extends Cn{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class bh extends Cn{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return ei.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,n,s){r.includes("mouse")?e.addEventListener(r,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{var o;if(r==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a)}}))})}_setEventListeners(e,t,r,n){var s,a,o;for(const[l,c]of r)(c==="Action"||(s=this.data.actions)!=null&&s[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,n),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":jt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||G7,s=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(Hx*n))||1,f=c/h;a=Math.min(n,l(f/Hx))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(n,l(c/Hx))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=jt.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Y7 extends bh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,n){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=r),s.setValue(a.id,{[n]:r})}render(){var n,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=c??o,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",c??o),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),dh.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=v0,this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",m=>{e.setValue(t,{value:m.target.value}),this.setPropertyOnSiblings(r,"value",m.target.value,"value"),h.formattedValue=null}),r.addEventListener("resetform",m=>{const p=this.data.defaultFieldValue??"";r.value=h.userValue=p,h.formattedValue=null});let f=m=>{const{formattedValue:p}=h;p!=null&&(m.target.value=p),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",p=>{var g;if(h.focused)return;const{target:x}=p;h.userValue&&(x.value=h.userValue),h.lastCommittedValue=x.value,h.commitKey=1,(g=this.data.actions)!=null&&g.Focus||(h.focused=!0)}),r.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const x={value(g){h.userValue=g.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),g.target.value=h.userValue},formattedValue(g){const{formattedValue:y}=g.detail;h.formattedValue=y,y!=null&&g.target!==document.activeElement&&(g.target.value=y),e.setValue(t,{formattedValue:y})},selRange(g){g.target.setSelectionRange(...g.detail.selRange)},charLimit:g=>{var S;const{charLimit:y}=g.detail,{target:b}=g;if(y===0){b.removeAttribute("maxLength");return}b.setAttribute("maxLength",y);let _=h.userValue;!_||_.length<=y||(_=_.slice(0,y),b.value=h.userValue=_,e.setValue(t,{value:_}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:b.selectionStart,selEnd:b.selectionEnd}}))}};this._dispatchEventFromSandbox(x,p)}),r.addEventListener("keydown",p=>{var y;h.commitKey=1;let x=-1;if(p.key==="Escape"?x=0:p.key==="Enter"&&!this.data.multiLine?x=2:p.key==="Tab"&&(h.commitKey=3),x===-1)return;const{value:g}=p.target;h.lastCommittedValue!==g&&(h.lastCommittedValue=g,h.userValue=g,(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:x,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const m=f;f=null,r.addEventListener("blur",p=>{var g,y;if(!h.focused||!p.relatedTarget)return;(g=this.data.actions)!=null&&g.Blur||(h.focused=!1);const{value:x}=p.target;h.userValue=x,h.lastCommittedValue!==x&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:h.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),m(p)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",p=>{var C;h.lastCommittedValue=null;const{data:x,target:g}=p,{value:y,selectionStart:b,selectionEnd:_}=g;let S=b,k=_;switch(p.inputType){case"deleteWordBackward":{const R=y.substring(0,b).match(/\w*[^\w]*$/);R&&(S-=R[0].length);break}case"deleteWordForward":{const R=y.substring(b).match(/^[^\w]*\w*/);R&&(k+=R[0].length);break}case"deleteContentBackward":b===_&&(S-=1);break;case"deleteContentForward":b===_&&(k+=1);break}p.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,change:x||"",willCommit:!1,selStart:S,selEnd:k}})}),this._setEventListeners(r,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(f&&r.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class X7 extends bh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class K7 extends bh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let n=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",e.setValue(r,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return dh.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,n&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=v0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,r)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class jL extends bh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let n=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof n=="string"&&(n=n!==t.buttonValue,e.setValue(r,{value:n})),n)for(const a of this._getElementsByName(t.fieldName,r))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(dh.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,n&&s.setAttribute("checked",!0),s.tabIndex=v0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,r))e.setValue(c.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const m=h&&f.id===r;f.domElement&&(f.domElement.checked=m),e.setValue(f.id,{value:m})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Z7 extends IL{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class Q7 extends bh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");dh.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=v0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const m of n.options)m.selected=m.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,r.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),s=!1),n.append(f)}let a=null;if(s){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:m,multiple:p}=n;return p?Array.prototype.filter.call(m,x=>x.selected).map(x=>x[f]):m.selectedIndex===-1?null:m[m.selectedIndex][f]};let l=o(!1);const c=h=>{const f=h.target.options;return Array.prototype.map.call(f,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const f={value(m){a==null||a();const p=m.detail.value,x=new Set(Array.isArray(p)?p:[p]);for(const g of n.options)g.selected=x.has(g.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(m){n.multiple=!0},remove(m){const p=n.options,x=m.detail.remove;p[x].selected=!1,n.remove(x),p.length>0&&Array.prototype.findIndex.call(p,y=>y.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:c(m)}),l=o(!1)},clear(m){for(;n.length!==0;)n.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(m){const{index:p,displayValue:x,exportValue:g}=m.detail.insert,y=n.children[p],b=document.createElement("option");b.textContent=x,b.value=g,y?y.before(b):n.append(b),e.setValue(t,{value:o(!0),items:c(m)}),l=o(!1)},items(m){const{items:p}=m.detail;for(;n.length!==0;)n.remove(0);for(const x of p){const{displayValue:g,exportValue:y}=x,b=document.createElement("option");b.textContent=g,b.value=y,n.append(b)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(m)}),l=o(!1)},indices(m){const p=new Set(m.detail.indices);for(const x of m.target.options)x.selected=p.has(x.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(f,h)}),n.addEventListener("input",h=>{var p;const f=o(!0),m=o(!1);e.setValue(t,{value:f}),h.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:m,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class yE extends Cn{constructor(e){const{data:t,elements:r}=e;super(e,{isRenderable:Cn._hasPopupData(t)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new J7({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",t.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(r=>`${HS}${r}`).join(",")),this.container}}var ip,dw,hw,sp,ap,pn,gl,op,xv,_v,lp,vl,La,yl,Ev,bl,Sv,Id,Fd,Or,hb,bE,BL,zL,$L,UL,fb,pb,wE;class J7{constructor({container:e,color:t,elements:r,titleObj:n,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:f}){q(this,Or);q(this,ip,X(this,Or,$L).bind(this));q(this,dw,X(this,Or,wE).bind(this));q(this,hw,X(this,Or,pb).bind(this));q(this,sp,X(this,Or,fb).bind(this));q(this,ap,null);q(this,pn,null);q(this,gl,null);q(this,op,null);q(this,xv,null);q(this,_v,null);q(this,lp,null);q(this,vl,!1);q(this,La,null);q(this,yl,null);q(this,Ev,null);q(this,bl,null);q(this,Sv,null);q(this,Id,null);q(this,Fd,!1);var m;H(this,pn,e),H(this,Sv,n),H(this,gl,a),H(this,bl,o),H(this,_v,l),H(this,ap,t),H(this,Ev,c),H(this,lp,h),H(this,xv,r),H(this,op,$w.toDateObject(s)),this.trigger=r.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",v(this,sp)),p.addEventListener("mouseenter",v(this,hw)),p.addEventListener("mouseleave",v(this,dw)),p.classList.add("popupTriggerArea");for(const p of r)(m=p.container)==null||m.addEventListener("keydown",v(this,ip));v(this,pn).hidden=!0,f&&X(this,Or,fb).call(this)}render(){if(v(this,La))return;const e=H(this,La,document.createElement("div"));if(e.className="popup",v(this,ap)){const s=e.style.outlineColor=jt.makeHexColor(...v(this,ap));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");t.className="header";const r=document.createElement("h1");if(t.append(r),{dir:r.dir,str:r.textContent}=v(this,Sv),e.append(t),v(this,op)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:v(this,op).valueOf()})),t.append(s)}const n=v(this,Or,hb);if(n)KS.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(v(this,gl));e.append(s)}v(this,pn).append(e)}_formatContents({str:e,dir:t}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=t;const n=e.split(/(?:\r\n?|\n)/);for(let s=0,a=n.length;s<a;++s){const o=n[s];r.append(document.createTextNode(o)),s<a-1&&r.append(document.createElement("br"))}return r}updateEdited({rect:e,popupContent:t}){var r;v(this,Id)||H(this,Id,{contentsObj:v(this,gl),richText:v(this,bl)}),e&&H(this,yl,null),t&&(H(this,bl,X(this,Or,zL).call(this,t)),H(this,gl,null)),(r=v(this,La))==null||r.remove(),H(this,La,null)}resetEdited(){var e;v(this,Id)&&({contentsObj:Bi(this,gl)._,richText:Bi(this,bl)._}=v(this,Id),H(this,Id,null),(e=v(this,La))==null||e.remove(),H(this,La,null),H(this,yl,null))}forceHide(){H(this,Fd,this.isVisible),v(this,Fd)&&(v(this,pn).hidden=!0)}maybeShow(){v(this,Fd)&&(v(this,La)||X(this,Or,pb).call(this),H(this,Fd,!1),v(this,pn).hidden=!1)}get isVisible(){return v(this,pn).hidden===!1}}ip=new WeakMap,dw=new WeakMap,hw=new WeakMap,sp=new WeakMap,ap=new WeakMap,pn=new WeakMap,gl=new WeakMap,op=new WeakMap,xv=new WeakMap,_v=new WeakMap,lp=new WeakMap,vl=new WeakMap,La=new WeakMap,yl=new WeakMap,Ev=new WeakMap,bl=new WeakMap,Sv=new WeakMap,Id=new WeakMap,Fd=new WeakMap,Or=new WeakSet,hb=function(){const e=v(this,bl),t=v(this,gl);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&v(this,bl).html||null},bE=function(){var e,t,r;return((r=(t=(e=v(this,Or,hb))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},BL=function(){var e,t,r;return((r=(t=(e=v(this,Or,hb))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},zL=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:v(this,Or,BL),fontSize:v(this,Or,bE)?`calc(${v(this,Or,bE)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:n});return r},$L=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&v(this,vl))&&X(this,Or,fb).call(this)},UL=function(){if(v(this,yl)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:n,pageY:s}}}=v(this,_v);let a=!!v(this,lp),o=a?v(this,lp):v(this,Ev);for(const x of v(this,xv))if(!o||jt.intersect(x.data.rect,o)!==null){o=x.data.rect,a=!0;break}const l=jt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,f=l[0]+h,m=l[1];H(this,yl,[100*(f-n)/t,100*(m-s)/r]);const{style:p}=v(this,pn);p.left=`${v(this,yl)[0]}%`,p.top=`${v(this,yl)[1]}%`},fb=function(){H(this,vl,!v(this,vl)),v(this,vl)?(X(this,Or,pb).call(this),v(this,pn).addEventListener("click",v(this,sp)),v(this,pn).addEventListener("keydown",v(this,ip))):(X(this,Or,wE).call(this),v(this,pn).removeEventListener("click",v(this,sp)),v(this,pn).removeEventListener("keydown",v(this,ip)))},pb=function(){v(this,La)||this.render(),this.isVisible?v(this,vl)&&v(this,pn).classList.add("focused"):(X(this,Or,UL).call(this),v(this,pn).hidden=!1,v(this,pn).style.zIndex=parseInt(v(this,pn).style.zIndex)+1e3)},wE=function(){v(this,pn).classList.remove("focused"),!(v(this,vl)||!this.isVisible)&&(v(this,pn).hidden=!0,v(this,pn).style.zIndex=parseInt(v(this,pn).style.zIndex)-1e3)};class HL extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Kt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Av;class e$ extends Cn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});q(this,Av,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:r,height:n}=this,s=this.svgFactory.create(r,n,!0),a=H(this,Av,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Av)}addHighlightArea(){this.container.classList.add("highlightArea")}}Av=new WeakMap;var Cv;class t$ extends Cn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});q(this,Cv,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:r,height:n}=this,s=this.svgFactory.create(r,n,!0),a=t.borderStyle.width,o=H(this,Cv,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",r-a),o.setAttribute("height",n-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Cv)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cv=new WeakMap;var kv;class r$ extends Cn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});q(this,kv,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:r,height:n}=this,s=this.svgFactory.create(r,n,!0),a=t.borderStyle.width,o=H(this,kv,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",r/2),o.setAttribute("cy",n/2),o.setAttribute("rx",r/2-a/2),o.setAttribute("ry",n/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,kv)}addHighlightArea(){this.container.classList.add("highlightArea")}}kv=new WeakMap;var Tv;class WL extends Cn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});q(this,Tv,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:n,popupRef:s},width:a,height:o}=this;if(!r)return this.container;const l=this.svgFactory.create(a,o,!0);let c=[];for(let f=0,m=r.length;f<m;f+=2){const p=r[f]-t[0],x=t[3]-r[f+1];c.push(`${p},${x}`)}c=c.join(" ");const h=H(this,Tv,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Tv)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tv=new WeakMap;class n$ extends WL{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class i$ extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Rv,Md,Nv,xE;class ZS extends Cn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});q(this,Nv);q(this,Rv,null);q(this,Md,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Kt.HIGHLIGHT:Kt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:n,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:c}=X(this,Nv,xE).call(this,r,t),h=this.svgFactory.create(l,c,!0),f=H(this,Rv,this.svgFactory.createElement("svg:g"));h.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let m=0,p=n.length;m<p;m++){const x=this.svgFactory.createElement(this.svgElementName);v(this,Md).push(x),x.setAttribute("points",n[m].join(",")),f.append(x)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:n,rect:s}=t,a=v(this,Rv);if(r>=0&&a.setAttribute("stroke-width",r||1),n)for(let o=0,l=v(this,Md).length;o<l;o++)v(this,Md)[o].setAttribute("points",n[o].join(","));if(s){const{transform:o,width:l,height:c}=X(this,Nv,xE).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return v(this,Md)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rv=new WeakMap,Md=new WeakMap,Nv=new WeakSet,xE=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class VL extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Kt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class s$ extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class a$ extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class o$ extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class GL extends Cn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Kt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Dv,Lv,_E;class l$ extends Cn{constructor(t){var n;super(t,{isRenderable:!0});q(this,Lv);q(this,Dv,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let n;r.hasAppearance||r.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),n.addEventListener("dblclick",X(this,Lv,_E).bind(this)),H(this,Dv,n);const{isMac:s}=ei.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&X(this,Lv,_E).call(this)}),!r.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return v(this,Dv)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dv=new WeakMap,Lv=new WeakSet,_E=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Pv,jd,Fu,Ov,lc,EE,SE,up;let QS=(up=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:n,page:s,viewport:a,structTreeLayer:o}){q(this,lc);q(this,Pv,null);q(this,jd,null);q(this,Fu,new Map);q(this,Ov,null);this.div=e,H(this,Pv,t),H(this,jd,r),H(this,Ov,o||null),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return v(this,Fu).size>0}async render(e){var a;const{annotations:t}=e,r=this.div;nc(r,this.viewport);const n=new Map,s={data:null,layer:r,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Sg,annotationStorage:e.annotationStorage||new VS,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===_n.POPUP;if(l){const f=n.get(o.id);if(!f)continue;s.elements=f}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;s.data=o;const c=AR.create(s);if(!c.isRenderable)continue;if(!l&&o.popupRef){const f=n.get(o.popupRef);f?f.push(c):n.set(o.popupRef,[c])}const h=c.render();o.hidden&&(h.style.visibility="hidden"),await X(this,lc,EE).call(this,h,o.id),c._isEditable&&(v(this,Fu).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}X(this,lc,SE).call(this)}async addLinkAnnotations(e,t){const r={data:null,layer:this.div,linkService:t,svgFactory:new Sg,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=up._defaultBorderStyle),r.data=n;const s=AR.create(r);if(!s.isRenderable)continue;const a=s.render();await X(this,lc,EE).call(this,a,n.id)}}update({viewport:e}){const t=this.div;this.viewport=e,nc(t,{rotation:e.rotation}),X(this,lc,SE).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(v(this,Fu).values())}getEditableAnnotation(e){return v(this,Fu).get(e)}static get _defaultBorderStyle(){return ur(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:of.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},Pv=new WeakMap,jd=new WeakMap,Fu=new WeakMap,Ov=new WeakMap,lc=new WeakSet,EE=async function(e,t){var a,o;const r=e.firstChild||e,n=r.id=`${HS}${t}`,s=await((a=v(this,Ov))==null?void 0:a.getAriaAttributes(n));if(s)for(const[l,c]of s)r.setAttribute(l,c);this.div.append(e),(o=v(this,Pv))==null||o.moveElementInDOM(this.div,e,r,!1)},SE=function(){var t;if(!v(this,jd))return;const e=this.div;for(const[r,n]of v(this,jd)){const s=e.querySelector(`[data-annotation-id="${r}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n);const o=v(this,Fu).get(r);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(r,s.id,n),o._hasNoCanvas=!1):o.canvas=n)}v(this,jd).clear()},up);const $y=/\r\n?|\n/g;var Pa,Ts,Iv,Bd,Rs,Dn,qL,YL,XL,mb,Pl,gb,vb,KL,CE,ZL;const Hr=class Hr extends Vr{constructor(t){super({...t,name:"freeTextEditor"});q(this,Dn);q(this,Pa);q(this,Ts,"");q(this,Iv,`${this.id}-editor`);q(this,Bd,null);q(this,Rs);H(this,Pa,t.color||Hr._defaultColor||Vr._defaultLineColor),H(this,Rs,t.fontSize||Hr._defaultFontSize)}static get _keyboardManager(){const t=Hr.prototype,r=a=>a.isEmpty(),n=ic.TRANSLATE_SMALL,s=ic.TRANSLATE_BIG;return ur(this,"_keyboardManager",new m0([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(t,r){Vr.initialize(t,r);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case fr.FREETEXT_SIZE:Hr._defaultFontSize=r;break;case fr.FREETEXT_COLOR:Hr._defaultColor=r;break}}updateParams(t,r){switch(t){case fr.FREETEXT_SIZE:X(this,Dn,qL).call(this,r);break;case fr.FREETEXT_COLOR:X(this,Dn,YL).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[fr.FREETEXT_SIZE,Hr._defaultFontSize],[fr.FREETEXT_COLOR,Hr._defaultColor||Vr._defaultLineColor]]}get propertiesToUpdate(){return[[fr.FREETEXT_SIZE,v(this,Rs)],[fr.FREETEXT_COLOR,v(this,Pa)]]}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-Hr._internalPadding*t,-(Hr._internalPadding+v(this,Rs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),H(this,Bd,new AbortController);const t=this._uiManager.combinedSignal(v(this,Bd));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",v(this,Iv)),this._isDraggable=!0,(t=v(this,Bd))==null||t.abort(),H(this,Bd,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=v(this,Ts),r=H(this,Ts,X(this,Dn,XL).call(this).trimEnd());if(t===r)return;const n=s=>{if(H(this,Ts,s),!s){this.remove();return}X(this,Dn,vb).call(this),this._uiManager.rebuild(this),X(this,Dn,mb).call(this)};this.addCommands({cmd:()=>{n(r)},undo:()=>{n(t)},mustExec:!1}),X(this,Dn,mb).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Hr._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,r;(this._isCopy||this.annotationElementId)&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",v(this,Iv)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${v(this,Rs)}px * var(--total-scale-factor))`,n.color=v(this,Pa),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,f]=this.pageDimensions,[m,p]=this.pageTranslation;let x,g;switch(this.rotation){case 0:x=t+(o[0]-m)/h,g=r+this.height-(o[1]-p)/f;break;case 90:x=t+(o[0]-m)/h,g=r-(o[1]-p)/f,[l,c]=[c,-l];break;case 180:x=t-this.width+(o[0]-m)/h,g=r-(o[1]-p)/f,[l,c]=[-l,-c];break;case 270:x=t+(o[0]-m-this.height*f)/h,g=r+(o[1]-p-this.width*h)/f,[l,c]=[-c,l];break}this.setAt(x*s,g*a,l,c)}else this._moveAfterPaste(t,r);X(this,Dn,vb).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var x,g,y;const r=t.clipboardData||window.clipboardData,{types:n}=r;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const s=X(x=Hr,Pl,CE).call(x,r.getData("text")||"").replaceAll($y,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,h=[],f=[];if(l.nodeType===Node.TEXT_NODE){const b=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll($y,"")),b!==this.editorDiv){let _=h;for(const S of this.editorDiv.childNodes){if(S===b){_=f;continue}_.push(X(g=Hr,Pl,gb).call(g,S))}}h.push(l.nodeValue.slice(0,c).replaceAll($y,""))}else if(l===this.editorDiv){let b=h,_=0;for(const S of this.editorDiv.childNodes)_++===c&&(b=f),b.push(X(y=Hr,Pl,gb).call(y,S))}H(this,Ts,`${h.join(`
`)}${s}${f.join(`
`)}`),X(this,Dn,vb).call(this);const m=new Range;let p=Math.sumPrecise(h.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const _=b.nodeValue.length;if(p<=_){m.setStart(b,p),m.setEnd(b,p);break}p-=_}a.removeAllRanges(),a.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(t,r,n){var o;let s=null;if(t instanceof HL){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:m,popupRef:p},textContent:x,textPosition:g,parent:{page:{pageNumber:y}}}=t;if(!x||x.length===0)return null;s=t={annotationType:Kt.FREETEXT,color:Array.from(c),fontSize:l,value:x.join(`
`),position:g,pageIndex:y-1,rect:h.slice(0),rotation:f,id:m,deleted:!1,popupRef:p}}const a=await super.deserialize(t,r,n);return H(a,Rs,t.fontSize),H(a,Pa,jt.makeHexColor(...t.color)),H(a,Ts,X(o=Hr,Pl,CE).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=s,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Hr._internalPadding*this.parentScale,n=this.getRect(r,r),s=Vr._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:v(this,Pa)),a={annotationType:Kt.FREETEXT,color:s,fontSize:v(this,Rs),value:X(this,Dn,KL).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.isCopy=!0,a):this.annotationElementId&&!X(this,Dn,ZL).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(this.deleted)return r;const{style:n}=r;n.fontSize=`calc(${v(this,Rs)}px * var(--total-scale-factor))`,n.color=v(this,Pa),r.replaceChildren();for(const a of v(this,Ts).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),r.append(o)}const s=Hr._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(s,s),popupContent:v(this,Ts)}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Pa=new WeakMap,Ts=new WeakMap,Iv=new WeakMap,Bd=new WeakMap,Rs=new WeakMap,Dn=new WeakSet,qL=function(t){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-v(this,Rs))*this.parentScale),H(this,Rs,s),X(this,Dn,mb).call(this)},n=v(this,Rs);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fr.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},YL=function(t){const r=s=>{H(this,Pa,this.editorDiv.style.color=s)},n=v(this,Pa);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fr.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},XL=function(){var n;const t=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(X(n=Hr,Pl,gb).call(n,s)),r=s);return t.join(`
`)},mb=function(){const[t,r]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/r):(this.width=n.height/t,this.height=n.width/r),this.fixAndSetPosition()},Pl=new WeakSet,gb=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll($y,"")},vb=function(){if(this.editorDiv.replaceChildren(),!!v(this,Ts))for(const t of v(this,Ts).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},KL=function(){return v(this,Ts).replaceAll(" "," ")},CE=function(t){return t.replaceAll(" "," ")},ZL=function(t){const{value:r,fontSize:n,color:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==r||t.fontSize!==n||t.color.some((o,l)=>o!==s[l])||t.pageIndex!==a},q(Hr,Pl),it(Hr,"_freeTextDefaultContent",""),it(Hr,"_internalPadding",0),it(Hr,"_defaultColor",null),it(Hr,"_defaultFontSize",10),it(Hr,"_type","freetext"),it(Hr,"_editorType",Kt.FREETEXT);let AE=Hr;class At{toSVGPath(){Pr("Abstract method `toSVGPath` must be implemented.")}get box(){Pr("Abstract getter `box` must be implemented.")}serialize(e,t){Pr("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,n,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*n,a[o+1]=r+e[o+1]*s;return a}static _rescaleAndSwap(e,t,r,n,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*n,a[o+1]=r+e[o]*s;return a}static _translate(e,t,r,n){n||(n=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)n[s]=t+e[s],n[s+1]=r+e[s+1];return n}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,n,s){switch(s){case 90:return[1-t/r,e/n];case 180:return[1-e/r,1-t/n];case 270:return[t/r,1-e/n];default:return[e/r,t/n]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,n,s,a){return[(e+5*r)/6,(t+5*n)/6,(5*r+s)/6,(5*n+a)/6,(r+s)/2,(n+a)/2]}}it(At,"PRECISION",1e-4);var Ns,Oa,cp,dp,bo,lr,zd,$d,Fv,Mv,hp,fp,Mu,jv,fw,pw,Wn,rg,QL,JL,eP,tP,rP,nP;const Qo=class Qo{constructor({x:e,y:t},r,n,s,a,o=0){q(this,Wn);q(this,Ns);q(this,Oa,[]);q(this,cp);q(this,dp);q(this,bo,[]);q(this,lr,new Float32Array(18));q(this,zd);q(this,$d);q(this,Fv);q(this,Mv);q(this,hp);q(this,fp);q(this,Mu,[]);H(this,Ns,r),H(this,fp,s*n),H(this,dp,a),v(this,lr).set([NaN,NaN,NaN,NaN,e,t],6),H(this,cp,o),H(this,Mv,v(Qo,jv)*n),H(this,Fv,v(Qo,pw)*n),H(this,hp,n),v(this,Mu).push(e,t)}isEmpty(){return isNaN(v(this,lr)[8])}add({x:e,y:t}){var I;H(this,zd,e),H(this,$d,t);const[r,n,s,a]=v(this,Ns);let[o,l,c,h]=v(this,lr).subarray(8,12);const f=e-c,m=t-h,p=Math.hypot(f,m);if(p<v(this,Fv))return!1;const x=p-v(this,Mv),g=x/p,y=g*f,b=g*m;let _=o,S=l;o=c,l=h,c+=y,h+=b,(I=v(this,Mu))==null||I.push(e,t);const k=-b/x,C=y/x,R=k*v(this,fp),N=C*v(this,fp);return v(this,lr).set(v(this,lr).subarray(2,8),0),v(this,lr).set([c+R,h+N],4),v(this,lr).set(v(this,lr).subarray(14,18),12),v(this,lr).set([c-R,h-N],16),isNaN(v(this,lr)[6])?(v(this,bo).length===0&&(v(this,lr).set([o+R,l+N],2),v(this,bo).push(NaN,NaN,NaN,NaN,(o+R-r)/s,(l+N-n)/a),v(this,lr).set([o-R,l-N],14),v(this,Oa).push(NaN,NaN,NaN,NaN,(o-R-r)/s,(l-N-n)/a)),v(this,lr).set([_,S,o,l,c,h],6),!this.isEmpty()):(v(this,lr).set([_,S,o,l,c,h],6),Math.abs(Math.atan2(S-l,_-o)-Math.atan2(b,y))<Math.PI/2?([o,l,c,h]=v(this,lr).subarray(2,6),v(this,bo).push(NaN,NaN,NaN,NaN,((o+c)/2-r)/s,((l+h)/2-n)/a),[o,l,_,S]=v(this,lr).subarray(14,18),v(this,Oa).push(NaN,NaN,NaN,NaN,((_+o)/2-r)/s,((S+l)/2-n)/a),!0):([_,S,o,l,c,h]=v(this,lr).subarray(0,6),v(this,bo).push(((_+5*o)/6-r)/s,((S+5*l)/6-n)/a,((5*o+c)/6-r)/s,((5*l+h)/6-n)/a,((o+c)/2-r)/s,((l+h)/2-n)/a),[c,h,o,l,_,S]=v(this,lr).subarray(12,18),v(this,Oa).push(((_+5*o)/6-r)/s,((S+5*l)/6-n)/a,((5*o+c)/6-r)/s,((5*l+h)/6-n)/a,((o+c)/2-r)/s,((l+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=v(this,bo),t=v(this,Oa);if(isNaN(v(this,lr)[6])&&!this.isEmpty())return X(this,Wn,QL).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?r.push(`L${e[n+4]} ${e[n+5]}`):r.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);X(this,Wn,eP).call(this,r);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?r.push(`L${t[n+4]} ${t[n+5]}`):r.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return X(this,Wn,JL).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,n,s,a){return new iP(e,t,r,n,s,a)}getOutlines(){var f;const e=v(this,bo),t=v(this,Oa),r=v(this,lr),[n,s,a,o]=v(this,Ns),l=new Float32Array((((f=v(this,Mu))==null?void 0:f.length)??0)+2);for(let m=0,p=l.length-2;m<p;m+=2)l[m]=(v(this,Mu)[m]-n)/a,l[m+1]=(v(this,Mu)[m+1]-s)/o;if(l[l.length-2]=(v(this,zd)-n)/a,l[l.length-1]=(v(this,$d)-s)/o,isNaN(r[6])&&!this.isEmpty())return X(this,Wn,tP).call(this,l);const c=new Float32Array(v(this,bo).length+24+v(this,Oa).length);let h=e.length;for(let m=0;m<h;m+=2){if(isNaN(e[m])){c[m]=c[m+1]=NaN;continue}c[m]=e[m],c[m+1]=e[m+1]}h=X(this,Wn,nP).call(this,c,h);for(let m=t.length-6;m>=6;m-=6)for(let p=0;p<6;p+=2){if(isNaN(t[m+p])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[m+p],c[h+1]=t[m+p+1],h+=2}return X(this,Wn,rP).call(this,c,h),this.newFreeDrawOutline(c,l,v(this,Ns),v(this,hp),v(this,cp),v(this,dp))}};Ns=new WeakMap,Oa=new WeakMap,cp=new WeakMap,dp=new WeakMap,bo=new WeakMap,lr=new WeakMap,zd=new WeakMap,$d=new WeakMap,Fv=new WeakMap,Mv=new WeakMap,hp=new WeakMap,fp=new WeakMap,Mu=new WeakMap,jv=new WeakMap,fw=new WeakMap,pw=new WeakMap,Wn=new WeakSet,rg=function(){const e=v(this,lr).subarray(4,6),t=v(this,lr).subarray(16,18),[r,n,s,a]=v(this,Ns);return[(v(this,zd)+(e[0]-t[0])/2-r)/s,(v(this,$d)+(e[1]-t[1])/2-n)/a,(v(this,zd)+(t[0]-e[0])/2-r)/s,(v(this,$d)+(t[1]-e[1])/2-n)/a]},QL=function(){const[e,t,r,n]=v(this,Ns),[s,a,o,l]=X(this,Wn,rg).call(this);return`M${(v(this,lr)[2]-e)/r} ${(v(this,lr)[3]-t)/n} L${(v(this,lr)[4]-e)/r} ${(v(this,lr)[5]-t)/n} L${s} ${a} L${o} ${l} L${(v(this,lr)[16]-e)/r} ${(v(this,lr)[17]-t)/n} L${(v(this,lr)[14]-e)/r} ${(v(this,lr)[15]-t)/n} Z`},JL=function(e){const t=v(this,Oa);e.push(`L${t[4]} ${t[5]} Z`)},eP=function(e){const[t,r,n,s]=v(this,Ns),a=v(this,lr).subarray(4,6),o=v(this,lr).subarray(16,18),[l,c,h,f]=X(this,Wn,rg).call(this);e.push(`L${(a[0]-t)/n} ${(a[1]-r)/s} L${l} ${c} L${h} ${f} L${(o[0]-t)/n} ${(o[1]-r)/s}`)},tP=function(e){const t=v(this,lr),[r,n,s,a]=v(this,Ns),[o,l,c,h]=X(this,Wn,rg).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-n)/a,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-n)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-n)/a,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-n)/a],0),this.newFreeDrawOutline(f,e,v(this,Ns),v(this,hp),v(this,cp),v(this,dp))},rP=function(e,t){const r=v(this,Oa);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},nP=function(e,t){const r=v(this,lr).subarray(4,6),n=v(this,lr).subarray(16,18),[s,a,o,l]=v(this,Ns),[c,h,f,m]=X(this,Wn,rg).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(n[0]-s)/o,(n[1]-a)/l],t),t+=24},q(Qo,jv,8),q(Qo,fw,2),q(Qo,pw,v(Qo,jv)+v(Qo,fw));let Wb=Qo;var pp,Ud,wl,Bv,Ds,zv,Sn,mw,sP;class iP extends At{constructor(t,r,n,s,a,o){super();q(this,mw);q(this,pp);q(this,Ud,new Float32Array(4));q(this,wl);q(this,Bv);q(this,Ds);q(this,zv);q(this,Sn);H(this,Sn,t),H(this,Ds,r),H(this,pp,n),H(this,zv,s),H(this,wl,a),H(this,Bv,o),this.lastPoint=[NaN,NaN],X(this,mw,sP).call(this,o);const[l,c,h,f]=v(this,Ud);for(let m=0,p=t.length;m<p;m+=2)t[m]=(t[m]-l)/h,t[m+1]=(t[m+1]-c)/f;for(let m=0,p=r.length;m<p;m+=2)r[m]=(r[m]-l)/h,r[m+1]=(r[m+1]-c)/f}toSVGPath(){const t=[`M${v(this,Sn)[4]} ${v(this,Sn)[5]}`];for(let r=6,n=v(this,Sn).length;r<n;r+=6){if(isNaN(v(this,Sn)[r])){t.push(`L${v(this,Sn)[r+4]} ${v(this,Sn)[r+5]}`);continue}t.push(`C${v(this,Sn)[r]} ${v(this,Sn)[r+1]} ${v(this,Sn)[r+2]} ${v(this,Sn)[r+3]} ${v(this,Sn)[r+4]} ${v(this,Sn)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,n,s],a){const o=n-t,l=s-r;let c,h;switch(a){case 0:c=At._rescale(v(this,Sn),t,s,o,-l),h=At._rescale(v(this,Ds),t,s,o,-l);break;case 90:c=At._rescaleAndSwap(v(this,Sn),t,r,o,l),h=At._rescaleAndSwap(v(this,Ds),t,r,o,l);break;case 180:c=At._rescale(v(this,Sn),n,r,-o,l),h=At._rescale(v(this,Ds),n,r,-o,l);break;case 270:c=At._rescaleAndSwap(v(this,Sn),n,s,-o,-l),h=At._rescaleAndSwap(v(this,Ds),n,s,-o,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return v(this,Ud)}newOutliner(t,r,n,s,a,o=0){return new Wb(t,r,n,s,a,o)}getNewOutline(t,r){const[n,s,a,o]=v(this,Ud),[l,c,h,f]=v(this,pp),m=a*h,p=o*f,x=n*h+l,g=s*f+c,y=this.newOutliner({x:v(this,Ds)[0]*m+x,y:v(this,Ds)[1]*p+g},v(this,pp),v(this,zv),t,v(this,Bv),r??v(this,wl));for(let b=2;b<v(this,Ds).length;b+=2)y.add({x:v(this,Ds)[b]*m+x,y:v(this,Ds)[b+1]*p+g});return y.getOutlines()}}pp=new WeakMap,Ud=new WeakMap,wl=new WeakMap,Bv=new WeakMap,Ds=new WeakMap,zv=new WeakMap,Sn=new WeakMap,mw=new WeakSet,sP=function(t){const r=v(this,Sn);let n=r[4],s=r[5];const a=[n,s,n,s];let o=n,l=s;const c=t?Math.max:Math.min;for(let f=6,m=r.length;f<m;f+=6){const p=r[f+4],x=r[f+5];if(isNaN(r[f]))jt.pointBoundingBox(p,x,a),l<x?(o=p,l=x):l===x&&(o=c(o,p));else{const g=[1/0,1/0,-1/0,-1/0];jt.bezierBoundingBox(n,s,...r.slice(f,f+6),g),jt.rectBoundingBox(...g,a),l<g[3]?(o=g[2],l=g[3]):l===g[3]&&(o=c(o,g[2]))}n=p,s=x}const h=v(this,Ud);h[0]=a[0]-v(this,wl),h[1]=a[1]-v(this,wl),h[2]=a[2]-a[0]+2*v(this,wl),h[3]=a[3]-a[1]+2*v(this,wl),this.lastPoint=[o,l]};var $v,Uv,ju,Ia,Ki,aP,yb,oP,lP,TE;class kE{constructor(e,t=0,r=0,n=!0){q(this,Ki);q(this,$v);q(this,Uv);q(this,ju,[]);q(this,Ia,[]);const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:p,y:x,width:g,height:y}of e){const b=Math.floor((p-t)/a)*a,_=Math.ceil((p+g+t)/a)*a,S=Math.floor((x-t)/a)*a,k=Math.ceil((x+y+t)/a)*a,C=[b,S,k,!0],R=[_,S,k,!1];v(this,ju).push(C,R),jt.rectBoundingBox(b,S,_,k,s)}const o=s[2]-s[0]+2*r,l=s[3]-s[1]+2*r,c=s[0]-r,h=s[1]-r,f=v(this,ju).at(n?-1:-2),m=[f[0],f[2]];for(const p of v(this,ju)){const[x,g,y]=p;p[0]=(x-c)/o,p[1]=(g-h)/l,p[2]=(y-h)/l}H(this,$v,new Float32Array([c,h,o,l])),H(this,Uv,m)}getOutlines(){v(this,ju).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of v(this,ju))t[3]?(e.push(...X(this,Ki,TE).call(this,t)),X(this,Ki,oP).call(this,t)):(X(this,Ki,lP).call(this,t),e.push(...X(this,Ki,TE).call(this,t)));return X(this,Ki,aP).call(this,e)}}$v=new WeakMap,Uv=new WeakMap,ju=new WeakMap,Ia=new WeakMap,Ki=new WeakSet,aP=function(e){const t=[],r=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),r.add(l),r.add(c)}const n=[];let s;for(;r.size>0;){const a=r.values().next().value;let[o,l,c,h,f]=a;r.delete(a);let m=o,p=l;for(s=[o,c],n.push(s);;){let x;if(r.has(h))x=h;else if(r.has(f))x=f;else break;r.delete(x),[o,l,c,h,f]=x,m!==o&&(s.push(m,p,o,p===l?l:c),m=o),p=p===l?c:l}s.push(m,p)}return new u$(n,v(this,$v),v(this,Uv))},yb=function(e){const t=v(this,Ia);let r=0,n=t.length-1;for(;r<=n;){const s=r+n>>1,a=t[s][0];if(a===e)return s;a<e?r=s+1:n=s-1}return n+1},oP=function([,e,t]){const r=X(this,Ki,yb).call(this,e);v(this,Ia).splice(r,0,[e,t])},lP=function([,e,t]){const r=X(this,Ki,yb).call(this,e);for(let n=r;n<v(this,Ia).length;n++){const[s,a]=v(this,Ia)[n];if(s!==e)break;if(s===e&&a===t){v(this,Ia).splice(n,1);return}}for(let n=r-1;n>=0;n--){const[s,a]=v(this,Ia)[n];if(s!==e)break;if(s===e&&a===t){v(this,Ia).splice(n,1);return}}},TE=function(e){const[t,r,n]=e,s=[[t,r,n]],a=X(this,Ki,yb).call(this,n);for(let o=0;o<a;o++){const[l,c]=v(this,Ia)[o];for(let h=0,f=s.length;h<f;h++){const[,m,p]=s[h];if(!(c<=m||p<=l)){if(m>=l){if(p>c)s[h][1]=c;else{if(f===1)return[];s.splice(h,1),h--,f--}continue}s[h][2]=l,p>c&&s.push([t,c,p])}}}return s};var Hv,mp;class u$ extends At{constructor(t,r,n){super();q(this,Hv);q(this,mp);H(this,mp,t),H(this,Hv,r),this.lastPoint=n}toSVGPath(){const t=[];for(const r of v(this,mp)){let[n,s]=r;t.push(`M${n} ${s}`);for(let a=2;a<r.length;a+=2){const o=r[a],l=r[a+1];o===n?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${o}`),n=o)}t.push("Z")}return t.join(" ")}serialize([t,r,n,s],a){const o=[],l=n-t,c=s-r;for(const h of v(this,mp)){const f=new Array(h.length);for(let m=0;m<h.length;m+=2)f[m]=t+h[m]*l,f[m+1]=s-h[m+1]*c;o.push(f)}return o}get box(){return v(this,Hv)}get classNamesForOutlining(){return["highlightOutline"]}}Hv=new WeakMap,mp=new WeakMap;class RE extends Wb{newFreeDrawOutline(e,t,r,n,s,a){return new c$(e,t,r,n,s,a)}}class c$ extends iP{newOutliner(e,t,r,n,s,a=0){return new RE(e,t,r,n,s,a)}}var Fa,Hd,gp,Un,Wv,vp,Vv,Gv,Bu,Ma,yp,qv,Lr,NE,DE,LE,Wc,uP,hu;const cs=class cs{constructor({editor:e=null,uiManager:t=null}){q(this,Lr);q(this,Fa,null);q(this,Hd,null);q(this,gp);q(this,Un,null);q(this,Wv,!1);q(this,vp,!1);q(this,Vv,null);q(this,Gv);q(this,Bu,null);q(this,Ma,null);q(this,yp);var r;e?(H(this,vp,!1),H(this,yp,fr.HIGHLIGHT_COLOR),H(this,Vv,e)):(H(this,vp,!0),H(this,yp,fr.HIGHLIGHT_DEFAULT_COLOR)),H(this,Ma,(e==null?void 0:e._uiManager)||t),H(this,Gv,v(this,Ma)._eventBus),H(this,gp,(e==null?void 0:e.color)||((r=v(this,Ma))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),v(cs,qv)||H(cs,qv,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ur(this,"_keyboardManager",new m0([[["Escape","mac+Escape"],cs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],cs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],cs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],cs.prototype._moveToPrevious],[["Home","mac+Home"],cs.prototype._moveToBeginning],[["End","mac+End"],cs.prototype._moveToEnd]]))}renderButton(){const e=H(this,Fa,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=v(this,Ma)._signal;e.addEventListener("click",X(this,Lr,Wc).bind(this),{signal:t}),e.addEventListener("keydown",X(this,Lr,LE).bind(this),{signal:t});const r=H(this,Hd,document.createElement("span"));return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=v(this,gp),e.append(r),e}renderMainDropdown(){const e=H(this,Un,X(this,Lr,NE).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===v(this,Fa)){X(this,Lr,Wc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&X(this,Lr,DE).call(this,t,e)}_moveToNext(e){var t,r;if(!v(this,Lr,hu)){X(this,Lr,Wc).call(this,e);return}if(e.target===v(this,Fa)){(t=v(this,Un).firstChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=v(this,Un))==null?void 0:t.firstChild)||e.target===v(this,Fa)){v(this,Lr,hu)&&this._hideDropdownFromKeyboard();return}v(this,Lr,hu)||X(this,Lr,Wc).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!v(this,Lr,hu)){X(this,Lr,Wc).call(this,e);return}(t=v(this,Un).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!v(this,Lr,hu)){X(this,Lr,Wc).call(this,e);return}(t=v(this,Un).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=v(this,Un))==null||e.classList.add("hidden"),(t=v(this,Bu))==null||t.abort(),H(this,Bu,null)}_hideDropdownFromKeyboard(){var e;if(!v(this,vp)){if(!v(this,Lr,hu)){(e=v(this,Vv))==null||e.unselect();return}this.hideDropdown(),v(this,Fa).focus({preventScroll:!0,focusVisible:v(this,Wv)})}}updateColor(e){if(v(this,Hd)&&(v(this,Hd).style.backgroundColor=e),!v(this,Un))return;const t=v(this,Ma).highlightColors.values();for(const r of v(this,Un).children)r.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=v(this,Fa))==null||e.remove(),H(this,Fa,null),H(this,Hd,null),(t=v(this,Un))==null||t.remove(),H(this,Un,null)}};Fa=new WeakMap,Hd=new WeakMap,gp=new WeakMap,Un=new WeakMap,Wv=new WeakMap,vp=new WeakMap,Vv=new WeakMap,Gv=new WeakMap,Bu=new WeakMap,Ma=new WeakMap,yp=new WeakMap,qv=new WeakMap,Lr=new WeakSet,NE=function(){const e=document.createElement("div"),t=v(this,Ma)._signal;e.addEventListener("contextmenu",ma,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,n]of v(this,Ma).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",n),s.title=r,s.setAttribute("data-l10n-id",v(cs,qv)[r]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=n,s.setAttribute("aria-selected",n===v(this,gp)),s.addEventListener("click",X(this,Lr,DE).bind(this,n),{signal:t}),e.append(s)}return e.addEventListener("keydown",X(this,Lr,LE).bind(this),{signal:t}),e},DE=function(e,t){t.stopPropagation(),v(this,Gv).dispatch("switchannotationeditorparams",{source:this,type:v(this,yp),value:e})},LE=function(e){cs._keyboardManager.exec(this,e)},Wc=function(e){if(v(this,Lr,hu)){this.hideDropdown();return}if(H(this,Wv,e.detail===0),v(this,Bu)||(H(this,Bu,new AbortController),window.addEventListener("pointerdown",X(this,Lr,uP).bind(this),{signal:v(this,Ma).combinedSignal(v(this,Bu))})),v(this,Un)){v(this,Un).classList.remove("hidden");return}const t=H(this,Un,X(this,Lr,NE).call(this));v(this,Fa).append(t)},uP=function(e){var t;(t=v(this,Un))!=null&&t.contains(e.target)||this.hideDropdown()},hu=function(){return v(this,Un)&&!v(this,Un).classList.contains("hidden")},q(cs,qv,null);let Ag=cs;var bp,Yv,xl,Wd,wp,fs,Xv,Kv,Vd,sa,Ls,ui,xp,_l,Ti,_p,aa,Zv,tr,PE,bb,cP,dP,hP,OE,Vc,ca,hf,fP,wb,ng,pP,mP,gP,vP,yP;const Ar=class Ar extends Vr{constructor(t){super({...t,name:"highlightEditor"});q(this,tr);q(this,bp,null);q(this,Yv,0);q(this,xl);q(this,Wd,null);q(this,wp,null);q(this,fs,null);q(this,Xv,null);q(this,Kv,0);q(this,Vd,null);q(this,sa,null);q(this,Ls,null);q(this,ui,!1);q(this,xp,null);q(this,_l);q(this,Ti,null);q(this,_p,"");q(this,aa);q(this,Zv,"");this.color=t.color||Ar._defaultColor,H(this,aa,t.thickness||Ar._defaultThickness),H(this,_l,t.opacity||Ar._defaultOpacity),H(this,xl,t.boxes||null),H(this,Zv,t.methodOfCreation||""),H(this,_p,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(H(this,ui,!0),X(this,tr,bb).call(this,t),X(this,tr,Vc).call(this)):v(this,xl)&&(H(this,bp,t.anchorNode),H(this,Yv,t.anchorOffset),H(this,Xv,t.focusNode),H(this,Kv,t.focusOffset),X(this,tr,PE).call(this),X(this,tr,Vc).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=Ar.prototype;return ur(this,"_keyboardManager",new m0([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:v(this,ui)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:v(this,aa),methodOfCreation:v(this,Zv)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var n;Vr.initialize(t,r),Ar._defaultColor||(Ar._defaultColor=((n=r.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case fr.HIGHLIGHT_DEFAULT_COLOR:Ar._defaultColor=r;break;case fr.HIGHLIGHT_THICKNESS:Ar._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return v(this,xp)}updateParams(t,r){switch(t){case fr.HIGHLIGHT_COLOR:X(this,tr,cP).call(this,r);break;case fr.HIGHLIGHT_THICKNESS:X(this,tr,dP).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[fr.HIGHLIGHT_DEFAULT_COLOR,Ar._defaultColor],[fr.HIGHLIGHT_THICKNESS,Ar._defaultThickness]]}get propertiesToUpdate(){return[[fr.HIGHLIGHT_COLOR,this.color||Ar._defaultColor],[fr.HIGHLIGHT_THICKNESS,v(this,aa)||Ar._defaultThickness],[fr.HIGHLIGHT_FREE,v(this,ui)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(H(this,wp,new Ag({editor:this})),t.addColorPicker(v(this,wp))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(X(this,tr,ng).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,X(this,tr,ng).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){X(this,tr,OE).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(X(this,tr,Vc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var n;let r=!1;this.parent&&!t?X(this,tr,OE).call(this):t&&(X(this,tr,Vc).call(this,t),r=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var s,a,o;const{drawLayer:r}=this.parent;let n;v(this,ui)?(t=(t-this.rotation+360)%360,n=X(s=Ar,ca,hf).call(s,v(this,sa).box,t)):n=X(a=Ar,ca,hf).call(a,[this.x,this.y,this.width,this.height],t),r.updateProperties(v(this,Ls),{bbox:n,root:{"data-main-rotation":t}}),r.updateProperties(v(this,Ti),{bbox:X(o=Ar,ca,hf).call(o,v(this,fs).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();v(this,_p)&&(t.setAttribute("aria-label",v(this,_p)),t.setAttribute("role","mark")),v(this,ui)?t.classList.add("free"):this.div.addEventListener("keydown",X(this,tr,fP).bind(this),{signal:this._uiManager._signal});const r=H(this,Vd,document.createElement("div"));t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=v(this,Wd);const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),MD(this,v(this,Vd),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(v(this,Ti),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(v(this,Ti),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:X(this,tr,wb).call(this,!0);break;case 1:case 3:X(this,tr,wb).call(this,!1);break}}select(){var t;super.select(),v(this,Ti)&&((t=this.parent)==null||t.drawLayer.updateProperties(v(this,Ti),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),v(this,Ti)&&((t=this.parent)==null||t.drawLayer.updateProperties(v(this,Ti),{rootClass:{selected:!1}}),v(this,ui)||X(this,tr,wb).call(this,!1))}get _mustFixPosition(){return!v(this,ui)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(v(this,Ls),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(v(this,Ti),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:n,x:s,y:a}){const{x:o,y:l,width:c,height:h}=n.getBoundingClientRect(),f=new AbortController,m=t.combinedSignal(f),p=x=>{f.abort(),X(this,ca,vP).call(this,t,x)};window.addEventListener("blur",p,{signal:m}),window.addEventListener("pointerup",p,{signal:m}),window.addEventListener("pointerdown",An,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",ma,{signal:m}),n.addEventListener("pointermove",X(this,ca,gP).bind(this,t),{signal:m}),this._freeHighlight=new RE({x:s,y:a},[o,l,c,h],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,n){var g,y,b,_;let s=null;if(t instanceof VL){const{data:{quadPoints:S,rect:k,rotation:C,id:R,color:N,opacity:O,popupRef:I},parent:{page:{pageNumber:F}}}=t;s=t={annotationType:Kt.HIGHLIGHT,color:Array.from(N),opacity:O,quadPoints:S,boxes:null,pageIndex:F-1,rect:k.slice(0),rotation:C,id:R,deleted:!1,popupRef:I}}else if(t instanceof ZS){const{data:{inkLists:S,rect:k,rotation:C,id:R,color:N,borderStyle:{rawWidth:O},popupRef:I},parent:{page:{pageNumber:F}}}=t;s=t={annotationType:Kt.HIGHLIGHT,color:Array.from(N),thickness:O,inkLists:S,boxes:null,pageIndex:F-1,rect:k.slice(0),rotation:C,id:R,deleted:!1,popupRef:I}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,h=await super.deserialize(t,r,n);h.color=jt.makeHexColor(...a),H(h,_l,c||1),l&&H(h,aa,t.thickness),h.annotationElementId=t.id||null,h._initialData=s;const[f,m]=h.pageDimensions,[p,x]=h.pageTranslation;if(o){const S=H(h,xl,[]);for(let k=0;k<o.length;k+=8)S.push({x:(o[k]-p)/f,y:1-(o[k+1]-x)/m,width:(o[k+2]-o[k])/f,height:(o[k+1]-o[k+5])/m});X(g=h,tr,PE).call(g),X(y=h,tr,Vc).call(y),h.rotate(h.rotation)}else if(l){H(h,ui,!0);const S=l[0],k={x:S[0]-p,y:m-(S[1]-x)},C=new RE(k,[0,0,f,m],1,v(h,aa)/2,!0,.001);for(let O=0,I=S.length;O<I;O+=2)k.x=S[O]-p,k.y=m-(S[O+1]-x),C.add(k);const{id:R,clipPathId:N}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);X(b=h,tr,bb).call(b,{highlightOutlines:C.getOutlines(),highlightId:R,clipPathId:N}),X(_=h,tr,Vc).call(_),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=this.getRect(0,0),n=Vr._colorManager.convert(this.color),s={annotationType:Kt.HIGHLIGHT,color:n,opacity:v(this,_l),thickness:v(this,aa),quadPoints:X(this,tr,pP).call(this),outlines:X(this,tr,mP).call(this,r),pageIndex:this.pageIndex,rect:r,rotation:X(this,tr,ng).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!X(this,tr,yP).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};bp=new WeakMap,Yv=new WeakMap,xl=new WeakMap,Wd=new WeakMap,wp=new WeakMap,fs=new WeakMap,Xv=new WeakMap,Kv=new WeakMap,Vd=new WeakMap,sa=new WeakMap,Ls=new WeakMap,ui=new WeakMap,xp=new WeakMap,_l=new WeakMap,Ti=new WeakMap,_p=new WeakMap,aa=new WeakMap,Zv=new WeakMap,tr=new WeakSet,PE=function(){const t=new kE(v(this,xl),.001);H(this,sa,t.getOutlines()),[this.x,this.y,this.width,this.height]=v(this,sa).box;const r=new kE(v(this,xl),.0025,.001,this._uiManager.direction==="ltr");H(this,fs,r.getOutlines());const{lastPoint:n}=v(this,fs);H(this,xp,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},bb=function({highlightOutlines:t,highlightId:r,clipPathId:n}){var f,m;if(H(this,sa,t),H(this,fs,t.getNewOutline(v(this,aa)/2+1.5,.0025)),r>=0)H(this,Ls,r),H(this,Wd,n),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),H(this,Ti,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:v(this,fs).box,path:{d:v(this,fs).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(v(this,Ls),{bbox:X(f=Ar,ca,hf).call(f,v(this,sa).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(v(this,Ti),{bbox:X(m=Ar,ca,hf).call(m,v(this,fs).box,p),path:{d:v(this,fs).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[p,x]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*x/p,this.height=c*p/x;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[p,x]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*x/p,this.height=c*p/x;break}}const{lastPoint:h}=v(this,fs);H(this,xp,[(h[0]-a)/l,(h[1]-o)/c])},cP=function(t){const r=(a,o)=>{var l,c;this.color=a,H(this,_l,o),(l=this.parent)==null||l.drawLayer.updateProperties(v(this,Ls),{root:{fill:a,"fill-opacity":o}}),(c=v(this,wp))==null||c.updateColor(a)},n=this.color,s=v(this,_l);this.addCommands({cmd:r.bind(this,t,Ar._defaultOpacity),undo:r.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fr.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},dP=function(t){const r=v(this,aa),n=s=>{H(this,aa,s),X(this,tr,hP).call(this,s)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fr.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},hP=function(t){if(!v(this,ui))return;X(this,tr,bb).call(this,{highlightOutlines:v(this,sa).getNewOutline(t/2)}),this.fixAndSetPosition();const[r,n]=this.parentDimensions;this.setDims(this.width*r,this.height*n)},OE=function(){v(this,Ls)===null||!this.parent||(this.parent.drawLayer.remove(v(this,Ls)),H(this,Ls,null),this.parent.drawLayer.remove(v(this,Ti)),H(this,Ti,null))},Vc=function(t=this.parent){v(this,Ls)===null&&({id:Bi(this,Ls)._,clipPathId:Bi(this,Wd)._}=t.drawLayer.draw({bbox:v(this,sa).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":v(this,_l)},rootClass:{highlight:!0,free:v(this,ui)},path:{d:v(this,sa).toSVGPath()}},!1,!0),H(this,Ti,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:v(this,ui)},bbox:v(this,fs).box,path:{d:v(this,fs).toSVGPath()}},v(this,ui))),v(this,Vd)&&(v(this,Vd).style.clipPath=v(this,Wd)))},ca=new WeakSet,hf=function([t,r,n,s],a){switch(a){case 90:return[1-r-s,t,s,n];case 180:return[1-t-n,1-r-s,n,s];case 270:return[r,1-t-n,s,n]}return[t,r,n,s]},fP=function(t){Ar._keyboardManager.exec(this,t)},wb=function(t){if(!v(this,bp))return;const r=window.getSelection();t?r.setPosition(v(this,bp),v(this,Yv)):r.setPosition(v(this,Xv),v(this,Kv))},ng=function(){return v(this,ui)?this.rotation:0},pP=function(){if(v(this,ui))return null;const[t,r]=this.pageDimensions,[n,s]=this.pageTranslation,a=v(this,xl),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:h,width:f,height:m}of a){const p=c*t+n,x=(1-h)*r+s;o[l]=o[l+4]=p,o[l+1]=o[l+3]=x,o[l+2]=o[l+6]=p+f*t,o[l+5]=o[l+7]=x-m*r,l+=8}return o},mP=function(t){return v(this,sa).serialize(t,X(this,tr,ng).call(this))},gP=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},vP=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},yP=function(t){const{color:r}=this._initialData;return t.color.some((n,s)=>n!==r[s])},q(Ar,ca),it(Ar,"_defaultColor",null),it(Ar,"_defaultOpacity",1),it(Ar,"_defaultThickness",12),it(Ar,"_type","highlight"),it(Ar,"_editorType",Kt.HIGHLIGHT),it(Ar,"_freeHighlightId",-1),it(Ar,"_freeHighlight",null),it(Ar,"_freeHighlightClipId","");let Vb=Ar;var Gd;class bP{constructor(){q(this,Gd,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){v(this,Gd)[e]=t}toSVGProperties(){const e=v(this,Gd);return H(this,Gd,Object.create(null)),{root:e}}reset(){H(this,Gd,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Pr("Not implemented")}}Gd=new WeakMap;var Ps,Ep,Kn,qd,Yd,zu,$u,Uu,Xd,_r,IE,FE,ME,ig,wP,xb,sg,ff;const Nt=class Nt extends Vr{constructor(t){super(t);q(this,_r);q(this,Ps,null);q(this,Ep);it(this,"_drawId",null);H(this,Ep,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(X(this,_r,IE).call(this,t),X(this,_r,ig).call(this))}static _mergeSVGProperties(t,r){const n=new Set(Object.keys(t));for(const[s,a]of Object.entries(r))n.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){Pr("Not implemented")}static get typesMap(){Pr("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,r),this._currentParent&&(v(Nt,Kn).updateProperty(n,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)t.push([n,r[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[n,s]of this.constructor.typesMap)t.push([n,r[s]]);return t}_updateProperty(t,r,n){const s=this._drawingOptions,a=s[r],o=l=>{var h;s.updateProperty(r,l);const c=v(this,Ps).updateProperty(r,l);c&&X(this,_r,sg).call(this,c),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(v(this,Ps).getPathResizingSVGProperties(X(this,_r,xb).call(this)),{bbox:X(this,_r,ff).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(v(this,Ps).getPathResizedSVGProperties(X(this,_r,xb).call(this)),{bbox:X(this,_r,ff).call(this)}))}_onTranslating(t,r){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{bbox:X(this,_r,ff).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(v(this,Ps).getPathTranslatedSVGProperties(X(this,_r,xb).call(this),this.parentDimensions),{bbox:X(this,_r,ff).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,v(this,Ep)&&(H(this,Ep,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){X(this,_r,ME).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(X(this,_r,ig).call(this),X(this,_r,sg).call(this,v(this,Ps).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var n;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),X(this,_r,ME).call(this)):t&&(this._uiManager.addShouldRescale(this),X(this,_r,ig).call(this,t),r=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties({bbox:X(this,_r,ff).call(this)},v(this,Ps).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&X(this,_r,sg).call(this,v(this,Ps).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,r;this._isCopy&&(t=this.x,r=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,r),n}static createDrawerInstance(t,r,n,s,a){Pr("Not implemented")}static startDrawing(t,r,n,s){var y;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:h}=s;if(v(Nt,$u)&&v(Nt,$u)!==h)return;const{viewport:{rotation:f}}=t,{width:m,height:p}=a.getBoundingClientRect(),x=H(Nt,qd,new AbortController),g=t.combinedSignal(x);if(v(Nt,zu)||H(Nt,zu,c),v(Nt,$u)??H(Nt,$u,h),window.addEventListener("pointerup",b=>{var _;v(Nt,zu)===b.pointerId?this._endDraw(b):(_=v(Nt,Uu))==null||_.delete(b.pointerId)},{signal:g}),window.addEventListener("pointercancel",b=>{var _;v(Nt,zu)===b.pointerId?this._currentParent.endDrawingSession():(_=v(Nt,Uu))==null||_.delete(b.pointerId)},{signal:g}),window.addEventListener("pointerdown",b=>{v(Nt,$u)===b.pointerType&&((v(Nt,Uu)||H(Nt,Uu,new Set)).add(b.pointerId),v(Nt,Kn).isCancellable()&&(v(Nt,Kn).removeLastElement(),v(Nt,Kn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",ma,{signal:g}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),a.addEventListener("touchmove",b=>{b.timeStamp===v(Nt,Xd)&&An(b)},{signal:g}),t.toggleDrawing(),(y=r._editorUndoBar)==null||y.hide(),v(Nt,Kn)){t.drawLayer.updateProperties(this._currentDrawId,v(Nt,Kn).startNew(o,l,m,p,f));return}r.updateUIForDefaultProperties(this),H(Nt,Kn,this.createDrawerInstance(o,l,m,p,f)),H(Nt,Yd,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(v(Nt,Yd).toSVGProperties(),v(Nt,Kn).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(H(Nt,Xd,-1),!v(Nt,Kn))return;const{offsetX:r,offsetY:n,pointerId:s}=t;if(v(Nt,zu)===s){if(((a=v(Nt,Uu))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,v(Nt,Kn).add(r,n)),H(Nt,Xd,t.timeStamp),An(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,H(Nt,Kn,null),H(Nt,Yd,null),H(Nt,$u,null),H(Nt,Xd,NaN)),v(Nt,qd)&&(v(Nt,qd).abort(),H(Nt,qd,null),H(Nt,zu,NaN),H(Nt,Uu,null))}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,v(Nt,Kn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=v(Nt,Kn),s=this._currentDrawId,a=n.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,n.setLastElement(a))},undo:()=>{r.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:fr.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(fr.DRAW_STEP),!v(Nt,Kn).isEmpty()){const{pageDimensions:[n,s],scale:a}=r,o=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:v(Nt,Kn).getOutlines(n*a,s*a,a,this._INNER_MARGIN),drawingOptions:v(Nt,Yd),mustBeCommitted:!t});return this._cleanup(!0),o}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,n,s,a,o){Pr("Not implemented")}static async deserialize(t,r,n){var f,m;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=r.viewport,c=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,t),h=await super.deserialize(t,r,n);return h.createDrawingOptions(t),X(f=h,_r,IE).call(f,{drawOutlines:c}),X(m=h,_r,ig).call(m),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[r,n]=this.pageTranslation,[s,a]=this.pageDimensions;return v(this,Ps).serialize([r,n,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ps=new WeakMap,Ep=new WeakMap,Kn=new WeakMap,qd=new WeakMap,Yd=new WeakMap,zu=new WeakMap,$u=new WeakMap,Uu=new WeakMap,Xd=new WeakMap,_r=new WeakSet,IE=function({drawOutlines:t,drawId:r,drawingOptions:n}){H(this,Ps,t),this._drawingOptions||(this._drawingOptions=n),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=X(this,_r,FE).call(this,t,this.parent),X(this,_r,sg).call(this,t.box)},FE=function(t,r){const{id:n}=r.drawLayer.draw(Nt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n},ME=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},ig=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=X(this,_r,FE).call(this,v(this,Ps),t)}},wP=function([t,r,n,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[r,1-t,n*(o/a),s*(a/o)];case 180:return[1-t,1-r,n,s];case 270:return[1-r,t,n*(o/a),s*(a/o)];default:return[t,r,n,s]}},xb=function(){const{x:t,y:r,width:n,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-r,t,n*(a/o),s*(o/a)];case 180:return[1-t,1-r,n,s];case 270:return[r,1-t,n*(a/o),s*(o/a)];default:return[t,r,n,s]}},sg=function(t){if([this.x,this.y,this.width,this.height]=X(this,_r,wP).call(this,t),this.div){this.fixAndSetPosition();const[r,n]=this.parentDimensions;this.setDims(this.width*r,this.height*n)}this._onResized()},ff=function(){const{x:t,y:r,width:n,height:s,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-r-s,t,s,n];case 2:return[1-t-n,1-r-s,n,s];case 3:return[r,1-t-n,s,n];case 4:return[t,r-n*(l/c),s*(c/l),n*(l/c)];case 5:return[1-r,t,n*(l/c),s*(c/l)];case 6:return[1-t-s*(c/l),1-r,s*(c/l),n*(l/c)];case 7:return[r-n*(l/c),1-t-s*(c/l),n*(l/c),s*(c/l)];case 8:return[t-n,r-s,n,s];case 9:return[1-r,t-n,s,n];case 10:return[1-t,1-r,n,s];case 11:return[r-s,1-t,s,n];case 12:return[t-s*(c/l),r,s*(c/l),n*(l/c)];case 13:return[1-r-n*(l/c),t-s*(c/l),n*(l/c),s*(c/l)];case 14:return[1-t,1-r-n*(l/c),s*(c/l),n*(l/c)];case 15:return[r,1-t,n*(l/c),s*(c/l)];default:return[t,r,n,s]}},it(Nt,"_currentDrawId",-1),it(Nt,"_currentParent",null),q(Nt,Kn,null),q(Nt,qd,null),q(Nt,Yd,null),q(Nt,zu,NaN),q(Nt,$u,null),q(Nt,Uu,null),q(Nt,Xd,NaN),it(Nt,"_INNER_MARGIN",3);let Gb=Nt;var wo,Zn,Qn,Kd,Sp,Ui,ci,oa,Zd,Qd,Jd,Ap,_b;class d${constructor(e,t,r,n,s,a){q(this,Ap);q(this,wo,new Float64Array(6));q(this,Zn);q(this,Qn);q(this,Kd);q(this,Sp);q(this,Ui);q(this,ci,"");q(this,oa,0);q(this,Zd,new y0);q(this,Qd);q(this,Jd);H(this,Qd,r),H(this,Jd,n),H(this,Kd,s),H(this,Sp,a),[e,t]=X(this,Ap,_b).call(this,e,t);const o=H(this,Zn,[NaN,NaN,NaN,NaN,e,t]);H(this,Ui,[e,t]),H(this,Qn,[{line:o,points:v(this,Ui)}]),v(this,wo).set(o,0)}updateProperty(e,t){e==="stroke-width"&&H(this,Sp,t)}isEmpty(){return!v(this,Qn)||v(this,Qn).length===0}isCancellable(){return v(this,Ui).length<=10}add(e,t){[e,t]=X(this,Ap,_b).call(this,e,t);const[r,n,s,a]=v(this,wo).subarray(2,6),o=e-s,l=t-a;return Math.hypot(v(this,Qd)*o,v(this,Jd)*l)<=2?null:(v(this,Ui).push(e,t),isNaN(r)?(v(this,wo).set([s,a,e,t],2),v(this,Zn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(v(this,wo)[0])&&v(this,Zn).splice(6,6),v(this,wo).set([r,n,s,a,e,t],0),v(this,Zn).push(...At.createBezierPoints(r,n,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(v(this,Ui).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,n,s){H(this,Qd,r),H(this,Jd,n),H(this,Kd,s),[e,t]=X(this,Ap,_b).call(this,e,t);const a=H(this,Zn,[NaN,NaN,NaN,NaN,e,t]);H(this,Ui,[e,t]);const o=v(this,Qn).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),v(this,Qn).push({line:a,points:v(this,Ui)}),v(this,wo).set(a,0),H(this,oa,0),this.toSVGPath(),null}getLastElement(){return v(this,Qn).at(-1)}setLastElement(e){return v(this,Qn)?(v(this,Qn).push(e),H(this,Zn,e.line),H(this,Ui,e.points),H(this,oa,0),{path:{d:this.toSVGPath()}}):v(this,Zd).setLastElement(e)}removeLastElement(){if(!v(this,Qn))return v(this,Zd).removeLastElement();v(this,Qn).pop(),H(this,ci,"");for(let e=0,t=v(this,Qn).length;e<t;e++){const{line:r,points:n}=v(this,Qn)[e];H(this,Zn,r),H(this,Ui,n),H(this,oa,0),this.toSVGPath()}return{path:{d:v(this,ci)}}}toSVGPath(){const e=At.svgRound(v(this,Zn)[4]),t=At.svgRound(v(this,Zn)[5]);if(v(this,Ui).length===2)return H(this,ci,`${v(this,ci)} M ${e} ${t} Z`),v(this,ci);if(v(this,Ui).length<=6){const n=v(this,ci).lastIndexOf("M");H(this,ci,`${v(this,ci).slice(0,n)} M ${e} ${t}`),H(this,oa,6)}if(v(this,Ui).length===4){const n=At.svgRound(v(this,Zn)[10]),s=At.svgRound(v(this,Zn)[11]);return H(this,ci,`${v(this,ci)} L ${n} ${s}`),H(this,oa,12),v(this,ci)}const r=[];v(this,oa)===0&&(r.push(`M ${e} ${t}`),H(this,oa,6));for(let n=v(this,oa),s=v(this,Zn).length;n<s;n+=6){const[a,o,l,c,h,f]=v(this,Zn).slice(n,n+6).map(At.svgRound);r.push(`C${a} ${o} ${l} ${c} ${h} ${f}`)}return H(this,ci,v(this,ci)+r.join(" ")),H(this,oa,v(this,Zn).length),v(this,ci)}getOutlines(e,t,r,n){const s=v(this,Qn).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),v(this,Zd).build(v(this,Qn),e,t,r,v(this,Kd),v(this,Sp),n),H(this,wo,null),H(this,Zn,null),H(this,Qn,null),H(this,ci,null),v(this,Zd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}wo=new WeakMap,Zn=new WeakMap,Qn=new WeakMap,Kd=new WeakMap,Sp=new WeakMap,Ui=new WeakMap,ci=new WeakMap,oa=new WeakMap,Zd=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,Ap=new WeakSet,_b=function(e,t){return At._normalizePoint(e,t,v(this,Qd),v(this,Jd),v(this,Kd))};var Hi,Qv,Jv,Os,xo,_o,Cp,kp,eh,hi,Ko,xP,_P,EP;class y0 extends At{constructor(){super(...arguments);q(this,hi);q(this,Hi);q(this,Qv,0);q(this,Jv);q(this,Os);q(this,xo);q(this,_o);q(this,Cp);q(this,kp);q(this,eh)}build(t,r,n,s,a,o,l){H(this,xo,r),H(this,_o,n),H(this,Cp,s),H(this,kp,a),H(this,eh,o),H(this,Jv,l??0),H(this,Os,t),X(this,hi,_P).call(this)}get thickness(){return v(this,eh)}setLastElement(t){return v(this,Os).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return v(this,Os).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of v(this,Os)){if(t.push(`M${At.svgRound(r[4])} ${At.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12&&isNaN(r[6])){t.push(`L${At.svgRound(r[10])} ${At.svgRound(r[11])}`);continue}for(let n=6,s=r.length;n<s;n+=6){const[a,o,l,c,h,f]=r.subarray(n,n+6).map(At.svgRound);t.push(`C${a} ${o} ${l} ${c} ${h} ${f}`)}}return t.join("")}serialize([t,r,n,s],a){const o=[],l=[],[c,h,f,m]=X(this,hi,xP).call(this);let p,x,g,y,b,_,S,k,C;switch(v(this,kp)){case 0:C=At._rescale,p=t,x=r+s,g=n,y=-s,b=t+c*n,_=r+(1-h-m)*s,S=t+(c+f)*n,k=r+(1-h)*s;break;case 90:C=At._rescaleAndSwap,p=t,x=r,g=n,y=s,b=t+h*n,_=r+c*s,S=t+(h+m)*n,k=r+(c+f)*s;break;case 180:C=At._rescale,p=t+n,x=r,g=-n,y=s,b=t+(1-c-f)*n,_=r+h*s,S=t+(1-c)*n,k=r+(h+m)*s;break;case 270:C=At._rescaleAndSwap,p=t+n,x=r+s,g=-n,y=-s,b=t+(1-h-m)*n,_=r+(1-c-f)*s,S=t+(1-h)*n,k=r+(1-c)*s;break}for(const{line:R,points:N}of v(this,Os))o.push(C(R,p,x,g,y,a?new Array(R.length):null)),l.push(C(N,p,x,g,y,a?new Array(N.length):null));return{lines:o,points:l,rect:[b,_,S,k]}}static deserialize(t,r,n,s,a,{paths:{lines:o,points:l},rotation:c,thickness:h}){const f=[];let m,p,x,g,y;switch(c){case 0:y=At._rescale,m=-t/n,p=r/s+1,x=1/n,g=-1/s;break;case 90:y=At._rescaleAndSwap,m=-r/s,p=-t/n,x=1/s,g=1/n;break;case 180:y=At._rescale,m=t/n+1,p=-r/s,x=-1/n,g=1/s;break;case 270:y=At._rescaleAndSwap,m=r/s+1,p=t/n+1,x=-1/s,g=-1/n;break}if(!o){o=[];for(const _ of l){const S=_.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const k=new Float32Array(3*(S-2));o.push(k);let[C,R,N,O]=_.subarray(0,4);k.set([NaN,NaN,NaN,NaN,C,R],0);for(let I=4;I<S;I+=2){const F=_[I],G=_[I+1];k.set(At.createBezierPoints(C,R,N,O,F,G),(I-2)*3),[C,R,N,O]=[N,O,F,G]}}}for(let _=0,S=o.length;_<S;_++)f.push({line:y(o[_].map(k=>k??NaN),m,p,x,g),points:y(l[_].map(k=>k??NaN),m,p,x,g)});const b=new this.prototype.constructor;return b.build(f,n,s,1,c,h,a),b}get box(){return v(this,Hi)}updateProperty(t,r){return t==="stroke-width"?X(this,hi,EP).call(this,r):null}updateParentDimensions([t,r],n){const[s,a]=X(this,hi,Ko).call(this);H(this,xo,t),H(this,_o,r),H(this,Cp,n);const[o,l]=X(this,hi,Ko).call(this),c=o-s,h=l-a,f=v(this,Hi);return f[0]-=c,f[1]-=h,f[2]+=2*c,f[3]+=2*h,f}updateRotation(t){return H(this,Qv,t),{path:{transform:this.rotationTransform}}}get viewBox(){return v(this,Hi).map(At.svgRound).join(" ")}get defaultProperties(){const[t,r]=v(this,Hi);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${At.svgRound(t)} ${At.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=v(this,Hi);let n=0,s=0,a=0,o=0,l=0,c=0;switch(v(this,Qv)){case 90:s=r/t,a=-t/r,l=t;break;case 180:n=-1,o=-1,l=t,c=r;break;case 270:s=-r/t,a=t/r,c=r;break;default:return""}return`matrix(${n} ${s} ${a} ${o} ${At.svgRound(l)} ${At.svgRound(c)})`}getPathResizingSVGProperties([t,r,n,s]){const[a,o]=X(this,hi,Ko).call(this),[l,c,h,f]=v(this,Hi);if(Math.abs(h-a)<=At.PRECISION||Math.abs(f-o)<=At.PRECISION){const y=t+n/2-(l+h/2),b=r+s/2-(c+f/2);return{path:{"transform-origin":`${At.svgRound(t)} ${At.svgRound(r)}`,transform:`${this.rotationTransform} translate(${y} ${b})`}}}const m=(n-2*a)/(h-2*a),p=(s-2*o)/(f-2*o),x=h/n,g=f/s;return{path:{"transform-origin":`${At.svgRound(l)} ${At.svgRound(c)}`,transform:`${this.rotationTransform} scale(${x} ${g}) translate(${At.svgRound(a)} ${At.svgRound(o)}) scale(${m} ${p}) translate(${At.svgRound(-a)} ${At.svgRound(-o)})`}}}getPathResizedSVGProperties([t,r,n,s]){const[a,o]=X(this,hi,Ko).call(this),l=v(this,Hi),[c,h,f,m]=l;if(l[0]=t,l[1]=r,l[2]=n,l[3]=s,Math.abs(f-a)<=At.PRECISION||Math.abs(m-o)<=At.PRECISION){const b=t+n/2-(c+f/2),_=r+s/2-(h+m/2);for(const{line:S,points:k}of v(this,Os))At._translate(S,b,_,S),At._translate(k,b,_,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${At.svgRound(t)} ${At.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(n-2*a)/(f-2*a),x=(s-2*o)/(m-2*o),g=-p*(c+a)+t+a,y=-x*(h+o)+r+o;if(p!==1||x!==1||g!==0||y!==0)for(const{line:b,points:_}of v(this,Os))At._rescale(b,g,y,p,x,b),At._rescale(_,g,y,p,x,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${At.svgRound(t)} ${At.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],n){const[s,a]=n,o=v(this,Hi),l=t-o[0],c=r-o[1];if(v(this,xo)===s&&v(this,_o)===a)for(const{line:h,points:f}of v(this,Os))At._translate(h,l,c,h),At._translate(f,l,c,f);else{const h=v(this,xo)/s,f=v(this,_o)/a;H(this,xo,s),H(this,_o,a);for(const{line:m,points:p}of v(this,Os))At._rescale(m,l,c,h,f,m),At._rescale(p,l,c,h,f,p);o[2]*=h,o[3]*=f}return o[0]=t,o[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${At.svgRound(t)} ${At.svgRound(r)}`}}}get defaultSVGProperties(){const t=v(this,Hi);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${At.svgRound(t[0])} ${At.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Hi=new WeakMap,Qv=new WeakMap,Jv=new WeakMap,Os=new WeakMap,xo=new WeakMap,_o=new WeakMap,Cp=new WeakMap,kp=new WeakMap,eh=new WeakMap,hi=new WeakSet,Ko=function(t=v(this,eh)){const r=v(this,Jv)+t/2*v(this,Cp);return v(this,kp)%180===0?[r/v(this,xo),r/v(this,_o)]:[r/v(this,_o),r/v(this,xo)]},xP=function(){const[t,r,n,s]=v(this,Hi),[a,o]=X(this,hi,Ko).call(this,0);return[t+a,r+o,n-2*a,s-2*o]},_P=function(){const t=H(this,Hi,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of v(this,Os)){if(s.length<=12){for(let l=4,c=s.length;l<c;l+=6)jt.pointBoundingBox(s[l],s[l+1],t);continue}let a=s[4],o=s[5];for(let l=6,c=s.length;l<c;l+=6){const[h,f,m,p,x,g]=s.subarray(l,l+6);jt.bezierBoundingBox(a,o,h,f,m,p,x,g,t),a=x,o=g}}const[r,n]=X(this,hi,Ko).call(this);t[0]=Ni(t[0]-r,0,1),t[1]=Ni(t[1]-n,0,1),t[2]=Ni(t[2]+r,0,1),t[3]=Ni(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]},EP=function(t){const[r,n]=X(this,hi,Ko).call(this);H(this,eh,t);const[s,a]=X(this,hi,Ko).call(this),[o,l]=[s-r,a-n],c=v(this,Hi);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class Hw extends bP{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Vr._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Hw(this._viewParameters);return e.updateAll(this),e}}var gw,SP;const bf=class bf extends Gb{constructor(t){super({...t,name:"inkEditor"});q(this,gw);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,r){Vr.initialize(t,r),this._defaultDrawingOptions=new Hw(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return ur(this,"typesMap",new Map([[fr.INK_THICKNESS,"stroke-width"],[fr.INK_COLOR,"stroke"],[fr.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,n,s,a){return new d$(t,r,n,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,n,s,a,o){return y0.deserialize(t,r,n,s,a,o)}static async deserialize(t,r,n){let s=null;if(t instanceof ZS){const{data:{inkLists:o,rect:l,rotation:c,id:h,color:f,opacity:m,borderStyle:{rawWidth:p},popupRef:x},parent:{page:{pageNumber:g}}}=t;s=t={annotationType:Kt.INK,color:Array.from(f),thickness:p,opacity:m,paths:{points:o},boxes:null,pageIndex:g-1,rect:l.slice(0),rotation:c,id:h,deleted:!1,popupRef:x}}const a=await super.deserialize(t,r,n);return a.annotationElementId=t.id||null,a._initialData=s,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:n}=this;r.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:n}){this._drawingOptions=bf.getDefaultDrawingOptions({stroke:jt.makeHexColor(...t),"stroke-width":r,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:n,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:Kt.INK,color:Vr._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:r,points:n},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(c.isCopy=!0,c):this.annotationElementId&&!X(this,gw,SP).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:r,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:r}),null}};gw=new WeakSet,SP=function(t){const{color:r,thickness:n,opacity:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==r[l])||t.thickness!==n||t.opacity!==s||t.pageIndex!==a},it(bf,"_type","ink"),it(bf,"_editorType",Kt.INK),it(bf,"_defaultDrawingOptions",null);let jE=bf;class BE extends y0{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Uy=8,Fm=3;var th,Tr,zE,ja,AP,CP,$E,Eb,kP,TP,RP,UE,HE,NP;class Co{static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:n},s,a,o,l){let c=new OffscreenCanvas(1,1),h=c.getContext("2d",{alpha:!1});const f=200,m=h.font=`${r} ${n} ${f}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:x,actualBoundingBoxAscent:g,actualBoundingBoxDescent:y,fontBoundingBoxAscent:b,fontBoundingBoxDescent:_,width:S}=h.measureText(e),k=1.5,C=Math.ceil(Math.max(Math.abs(p)+Math.abs(x)||0,S)*k),R=Math.ceil(Math.max(Math.abs(g)+Math.abs(y)||f,Math.abs(b)+Math.abs(_)||f)*k);c=new OffscreenCanvas(C,R),h=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=m,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,C,R),h.fillStyle="black",h.fillText(e,C*(k-1)/2,R*(3-k)/2);const N=X(this,Tr,UE).call(this,h.getImageData(0,0,C,R).data),O=X(this,Tr,RP).call(this,N),I=X(this,Tr,HE).call(this,O),F=X(this,Tr,$E).call(this,N,C,R,I);return this.processDrawnLines({lines:{curves:F,width:C,height:R},pageWidth:s,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,r,n,s){const[a,o,l]=X(this,Tr,NP).call(this,e),[c,h]=X(this,Tr,TP).call(this,a,o,l,Math.hypot(o,l)*v(this,th).sigmaSFactor,v(this,th).sigmaR,v(this,th).kernelSize),f=X(this,Tr,HE).call(this,h),m=X(this,Tr,$E).call(this,c,o,l,f);return this.processDrawnLines({lines:{curves:m,width:o,height:l},pageWidth:t,pageHeight:r,rotation:n,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:n,innerMargin:s,mustSmooth:a,areContours:o}){n%180!==0&&([t,r]=[r,t]);const{curves:l,width:c,height:h}=e,f=e.thickness??0,m=[],p=Math.min(t/c,r/h),x=p/t,g=p/r,y=[];for(const{points:_}of l){const S=a?X(this,Tr,kP).call(this,_):_;if(!S)continue;y.push(S);const k=S.length,C=new Float32Array(k),R=new Float32Array(3*(k===2?2:k-2));if(m.push({line:R,points:C}),k===2){C[0]=S[0]*x,C[1]=S[1]*g,R.set([NaN,NaN,NaN,NaN,C[0],C[1]],0);continue}let[N,O,I,F]=S;N*=x,O*=g,I*=x,F*=g,C.set([N,O,I,F],0),R.set([NaN,NaN,NaN,NaN,N,O],0);for(let G=4;G<k;G+=2){const B=C[G]=S[G]*x,Y=C[G+1]=S[G+1]*g;R.set(At.createBezierPoints(N,O,I,F,B,Y),(G-2)*3),[N,O,I,F]=[I,F,B,Y]}}if(m.length===0)return null;const b=o?new BE:new y0;return b.build(m,t,r,1,n,o?0:f,s),{outline:b,newCurves:y,areContours:o,thickness:f,width:c,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:n,height:s}){let a=1/0,o=-1/0,l=0;for(const S of e){l+=S.length;for(let k=2,C=S.length;k<C;k++){const R=S[k]-S[k-2];a=Math.min(a,R),o=Math.max(o,R)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const h=e.length,f=Uy+Fm*h,m=new Uint32Array(f);let p=0;m[p++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*c.BYTES_PER_ELEMENT,m[p++]=0,m[p++]=n,m[p++]=s,m[p++]=t?0:1,m[p++]=Math.max(0,Math.floor(r??0)),m[p++]=h,m[p++]=c.BYTES_PER_ELEMENT;for(const S of e)m[p++]=S.length-2,m[p++]=S[0],m[p++]=S[1];const x=new CompressionStream("deflate-raw"),g=x.writable.getWriter();await g.ready,g.write(m);const y=c.prototype.constructor;for(const S of e){const k=new y(S.length-2);for(let C=2,R=S.length;C<R;C++)k[C-2]=S[C]-S[C-2];g.write(k)}g.close();const b=await new Response(x.readable).arrayBuffer(),_=new Uint8Array(b);return CD(_)}static async decompressSignature(e){try{const t=$z(e),{readable:r,writable:n}=new DecompressionStream("deflate-raw"),s=n.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,o=0;for await(const S of r)a||(a=new Uint8Array(new Uint32Array(S.buffer,0,4)[0])),a.set(S,o),o+=S.length;const l=new Uint32Array(a.buffer,0,a.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const h=l[2],f=l[3],m=l[4]===0,p=l[5],x=l[6],g=l[7],y=[],b=(Uy+Fm*x)*Uint32Array.BYTES_PER_ELEMENT;let _;switch(g){case Int8Array.BYTES_PER_ELEMENT:_=new Int8Array(a.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:_=new Int16Array(a.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:_=new Int32Array(a.buffer,b);break}o=0;for(let S=0;S<x;S++){const k=l[Fm*S+Uy],C=new Float32Array(k+2);y.push(C);for(let R=0;R<Fm-1;R++)C[R]=l[Fm*S+Uy+R+1];for(let R=0;R<k;R++)C[R+2]=C[R]+_[o++]}return{areContours:m,thickness:p,outlines:y,width:h,height:f}}catch(t){return Qt(`decompressSignature: ${t}`),null}}}th=new WeakMap,Tr=new WeakSet,zE=function(e,t,r,n){return r-=e,n-=t,r===0?n>0?0:4:r===1?n+6:2-n},ja=new WeakMap,AP=function(e,t,r,n,s,a,o){const l=X(this,Tr,zE).call(this,r,n,s,a);for(let c=0;c<8;c++){const h=(-c+l-o+16)%8,f=v(this,ja)[2*h],m=v(this,ja)[2*h+1];if(e[(r+f)*t+(n+m)]!==0)return h}return-1},CP=function(e,t,r,n,s,a,o){const l=X(this,Tr,zE).call(this,r,n,s,a);for(let c=0;c<8;c++){const h=(c+l+o+16)%8,f=v(this,ja)[2*h],m=v(this,ja)[2*h+1];if(e[(r+f)*t+(n+m)]!==0)return h}return-1},$E=function(e,t,r,n){const s=e.length,a=new Int32Array(s);for(let h=0;h<s;h++)a[h]=e[h]<=n?1:0;for(let h=1;h<r-1;h++)a[h*t]=a[h*t+t-1]=0;for(let h=0;h<t;h++)a[h]=a[t*r-1-h]=0;let o=1,l;const c=[];for(let h=1;h<r-1;h++){l=1;for(let f=1;f<t-1;f++){const m=h*t+f,p=a[m];if(p===0)continue;let x=h,g=f;if(p===1&&a[m-1]===0)o+=1,g-=1;else if(p>=1&&a[m+1]===0)o+=1,g+=1,p>1&&(l=p);else{p!==1&&(l=Math.abs(p));continue}const y=[f,h],b=g===f+1,_={isHole:b,points:y,id:o,parent:0};c.push(_);let S;for(const G of c)if(G.id===l){S=G;break}S?S.isHole?_.parent=b?S.parent:l:_.parent=b?l:S.parent:_.parent=b?l:0;const k=X(this,Tr,AP).call(this,a,t,h,f,x,g,0);if(k===-1){a[m]=-o,a[m]!==1&&(l=Math.abs(a[m]));continue}let C=v(this,ja)[2*k],R=v(this,ja)[2*k+1];const N=h+C,O=f+R;x=N,g=O;let I=h,F=f;for(;;){const G=X(this,Tr,CP).call(this,a,t,I,F,x,g,1);C=v(this,ja)[2*G],R=v(this,ja)[2*G+1];const B=I+C,Y=F+R;y.push(Y,B);const j=I*t+F;if(a[j+1]===0?a[j]=-o:a[j]===1&&(a[j]=o),B===h&&Y===f&&I===N&&F===O){a[m]!==1&&(l=Math.abs(a[m]));break}else x=I,g=F,I=B,F=Y}}}return c},Eb=function(e,t,r,n){if(r-t<=4){for(let N=t;N<r-2;N+=2)n.push(e[N],e[N+1]);return}const s=e[t],a=e[t+1],o=e[r-4]-s,l=e[r-3]-a,c=Math.hypot(o,l),h=o/c,f=l/c,m=h*a-f*s,p=l/o,x=1/c,g=Math.atan(p),y=Math.cos(g),b=Math.sin(g),_=x*(Math.abs(y)+Math.abs(b)),S=x*(1-_+_**2),k=Math.max(Math.atan(Math.abs(b+y)*S),Math.atan(Math.abs(b-y)*S));let C=0,R=t;for(let N=t+2;N<r-2;N+=2){const O=Math.abs(m-h*e[N+1]+f*e[N]);O>C&&(R=N,C=O)}C>(c*k)**2?(X(this,Tr,Eb).call(this,e,t,R+2,n),X(this,Tr,Eb).call(this,e,R,r,n)):n.push(s,a)},kP=function(e){const t=[],r=e.length;return X(this,Tr,Eb).call(this,e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t},TP=function(e,t,r,n,s,a){const o=new Float32Array(a**2),l=-2*n**2,c=a>>1;for(let g=0;g<a;g++){const y=(g-c)**2;for(let b=0;b<a;b++)o[g*a+b]=Math.exp((y+(b-c)**2)/l)}const h=new Float32Array(256),f=-2*s**2;for(let g=0;g<256;g++)h[g]=Math.exp(g**2/f);const m=e.length,p=new Uint8Array(m),x=new Uint32Array(256);for(let g=0;g<r;g++)for(let y=0;y<t;y++){const b=g*t+y,_=e[b];let S=0,k=0;for(let R=0;R<a;R++){const N=g+R-c;if(!(N<0||N>=r))for(let O=0;O<a;O++){const I=y+O-c;if(I<0||I>=t)continue;const F=e[N*t+I],G=o[R*a+O]*h[Math.abs(F-_)];S+=F*G,k+=G}}const C=p[b]=Math.round(S/k);x[C]++}return[p,x]},RP=function(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t},UE=function(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let n=-1/0,s=1/0;for(let o=0,l=r.length;o<l;o++){if(e[(o<<2)+3]===0){n=r[o]=255;continue}const h=r[o]=e[o<<2];h>n&&(n=h),h<s&&(s=h)}const a=255/(n-s);for(let o=0;o<t;o++)r[o]=(r[o]-s)*a;return r},HE=function(e){let t,r=-1/0,n=-1/0;const s=e.findIndex(l=>l!==0);let a=s,o=s;for(t=s;t<256;t++){const l=e[t];l>r&&(t-a>n&&(n=t-a,o=t-1),r=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},NP=function(e){const t=e,{width:r,height:n}=e,{maxDim:s}=v(this,th);let a=r,o=n;if(r>s||n>s){let m=r,p=n,x=Math.log2(Math.max(r,n)/s);const g=Math.floor(x);x=x===g?g-1:g;for(let b=0;b<x;b++){a=Math.ceil(m/2),o=Math.ceil(p/2);const _=new OffscreenCanvas(a,o);_.getContext("2d").drawImage(e,0,0,m,p,0,0,a,o),m=a,p=o,e!==t&&e.close(),e=_.transferToImageBitmap()}const y=Math.min(s/a,s/o);a=Math.round(a*y),o=Math.round(o*y)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,o);const h=c.getImageData(0,0,a,o).data;return[X(this,Tr,UE).call(this,h),a,o]},q(Co,Tr),q(Co,th,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),q(Co,ja,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class JS extends bP{constructor(){super(),super.updateProperties({fill:Vr._defaultLineColor,"stroke-width":0})}clone(){const e=new JS;return e.updateAll(this),e}}class eA extends Hw{constructor(e){super(e),super.updateProperties({stroke:Vr._defaultLineColor,"stroke-width":1})}clone(){const e=new eA(this._viewParameters);return e.updateAll(this),e}}var Hu,Is,Wu,Vu;const Es=class Es extends Gb{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});q(this,Hu,!1);q(this,Is,null);q(this,Wu,null);q(this,Vu,null);this._willKeepAspectRatio=!0,H(this,Wu,t.signatureData||null),H(this,Is,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,r){Vr.initialize(t,r),this._defaultDrawingOptions=new JS,this._defaultDrawnSignatureOptions=new eA(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return ur(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!v(this,Is)}}static computeTelemetryFinalData(t){const r=t.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,r;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,r=this.y),super.render(),this._drawId===null)if(v(this,Wu)){const{lines:s,mustSmooth:a,areContours:o,description:l,uuid:c,heightInPage:h}=v(this,Wu),{rawDims:{pageWidth:f,pageHeight:m},rotation:p}=this.parent.viewport,x=Co.processDrawnLines({lines:s,pageWidth:f,pageHeight:m,rotation:p,innerMargin:Es._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(x,h,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return n&&(this._isCopy=!0,this._moveAfterPaste(t,r)),this.div}setUuid(t){H(this,Vu,t),this.addEditToolbar()}getUuid(){return v(this,Vu)}get description(){return v(this,Is)}set description(t){H(this,Is,t),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:r,thickness:n,width:s,height:a}=v(this,Wu),o=Math.max(s,a),l=Co.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:n,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&v(this,Is)!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,v(this,Vu),v(this,Is)),t.show()),t):null}addSignature(t,r,n,s){const{x:a,y:o}=this,{outline:l}=H(this,Wu,t);H(this,Hu,l instanceof BE),H(this,Is,n),this.div.setAttribute("data-l10n-args",JSON.stringify({description:n}));let c;v(this,Hu)?c=Es.getDefaultDrawingOptions():(c=Es._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[h,f]=this.parentDimensions,[,m]=this.pageDimensions;let p=r/m;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(h*this.width,f*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:r,pageHeight:n},rotation:s}=this.parent.viewport;return Co.process(t,r,n,s,Es._INNER_MARGIN)}getFromText(t,r){const{rawDims:{pageWidth:n,pageHeight:s},rotation:a}=this.parent.viewport;return Co.extractContoursFromText(t,r,n,s,a,Es._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:r,pageHeight:n},rotation:s}=this.parent.viewport;return Co.processDrawnLines({lines:t,pageWidth:r,pageHeight:n,rotation:s,innerMargin:Es._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:r}){t?this._drawingOptions=Es.getDefaultDrawingOptions():(this._drawingOptions=Es._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:r,points:n,rect:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:Kt.SIGNATURE,isSignature:!0,areContours:v(this,Hu),color:[0,0,0],thickness:v(this,Hu)?0:a,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.paths={lines:r,points:n},o.uuid=v(this,Vu),o.isCopy=!0):o.lines=r,v(this,Is)&&(o.accessibilityData={type:"Figure",alt:v(this,Is)}),o}static deserializeDraw(t,r,n,s,a,o){return o.areContours?BE.deserialize(t,r,n,s,a,o):y0.deserialize(t,r,n,s,a,o)}static async deserialize(t,r,n){var a;const s=await super.deserialize(t,r,n);return H(s,Hu,t.areContours),H(s,Is,((a=t.accessibilityData)==null?void 0:a.alt)||""),H(s,Vu,t.uuid),s}};Hu=new WeakMap,Is=new WeakMap,Wu=new WeakMap,Vu=new WeakMap,it(Es,"_type","signature"),it(Es,"_editorType",Kt.SIGNATURE),it(Es,"_defaultDrawingOptions",null);let WE=Es;var en,Jn,Gu,El,qu,Tp,Sl,rh,Eo,Fs,Rp,Er,ag,og,Sb,Ab,Cb,GE,kb,DP;class VE extends Vr{constructor(t){super({...t,name:"stampEditor"});q(this,Er);q(this,en,null);q(this,Jn,null);q(this,Gu,null);q(this,El,null);q(this,qu,null);q(this,Tp,"");q(this,Sl,null);q(this,rh,!1);q(this,Eo,null);q(this,Fs,!1);q(this,Rp,!1);H(this,El,t.bitmapUrl),H(this,qu,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,r){Vr.initialize(t,r)}static isHandlingMimeForPasting(t){return Ub.includes(t)}static paste(t,r){r.pasteEditor({mode:Kt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await n.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),r&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;v(this,Jn)&&(H(this,en,null),this._uiManager.imageManager.deleteId(v(this,Jn)),(t=v(this,Sl))==null||t.remove(),H(this,Sl,null),v(this,Eo)&&(clearTimeout(v(this,Eo)),H(this,Eo,null))),super.remove()}rebuild(){if(!this.parent){v(this,Jn)&&X(this,Er,Sb).call(this);return}super.rebuild(),this.div!==null&&(v(this,Jn)&&v(this,Sl)===null&&X(this,Er,Sb).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(v(this,Gu)||v(this,en)||v(this,El)||v(this,qu)||v(this,Jn)||v(this,rh))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;return this._isCopy&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),v(this,rh)||(v(this,en)?X(this,Er,Ab).call(this):X(this,Er,Sb).call(this)),this._isCopy&&this._moveAfterPaste(t,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,r){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,r);r.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(H(this,Jn,n),s&&H(this,en,s),H(this,rh,!1),X(this,Er,Ab).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;v(this,Eo)!==null&&clearTimeout(v(this,Eo)),H(this,Eo,setTimeout(()=>{H(this,Eo,null),X(this,Er,GE).call(this)},200))}copyCanvas(t,r,n=!1){var p;t||(t=224);const{width:s,height:a}=v(this,en),o=new qa;let l=v(this,en),c=s,h=a,f=null;if(r){if(s>r||a>r){const O=Math.min(r/s,r/a);c=Math.floor(s*O),h=Math.floor(a*O)}f=document.createElement("canvas");const x=f.width=Math.ceil(c*o.sx),g=f.height=Math.ceil(h*o.sy);v(this,Fs)||(l=X(this,Er,Cb).call(this,x,g));const y=f.getContext("2d");y.filter=this._uiManager.hcmFilter;let b="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",_="#42414d");const S=15,k=S*o.sx,C=S*o.sy,R=new OffscreenCanvas(k*2,C*2),N=R.getContext("2d");N.fillStyle=b,N.fillRect(0,0,k*2,C*2),N.fillStyle=_,N.fillRect(0,0,k,C),N.fillRect(k,C,k,C),y.fillStyle=y.createPattern(R,"repeat"),y.fillRect(0,0,x,g),y.drawImage(l,0,0,l.width,l.height,0,0,x,g)}let m=null;if(n){let x,g;if(o.symmetric&&l.width<t&&l.height<t)x=l.width,g=l.height;else if(l=v(this,en),s>t||a>t){const _=Math.min(t/s,t/a);x=Math.floor(s*_),g=Math.floor(a*_),v(this,Fs)||(l=X(this,Er,Cb).call(this,x,g))}const b=new OffscreenCanvas(x,g).getContext("2d",{willReadFrequently:!0});b.drawImage(l,0,0,l.width,l.height,0,0,x,g),m={width:x,height:g,data:b.getImageData(0,0,x,g).data}}return{canvas:f,width:c,height:h,imageData:m}}static async deserialize(t,r,n){var y;let s=null,a=!1;if(t instanceof GL){const{data:{rect:b,rotation:_,id:S,structParent:k,popupRef:C},container:R,parent:{page:{pageNumber:N}},canvas:O}=t;let I,F;O?(delete t.canvas,{id:I,bitmap:F}=n.imageManager.getFromCanvas(R.id,O),O.remove()):(a=!0,t._hasNoCanvas=!0);const G=((y=await r._structTree.getAriaAttributes(`${HS}${S}`))==null?void 0:y.get("aria-label"))||"";s=t={annotationType:Kt.STAMP,bitmapId:I,bitmap:F,pageIndex:N-1,rect:b.slice(0),rotation:_,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:G},isSvg:!1,structParent:k,popupRef:C}}const o=await super.deserialize(t,r,n),{rect:l,bitmap:c,bitmapUrl:h,bitmapId:f,isSvg:m,accessibilityData:p}=t;a?(n.addMissingCanvas(t.id,o),H(o,rh,!0)):f&&n.imageManager.isValidId(f)?(H(o,Jn,f),c&&H(o,en,c)):H(o,El,h),H(o,Fs,m);const[x,g]=o.pageDimensions;return o.width=(l[2]-l[0])/x,o.height=(l[3]-l[1])/g,o.annotationElementId=t.id||null,p&&(o.altTextData=p),o._initialData=s,H(o,Rp,!!s),o}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Kt.STAMP,bitmapId:v(this,Jn),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:v(this,Fs),structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=X(this,Er,kb).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=X(this,Er,DP).call(this,n);if(l.isSame)return null;l.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,r===null)return n;r.stamps||(r.stamps=new Map);const o=v(this,Fs)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!r.stamps.has(v(this,Jn)))r.stamps.set(v(this,Jn),{area:o,serialized:n}),n.bitmap=X(this,Er,kb).call(this,!1);else if(v(this,Fs)){const l=r.stamps.get(v(this,Jn));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=X(this,Er,kb).call(this,!1))}return n}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}en=new WeakMap,Jn=new WeakMap,Gu=new WeakMap,El=new WeakMap,qu=new WeakMap,Tp=new WeakMap,Sl=new WeakMap,rh=new WeakMap,Eo=new WeakMap,Fs=new WeakMap,Rp=new WeakMap,Er=new WeakSet,ag=function(t,r=!1){if(!t){this.remove();return}H(this,en,t.bitmap),r||(H(this,Jn,t.id),H(this,Fs,t.isSvg)),t.file&&H(this,Tp,t.file.name),X(this,Er,Ab).call(this)},og=function(){if(H(this,Gu,null),this._uiManager.enableWaiting(!1),!!v(this,Sl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&v(this,en)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&v(this,en)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Sb=function(){if(v(this,Jn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(v(this,Jn)).then(n=>X(this,Er,ag).call(this,n,!0)).finally(()=>X(this,Er,og).call(this));return}if(v(this,El)){const n=v(this,El);H(this,El,null),this._uiManager.enableWaiting(!0),H(this,Gu,this._uiManager.imageManager.getFromUrl(n).then(s=>X(this,Er,ag).call(this,s)).finally(()=>X(this,Er,og).call(this)));return}if(v(this,qu)){const n=v(this,qu);H(this,qu,null),this._uiManager.enableWaiting(!0),H(this,Gu,this._uiManager.imageManager.getFromFile(n).then(s=>X(this,Er,ag).call(this,s)).finally(()=>X(this,Er,og).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Ub.join(",");const r=this._uiManager._signal;H(this,Gu,new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),X(this,Er,ag).call(this,s)}n()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:r})}).finally(()=>X(this,Er,og).call(this))),t.click()},Ab=function(){var f;const{div:t}=this;let{width:r,height:n}=v(this,en);const[s,a]=this.pageDimensions,o=.75;if(this.width)r=this.width*s,n=this.height*a;else if(r>o*s||n>o*a){const m=Math.min(o*s/r,o*a/n);r*=m,n*=m}const[l,c]=this.parentDimensions;this.setDims(r*l/s,n*c/a),this._uiManager.enableWaiting(!1);const h=H(this,Sl,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=r/s,this.height=n/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),X(this,Er,GE).call(this),v(this,Rp)||(this.parent.addUndoableEditor(this),H(this,Rp,!0)),this._reportTelemetry({action:"inserted_image"}),v(this,Tp)&&this.div.setAttribute("aria-description",v(this,Tp))},Cb=function(t,r){const{width:n,height:s}=v(this,en);let a=n,o=s,l=v(this,en);for(;a>2*t||o>2*r;){const c=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*r&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,c,h,0,0,a,o),l=f.transferToImageBitmap()}return l},GE=function(){const[t,r]=this.parentDimensions,{width:n,height:s}=this,a=new qa,o=Math.ceil(n*t*a.sx),l=Math.ceil(s*r*a.sy),c=v(this,Sl);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const h=v(this,Fs)?v(this,en):X(this,Er,Cb).call(this,o,l),f=c.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(h,0,0,h.width,h.height,0,0,o,l)},kb=function(t){if(t){if(v(this,Fs)){const s=this._uiManager.imageManager.getSvgUrl(v(this,Jn));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=v(this,en),r.getContext("2d").drawImage(v(this,en),0,0),r.toDataURL()}if(v(this,Fs)){const[r,n]=this.pageDimensions,s=Math.round(this.width*r*zl.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*zl.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(v(this,en),0,0,v(this,en).width,v(this,en).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(v(this,en))},DP=function(t){var o;const{pageIndex:r,accessibilityData:{altText:n}}=this._initialData,s=t.pageIndex===r,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},it(VE,"_type","stamp"),it(VE,"_editorType",Kt.STAMP);var nh,Np,So,Yu,Al,la,Xu,Dp,ih,Ba,Cl,Ri,kl,Mt,Ku,rn,LP,oo,qE,YE,Tb;const Ca=class Ca{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:n,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){q(this,rn);q(this,nh);q(this,Np,!1);q(this,So,null);q(this,Yu,null);q(this,Al,null);q(this,la,new Map);q(this,Xu,!1);q(this,Dp,!1);q(this,ih,!1);q(this,Ba,null);q(this,Cl,null);q(this,Ri,null);q(this,kl,null);q(this,Mt);const f=[...v(Ca,Ku).values()];if(!Ca._initialized){Ca._initialized=!0;for(const m of f)m.initialize(h,e)}e.registerEditorTypes(f),H(this,Mt,e),this.pageIndex=t,this.div=r,H(this,nh,s),H(this,So,a),this.viewport=c,H(this,Ri,l),this.drawLayer=o,this._structTree=n,v(this,Mt).addLayer(this)}get isEmpty(){return v(this,la).size===0}get isInvisible(){return this.isEmpty&&v(this,Mt).getMode()===Kt.NONE}updateToolbar(e){v(this,Mt).updateToolbar(e)}updateMode(e=v(this,Mt).getMode()){switch(X(this,rn,Tb).call(this),e){case Kt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Kt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Kt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const r of v(Ca,Ku).values())t.toggle(`${r._type}Editing`,e===r._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=v(this,Ri))==null?void 0:t.div)}setEditingState(e){v(this,Mt).setEditingState(e)}addCommands(e){v(this,Mt).addCommands(e)}cleanUndoStack(e){v(this,Mt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=v(this,So))==null||t.div.classList.toggle("disabled",!e)}async enable(){H(this,ih,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const r of v(this,la).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(v(this,Mt).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!v(this,So)){H(this,ih,!1);return}const t=v(this,So).getEditableAnnotations();for(const r of t){if(r.hide(),v(this,Mt).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const n=await this.deserialize(r);n&&(this.addOrRebuild(n),n.enableEditing())}H(this,ih,!1)}disable(){var n;H(this,Dp,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const s of v(this,la).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);(n=this.getEditableAnnotation(s.annotationElementId))==null||n.show(),s.remove()}if(v(this,So)){const s=v(this,So).getEditableAnnotations();for(const a of s){const{id:o}=a.data;if(v(this,Mt).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(v(this,Mt).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}X(this,rn,Tb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of v(Ca,Ku).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),H(this,Dp,!1)}getEditableAnnotation(e){var t;return((t=v(this,So))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){v(this,Mt).getActive()!==e&&v(this,Mt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=v(this,Ri))!=null&&e.div&&!v(this,kl)){H(this,kl,new AbortController);const t=v(this,Mt).combinedSignal(v(this,kl));v(this,Ri).div.addEventListener("pointerdown",X(this,rn,LP).bind(this),{signal:t}),v(this,Ri).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=v(this,Ri))!=null&&e.div&&v(this,kl)&&(v(this,kl).abort(),H(this,kl,null),v(this,Ri).div.classList.remove("highlighting"))}enableClick(){if(v(this,Yu))return;H(this,Yu,new AbortController);const e=v(this,Mt).combinedSignal(v(this,Yu));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=v(this,Yu))==null||e.abort(),H(this,Yu,null)}attach(e){v(this,la).set(e.id,e);const{annotationElementId:t}=e;t&&v(this,Mt).isDeletedAnnotationElement(t)&&v(this,Mt).removeDeletedAnnotationElement(e)}detach(e){var t;v(this,la).delete(e.id),(t=v(this,nh))==null||t.removePointerInTextLayer(e.contentDiv),!v(this,Dp)&&e.annotationElementId&&v(this,Mt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),v(this,Mt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(v(this,Mt).addDeletedAnnotationElement(e.annotationElementId),Vr.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),v(this,Mt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!v(this,ih)),v(this,Mt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!v(this,Al)&&(e._focusEventsAllowed=!1,H(this,Al,setTimeout(()=>{H(this,Al,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:v(this,Mt)._signal}),t.focus())},0))),e._structTreeParentId=(r=v(this,nh))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getNextId(){return v(this,Mt).getId()}combinedSignal(e){return v(this,Mt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=v(this,rn,oo))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await v(this,Mt).updateMode(e.mode);const{offsetX:r,offsetY:n}=X(this,rn,YE).call(this),s=this.getNextId(),a=X(this,rn,qE).call(this,{parent:this,id:s,x:r,y:n,uiManager:v(this,Mt),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=v(Ca,Ku).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,v(this,Mt)))||null}createAndAddNewEditor(e,t,r={}){const n=this.getNextId(),s=X(this,rn,qE).call(this,{parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:v(this,Mt),isCentered:t,...r});return s&&this.add(s),s}addNewEditor(e={}){this.createAndAddNewEditor(X(this,rn,YE).call(this),!0,e)}setSelected(e){v(this,Mt).setSelected(e)}toggleSelected(e){v(this,Mt).toggleSelected(e)}unselect(e){v(this,Mt).unselect(e)}pointerup(e){var n;const{isMac:t}=ei.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!v(this,Xu)||(H(this,Xu,!1),(n=v(this,rn,oo))!=null&&n.isDrawer&&v(this,rn,oo).supportMultipleDrawings))return;if(!v(this,Np)){H(this,Np,!0);return}const r=v(this,Mt).getMode();if(r===Kt.STAMP||r===Kt.SIGNATURE){v(this,Mt).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var n;if(v(this,Mt).getMode()===Kt.HIGHLIGHT&&this.enableTextSelection(),v(this,Xu)){H(this,Xu,!1);return}const{isMac:t}=ei.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(H(this,Xu,!0),(n=v(this,rn,oo))!=null&&n.isDrawer){this.startDrawingSession(e);return}const r=v(this,Mt).getActive();H(this,Np,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),v(this,Ba)){v(this,rn,oo).startDrawing(this,v(this,Mt),!1,e);return}v(this,Mt).setCurrentDrawingSession(this),H(this,Ba,new AbortController);const t=v(this,Mt).combinedSignal(v(this,Ba));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(H(this,Cl,null),this.commitOrRemove())},{signal:t}),v(this,rn,oo).startDrawing(this,v(this,Mt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&H(this,Cl,t);return}v(this,Cl)&&setTimeout(()=>{var t;(t=v(this,Cl))==null||t.focus(),H(this,Cl,null)},0)}endDrawingSession(e=!1){return v(this,Ba)?(v(this,Mt).setCurrentDrawingSession(null),v(this,Ba).abort(),H(this,Ba,null),H(this,Cl,null),v(this,rn,oo).endDrawing(e)):null}findNewParent(e,t,r){const n=v(this,Mt).findParent(t,r);return n===null||n===this?!1:(n.changeParent(e),!0)}commitOrRemove(){return v(this,Ba)?(this.endDrawingSession(),!0):!1}onScaleChanging(){v(this,Ba)&&v(this,rn,oo).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=v(this,Mt).getActive())==null?void 0:e.parent)===this&&(v(this,Mt).commitOrRemove(),v(this,Mt).setActiveEditor(null)),v(this,Al)&&(clearTimeout(v(this,Al)),H(this,Al,null));for(const r of v(this,la).values())(t=v(this,nh))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,v(this,la).clear(),v(this,Mt).removeLayer(this)}render({viewport:e}){this.viewport=e,nc(this.div,e);for(const t of v(this,Mt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){v(this,Mt).commitOrRemove(),X(this,rn,Tb).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,nc(this.div,{rotation:r}),t!==r)for(const n of v(this,la).values())n.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return v(this,Mt).viewParameters.realScale}};nh=new WeakMap,Np=new WeakMap,So=new WeakMap,Yu=new WeakMap,Al=new WeakMap,la=new WeakMap,Xu=new WeakMap,Dp=new WeakMap,ih=new WeakMap,Ba=new WeakMap,Cl=new WeakMap,Ri=new WeakMap,kl=new WeakMap,Mt=new WeakMap,Ku=new WeakMap,rn=new WeakSet,LP=function(e){v(this,Mt).unselectAll();const{target:t}=e;if(t===v(this,Ri).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&v(this,Ri).div.contains(t)){const{isMac:r}=ei.platform;if(e.button!==0||e.ctrlKey&&r)return;v(this,Mt).showAllEditors("highlight",!0,!0),v(this,Ri).div.classList.add("free"),this.toggleDrawing(),Vb.startHighlighting(this,v(this,Mt).direction==="ltr",{target:v(this,Ri).div,x:e.x,y:e.y}),v(this,Ri).div.addEventListener("pointerup",()=>{v(this,Ri).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:v(this,Mt)._signal}),e.preventDefault()}},oo=function(){return v(Ca,Ku).get(v(this,Mt).getMode())},qE=function(e){const t=v(this,rn,oo);return t?new t.prototype.constructor(e):null},YE=function(){const{x:e,y:t,width:r,height:n}=this.div.getBoundingClientRect(),s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+n),c=(s+o)/2-e,h=(a+l)/2-t,[f,m]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:f,offsetY:m}},Tb=function(){for(const e of v(this,la).values())e.isEmpty()&&e.remove()},it(Ca,"_initialized",!1),q(Ca,Ku,new Map([AE,jE,VE,Vb,WE].map(e=>[e._editorType,e])));let qb=Ca;var za,Wi,sh,e0,vw,PP,No,XE,OP,KE;const zn=class zn{constructor({pageIndex:e}){q(this,No);q(this,za,null);q(this,Wi,new Map);q(this,sh,new Map);this.pageIndex=e}setParent(e){if(!v(this,za)){H(this,za,e);return}if(v(this,za)!==e){if(v(this,Wi).size>0)for(const t of v(this,Wi).values())t.remove(),e.append(t);H(this,za,e)}}static get _svgFactory(){return ur(this,"_svgFactory",new Sg)}draw(e,t=!1,r=!1){const n=Bi(zn,e0)._++,s=X(this,No,XE).call(this),a=zn._svgFactory.createElement("defs");s.append(a);const o=zn._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&v(this,sh).set(n,o);const c=r?X(this,No,OP).call(this,a,l):null,h=zn._svgFactory.createElement("use");return s.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(s,e),v(this,Wi).set(n,s),{id:n,clipPathId:`url(#${c})`}}drawOutline(e,t){const r=Bi(zn,e0)._++,n=X(this,No,XE).call(this),s=zn._svgFactory.createElement("defs");n.append(s);const a=zn._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=zn._svgFactory.createElement("mask");s.append(f),l=`mask_p${this.pageIndex}_${r}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const m=zn._svgFactory.createElement("rect");f.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const p=zn._svgFactory.createElement("use");f.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const c=zn._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return n.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(n,e),v(this,Wi).set(r,n),r}finalizeDraw(e,t){v(this,sh).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:n,rootClass:s,path:a}=t,o=typeof e=="number"?v(this,Wi).get(e):e;if(o){if(r&&X(this,No,KE).call(this,o,r),n&&X(l=zn,vw,PP).call(l,o,n),s){const{classList:c}=o;for(const[h,f]of Object.entries(s))c.toggle(h,f)}if(a){const h=o.firstChild.firstChild;X(this,No,KE).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const r=v(this,Wi).get(e);r&&(v(t,za).append(r),v(this,Wi).delete(e),v(t,Wi).set(e,r))}remove(e){v(this,sh).delete(e),v(this,za)!==null&&(v(this,Wi).get(e).remove(),v(this,Wi).delete(e))}destroy(){H(this,za,null);for(const e of v(this,Wi).values())e.remove();v(this,Wi).clear(),v(this,sh).clear()}};za=new WeakMap,Wi=new WeakMap,sh=new WeakMap,e0=new WeakMap,vw=new WeakSet,PP=function(e,[t,r,n,s]){const{style:a}=e;a.top=`${100*r}%`,a.left=`${100*t}%`,a.width=`${100*n}%`,a.height=`${100*s}%`},No=new WeakSet,XE=function(){const e=zn._svgFactory.create(1,1,!0);return v(this,za).append(e),e.setAttribute("aria-hidden",!0),e},OP=function(e,t){const r=zn._svgFactory.createElement("clipPath");e.append(r);const n=`clip_${t}`;r.setAttribute("id",n),r.setAttribute("clipPathUnits","objectBoundingBox");const s=zn._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),n},KE=function(e,t){for(const[r,n]of Object.entries(t))n===null?e.removeAttribute(r):e.setAttribute(r,n)},q(zn,vw),q(zn,e0,0);let Yb=zn;globalThis._pdfjsTestingUtils={HighlightOutliner:kE};globalThis.pdfjsLib={AbortException:Bl,AnnotationEditorLayer:qb,AnnotationEditorParamsType:fr,AnnotationEditorType:Kt,AnnotationEditorUIManager:ic,AnnotationLayer:QS,AnnotationMode:Ao,AnnotationType:_n,build:OL,ColorPicker:Ag,createValidAbsoluteUrl:zS,DOMSVGFactory:Sg,DrawLayer:Yb,FeatureTest:ei,fetchData:Wp,getDocument:YS,getFilenameFromUrl:kD,getPdfFilenameFromUrl:TD,getUuid:US,getXfaPageViewport:RD,GlobalWorkerOptions:ua,ImageKind:hg,InvalidPDFException:$b,isDataScheme:p0,isPdfFile:zw,isValidExplicitDest:cL,MathClamp:Ni,noContextMenu:ma,normalizeUnicode:AD,OPS:bg,OutputScale:qa,PasswordResponses:ED,PDFDataRangeTransport:XS,PDFDateString:$w,PDFWorker:Ip,PermissionFlag:_D,PixelsPerInch:zl,RenderingCancelledException:Bw,ResponseException:wg,setLayerDimensions:nc,shadow:ur,SignatureExtractor:Co,stopEvent:An,SupportedImageMimeTypes:Ub,TextLayer:_g,TouchManager:xg,updateUrlHash:$S,Util:jt,VerbosityLevel:d0,version:PL,XfaLayer:KS};const h$=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Bl,AnnotationEditorLayer:qb,AnnotationEditorParamsType:fr,AnnotationEditorType:Kt,AnnotationEditorUIManager:ic,AnnotationLayer:QS,AnnotationMode:Ao,AnnotationType:_n,ColorPicker:Ag,DOMSVGFactory:Sg,DrawLayer:Yb,FeatureTest:ei,GlobalWorkerOptions:ua,ImageKind:hg,InvalidPDFException:$b,MathClamp:Ni,OPS:bg,OutputScale:qa,PDFDataRangeTransport:XS,PDFDateString:$w,PDFWorker:Ip,PasswordResponses:ED,PermissionFlag:_D,PixelsPerInch:zl,RenderingCancelledException:Bw,ResponseException:wg,SignatureExtractor:Co,SupportedImageMimeTypes:Ub,TextLayer:_g,TouchManager:xg,Util:jt,VerbosityLevel:d0,XfaLayer:KS,build:OL,createValidAbsoluteUrl:zS,fetchData:Wp,getDocument:YS,getFilenameFromUrl:kD,getPdfFilenameFromUrl:TD,getUuid:US,getXfaPageViewport:RD,isDataScheme:p0,isPdfFile:zw,isValidExplicitDest:cL,noContextMenu:ma,normalizeUnicode:AD,setLayerDimensions:nc,shadow:ur,stopEvent:An,updateUrlHash:$S,version:PL},Symbol.toStringTag,{value:"Module"})),f$=["onCopy","onCut","onPaste"],p$=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],m$=["onFocus","onBlur"],g$=["onInput","onInvalid","onReset","onSubmit"],v$=["onLoad","onError"],y$=["onKeyDown","onKeyPress","onKeyUp"],b$=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],w$=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],x$=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],_$=["onSelect"],E$=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],S$=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],A$=["onScroll"],C$=["onWheel"],k$=["onAnimationStart","onAnimationEnd","onAnimationIteration"],T$=["onTransitionEnd"],R$=["onToggle"],N$=["onChange"],D$=[...f$,...p$,...m$,...g$,...v$,...y$,...b$,...w$,...x$,..._$,...E$,...S$,...A$,...C$,...k$,...T$,...N$,...R$];function IP(i,e){const t={};for(const r of D$){const n=i[r];n&&(e?t[r]=s=>n(s,e(r)):t[r]=n)}return t}function b0(i){let e=!1;return{promise:new Promise((r,n)=>{i.then(s=>!e&&r(s)).catch(s=>!e&&n(s))}),cancel(){e=!0}}}var L$="Invariant failed";function Mr(i,e){if(!i)throw new Error(L$)}var Zx,CR;function P$(){if(CR)return Zx;CR=1;var i=function(){};return Zx=i,Zx}var O$=P$();const Di=Do(O$);var kR=Object.prototype.hasOwnProperty;function TR(i,e,t){for(t of i.keys())if(Ef(t,e))return t}function Ef(i,e){var t,r,n;if(i===e)return!0;if(i&&e&&(t=i.constructor)===e.constructor){if(t===Date)return i.getTime()===e.getTime();if(t===RegExp)return i.toString()===e.toString();if(t===Array){if((r=i.length)===e.length)for(;r--&&Ef(i[r],e[r]););return r===-1}if(t===Set){if(i.size!==e.size)return!1;for(r of i)if(n=r,n&&typeof n=="object"&&(n=TR(e,n),!n)||!e.has(n))return!1;return!0}if(t===Map){if(i.size!==e.size)return!1;for(r of i)if(n=r[0],n&&typeof n=="object"&&(n=TR(e,n),!n)||!Ef(r[1],e.get(n)))return!1;return!0}if(t===ArrayBuffer)i=new Uint8Array(i),e=new Uint8Array(e);else if(t===DataView){if((r=i.byteLength)===e.byteLength)for(;r--&&i.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(i)){if((r=i.byteLength)===e.byteLength)for(;r--&&i[r]===e[r];);return r===-1}if(!t||typeof i=="object"){r=0;for(t in i)if(kR.call(i,t)&&++r&&!kR.call(e,t)||!(t in e)||!Ef(i[t],e[t]))return!1;return Object.keys(e).length===r}}return i!==i&&e!==e}const FP=T.createContext(null);function Sf({children:i,type:e}){return E.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:i})}const I$="noopener noreferrer nofollow";class F${constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Mr(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Mr(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{Mr(this.pdfDocument),Mr(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Mr(Array.isArray(t));const r=t[0];new Promise(n=>{Mr(this.pdfDocument),r instanceof Object?this.pdfDocument.getPageIndex(r).then(s=>{n(s)}).catch(()=>{Mr(!1)}):typeof r=="number"?n(r):Mr(!1)}).then(n=>{const s=n+1;Mr(this.pdfViewer),Mr(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:n,pageNumber:s})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;Mr(this.pdfViewer),Mr(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,r){e.href=t,e.rel=this.externalLinkRel||I$,e.target=r?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const RR={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Ww=typeof window<"u",MP=Ww&&window.location.protocol==="file:";function M$(i){return typeof i<"u"}function zc(i){return M$(i)&&i!==null}function j$(i){return typeof i=="string"}function B$(i){return i instanceof ArrayBuffer}function z$(i){return Mr(Ww),i instanceof Blob}function ZE(i){return j$(i)&&/^data:/.test(i)}function NR(i){Mr(ZE(i));const[e="",t=""]=i.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function $$(){return Ww&&window.devicePixelRatio||1}const jP="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function DR(){Di(!MP,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${jP}`)}function U$(){Di(!MP,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${jP}`)}function hh(i){i!=null&&i.cancel&&i.cancel()}function QE(i,e){return Object.defineProperty(i,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(i,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(i,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(i,"originalHeight",{get(){return this.view[3]},configurable:!0}),i}function H$(i){return i.name==="RenderingCancelledException"}function W$(i){return new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return t(new Error("Error while reading a file."));e(r.result)},r.onerror=n=>{if(!n.target)return t(new Error("Error while reading a file."));const{error:s}=n.target;if(!s)return t(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},r.readAsArrayBuffer(i)})}function V$(i,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return i}}function Fp(){return T.useReducer(V$,{value:void 0,error:void 0})}var LR=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const{PDFDataRangeTransport:G$}=h$,q$=(i,e)=>{switch(e){case RR.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");i(t);break}case RR.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");i(t);break}}};function PR(i){return typeof i=="object"&&i!==null&&("data"in i||"range"in i||"url"in i)}const Y$=T.forwardRef(function(e,t){var{children:r,className:n,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF…",noData:m="No PDF file specified.",onItemClick:p,onLoadError:x,onLoadProgress:g,onLoadSuccess:y,onPassword:b=q$,onSourceError:_,onSourceSuccess:S,options:k,renderMode:C,rotate:R,scale:N}=e,O=LR(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[I,F]=Fp(),{value:G,error:B}=I,[Y,j]=Fp(),{value:ae,error:he}=Y,ee=T.useRef(new F$),Z=T.useRef([]),ie=T.useRef(void 0),ge=T.useRef(void 0);l&&l!==ie.current&&PR(l)&&(Di(!Ef(l,ie.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),ie.current=l),k&&k!==ge.current&&(Di(!Ef(k,ge.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ge.current=k);const V=T.useRef({scrollPageIntoView:z=>{const{dest:Le,pageNumber:_e,pageIndex:ue=_e-1}=z;if(p){p({dest:Le,pageIndex:ue,pageNumber:_e});return}const oe=Z.current[ue];if(oe){oe.scrollIntoView();return}Di(!1,`An internal link leading to page ${_e} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});T.useImperativeHandle(t,()=>({linkService:ee,pages:Z,viewer:V}),[]);function K(){S&&S()}function be(){B&&(Di(!1,B.toString()),_&&_(B))}function Ae(){F({type:"RESET"})}T.useEffect(Ae,[l,F]);const ce=T.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return ZE(l)?{data:NR(l)}:(DR(),{url:l});if(l instanceof G$)return{range:l};if(B$(l))return{data:l};if(Ww&&z$(l))return{data:await W$(l)};if(Mr(typeof l=="object"),Mr(PR(l)),"url"in l&&typeof l.url=="string"){if(ZE(l.url)){const{url:z}=l,Le=LR(l,["url"]),_e=NR(z);return Object.assign({data:_e},Le)}DR()}return l},[l]);T.useEffect(()=>{const z=b0(ce());return z.promise.then(Le=>{F({type:"RESOLVE",value:Le})}).catch(Le=>{F({type:"REJECT",error:Le})}),()=>{hh(z)}},[ce,F]),T.useEffect(()=>{if(!(typeof G>"u")){if(G===!1){be();return}K()}},[G]);function Pe(){ae&&(y&&y(ae),Z.current=new Array(ae.numPages),ee.current.setDocument(ae))}function Ve(){he&&(Di(!1,he.toString()),x&&x(he))}T.useEffect(function(){j({type:"RESET"})},[j,G]),T.useEffect(function(){if(!G)return;const Le=k?Object.assign(Object.assign({},G),k):G,_e=YS(Le);g&&(_e.onProgress=g),b&&(_e.onPassword=b);const ue=_e,oe=ue.promise.then(le=>{j({type:"RESOLVE",value:le})}).catch(le=>{ue.destroyed||j({type:"REJECT",error:le})});return()=>{oe.finally(()=>ue.destroy())}},[k,j,G]),T.useEffect(()=>{if(!(typeof ae>"u")){if(ae===!1){Ve();return}Pe()}},[ae]),T.useEffect(function(){ee.current.setViewer(V.current),ee.current.setExternalLinkRel(a),ee.current.setExternalLinkTarget(o)},[a,o]);const $e=T.useCallback((z,Le)=>{Z.current[z]=Le},[]),qe=T.useCallback(z=>{delete Z.current[z]},[]),Ze=T.useMemo(()=>({imageResourcesPath:h,linkService:ee.current,onItemClick:p,pdf:ae,registerPage:$e,renderMode:C,rotate:R,scale:N,unregisterPage:qe}),[h,p,ae,$e,C,R,N,qe]),at=T.useMemo(()=>IP(O,()=>ae),[O,ae]);function gt(){return E.jsx(FP.Provider,{value:Ze,children:r})}function ut(){return l?ae==null?E.jsx(Sf,{type:"loading",children:typeof f=="function"?f():f}):ae===!1?E.jsx(Sf,{type:"error",children:typeof s=="function"?s():s}):gt():E.jsx(Sf,{type:"no-data",children:typeof m=="function"?m():m})}return E.jsx("div",Object.assign({className:Va("react-pdf__Document",n),ref:c},at,{children:ut()}))});function BP(){return T.useContext(FP)}function zP(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=i.filter(Boolean);if(t.length<=1){var r=t[0];return r||null}return function(s){for(var a=0,o=t;a<o.length;a++){var l=o[a];typeof l=="function"?l(s):l&&(l.current=s)}}}const $P=T.createContext(null),UP={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},X$=/^H(\d+)$/;function K$(i){return i in UP}function Vw(i){return"children"in i}function HP(i){return Vw(i)?i.children.length===1&&0 in i.children&&"id"in i.children[0]:!1}function Z$(i){const e={};if(Vw(i)){const{role:t}=i,r=t.match(X$);if(r)e.role="heading",e["aria-level"]=Number(r[1]);else if(K$(t)){const n=UP[t];n&&(e.role=n)}}return e}function WP(i){const e={};if(Vw(i)){if(i.alt!==void 0&&(e["aria-label"]=i.alt),i.lang!==void 0&&(e.lang=i.lang),HP(i)){const[t]=i.children;if(t){const r=WP(t);return Object.assign(Object.assign({},e),r)}}}else"id"in i&&(e["aria-owns"]=i.id);return e}function Q$(i){return i?Object.assign(Object.assign({},Z$(i)),WP(i)):null}function VP({className:i,node:e}){const t=T.useMemo(()=>Q$(e),[e]),r=T.useMemo(()=>!Vw(e)||HP(e)?null:e.children.map((n,s)=>E.jsx(VP,{node:n},s)),[e]);return E.jsx("span",Object.assign({className:i},t,{children:r}))}function Gw(){return T.useContext($P)}function J$(){const i=Gw();Mr(i);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=i,[r,n]=Fp(),{value:s,error:a}=r,{customTextRenderer:o,page:l}=i;function c(){s&&t&&t(s)}function h(){a&&(Di(!1,a.toString()),e&&e(a))}return T.useEffect(function(){n({type:"RESET"})},[n,l]),T.useEffect(function(){if(o||!l)return;const m=b0(l.getStructTree()),p=m;return m.promise.then(x=>{n({type:"RESOLVE",value:x})}).catch(x=>{n({type:"REJECT",error:x})}),()=>hh(p)},[o,l,n]),T.useEffect(()=>{if(s!==void 0){if(s===!1){h();return}c()}},[s]),s?E.jsx(VP,{className:"react-pdf__Page__structTree structTree",node:s}):null}const OR=Ao;function e9(i){const e=Gw();Mr(e);const t=Object.assign(Object.assign({},e),i),{_className:r,canvasBackground:n,devicePixelRatio:s=$$(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:h,rotate:f,scale:m}=t,{canvasRef:p}=i;Mr(l);const x=T.useRef(null);function g(){l&&o&&o(QE(l,m))}function y(k){H$(k)||(Di(!1,k.toString()),a&&a(k))}const b=T.useMemo(()=>l.getViewport({scale:m*s,rotation:f}),[s,l,f,m]),_=T.useMemo(()=>l.getViewport({scale:m,rotation:f}),[l,f,m]);T.useEffect(function(){if(!l)return;l.cleanup();const{current:C}=x;if(!C)return;C.width=b.width,C.height=b.height,C.style.width=`${Math.floor(_.width)}px`,C.style.height=`${Math.floor(_.height)}px`,C.style.visibility="hidden";const R={annotationMode:c?OR.ENABLE_FORMS:OR.ENABLE,canvasContext:C.getContext("2d",{alpha:!1}),viewport:b};n&&(R.background=n);const N=l.render(R),O=N;return N.promise.then(()=>{C.style.visibility="",g()}).catch(y),()=>hh(O)},[n,l,c,b,_]);const S=T.useCallback(()=>{const{current:k}=x;k&&(k.width=0,k.height=0)},[]);return T.useEffect(()=>S,[S]),E.jsx("canvas",{className:`${r}__canvas`,dir:"ltr",ref:zP(p,x),style:{display:"block",userSelect:"none"},children:h?E.jsx(J$,{}):null})}function t9(i){return"str"in i}function r9(){const i=Gw();Mr(i);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:r,onRenderTextLayerError:n,onRenderTextLayerSuccess:s,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:h}=i;Mr(a);const[f,m]=Fp(),{value:p,error:x}=f,g=T.useRef(null);Di(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function y(){p&&r&&r(p)}function b(){x&&(Di(!1,x.toString()),t&&t(x))}T.useEffect(function(){m({type:"RESET"})},[a,m]),T.useEffect(function(){if(!a)return;const O=b0(a.getTextContent()),I=O;return O.promise.then(F=>{m({type:"RESOLVE",value:F})}).catch(F=>{m({type:"REJECT",error:F})}),()=>hh(I)},[a,m]),T.useEffect(()=>{if(p!==void 0){if(p===!1){b();return}y()}},[p]);const _=T.useCallback(()=>{s&&s()},[s]),S=T.useCallback(N=>{Di(!1,N.toString()),n&&n(N)},[n]);function k(){const N=g.current;N&&N.classList.add("selecting")}function C(){const N=g.current;N&&N.classList.remove("selecting")}const R=T.useMemo(()=>a.getViewport({scale:h,rotation:c}),[a,c,h]);return T.useLayoutEffect(function(){if(!a||!p)return;const{current:O}=g;if(!O)return;O.innerHTML="";const I=a.streamTextContent({includeMarkedContent:!0}),F={container:O,textContentSource:I,viewport:R},G=new _g(F),B=G;return G.render().then(()=>{const Y=document.createElement("div");Y.className="endOfContent",O.append(Y);const j=O.querySelectorAll('[role="presentation"]');if(e){let ae=0;p.items.forEach((he,ee)=>{if(!t9(he))return;const Z=j[ae];if(!Z)return;const ie=e(Object.assign({pageIndex:o,pageNumber:l,itemIndex:ee},he));Z.innerHTML=ie,ae+=he.str&&he.hasEOL?2:1})}_()}).catch(S),()=>hh(B)},[e,S,_,a,o,l,p,R]),E.jsx("div",{className:Va("react-pdf__Page__textContent","textLayer"),onMouseUp:C,onMouseDown:k,ref:g})}function n9(){const i=BP(),e=Gw();Mr(e);const t=Object.assign(Object.assign({},i),e),{imageResourcesPath:r,linkService:n,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:h,renderForms:f,rotate:m,scale:p=1}=t;Mr(h),Mr(c),Mr(n);const[x,g]=Fp(),{value:y,error:b}=x,_=T.useRef(null);Di(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function S(){y&&a&&a(y)}function k(){b&&(Di(!1,b.toString()),s&&s(b))}T.useEffect(function(){g({type:"RESET"})},[g,c]),T.useEffect(function(){if(!c)return;const I=b0(c.getAnnotations()),F=I;return I.promise.then(G=>{g({type:"RESOLVE",value:G})}).catch(G=>{g({type:"REJECT",error:G})}),()=>{hh(F)}},[g,c]),T.useEffect(()=>{if(y!==void 0){if(y===!1){k();return}S()}},[y]);function C(){l&&l()}function R(O){Di(!1,`${O}`),o&&o(O)}const N=T.useMemo(()=>c.getViewport({scale:p,rotation:m}),[c,m,p]);return T.useEffect(function(){if(!h||!c||!n||!y)return;const{current:I}=_;if(!I)return;const F=N.clone({dontFlip:!0}),G={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:I,l10n:null,page:c,structTreeLayer:null,viewport:F},B={annotations:y,annotationStorage:h.annotationStorage,div:I,imageResourcesPath:r,linkService:n,page:c,renderForms:f,viewport:F};I.innerHTML="";try{new QS(G).render(B),C()}catch(Y){R(Y)}return()=>{}},[y,r,n,c,h,f,N]),E.jsx("div",{className:Va("react-pdf__Page__annotations","annotationLayer"),ref:_})}var i9=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const IR=1;function Qx(i){const e=BP(),t=Object.assign(Object.assign({},e),i),{_className:r="react-pdf__Page",_enableRegisterUnregisterPage:n=!0,canvasBackground:s,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:h,devicePixelRatio:f,error:m="Failed to load the page.",height:p,inputRef:x,loading:g="Loading page…",noData:y="No page specified.",onGetAnnotationsError:b,onGetAnnotationsSuccess:_,onGetStructTreeError:S,onGetStructTreeSuccess:k,onGetTextError:C,onGetTextSuccess:R,onLoadError:N,onLoadSuccess:O,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:F,onRenderError:G,onRenderSuccess:B,onRenderTextLayerError:Y,onRenderTextLayerSuccess:j,pageIndex:ae,pageNumber:he,pdf:ee,registerPage:Z,renderAnnotationLayer:ie=!0,renderForms:ge=!1,renderMode:V="canvas",renderTextLayer:K=!0,rotate:be,scale:Ae=IR,unregisterPage:ce,width:Pe}=t,Ve=i9(t,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[$e,qe]=Fp(),{value:Ze,error:at}=$e,gt=T.useRef(null);Mr(ee);const ut=zc(he)?he-1:ae??null,z=he??(zc(ae)?ae+1:null),Le=be??(Ze?Ze.rotate:null),_e=T.useMemo(()=>{if(!Ze)return null;let Rt=1;const _t=Ae??IR;if(Pe||p){const ar=Ze.getViewport({scale:1,rotation:Le});Pe?Rt=Pe/ar.width:p&&(Rt=p/ar.height)}return _t*Rt},[p,Ze,Le,Ae,Pe]);T.useEffect(function(){return()=>{zc(ut)&&n&&ce&&ce(ut)}},[n,ee,ut,ce]);function ue(){if(O){if(!Ze||!_e)return;O(QE(Ze,_e))}if(n&&Z){if(!zc(ut)||!gt.current)return;Z(ut,gt.current)}}function oe(){at&&(Di(!1,at.toString()),N&&N(at))}T.useEffect(function(){qe({type:"RESET"})},[qe,ee,ut]),T.useEffect(function(){if(!ee||!z)return;const _t=b0(ee.getPage(z)),ar=_t;return _t.promise.then(cr=>{qe({type:"RESOLVE",value:cr})}).catch(cr=>{qe({type:"REJECT",error:cr})}),()=>hh(ar)},[qe,ee,z]),T.useEffect(()=>{if(Ze!==void 0){if(Ze===!1){oe();return}ue()}},[Ze,_e]);const le=T.useMemo(()=>Ze&&zc(ut)&&z&&zc(Le)&&zc(_e)?{_className:r,canvasBackground:s,customTextRenderer:h,devicePixelRatio:f,onGetAnnotationsError:b,onGetAnnotationsSuccess:_,onGetStructTreeError:S,onGetStructTreeSuccess:k,onGetTextError:C,onGetTextSuccess:R,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:F,onRenderError:G,onRenderSuccess:B,onRenderTextLayerError:Y,onRenderTextLayerSuccess:j,page:Ze,pageIndex:ut,pageNumber:z,renderForms:ge,renderTextLayer:K,rotate:Le,scale:_e}:null,[r,s,h,f,b,_,S,k,C,R,I,F,G,B,Y,j,Ze,ut,z,ge,K,Le,_e]),Oe=T.useMemo(()=>IP(Ve,()=>Ze&&(_e?QE(Ze,_e):void 0)),[Ve,Ze,_e]),Te=`${ut}@${_e}/${Le}`;function ye(){switch(V){case"custom":return Mr(c),E.jsx(c,{},`${Te}_custom`);case"none":return null;case"canvas":default:return E.jsx(e9,{canvasRef:a},`${Te}_canvas`)}}function Ue(){return K?E.jsx(r9,{},`${Te}_text`):null}function rt(){return ie?E.jsx(n9,{},`${Te}_annotations`):null}function Ke(){return E.jsxs($P.Provider,{value:le,children:[ye(),Ue(),rt(),o]})}function yt(){return z?ee===null||Ze===void 0||Ze===null?E.jsx(Sf,{type:"loading",children:typeof g=="function"?g():g}):ee===!1||Ze===!1?E.jsx(Sf,{type:"error",children:typeof m=="function"?m():m}):Ke():E.jsx(Sf,{type:"no-data",children:typeof y=="function"?y():y})}return E.jsx("div",Object.assign({className:Va(r,l),"data-page-number":z,ref:zP(x,gt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${_e}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Oe,{children:yt()}))}U$();ua.workerSrc="pdf.worker.mjs";ua.workerSrc=new URL("/client/assets/pdf.worker.min-BFAMBS4k.mjs",import.meta.url).toString();const Jx=["Lexend","ComicNeue-Regular","EBGaramond-Regular","Baskervville"];function s9(){const{t:i}=ir(),{id:e}=cc(),[t]=Ul(),r=t.get("isLocal")==="true",n=t.get("server"),s=t.get("opdsType"),a=t.get("opdsUrl"),{retrieveBook:o,retrieveLocalBook:l}=Up(),{retrieveLibrary:c}=vn(),{libraryData:h}=Xr(Dt(le=>({libraryData:le.libraryData}))),{pageEvent:f}=Vl(),m=Br(),p=T.useRef(!1),{server:x}=Ln(Dt(le=>({server:le.server}))),{opdsUrl:g}=gh(Dt(le=>({opdsUrl:le.opdsUrl}))),{bookTheme:y,bookCustomBackground:b,bookCustomForeground:_,bookCustomFontSize:S,bookCustomFontFamily:k,setBookCustomFontFamily:C,setBookTheme:R,setBookCustomFontSize:N}=c0(Dt(le=>({bookTheme:le.bookTheme,bookCustomBackground:le.bookCustomBackground,bookCustomForeground:le.bookCustomForeground,bookCustomFontSize:le.bookCustomFontSize,bookCustomFontFamily:le.bookCustomFontFamily,setBookCustomFontFamily:le.setBookCustomFontFamily,setBookTheme:le.setBookTheme,setBookCustomFontSize:le.setBookCustomFontSize}))),[O,I]=T.useState(null),[F,G]=T.useState(null),[B,Y]=T.useState(!1),[j,ae]=T.useState(null),[he,ee]=T.useState(null),[Z,ie]=T.useState(1),[ge,V]=T.useState(null),[K,be]=T.useState(null),Ae=T.useRef(null),ce=T.useRef([]),Pe=T.useRef(null),Ve=T.useRef(null),$e=T.useRef(!1),qe={...dn,arrow:{...dn.arrow,color:_},arrowHover:{...dn.arrowHover,color:_},readerArea:{...dn.readerArea,backgroundColor:b,transition:void 0},titleArea:{...dn.titleArea,color:_},tocArea:{...dn.tocArea,background:b},tocButtonExpanded:{...dn.tocButtonExpanded,background:b},tocButtonBar:{...dn.tocButtonBar,background:_},tocButton:{...dn.tocButton,color:_}},Ze=async()=>{if(p.current)return;if(p.current=!0,!e&&!a)return null;let le=null;if(r){if(le=await l(Number(e),n||""),!le)return _e(i("book.bookNotFound")),!1;console.log("[BookRead.tsx] epub location",le.current_page),le.current_page&&le.current_page!==0&&le.current_page!=="0"&&(le.file_format==="epub"?ae(le.current_page):ie(Number(le.current_page)));const Oe=(x==null?void 0:x.replace(/[/:?&]/g,"_"))||"",Te=await Dl(),ye=await Gi(Te,String(hr.AppLocalData),Oe,"books",String(le==null?void 0:le.file_id),"files",le.file_name);I(le),G(lg(ye))}else if(s&&a)await gt(s==="opds-pdf"?"opds-pdf":"opds-epub",void 0,void 0,a),I({id:0,file_id:0,title:"",path:"",file_name:"",file_format:s==="opds-pdf"?"pdf":"epub",current_page:0,total_pages:0,is_read:!1,library_id:0,metadata:{}});else{if(le=await o(Number(e)),!le)return _e(i("book.bookNotFound")),!1;console.log("[BookRead.tsx] epub location",le.current_page),le.current_page&&le.current_page!==0&&le.current_page!=="0"&&(le.file_format==="epub"?(console.log("[BookRead.tsx] epub location :(",le.current_page),ae(le.current_page)):ie(Number(le.current_page))),I(le),await gt("devourer",le,x)}};function at(le,Oe){const Te=le.themes;switch(Oe){case"dark":{Te.override("color","#fff"),Te.override("background","#000");break}case"light":{Te.override("color","#000"),Te.override("background","#fff");break}case"custom":{Te.override("color",_),Te.override("background",b);break}}}const gt=async(le,Oe,Te,ye)=>{Te!=null&&Te.replace(/[/:?&]/g,"_"),r||(le==="opds-pdf"||le==="opds-epub"?(ae(null),G(ye||"")):(ae(null),G(`${Te}/stream/${h==null?void 0:h.id}/${Oe.id}`)))},ut=()=>{const le=window.innerHeight-100,Oe=window.innerWidth;V(le),be(Oe)},z=()=>{if(Z===1)return;let le=null;if(B){if(Z-1===1){le=1;return}le=Z-2}else le=Z-1;le&&!s&&!(a!=null&&a.includes("local"))&&(f(le,r,(h==null?void 0:h.id)||0,r?(O==null?void 0:O.file_id)||0:(O==null?void 0:O.id)||0,n||""),ie(le))},Le=()=>{if(Z===he)return;let le=null;if(B){if(Z+1===he){le=he;return}le=Z+2}else{if(Z+1===he){le=he;return}le=Z+1}le&&!s&&!(a!=null&&a.includes("local"))&&(f(le,r,(h==null?void 0:h.id)||0,r?(O==null?void 0:O.file_id)||0:(O==null?void 0:O.id)||0,n||""),ie(le))},_e=async le=>{console.error("Error loading book:",le),wt.error(i("book.errorLoadingBook"),{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),await new Promise(Oe=>setTimeout(Oe,50)),m("/")};T.useEffect(()=>{if(O&&O.file_format==="pdf"||s==="opds-pdf"){const le=Oe=>{Oe.key==="ArrowLeft"?z():Oe.key==="ArrowRight"&&Le()};return window.addEventListener("keydown",le),()=>{window.removeEventListener("keydown",le)}}},[O,s,Le,z]),T.useEffect(()=>{O&&F||((!r&&h&&e||s&&a)&&Ze(),r&&e&&Ze())},[e,h,Ze,s,a]),T.useEffect(()=>{const le=window.matchMedia("(orientation: landscape)");Y(le.matches);const Oe=Te=>{Y(Te.matches)};return le.addEventListener("change",Oe),()=>{le.removeEventListener("change",Oe)}},[]),T.useEffect(()=>(window.addEventListener("resize",ut),()=>window.removeEventListener("resize",ut)),[]),T.useLayoutEffect(()=>{ut()},[F,O,B,he]);function ue({numPages:le}){ee(le)}T.useEffect(()=>{Ae.current&&Ae.current.themes.fontSize(`${S}%`)},[S]),T.useEffect(()=>{Ae.current&&at(Ae.current,y)},[y]),T.useEffect(()=>{if(F&&k){let le=0;const Oe=50,Te=()=>{var rt;const Ue=document.querySelector("iframe");if(Ue&&((rt=Ue.contentWindow)!=null&&rt.document.head)){const Ke=Ue.contentWindow.document.head;Ke.querySelectorAll("style[data-epub-font-injection]").forEach(_t=>_t.remove());const Rt=document.createElement("style");Rt.setAttribute("data-epub-font-injection","true"),Rt.textContent=`
            @font-face {
              font-family: "Lexend";
              src: url("/fonts/Lexend/Lexend-VariableFont_wght.ttf") format("truetype");
              font-weight: 100 900;
              font-stretch: 75% 100%;
              font-style: normal;
            }
            @font-face {
              font-family: "ComicNeue-Regular";
              src: url("/fonts/Comic_Neue/ComicNeue-Regular.ttf") format("truetype");
              font-weight: 100 900;
              font-stretch: 75% 100%;
              font-style: normal;
            }
            @font-face {
              font-family: "EBGaramond-Regular";
              src: url("/fonts/EB_Garamond/EBGaramond-VariableFont_wght.ttf") format("truetype");
              font-weight: 100 900;
              font-stretch: 75% 100%;
              font-style: normal;
            }
            @font-face {
              font-family: "Baskervville";
              src: url("/fonts/Baskervville/Baskervville-VariableFont_wght.ttf") format("truetype");
              font-weight: 100 900;
              font-stretch: 75% 100%;
              font-style: normal;
            }
            h1 { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
            h2 { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
            h3 { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
            h4 { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
            h5 { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
            h6 { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
            p { font-family: ${k}, system-ui, -apple-system, sans-serif !important; }
          `,Ke.appendChild(Rt),$e.current=!0}else le<Oe&&(le++,setTimeout(Te,100))};$e.current=!1;const ye=setTimeout(Te,100);return()=>clearTimeout(ye)}},[F,k]);const oe=(le,Oe)=>E.jsx("button",{className:"bg-primary text-white rounded-full p-2 hover:bg-tertiary hover:cursor-pointer",onClick:Oe,children:le});return E.jsxs("div",{className:"h-[100vh] w-screen overflow-hidden",children:[E.jsxs("div",{className:"mt-[30px] h-[50px] flex items-center justify-between px-3",style:{backgroundColor:y==="dark"?"#000":y==="light"?"#fff":b},children:[E.jsx("div",{children:oe(E.jsx(Pp,{className:"size-4"}),async()=>{!r&&!(a!=null&&a.includes("local"))&&c((h==null?void 0:h.id)||0),m(-1)})}),E.jsxs("div",{className:"flex flex-row items-center gap-2",children:[oe(E.jsx(q8,{className:"size-4"}),()=>{R(y==="light"?"dark":y==="dark"?"custom":"light")}),oe(E.jsx($8,{className:"size-4"}),()=>{S!==10&&N(S-10)}),oe(E.jsx(TS,{className:"size-4"}),()=>{S!==200&&N(S+10)}),oe(E.jsx(H5,{className:"size-4"}),()=>{const le=k,Te=(Jx.indexOf(le)+1)%Jx.length,ye=Jx[Te];C(ye)})]})]}),E.jsx("div",{id:"book-reader",className:`h-[calc(100vh-80px)] overflow-hidden ${k.toLowerCase()}`,children:O&&F&&E.jsx(E.Fragment,{children:s==="opds-epub"||(O==null?void 0:O.file_format)==="epub"?E.jsx("div",{className:"w-screen h-[calc(100vh-80px)]",children:E.jsx(Nz,{url:F,location:j!=="0"?j:null,locationChanged:le=>{ae(le),!s&&!(a!=null&&a.includes("local"))&&f(le,r,(h==null?void 0:h.id)||0,r?O.file_id:O.id,n||"")},tocChanged:le=>ce.current=le,epubInitOptions:{openAs:"epub"},epubOptions:{allowPopups:!0,allowScriptedContent:!0},readerStyles:y==="dark"?o9:y==="light"?a9:qe,getRendition:le=>{const Oe=le.book.spine.get.bind(le.book.spine);le.book.spine.get=function(Te){let ye=Oe(Te);for(;ye==null&&Te.startsWith("../");)Te=Te.substring(3),ye=Oe(Te);return ye},Ae.current=le,Ae.current.themes.fontSize(`${S}%`),Ae.current.themes.register("custom",{h1:{"font-family":`${k}`},h2:{"font-family":`${k}`},h3:{"font-family":`${k}`},p:{"font-family":`${k}`}}),Ae.current.themes.select("custom")}})}):E.jsxs(E.Fragment,{children:[E.jsx("div",{ref:Ve,className:"w-screen overflow-y-hidden",style:{height:"calc(100vh - 80px)"},children:E.jsx(Y$,{file:F,onLoadSuccess:ue,renderMode:"canvas",className:`${B?"flex flex-row gap-0":""}`,children:B?E.jsxs(E.Fragment,{children:[E.jsx(Qx,{height:B?ge||0:void 0,pageNumber:Z,renderAnnotationLayer:!1,renderTextLayer:!1,className:"w-screen h-[100vh]",width:B?void 0:K||0},`${Z}-${b}`),he&&Z+1<=he&&E.jsx(Qx,{height:B?ge||0:void 0,pageNumber:Z+1,renderAnnotationLayer:!1,renderTextLayer:!1,className:"w-screen h-[100vh]",width:B?void 0:K||0},`${Z+1}-${b}`)]}):E.jsx(Qx,{height:B?ge||0:void 0,pageNumber:Z,renderAnnotationLayer:!1,renderTextLayer:!1,className:"w-screen h-[100vh]",width:B?void 0:K||0},`${Z}-${b}`)})}),E.jsx("div",{ref:Pe,className:"w-full h-[50px] absolute bottom-0 text-gray-600 flex items-center justify-center",children:E.jsxs("div",{className:"flex flex-row items-center gap-2",children:[oe(E.jsx(Pp,{className:"size-4"}),z),E.jsxs("p",{children:[i("read.page")," ",Z," ",i("read.of")," ",he||0]}),oe(E.jsx(f8,{className:"size-4"}),Le)]})})]})})})]})}const a9={...dn,readerArea:{...dn.readerArea,transition:void 0}},o9={...dn,arrow:{...dn.arrow,color:"white"},arrowHover:{...dn.arrowHover,color:"#ccc"},readerArea:{...dn.readerArea,backgroundColor:"#000",transition:void 0},titleArea:{...dn.titleArea,color:"#ccc"},tocArea:{...dn.tocArea,background:"#111"},tocButtonExpanded:{...dn.tocButtonExpanded,background:"#222"},tocButtonBar:{...dn.tocButtonBar,background:"#fff"},tocButton:{...dn.tocButton,color:"white"}};function l9({tags:i}){return i?E.jsx("div",{className:`flex flex-row flex-wrap mb-[1rem] gap-2 ${i.length===0?"hidden":""}`,children:i.map(e=>E.jsx("div",{className:"bg-primary text-white rounded-md px-2 py-1 text-sm font-semibold",children:e},e))}):null}function u9({series:i}){var t,r;const{t:e}=ir();return i?E.jsxs("div",{className:"text-sm mb-[1rem] bg-primary rounded-xl p-3 text-white mt-[1rem] flex flex-col gap-1",children:[i.manga_data.authors&&i.manga_data.authors.length>0&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("series.authors"),":"]})," ",(t=i.manga_data.authors)==null?void 0:t.join(", ")]}),i.manga_data.genres&&i.manga_data.genres.length>0&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("series.genres"),":"]})," ",(r=i.manga_data.genres)==null?void 0:r.join(", ")]})]}):null}const c9=T.memo(function({entity:e,offline:t,series:r}){const{libraryData:n}=Xr(Dt(b=>({libraryData:b.libraryData}))),s=Br(),{isFileAvailableOffline:a,makeSeriesAvailableOffline:o,makeSeriesUnavailableOffline:l}=Hp(),[c,h]=T.useState(!1),f=T.useRef(null),{imagePath:m,isLoading:p}=Pw({type:"file",entity:e,libraryId:n==null?void 0:n.id,offline:t});T.useEffect(()=>{t||a(e.id).then(b=>{h(b)})},[t,e.file_id,a]),T.useEffect(()=>{if(m&&f.current){const b=f.current;b.src!==m&&(b.src=m);const _=new Image;_.src=m,_.onload=()=>{b.src===m&&b.complete&&(b.style.opacity="1")}}},[m]);const x=T.useCallback(()=>{if(!n)return;const b=n.type==="manga"?`/manga/${t?e.file_id:e.id}/read${t?`?isLocal=true&server=${e.server}`:""}`:`/book/${t?e.file_id:e.id}/read${t?`?isLocal=true&server=${e.server}`:""}`;s(b)},[n,e.id,t,s]),g=T.useMemo(()=>e.volume>0?`Vol. ${e.volume}`:e.chapter>0?`Ch. ${e.chapter}`:e.file_name,[e]),y=T.useMemo(()=>e.is_read,[e]);return!n||p?E.jsxs("div",{className:"bg-primary text-white rounded-xl flex flex-col h-full animate-pulse",children:[E.jsx("div",{className:"h-[16rem] bg-gray-300 rounded-t-xl"}),E.jsx("div",{className:"text-sm p-3 flex-1 flex items-center justify-center",children:E.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"})})]}):E.jsx("button",{className:"bg-primary text-white rounded-xl flex flex-col hover:cursor-pointer h-full transition-transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>{x()},style:{contain:"layout style paint"},children:E.jsxs("div",{className:"h-[14rem] relative overflow-hidden",children:[E.jsx("div",{className:Number(e.current_page)>1&&Number(e.current_page)===Number(e.total_pages)?"opacity-50":"",children:E.jsx("img",{ref:f,src:m||"",alt:e.file_name,className:"w-full h-full object-cover rounded-t-xl",style:{willChange:"auto",opacity:"0.5",transition:"opacity 0.2s ease-in-out"},onLoad:b=>{const _=b.currentTarget;_.style.opacity="1"},onError:b=>{const _=b.currentTarget;m&&_.src!==m&&setTimeout(()=>{_.src=m},100)}})}),E.jsx("button",{className:"absolute top-1 left-1 bg-black/75 text-white p-2 rounded-full hover:cursor-pointer",style:{zIndex:1e3},onClick:b=>{b.preventDefault(),b.stopPropagation(),c||t?l(r,e):o(r,e)},children:c||t?E.jsx(O8,{className:"w-4 h-4 text-green-500"}):E.jsx(F8,{className:"w-4 h-4"})}),y||Number(e.current_page)===Number(e.total_pages)?E.jsx("div",{className:"absolute top-1 right-1 bg-black/75 text-white p-1 rounded-full",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})}):E.jsx(E.Fragment,{children:Number(e.current_page)>1&&E.jsxs("div",{className:"absolute top-1 right-1 bg-black/75 text-white p-1 rounded-xl text-sm px-2 py-1",children:[e.current_page," / ",e.total_pages]})}),E.jsx("div",{className:"absolute bottom-1 left-1 right-1 bg-black/80 rounded-lg text-sm px-3 py-1 flex-1 flex items-center justify-center",children:E.jsx("span",{className:"line-clamp-3 text-center leading-relaxed",children:g})})]})})},(i,e)=>i.entity.id===e.entity.id&&i.entity.volume===e.entity.volume&&i.entity.chapter===e.entity.chapter&&i.offline===e.offline&&i.entity.is_read===e.entity.is_read);function d9({series:i}){const[e,t]=T.useState(!0);return i?E.jsxs("div",{className:"text-sm mb-[1rem] bg-primary rounded-xl p-3 text-white",children:[E.jsx("div",{className:`${e?"line-clamp-4":"line-clamp-none"}`,children:i.manga_data.synopsis&&i.manga_data.synopsis.length>0?i.manga_data.synopsis:"No description available."}),E.jsx("button",{className:"text-xs text-gray-200 mt-[1rem] hover:cursor-pointer",onClick:()=>t(!e),children:e?"Read more":"Read less"})]}):null}function h9({series:i}){const{t:e}=ir();return i?E.jsxs("div",{className:"bg-primary rounded-xl p-3 mb-[1rem] text-white text-sm mt-[1rem] flex flex-col gap-1",children:[i.manga_data.published_from&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("series.publishedFrom"),":"]})," ",new Date(i.manga_data.published_from).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})]}),i.manga_data.published_to&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("series.publishedTo"),":"]})," ",new Date(i.manga_data.published_to).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})]}),i.manga_data.total_volumes&&i.manga_data.total_volumes>0&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("series.volumes"),":"]})," ",i.manga_data.total_volumes]}),i.manga_data.total_chapters&&i.manga_data.total_chapters>0&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e("series.chapters"),":"]})," ",i.manga_data.total_chapters]})]}):null}function f9({series:i}){return!i||!i.manga_data||!i.manga_data.titles||i.manga_data.titles.length===0?null:E.jsx("div",{className:"bg-primary rounded-xl p-3 mb-[1rem] text-white text-sm mt-[1rem] flex flex-col gap-1",children:i.manga_data.titles.map(e=>E.jsx("div",{children:e.type!=="Default"&&E.jsxs("div",{children:[E.jsxs("span",{className:"font-bold",children:[e.type,":"]})," ",e.title]})}))})}function p9(){const{t:i}=ir(),{id:e}=cc(),[t]=Ul(),r=t.get("isLocal")==="true",n=t.get("server"),{series:s,offlineAvailability:a,retrieveSeries:o,retrieveLocalSeries:l}=Hp(),{filesData:c,libraryId:h}=Xr(Dt(x=>({filesData:x.filesData,libraryId:x.libraryId}))),f=s&&(r||h!=null),{imagePath:m,isLoading:p}=Pw({type:"manga",entity:s||{id:-1,series_id:-1},libraryId:h||0,offline:r});return T.useEffect(()=>{r?l(Number(e),n||""):e&&o(Number(e))},[e,o,l,r,n]),E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-24 pt-8",children:s?E.jsx(E.Fragment,{children:E.jsxs("div",{className:"mt-[1rem]",children:[E.jsx(X5,{type:"series",entity:s,libraryId:h||0,isLocal:r,offlineAvailability:a,localServer:n}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-0 md:gap-5",children:[E.jsxs("div",{children:[E.jsx("div",{className:"mb-[1rem]",children:!f||p?E.jsx("div",{className:"w-full h-64 bg-gray-300 rounded-xl animate-pulse flex items-center justify-center",children:E.jsx("span",{className:"text-gray-500",children:i("common.loading")})}):E.jsx("img",{src:m||"",alt:"Series cover",className:"w-full h-auto rounded-xl"})}),!r&&E.jsx(K5,{series:s,retrieveSeries:()=>{r?l(Number(e),n||""):e&&o(Number(e))}}),E.jsx(u9,{series:s}),E.jsx(f9,{series:s}),E.jsx(h9,{series:s})]}),E.jsxs("div",{className:"col-span-3 pb-[8rem]",children:[!r&&E.jsx(l9,{tags:s.tags||[]}),E.jsx(d9,{series:s}),c&&c.length>0&&E.jsx("div",{className:"mt-[1rem] grid grid-cols-1 md:grid-cols-5 gap-5 auto-rows-fr",children:c&&c.map(x=>E.jsx(c9,{entity:x,offline:r,series:s},x.id))})]})]})]})}):E.jsx($p,{})}),E.jsx(es,{})]})}var $c={},Aa={},FR;function m9(){if(FR)return Aa;FR=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.retrieveOpenLibraryMetadata=Aa.retrieveGoogleBooksMetadata=Aa.retrieveJikanMetadata=Aa.retrieveComicVineMetadata=void 0;const i=(p,x,g)=>{if(!["title"].includes(p))throw new Error("invalid selector");return`https://comicvine.gamespot.com/api/volumes/?api_key=${g}&format=json&filter=name:${encodeURIComponent(x)}`},e=(p,x)=>{if(!["id","title"].includes(p))throw new Error("invalid selector");return`https://api.jikan.moe/v4/manga${p==="id"?`/${x}`:`?q=${x}`}`},t=(p,x)=>{if(!["id","title"].includes(p))throw new Error("invalid selector");return`https://www.googleapis.com/books/v1/volumes?q=${p==="id"?`isbn:${x}`:x.replace(/\s+/g,"+").toLowerCase()}`},r=(p,x)=>{if(!["id","title"].includes(p))throw new Error("invalid selector");return`https://search.devourer.app/search?by=${p}&query=${x}`},n=async(p,x,g)=>{const y=i(p,x,g),_=await(await fetch(y,{headers:{"Content-Type":"application/json"}})).json();return l(_,x)};Aa.retrieveComicVineMetadata=n;const s=async(p,x,g=!1)=>{const y=e(p,x),_=await(await fetch(y,{headers:{"Content-Type":"application/json"}})).json();return c(_,x,g)};Aa.retrieveJikanMetadata=s;const a=async(p,x,g)=>{const y=t(p,x),_=await(await fetch(y,{headers:{"Content-Type":"application/json"}})).json();return f(_,x)};Aa.retrieveGoogleBooksMetadata=a;const o=async(p,x)=>{const g=r(p,x),b=await(await fetch(g,{headers:{"Content-Type":"application/json"}})).json();return m(b,x)};Aa.retrieveOpenLibraryMetadata=o;const l=(p,x)=>{if(!p.results||p.results.length===0)throw new Error("no results found");let g=null;for(const b of p.results)if(b.name.toLowerCase()===x.toLowerCase()){g=b;break}return g||(g=p.results[0]),{metadata_id:g.id,metadata_provider:"comicvine",title:g.name?g.name:null,titles:g.name?[g.name]:[],synopsis:null,background:g.description?g.description:null,coverImage:g.image&&g.image.medium_url?g.image.medium_url:null,authors:g.publisher&&g.publisher.name?[g.publisher.name]:[],demographics:[],genres:[],themes:[],score:null,url:g.api_detail_url?g.api_detail_url:null,total_volumes:null,total_chapters:g.count_of_issues?g.count_of_issues:null,published_from:g.start_year??null,published_to:null,status:null}},c=(p,x,g=!1)=>{if(!p.data||p.data.length===0)throw new Error("no results found");if(g)return p.data.map(y=>h(y));{let y=null;for(const _ of p.data)if(_.titles.some(S=>S.title.toLowerCase()===x.toLowerCase())){y=_;break}return y||(y=p.data[0]),h(y)}},h=p=>{let x=null;for(const g of p.titles)if(g.type==="English"){x=g.title;break}return{metadata_id:p.mal_id,metadata_provider:"jikan",title:x||(p.title?p.title:null),titles:p.titles?p.titles:[],synopsis:p.synopsis?p.synopsis:null,background:p.background?p.background:null,coverImage:p.images?p.images.webp.image_url:null,authors:p.authors?p.authors.map(g=>g.name):[],demographics:p.demographics?p.demographics.map(g=>g.name):[],genres:p.genres?p.genres.map(g=>g.name):[],themes:p.themes?p.themes.map(g=>g.name):[],score:p.score?p.score:null,url:p.url?p.url:null,total_volumes:p.volumes?p.volumes:null,total_chapters:p.chapters?p.chapters:null,published_from:p.published.from?p.published.from:null,published_to:p.published.to?p.published.to:null,status:p.status?p.status:null}},f=(p,x)=>{var y;if(!p.items||p.items.length===0)throw new Error("no results found");let g=null;if(p.items=p.items.filter(b=>b.volumeInfo.categories?!b.volumeInfo.categories.includes("Comics & Graphic Novels"):!0),p.items.length===0)throw new Error("no results found after filtering comics");for(const b of p.items)if(!(!b.volumeInfo.description||!b.volumeInfo.title)&&b.volumeInfo.title.toLowerCase()===x.toLowerCase()){g=b;break}return g||(g=p.items[0]),{title:g.volumeInfo.title||null,isbn_10:null,isbn_13:null,publish_date:g.volumeInfo.publishedDate||null,oclc_numbers:null,work_key:null,key:null,dewey_decimal_class:null,description:g.volumeInfo.description||null,authors:g.volumeInfo.authors||[],genres:g.volumeInfo.categories||[],publishers:g.volumeInfo.publisher?[g.volumeInfo.publisher]:[],identifiers:g.volumeInfo.industryIdentifiers||[],subtitle:g.volumeInfo.subtitle||null,number_of_pages:g.volumeInfo.pageCount||null,cover:((y=g.volumeInfo.imageLinks)==null?void 0:y.thumbnail)||null,subjects:g.volumeInfo.categories||[],provider:"google"}},m=(p,x)=>{if(!p.hits||!p.hits.hits||p.hits.hits.length===0)throw new Error("no results found");let g=null;const y=p.hits.hits.map(_=>_._source);for(const _ of y)if(!(!_.description||!_.title)&&_.title.toLowerCase()===x.toLowerCase()){g=_;break}g||(g=y[0]);const b={title:g.title||null,isbn_10:g.isbn_10||null,isbn_13:g.isbn_13||null,publish_date:g.publish_date||null,oclc_numbers:g.oclc_numbers||null,work_key:g.work_key||null,key:g.key||null,dewey_decimal_class:g.dewey_decimal_class||null,description:g.description||null,authors:g.authors||[],genres:g.genres||[],publishers:g.publishers||[],identifiers:[],subtitle:g.subtitle||null,number_of_pages:g.number_of_pages||null,cover:g.cover||null,subjects:g.subjects||[],provider:"devourer"};return g.isbn_10&&b.identifiers.push({type:"ISBN_10",identifier:g.isbn_10}),g.isbn_13&&b.identifiers.push({type:"ISBN_13",identifier:g.isbn_13}),b};return Aa}var MR;function g9(){if(MR)return $c;MR=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.retrieveMetadataResults=$c.retrieveMetadata=void 0;const i=m9(),e=["comicvine","googlebooks","jikan","myanimelist","openlibrary"],t=async(n,s="title",a,o)=>{let l=null;if(!e.includes(n)||["comicvine"].includes(n)&&!o)return null;switch(n){case"comicvine":l=await(0,i.retrieveComicVineMetadata)(s,a,o||"");break;case"googlebooks":l=await(0,i.retrieveGoogleBooksMetadata)(s,a,o||null);break;case"jikan":l=await(0,i.retrieveJikanMetadata)(s,a);break;case"myanimelist":l=await(0,i.retrieveJikanMetadata)(s,a);break;case"openlibrary":l=await(0,i.retrieveOpenLibraryMetadata)(s,a);break}return l||null};$c.retrieveMetadata=t;const r=async(n,s,a)=>{if(!e.includes(n))return null;try{switch(n){case"myanimelist":return await(0,i.retrieveJikanMetadata)(s,a,!0)}return[]}catch(o){return console.error(o),[]}};return $c.retrieveMetadataResults=r,$c}var v9=g9();function y9({series:i,displayJikan:e,setDisplayJikan:t}){const{libraryId:r}=Xr(Dt(x=>({libraryId:x.libraryId}))),{retrieveLibrary:n}=vn(),{updateMetadata:s}=Vl(),[a,o]=T.useState([]),[l,c]=T.useState(!1),[h,f]=T.useState(i.title||""),m=async()=>{if(l)return;c(!0);const x=await v9.retrieveMetadataResults("myanimelist","title",h);o(x||[]),c(!1)},p=async x=>{l||(c(!0),await s(r||0,i.id,x),await n(r||0),c(!1),t(!1))};return E.jsx(ms,{open:e,as:"div",className:"relative z-10 focus:outline-none",onClose:()=>t(!1),children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen mt-[2rem] overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-6xl rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-2",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:"Search MyAnimeList"}),E.jsx("div",{className:"flex items-center justify-center",children:E.jsx("button",{className:"bg-secondary p-3 rounded-full text-white hover:cursor-pointer",onClick:()=>t(!1),children:E.jsx(Oo,{className:"w-6 h-6"})})})]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"name",className:"font-semibold",children:"Query"}),E.jsx("input",{type:"text",id:"name",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:h,onChange:x=>f(x.target.value)})]}),E.jsx("div",{className:"mt-5",children:E.jsx(Yt,{className:"md:w-full",onPress:m,disabled:l,"aria-busy":l,children:"Search"})}),a.length>0&&E.jsx("div",{className:"mt-5",children:E.jsxs("table",{className:"w-full text-sm [&>tbody>*:nth-child(odd)]:bg-input [&>tbody>*:nth-child(even)]:bg-primary text-white rounded-lg overflow-hidden",children:[E.jsx("thead",{children:E.jsxs("tr",{className:"bg-primary text-left",children:[E.jsx("th",{className:"p-3",children:"Cover"}),E.jsx("th",{className:"p-3",children:"Title"}),E.jsx("th",{className:"p-3 text-right",children:" "})]})}),E.jsx("tbody",{children:a.map(x=>{var g,y;return E.jsxs("tr",{children:[E.jsx("td",{className:"p-3",children:x.coverImage&&E.jsx("img",{src:x.coverImage,alt:x.title,className:"h-[12rem] object-contain rounded-lg aspect-square"})}),E.jsx("td",{className:"p-3",children:x.titles&&((g=x.titles.find(b=>b.type==="English"))!=null&&g.title)?(y=x.titles.find(b=>b.type==="English"))==null?void 0:y.title:x.title}),E.jsx("td",{className:"p-3 text-right",children:E.jsx(Yt,{className:"ml-auto mr-0 text-xs",onPress:()=>{p(x)},children:"Select"})})]},x.id)})})]})})]})})})})}function b9(){var C,R;const{t:i}=ir(),{id:e}=cc(),[t]=Ul(),r=t.get("local")==="book"||t.get("local")==="manga",n=t.get("local"),s=t.get("localServer"),{series:a,retrieveSeries:o,retrieveLocalSeries:l}=Hp(),{updateMetadata:c}=Vl(),h=Br(),{retrieveLibrary:f}=vn(),{libraryData:m,libraryId:p}=Xr(Dt(N=>({libraryData:N.libraryData,libraryId:N.libraryId}))),[x,g]=T.useState(!1),[y,b]=T.useState(!1),[_,S]=T.useState({});T.useEffect(()=>{e&&k(Number(e))},[e,o,r,n]);const k=async N=>{if(r){const O=await l(N,s||"");S(O.manga_data)}else{const O=await o(N);S(O.manga_data)}};return E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-[8rem] pt-8",children:!_||!a||!p?E.jsx($p,{}):E.jsx(E.Fragment,{children:E.jsxs("div",{className:"mt-[1rem]",children:[E.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-[1rem] gap-3",children:[E.jsxs(Yt,{className:"w-full md:w-auto",onPress:()=>{h(r?`/manga/${a.series_id}?isLocal=true&server=${s}`:`/manga/${a.id}`)},children:[E.jsx(Pp,{className:"w-4 h-4"}),i("common.returnToManga")]}),E.jsxs(Yt,{className:"w-full md:w-auto",onPress:()=>{g(!0)},children:[E.jsx(CS,{className:"w-4 h-4"}),i("common.searchJikanMetadata")]})]}),E.jsxs("div",{className:"bg-primary rounded-xl p-3 text-white",children:[E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"title",className:"font-semibold",children:"Default Title"}),E.jsx("input",{id:"title",type:"text",value:_.title||a.title,onChange:N=>{S({..._,title:N.target.value})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"description",className:"font-semibold",children:"Description"}),E.jsx("textarea",{id:"description",rows:4,value:_.synopsis||"",onChange:N=>{S({..._,synopsis:N.target.value})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsxs("label",{htmlFor:"authors",className:"font-semibold",children:["Authors"," ",E.jsx("span",{className:"text-xs",children:"(separated by comma)"})]}),E.jsx("input",{id:"authors",type:"text",value:((C=_.authors)==null?void 0:C.join(", "))||"",onChange:N=>{S({..._,authors:N.target.value.split(",").map(O=>O.trim())})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsxs("label",{htmlFor:"genres",className:"font-semibold",children:["Genres ",E.jsx("span",{className:"text-xs",children:"(separated by comma)"})]}),E.jsx("input",{id:"genres",type:"text",value:((R=_.genres)==null?void 0:R.join(", "))||"",onChange:N=>{S({..._,genres:N.target.value.split(",").map(O=>O.trim())})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"publishedFrom",className:"font-semibold",children:"Published from"}),E.jsx("input",{id:"publishedFrom",type:"text",value:_.published_from||"",onChange:N=>{S({..._,published_from:N.target.value})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"publishedTo",className:"font-semibold",children:"Published to"}),E.jsx("input",{id:"publishedTo",type:"text",value:_.published_to||"",onChange:N=>{S({..._,published_to:N.target.value})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"publishDate",className:"font-semibold",children:"Total chapters"}),E.jsx("input",{id:"totalChapters",type:"text",value:_.total_chapters||"",onChange:N=>{S({..._,total_chapters:N.target.value})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"totalVolumes",className:"font-semibold",children:"Total volumes"}),E.jsx("input",{id:"totalVolumes",type:"text",value:_.total_volumes||"",onChange:N=>{S({..._,total_volumes:N.target.value})},className:"w-full p-2 mt-2 rounded-md border border-gray-300"})]})]}),E.jsx("div",{className:"mt-[1rem] mb-[3rem]",children:E.jsx(Yt,{onPress:async()=>{if(y)return;b(!0),await c(p,r?a.series_id:a.id,_,r,s||void 0)&&f(m.id),b(!1)},disabled:y,className:"w-full md:text-lg",children:i("common.saveChanges")})})]})})}),a&&E.jsx(y9,{series:a,displayJikan:x,setDisplayJikan:g}),E.jsx(es,{})]})}var ha=function(i,e){return Number(i.toFixed(e))},w9=function(i,e){return e},tn=function(i,e,t){t&&typeof t=="function"&&t(i,e)},x9=function(i){return-Math.cos(i*Math.PI)/2+.5},_9=function(i){return i},E9=function(i){return i*i},S9=function(i){return i*(2-i)},A9=function(i){return i<.5?2*i*i:-1+(4-2*i)*i},C9=function(i){return i*i*i},k9=function(i){return--i*i*i+1},T9=function(i){return i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},R9=function(i){return i*i*i*i},N9=function(i){return 1- --i*i*i*i},D9=function(i){return i<.5?8*i*i*i*i:1-8*--i*i*i*i},L9=function(i){return i*i*i*i*i},P9=function(i){return 1+--i*i*i*i*i},O9=function(i){return i<.5?16*i*i*i*i*i:1+16*--i*i*i*i*i},GP={easeOut:x9,linear:_9,easeInQuad:E9,easeOutQuad:S9,easeInOutQuad:A9,easeInCubic:C9,easeOutCubic:k9,easeInOutCubic:T9,easeInQuart:R9,easeOutQuart:N9,easeInOutQuart:D9,easeInQuint:L9,easeOutQuint:P9,easeInOutQuint:O9},qP=function(i){typeof i=="number"&&cancelAnimationFrame(i)},Ha=function(i){i.mounted&&(qP(i.animation),i.animate=!1,i.animation=null,i.velocity=null)};function YP(i,e,t,r){if(i.mounted){var n=new Date().getTime(),s=1;Ha(i),i.animation=function(){if(!i.mounted)return qP(i.animation);var a=new Date().getTime()-n,o=a/t,l=GP[e],c=l(o);a>=t?(r(s),i.animation=null):i.animation&&(r(c),requestAnimationFrame(i.animation))},requestAnimationFrame(i.animation)}}function I9(i){var e=i.scale,t=i.positionX,r=i.positionY;return!(Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(r))}function fc(i,e,t,r){var n=I9(e);if(!(!i.mounted||!n)){var s=i.setTransformState,a=i.transformState,o=a.scale,l=a.positionX,c=a.positionY,h=e.scale-o,f=e.positionX-l,m=e.positionY-c;t===0?s(e.scale,e.positionX,e.positionY):YP(i,r,t,function(p){var x=o+h*p,g=l+f*p,y=c+m*p;s(x,g,y)})}}function F9(i,e,t){var r=i.offsetWidth,n=i.offsetHeight,s=e.offsetWidth,a=e.offsetHeight,o=s*t,l=a*t,c=r-o,h=n-l;return{wrapperWidth:r,wrapperHeight:n,newContentWidth:o,newDiffWidth:c,newContentHeight:l,newDiffHeight:h}}var M9=function(i,e,t,r,n,s,a){var o=i>e?t*(a?1:.5):0,l=r>n?s*(a?1:.5):0,c=i-e-o,h=o,f=r-n-l,m=l;return{minPositionX:c,maxPositionX:h,minPositionY:f,maxPositionY:m}},tA=function(i,e){var t=i.wrapperComponent,r=i.contentComponent,n=i.setup.centerZoomedOut;if(!t||!r)throw new Error("Components are not mounted");var s=F9(t,r,e),a=s.wrapperWidth,o=s.wrapperHeight,l=s.newContentWidth,c=s.newDiffWidth,h=s.newContentHeight,f=s.newDiffHeight,m=M9(a,l,c,o,h,f,!!n);return m},JE=function(i,e,t,r){return r?i<e?ha(e,2):i>t?ha(t,2):ha(i,2):ha(i,2)},lh=function(i,e){var t=tA(i,e);return i.bounds=t,t};function w0(i,e,t,r,n,s,a){var o=t.minPositionX,l=t.minPositionY,c=t.maxPositionX,h=t.maxPositionY,f=0,m=0;a&&(f=n,m=s);var p=JE(i,o-f,c+f,r),x=JE(e,l-m,h+m,r);return{x:p,y:x}}function qw(i,e,t,r,n,s){var a=i.transformState,o=a.scale,l=a.positionX,c=a.positionY,h=r-o;if(typeof e!="number"||typeof t!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:c};var f=l-e*h,m=c-t*h,p=w0(f,m,n,s,0,0,null);return p}function x0(i,e,t,r,n){var s=n?r:0,a=e-s;return!Number.isNaN(t)&&i>=t?t:!Number.isNaN(e)&&i<=a?a:i}var jR=function(i,e){var t=i.setup.panning.excluded,r=i.isInitialized,n=i.wrapperComponent,s=e.target,a="shadowRoot"in s&&"composedPath"in e,o=a?e.composedPath().some(function(h){return h instanceof Element?n==null?void 0:n.contains(h):!1}):n==null?void 0:n.contains(s),l=r&&s&&o;if(!l)return!1;var c=Yw(s,t);return!c},BR=function(i){var e=i.isInitialized,t=i.isPanning,r=i.setup,n=r.panning.disabled,s=e&&t&&!n;return!!s},j9=function(i,e){var t=i.transformState,r=t.positionX,n=t.positionY;i.isPanning=!0;var s=e.clientX,a=e.clientY;i.startCoords={x:s-r,y:a-n}},B9=function(i,e){var t=e.touches,r=i.transformState,n=r.positionX,s=r.positionY;i.isPanning=!0;var a=t.length===1;if(a){var o=t[0].clientX,l=t[0].clientY;i.startCoords={x:o-n,y:l-s}}};function z9(i){var e=i.transformState,t=e.positionX,r=e.positionY,n=e.scale,s=i.setup,a=s.disabled,o=s.limitToBounds,l=s.centerZoomedOut,c=i.wrapperComponent;if(!(a||!c||!i.bounds)){var h=i.bounds,f=h.maxPositionX,m=h.minPositionX,p=h.maxPositionY,x=h.minPositionY,g=t>f||t<m,y=r>p||r<x,b=t>f?c.offsetWidth:i.setup.minPositionX||0,_=r>p?c.offsetHeight:i.setup.minPositionY||0,S=qw(i,b,_,n,i.bounds,o||l),k=S.x,C=S.y;return{scale:n,positionX:g?k:t,positionY:y?C:r}}}function XP(i,e,t,r,n){var s=i.setup.limitToBounds,a=i.wrapperComponent,o=i.bounds,l=i.transformState,c=l.scale,h=l.positionX,f=l.positionY;if(!(a===null||o===null||e===h&&t===f)){var m=w0(e,t,o,s,r,n,a),p=m.x,x=m.y;i.setTransformState(c,p,x)}}var $9=function(i,e,t){var r=i.startCoords,n=i.transformState,s=i.setup.panning,a=s.lockAxisX,o=s.lockAxisY,l=n.positionX,c=n.positionY;if(!r)return{x:l,y:c};var h=e-r.x,f=t-r.y,m=a?l:h,p=o?c:f;return{x:m,y:p}},sc=function(i,e){var t=i.setup,r=i.transformState,n=r.scale,s=t.minScale,a=t.disablePadding;return e>0&&n>=s&&!a?e:0},U9=function(i){var e=i.mounted,t=i.setup,r=t.disabled,n=t.velocityAnimation,s=i.transformState.scale,a=n.disabled,o=!a||s>1||!r||e;return!!o},H9=function(i){var e=i.mounted,t=i.velocity,r=i.bounds,n=i.setup,s=n.disabled,a=n.velocityAnimation,o=i.transformState.scale,l=a.disabled,c=!l||o>1||!s||e;return!(!c||!t||!r)};function W9(i,e){var t=i.setup.velocityAnimation,r=t.equalToMove,n=t.animationTime,s=t.sensitivity;return r?n*e*s:n}function zR(i,e,t,r,n,s,a,o,l,c){if(n){if(e>a&&t>a){var h=a+(i-a)*c;return h>l?l:h<a?a:h}if(e<s&&t<s){var h=s+(i-s)*c;return h<o?o:h>s?s:h}}return r?e:JE(i,s,a,n)}function V9(i,e){var t=1;return e?Math.min(t,i.offsetWidth/window.innerWidth):t}function G9(i,e){var t=U9(i);if(t){var r=i.lastMousePosition,n=i.velocityTime,s=i.setup,a=i.wrapperComponent,o=s.velocityAnimation.equalToMove,l=Date.now();if(r&&n&&a){var c=V9(a,o),h=e.x-r.x,f=e.y-r.y,m=h/c,p=f/c,x=l-n,g=h*h+f*f,y=Math.sqrt(g)/x;i.velocity={velocityX:m,velocityY:p,total:y}}i.lastMousePosition=e,i.velocityTime=l}}function q9(i){var e=i.velocity,t=i.bounds,r=i.setup,n=i.wrapperComponent,s=H9(i);if(!(!s||!e||!t||!n)){var a=e.velocityX,o=e.velocityY,l=e.total,c=t.maxPositionX,h=t.minPositionX,f=t.maxPositionY,m=t.minPositionY,p=r.limitToBounds,x=r.alignmentAnimation,g=r.zoomAnimation,y=r.panning,b=y.lockAxisY,_=y.lockAxisX,S=g.animationType,k=x.sizeX,C=x.sizeY,R=x.velocityAlignmentTime,N=R,O=W9(i,l),I=Math.max(O,N),F=sc(i,k),G=sc(i,C),B=F*n.offsetWidth/100,Y=G*n.offsetHeight/100,j=c+B,ae=h-B,he=f+Y,ee=m-Y,Z=i.transformState,ie=new Date().getTime();YP(i,S,I,function(ge){var V=i.transformState,K=V.scale,be=V.positionX,Ae=V.positionY,ce=new Date().getTime()-ie,Pe=ce/N,Ve=GP[x.animationType],$e=1-Ve(Math.min(1,Pe)),qe=1-ge,Ze=be+a*qe,at=Ae+o*qe,gt=zR(Ze,Z.positionX,be,_,p,h,c,ae,j,$e),ut=zR(at,Z.positionY,Ae,b,p,m,f,ee,he,$e);(be!==Ze||Ae!==at)&&i.setTransformState(K,gt,ut)})}}function $R(i,e){var t=i.transformState.scale;Ha(i),lh(i,t),window.TouchEvent!==void 0&&e instanceof TouchEvent?B9(i,e):j9(i,e)}function rA(i,e){var t=i.transformState.scale,r=i.setup,n=r.minScale,s=r.alignmentAnimation,a=s.disabled,o=s.sizeX,l=s.sizeY,c=s.animationTime,h=s.animationType,f=a||t<n||!o&&!l;if(!f){var m=z9(i);m&&fc(i,m,e??c,h)}}function UR(i,e,t){var r=i.startCoords,n=i.setup,s=n.alignmentAnimation,a=s.sizeX,o=s.sizeY;if(r){var l=$9(i,e,t),c=l.x,h=l.y,f=sc(i,a),m=sc(i,o);G9(i,{x:c,y:h}),XP(i,c,h,f,m)}}function Y9(i){if(i.isPanning){var e=i.setup.panning.velocityDisabled,t=i.velocity,r=i.wrapperComponent,n=i.contentComponent;i.isPanning=!1,i.animate=!1,i.animation=null;var s=r==null?void 0:r.getBoundingClientRect(),a=n==null?void 0:n.getBoundingClientRect(),o=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,c=(a==null?void 0:a.width)||0,h=(a==null?void 0:a.height)||0,f=o<c||l<h,m=!e&&t&&(t==null?void 0:t.total)>.1&&f;m?q9(i):rA(i)}}function nA(i,e,t,r){var n=i.setup,s=n.minScale,a=n.maxScale,o=n.limitToBounds,l=x0(ha(e,2),s,a,0,!1),c=lh(i,l),h=qw(i,t,r,l,c,o),f=h.x,m=h.y;return{scale:l,positionX:f,positionY:m}}function KP(i,e,t){var r=i.transformState.scale,n=i.wrapperComponent,s=i.setup,a=s.minScale,o=s.limitToBounds,l=s.zoomAnimation,c=l.disabled,h=l.animationTime,f=l.animationType,m=c||r>=a;if((r>=1||o)&&rA(i),!(m||!n||!i.mounted)){var p=e||n.offsetWidth/2,x=t||n.offsetHeight/2,g=nA(i,a,p,x);g&&fc(i,g,h,f)}}var tc=function(){return tc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},tc.apply(this,arguments)};function HR(i,e,t){for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return i.concat(s||Array.prototype.slice.call(e))}var Hy={scale:1,positionX:0,positionY:0},Mm={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},eS={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},ZP=function(i){var e,t,r,n;return{previousScale:(e=i.initialScale)!==null&&e!==void 0?e:Hy.scale,scale:(t=i.initialScale)!==null&&t!==void 0?t:Hy.scale,positionX:(r=i.initialPositionX)!==null&&r!==void 0?r:Hy.positionX,positionY:(n=i.initialPositionY)!==null&&n!==void 0?n:Hy.positionY}},WR=function(i){var e=tc({},Mm);return Object.keys(i).forEach(function(t){var r=typeof i[t]<"u",n=typeof Mm[t]<"u";if(n&&r){var s=Object.prototype.toString.call(Mm[t]),a=s==="[object Object]",o=s==="[object Array]";a?e[t]=tc(tc({},Mm[t]),i[t]):o?e[t]=HR(HR([],Mm[t],!0),i[t]):e[t]=i[t]}}),e},QP=function(i,e,t){var r=i.transformState.scale,n=i.wrapperComponent,s=i.setup,a=s.maxScale,o=s.minScale,l=s.zoomAnimation,c=s.smooth,h=l.size;if(!n)throw new Error("Wrapper is not mounted");var f=c?r*Math.exp(e*t):r+e*t,m=x0(ha(f,3),o,a,h,!1);return m};function JP(i,e,t,r,n){var s=i.wrapperComponent,a=i.transformState,o=a.scale,l=a.positionX,c=a.positionY;if(!s)return console.error("No WrapperComponent found");var h=s.offsetWidth,f=s.offsetHeight,m=(h/2-l)/o,p=(f/2-c)/o,x=QP(i,e,t),g=nA(i,x,m,p);if(!g)return console.error("Error during zoom event. New transformation state was not calculated.");fc(i,g,r,n)}function e3(i,e,t,r){var n=i.setup,s=i.wrapperComponent,a=n.limitToBounds,o=ZP(i.props),l=i.transformState,c=l.scale,h=l.positionX,f=l.positionY;if(s){var m=tA(i,o.scale),p=w0(o.positionX,o.positionY,m,a,0,0,s),x={scale:o.scale,positionX:p.x,positionY:p.y};c===o.scale&&h===o.positionX&&f===o.positionY||(r==null||r(),fc(i,x,e,t))}}function X9(i,e,t,r){var n=i.getBoundingClientRect(),s=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=s.x*r.scale,l=s.y*r.scale;return{x:(n.x-a.x+o)/r.scale,y:(n.y-a.y+l)/r.scale}}function K9(i,e,t){var r=i.wrapperComponent,n=i.contentComponent,s=i.transformState,a=i.setup,o=a.limitToBounds,l=a.minScale,c=a.maxScale;if(!r||!n)return s;var h=r.getBoundingClientRect(),f=e.getBoundingClientRect(),m=X9(e,r,n,s),p=m.x,x=m.y,g=f.width/s.scale,y=f.height/s.scale,b=r.offsetWidth/g,_=r.offsetHeight/y,S=x0(t||Math.min(b,_),l,c,0,!1),k=(h.width-g*S)/2,C=(h.height-y*S)/2,R=(h.left-p)*S+k,N=(h.top-x)*S+C,O=tA(i,S),I=w0(R,N,O,o,0,0,r),F=I.x,G=I.y;return{positionX:F,positionY:G,scale:S}}var Z9=function(i){return function(e,t,r){e===void 0&&(e=.5),t===void 0&&(t=300),r===void 0&&(r="easeOut"),JP(i,1,e,t,r)}},Q9=function(i){return function(e,t,r){e===void 0&&(e=.5),t===void 0&&(t=300),r===void 0&&(r="easeOut"),JP(i,-1,e,t,r)}},J9=function(i){return function(e,t,r,n,s){n===void 0&&(n=300),s===void 0&&(s="easeOut");var a=i.transformState,o=a.positionX,l=a.positionY,c=a.scale,h=i.wrapperComponent,f=i.contentComponent,m=i.setup.disabled;if(!(m||!h||!f)){var p={positionX:Number.isNaN(e)?o:e,positionY:Number.isNaN(t)?l:t,scale:Number.isNaN(r)?c:r};fc(i,p,n,s)}}},eU=function(i){return function(e,t){e===void 0&&(e=200),t===void 0&&(t="easeOut"),e3(i,e,t)}},tU=function(i){return function(e,t,r){t===void 0&&(t=200),r===void 0&&(r="easeOut");var n=i.transformState,s=i.wrapperComponent,a=i.contentComponent;if(s&&a){var o=t3(e||n.scale,s,a);fc(i,o,t,r)}}},rU=function(i){return function(e,t,r,n){r===void 0&&(r=600),n===void 0&&(n="easeOut"),Ha(i);var s=i.wrapperComponent,a=typeof e=="string"?document.getElementById(e):e;if(s&&a&&s.contains(a)){var o=K9(i,a,t);fc(i,o,r,n)}}},tS=function(i){return{instance:i,zoomIn:Z9(i),zoomOut:Q9(i),setTransform:J9(i),resetTransform:eU(i),centerView:tU(i),zoomToElement:rU(i)}},nU=function(i){return{instance:i,state:i.transformState}},Wr=function(i){var e={};return Object.assign(e,nU(i)),Object.assign(e,tS(i)),e},e_=!1;function t_(){try{var i={get passive(){return e_=!0,!1}};return i}catch{return e_=!1,e_}}var Wy=".".concat(eS.wrapperClass),Yw=function(i,e){return e.some(function(t){return i.matches("".concat(Wy," ").concat(t,", ").concat(Wy," .").concat(t,", ").concat(Wy," ").concat(t," *, ").concat(Wy," .").concat(t," *"))})},rS=function(i){i&&clearTimeout(i)},iU=function(i,e,t){return"translate(".concat(i,"px, ").concat(e,"px) scale(").concat(t,")")},t3=function(i,e,t){var r=t.offsetWidth*i,n=t.offsetHeight*i,s=(e.offsetWidth-r)/2,a=(e.offsetHeight-n)/2;return{scale:i,positionX:s,positionY:a}};function sU(i){return function(e){i.forEach(function(t){typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var aU=function(i,e){var t=i.setup.wheel,r=t.disabled,n=t.wheelDisabled,s=t.touchPadDisabled,a=t.excluded,o=i.isInitialized,l=i.isPanning,c=e.target,h=o&&!l&&!r&&c;if(!h||n&&!e.ctrlKey||s&&e.ctrlKey)return!1;var f=Yw(c,a);return!f},oU=function(i){return i?i.deltaY<0?1:-1:0};function lU(i,e){var t=oU(i),r=w9(e,t);return r}function r3(i,e,t){var r=e.getBoundingClientRect(),n=0,s=0;if("clientX"in i)n=(i.clientX-r.left)/t,s=(i.clientY-r.top)/t;else{var a=i.touches[0];n=(a.clientX-r.left)/t,s=(a.clientY-r.top)/t}return(Number.isNaN(n)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:n,y:s}}var uU=function(i,e,t,r,n){var s=i.transformState.scale,a=i.wrapperComponent,o=i.setup,l=o.maxScale,c=o.minScale,h=o.zoomAnimation,f=o.disablePadding,m=h.size,p=h.disabled;if(!a)throw new Error("Wrapper is not mounted");var x=s+e*t,g=r?!1:!p,y=x0(ha(x,3),c,l,m,g&&!f);return y},cU=function(i,e){var t=i.previousWheelEvent,r=i.transformState.scale,n=i.setup,s=n.maxScale,a=n.minScale;return t?r<s||r>a||Math.sign(t.deltaY)!==Math.sign(e.deltaY)||t.deltaY>0&&t.deltaY<e.deltaY||t.deltaY<0&&t.deltaY>e.deltaY||Math.sign(t.deltaY)!==Math.sign(e.deltaY):!1},dU=function(i,e){var t=i.setup.pinch,r=t.disabled,n=t.excluded,s=i.isInitialized,a=e.target,o=s&&!r&&a;if(!o)return!1;var l=Yw(a,n);return!l},hU=function(i){var e=i.setup.pinch.disabled,t=i.isInitialized,r=i.pinchStartDistance,n=t&&!e&&r;return!!n},fU=function(i,e,t){var r=t.getBoundingClientRect(),n=i.touches,s=ha(n[0].clientX-r.left,5),a=ha(n[0].clientY-r.top,5),o=ha(n[1].clientX-r.left,5),l=ha(n[1].clientY-r.top,5);return{x:(s+o)/2/e,y:(a+l)/2/e}},n3=function(i){return Math.sqrt(Math.pow(i.touches[0].pageX-i.touches[1].pageX,2)+Math.pow(i.touches[0].pageY-i.touches[1].pageY,2))},pU=function(i,e){var t=i.pinchStartScale,r=i.pinchStartDistance,n=i.setup,s=n.maxScale,a=n.minScale,o=n.zoomAnimation,l=n.disablePadding,c=o.size,h=o.disabled;if(!t||r===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return i.transformState.scale;var f=e/r,m=f*t;return x0(ha(m,2),a,s,c,!h&&!l)},mU=160,gU=100,vU=function(i,e){var t=i.props,r=t.onWheelStart,n=t.onZoomStart;i.wheelStopEventTimer||(Ha(i),tn(Wr(i),e,r),tn(Wr(i),e,n))},yU=function(i,e){var t=i.props,r=t.onWheel,n=t.onZoom,s=i.contentComponent,a=i.setup,o=i.transformState,l=o.scale,c=a.limitToBounds,h=a.centerZoomedOut,f=a.zoomAnimation,m=a.wheel,p=a.disablePadding,x=a.smooth,g=f.size,y=f.disabled,b=m.step,_=m.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var S=lU(e,null),k=x?_*Math.abs(e.deltaY):b,C=uU(i,S,k,!e.ctrlKey);if(l!==C){var R=lh(i,C),N=r3(e,s,l),O=y||g===0||h||p,I=c&&O,F=qw(i,N.x,N.y,C,R,I),G=F.x,B=F.y;i.previousWheelEvent=e,i.setTransformState(C,G,B),tn(Wr(i),e,r),tn(Wr(i),e,n)}},bU=function(i,e){var t=i.props,r=t.onWheelStop,n=t.onZoomStop;rS(i.wheelAnimationTimer),i.wheelAnimationTimer=setTimeout(function(){i.mounted&&(KP(i,e.x,e.y),i.wheelAnimationTimer=null)},gU);var s=cU(i,e);s&&(rS(i.wheelStopEventTimer),i.wheelStopEventTimer=setTimeout(function(){i.mounted&&(i.wheelStopEventTimer=null,tn(Wr(i),e,r),tn(Wr(i),e,n))},mU))},i3=function(i){for(var e=0,t=0,r=0;r<2;r+=1)e+=i.touches[r].clientX,t+=i.touches[r].clientY;var n=e/2,s=t/2;return{x:n,y:s}},wU=function(i,e){var t=n3(e);i.pinchStartDistance=t,i.lastDistance=t,i.pinchStartScale=i.transformState.scale,i.isPanning=!1;var r=i3(e);i.pinchLastCenterX=r.x,i.pinchLastCenterY=r.y,Ha(i)},xU=function(i,e){var t=i.contentComponent,r=i.pinchStartDistance,n=i.wrapperComponent,s=i.transformState.scale,a=i.setup,o=a.limitToBounds,l=a.centerZoomedOut,c=a.zoomAnimation,h=a.alignmentAnimation,f=c.disabled,m=c.size;if(!(r===null||!t)){var p=fU(e,s,t);if(!(!Number.isFinite(p.x)||!Number.isFinite(p.y))){var x=n3(e),g=pU(i,x),y=i3(e),b=y.x-(i.pinchLastCenterX||0),_=y.y-(i.pinchLastCenterY||0);if(!(g===s&&b===0&&_===0)){i.pinchLastCenterX=y.x,i.pinchLastCenterY=y.y;var S=lh(i,g),k=f||m===0||l,C=o&&k,R=qw(i,p.x,p.y,g,S,C),N=R.x,O=R.y;i.pinchMidpoint=p,i.lastDistance=x;var I=h.sizeX,F=h.sizeY,G=sc(i,I),B=sc(i,F),Y=N+b,j=O+_,ae=w0(Y,j,S,o,G,B,n),he=ae.x,ee=ae.y;i.setTransformState(g,he,ee)}}}},_U=function(i){var e=i.pinchMidpoint;i.velocity=null,i.lastDistance=null,i.pinchMidpoint=null,i.pinchStartScale=null,i.pinchStartDistance=null,KP(i,e==null?void 0:e.x,e==null?void 0:e.y)},s3=function(i,e){var t=i.props.onZoomStop,r=i.setup.doubleClick.animationTime;rS(i.doubleClickStopEventTimer),i.doubleClickStopEventTimer=setTimeout(function(){i.doubleClickStopEventTimer=null,tn(Wr(i),e,t)},r)},EU=function(i,e){var t=i.props,r=t.onZoomStart,n=t.onZoom,s=i.setup.doubleClick,a=s.animationTime,o=s.animationType;tn(Wr(i),e,r),e3(i,a,o,function(){return tn(Wr(i),e,n)}),s3(i,e)};function SU(i,e){return i==="toggle"?e===1?1:-1:i==="zoomOut"?-1:1}function AU(i,e){var t=i.setup,r=i.doubleClickStopEventTimer,n=i.transformState,s=i.contentComponent,a=n.scale,o=i.props,l=o.onZoomStart,c=o.onZoom,h=t.doubleClick,f=h.disabled,m=h.mode,p=h.step,x=h.animationTime,g=h.animationType;if(!f&&!r){if(m==="reset")return EU(i,e);if(!s)return console.error("No ContentComponent found");var y=SU(m,i.transformState.scale),b=QP(i,y,p);if(a!==b){tn(Wr(i),e,l);var _=r3(e,s,a),S=nA(i,b,_.x,_.y);if(!S)return console.error("Error during zoom event. New transformation state was not calculated.");tn(Wr(i),e,c),fc(i,S,x,g),s3(i,e)}}}var CU=function(i,e){var t=i.isInitialized,r=i.setup,n=i.wrapperComponent,s=r.doubleClick,a=s.disabled,o=s.excluded,l=e.target,c=n==null?void 0:n.contains(l),h=t&&l&&c&&!a;if(!h)return!1;var f=Yw(l,o);return!f},kU=function(){function i(e){var t=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){t.initializeWindowEvents()},this.unmount=function(){t.cleanupWindowEvents()},this.update=function(r){t.props=r,lh(t,t.transformState.scale),t.setup=WR(r)},this.initializeWindowEvents=function(){var r,n,s=t_(),a=(r=t.wrapperComponent)===null||r===void 0?void 0:r.ownerDocument,o=a==null?void 0:a.defaultView;(n=t.wrapperComponent)===null||n===void 0||n.addEventListener("wheel",t.onWheelPanning,s),o==null||o.addEventListener("mousedown",t.onPanningStart,s),o==null||o.addEventListener("mousemove",t.onPanning,s),o==null||o.addEventListener("mouseup",t.onPanningStop,s),a==null||a.addEventListener("mouseleave",t.clearPanning,s),o==null||o.addEventListener("keyup",t.setKeyUnPressed,s),o==null||o.addEventListener("keydown",t.setKeyPressed,s)},this.cleanupWindowEvents=function(){var r,n,s=t_(),a=(r=t.wrapperComponent)===null||r===void 0?void 0:r.ownerDocument,o=a==null?void 0:a.defaultView;o==null||o.removeEventListener("mousedown",t.onPanningStart,s),o==null||o.removeEventListener("mousemove",t.onPanning,s),o==null||o.removeEventListener("mouseup",t.onPanningStop,s),a==null||a.removeEventListener("mouseleave",t.clearPanning,s),o==null||o.removeEventListener("keyup",t.setKeyUnPressed,s),o==null||o.removeEventListener("keydown",t.setKeyPressed,s),document.removeEventListener("mouseleave",t.clearPanning,s),Ha(t),(n=t.observer)===null||n===void 0||n.disconnect()},this.handleInitializeWrapperEvents=function(r){var n=t_();r.addEventListener("wheel",t.onWheelZoom,n),r.addEventListener("dblclick",t.onDoubleClick,n),r.addEventListener("touchstart",t.onTouchPanningStart,n),r.addEventListener("touchmove",t.onTouchPanning,n),r.addEventListener("touchend",t.onTouchPanningStop,n)},this.handleInitialize=function(r,n){var s=!1,a=t.setup.centerOnInit,o=function(l,c){for(var h=0,f=l;h<f.length;h++){var m=f[h];if(m.target===c)return!0}return!1};t.applyTransformation(),t.onInitCallbacks.forEach(function(l){l(Wr(t))}),t.observer=new ResizeObserver(function(l){if(o(l,r)||o(l,n))if(a&&!s){var c=n.offsetWidth,h=n.offsetHeight;(c>0||h>0)&&(s=!0,t.setCenter())}else Ha(t),lh(t,t.transformState.scale),rA(t,0)}),t.observer.observe(r),t.observer.observe(n)},this.onWheelZoom=function(r){var n=t.setup.disabled;if(!n){var s=aU(t,r);if(s){var a=t.isPressingKeys(t.setup.wheel.activationKeys);a&&(vU(t,r),yU(t,r),bU(t,r))}}},this.onWheelPanning=function(r){var n=t.setup,s=n.disabled,a=n.wheel,o=n.panning;if(!(!t.wrapperComponent||!t.contentComponent||s||!a.wheelDisabled||o.disabled||!o.wheelPanning||r.ctrlKey)){r.preventDefault(),r.stopPropagation();var l=t.transformState,c=l.positionX,h=l.positionY,f=c-r.deltaX,m=h-r.deltaY,p=o.lockAxisX?c:f,x=o.lockAxisY?h:m,g=t.setup.alignmentAnimation,y=g.sizeX,b=g.sizeY,_=sc(t,y),S=sc(t,b);p===c&&x===h||XP(t,p,x,_,S)}},this.onPanningStart=function(r){var n=t.setup.disabled,s=t.props.onPanningStart;if(!n){var a=jR(t,r);if(a){var o=t.isPressingKeys(t.setup.panning.activationKeys);o&&(r.button===0&&!t.setup.panning.allowLeftClickPan||r.button===1&&!t.setup.panning.allowMiddleClickPan||r.button===2&&!t.setup.panning.allowRightClickPan||(r.preventDefault(),r.stopPropagation(),Ha(t),$R(t,r),tn(Wr(t),r,s)))}}},this.onPanning=function(r){var n=t.setup.disabled,s=t.props.onPanning;if(!n){var a=BR(t);if(a){var o=t.isPressingKeys(t.setup.panning.activationKeys);o&&(r.preventDefault(),r.stopPropagation(),UR(t,r.clientX,r.clientY),tn(Wr(t),r,s))}}},this.onPanningStop=function(r){var n=t.props.onPanningStop;t.isPanning&&(Y9(t),tn(Wr(t),r,n))},this.onPinchStart=function(r){var n=t.setup.disabled,s=t.props,a=s.onPinchingStart,o=s.onZoomStart;if(!n){var l=dU(t,r);l&&(wU(t,r),Ha(t),tn(Wr(t),r,a),tn(Wr(t),r,o))}},this.onPinch=function(r){var n=t.setup.disabled,s=t.props,a=s.onPinching,o=s.onZoom;if(!n){var l=hU(t);l&&(r.preventDefault(),r.stopPropagation(),xU(t,r),tn(Wr(t),r,a),tn(Wr(t),r,o))}},this.onPinchStop=function(r){var n=t.props,s=n.onPinchingStop,a=n.onZoomStop;t.pinchStartScale&&(_U(t),tn(Wr(t),r,s),tn(Wr(t),r,a))},this.onTouchPanningStart=function(r){var n=t.setup.disabled,s=t.props.onPanningStart;if(!n){var a=jR(t,r);if(a){var o=t.lastTouch&&+new Date-t.lastTouch<200&&r.touches.length===1;if(!o){t.lastTouch=+new Date,Ha(t);var l=r.touches,c=l.length===1,h=l.length===2;c&&(Ha(t),$R(t,r),tn(Wr(t),r,s)),h&&t.onPinchStart(r)}}}},this.onTouchPanning=function(r){var n=t.setup.disabled,s=t.props.onPanning;if(t.isPanning&&r.touches.length===1){if(n)return;var a=BR(t);if(!a)return;r.preventDefault(),r.stopPropagation();var o=r.touches[0];UR(t,o.clientX,o.clientY),tn(Wr(t),r,s)}else r.touches.length>1&&t.onPinch(r)},this.onTouchPanningStop=function(r){t.onPanningStop(r),t.onPinchStop(r)},this.onDoubleClick=function(r){var n=t.setup.disabled;if(!n){var s=CU(t,r);s&&AU(t,r)}},this.clearPanning=function(r){t.isPanning&&t.onPanningStop(r)},this.setKeyPressed=function(r){t.pressedKeys[r.key]=!0},this.setKeyUnPressed=function(r){t.pressedKeys[r.key]=!1},this.isPressingKeys=function(r){return r.length?!!r.find(function(n){return t.pressedKeys[n]}):!0},this.setTransformState=function(r,n,s){var a=t.props.onTransformed;if(!Number.isNaN(r)&&!Number.isNaN(n)&&!Number.isNaN(s)){r!==t.transformState.scale&&(t.transformState.previousScale=t.transformState.scale,t.transformState.scale=r),t.transformState.positionX=n,t.transformState.positionY=s,t.applyTransformation();var o=Wr(t);t.onChangeCallbacks.forEach(function(l){return l(o)}),tn(o,{scale:r,positionX:n,positionY:s},a)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(t.wrapperComponent&&t.contentComponent){var r=t3(t.transformState.scale,t.wrapperComponent,t.contentComponent);t.setTransformState(r.scale,r.positionX,r.positionY)}},this.handleTransformStyles=function(r,n,s){return t.props.customTransform?t.props.customTransform(r,n,s):iU(r,n,s)},this.applyTransformation=function(){if(!(!t.mounted||!t.contentComponent)){var r=t.transformState,n=r.scale,s=r.positionX,a=r.positionY,o=t.handleTransformStyles(s,a,n);t.contentComponent.style.transform=o}},this.getContext=function(){return Wr(t)},this.onChange=function(r){return t.onChangeCallbacks.has(r)||t.onChangeCallbacks.add(r),function(){t.onChangeCallbacks.delete(r)}},this.onInit=function(r){return t.onInitCallbacks.has(r)||t.onInitCallbacks.add(r),function(){t.onInitCallbacks.delete(r)}},this.init=function(r,n){t.cleanupWindowEvents(),t.wrapperComponent=r,t.contentComponent=n,lh(t,t.transformState.scale),t.handleInitializeWrapperEvents(r),t.handleInitialize(r,n),t.initializeWindowEvents(),t.isInitialized=!0;var s=Wr(t);tn(s,void 0,t.props.onInit)},this.props=e,this.setup=WR(this.props),this.transformState=ZP(this.props)}return i}(),iA=st.createContext(null),TU=function(i,e){return typeof i=="function"?i(e):i},RU=st.forwardRef(function(i,e){var t=T.useRef(new kU(i)).current,r=TU(i.children,tS(t));return T.useImperativeHandle(e,function(){return tS(t)},[t]),T.useEffect(function(){t.update(i)},[t,i]),st.createElement(iA.Provider,{value:t},r)});st.forwardRef(function(i,e){var t=T.useRef(null),r=T.useContext(iA);return T.useEffect(function(){return r.onChange(function(n){if(t.current){var s=0,a=0;t.current.style.transform=r.handleTransformStyles(s,a,1/n.instance.transformState.scale)}})},[r]),st.createElement("div",tc({},i,{ref:sU([t,e])}))});function NU(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i))}}var DU=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,VR={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};NU(DU);var LU=function(i){var e=i.children,t=i.wrapperClass,r=t===void 0?"":t,n=i.contentClass,s=n===void 0?"":n,a=i.wrapperStyle,o=i.contentStyle,l=i.wrapperProps,c=l===void 0?{}:l,h=i.contentProps,f=h===void 0?{}:h,m=T.useContext(iA),p=m.init,x=m.cleanupWindowEvents,g=T.useRef(null),y=T.useRef(null);return T.useEffect(function(){var b=g.current,_=y.current;return b!==null&&_!==null&&p&&(p==null||p(b,_)),function(){x==null||x()}},[]),st.createElement("div",tc({},c,{ref:g,className:"".concat(eS.wrapperClass," ").concat(VR.wrapper," ").concat(r),style:a}),st.createElement("div",tc({},f,{ref:y,className:"".concat(eS.contentClass," ").concat(VR.content," ").concat(s),style:o}),e))},r_={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var GR;function PU(){return GR||(GR=1,function(i,e){(function(t){i.exports=t()})(function(){return function t(r,n,s){function a(c,h){if(!n[c]){if(!r[c]){var f=typeof da=="function"&&da;if(!h&&f)return f(c,!0);if(o)return o(c,!0);var m=new Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m}var p=n[c]={exports:{}};r[c][0].call(p.exports,function(x){var g=r[c][1][x];return a(g||x)},p,p.exports,t,r,n,s)}return n[c].exports}for(var o=typeof da=="function"&&da,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,r,n){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(l){for(var c,h,f,m,p,x,g,y=[],b=0,_=l.length,S=_,k=s.getTypeOf(l)!=="string";b<l.length;)S=_-b,f=k?(c=l[b++],h=b<_?l[b++]:0,b<_?l[b++]:0):(c=l.charCodeAt(b++),h=b<_?l.charCodeAt(b++):0,b<_?l.charCodeAt(b++):0),m=c>>2,p=(3&c)<<4|h>>4,x=1<S?(15&h)<<2|f>>6:64,g=2<S?63&f:64,y.push(o.charAt(m)+o.charAt(p)+o.charAt(x)+o.charAt(g));return y.join("")},n.decode=function(l){var c,h,f,m,p,x,g=0,y=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var _,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|S):new Array(0|S);g<l.length;)c=o.indexOf(l.charAt(g++))<<2|(m=o.indexOf(l.charAt(g++)))>>4,h=(15&m)<<4|(p=o.indexOf(l.charAt(g++)))>>2,f=(3&p)<<6|(x=o.indexOf(l.charAt(g++))),_[y++]=c,p!==64&&(_[y++]=h),x!==64&&(_[y++]=f);return _}},{"./support":30,"./utils":32}],2:[function(t,r,n){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(h,f,m,p,x){this.compressedSize=h,this.uncompressedSize=f,this.crc32=m,this.compression=p,this.compressedContent=x}c.prototype={getContentWorker:function(){var h=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return h.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(h,f,m){return h.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(m)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,n){var s=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,n){var s=t("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?function(c,h,f,m){var p=a,x=m+f;c^=-1;for(var g=m;g<x;g++)c=c>>>8^p[255&(c^h[g])];return-1^c}(0|l,o,o.length,0):function(c,h,f,m){var p=a,x=m+f;c^=-1;for(var g=m;g<x;g++)c=c>>>8^p[255&(c^h.charCodeAt(g))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,r,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,r,n){var s=null;s=typeof Promise<"u"?Promise:t("lie"),r.exports={Promise:s}},{lie:37}],7:[function(t,r,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=s?"uint8array":"array";function h(f,m){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=m,this.meta={}}n.magic="\b\0",o.inherits(h,l),h.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,f.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(m){f.push({data:m,meta:f.meta})}},n.compressWorker=function(f){return new h("Deflate",f)},n.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,n){function s(p,x){var g,y="";for(g=0;g<x;g++)y+=String.fromCharCode(255&p),p>>>=8;return y}function a(p,x,g,y,b,_){var S,k,C=p.file,R=p.compression,N=_!==c.utf8encode,O=o.transformTo("string",_(C.name)),I=o.transformTo("string",c.utf8encode(C.name)),F=C.comment,G=o.transformTo("string",_(F)),B=o.transformTo("string",c.utf8encode(F)),Y=I.length!==C.name.length,j=B.length!==F.length,ae="",he="",ee="",Z=C.dir,ie=C.date,ge={crc32:0,compressedSize:0,uncompressedSize:0};x&&!g||(ge.crc32=p.crc32,ge.compressedSize=p.compressedSize,ge.uncompressedSize=p.uncompressedSize);var V=0;x&&(V|=8),N||!Y&&!j||(V|=2048);var K=0,be=0;Z&&(K|=16),b==="UNIX"?(be=798,K|=function(ce,Pe){var Ve=ce;return ce||(Ve=Pe?16893:33204),(65535&Ve)<<16}(C.unixPermissions,Z)):(be=20,K|=function(ce){return 63&(ce||0)}(C.dosPermissions)),S=ie.getUTCHours(),S<<=6,S|=ie.getUTCMinutes(),S<<=5,S|=ie.getUTCSeconds()/2,k=ie.getUTCFullYear()-1980,k<<=4,k|=ie.getUTCMonth()+1,k<<=5,k|=ie.getUTCDate(),Y&&(he=s(1,1)+s(h(O),4)+I,ae+="up"+s(he.length,2)+he),j&&(ee=s(1,1)+s(h(G),4)+B,ae+="uc"+s(ee.length,2)+ee);var Ae="";return Ae+=`
\0`,Ae+=s(V,2),Ae+=R.magic,Ae+=s(S,2),Ae+=s(k,2),Ae+=s(ge.crc32,4),Ae+=s(ge.compressedSize,4),Ae+=s(ge.uncompressedSize,4),Ae+=s(O.length,2),Ae+=s(ae.length,2),{fileRecord:f.LOCAL_FILE_HEADER+Ae+O+ae,dirRecord:f.CENTRAL_FILE_HEADER+s(be,2)+Ae+s(G.length,2)+"\0\0\0\0"+s(K,4)+s(y,4)+O+ae+G}}var o=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),h=t("../crc32"),f=t("../signature");function m(p,x,g,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=g,this.encodeFileName=y,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(m,l),m.prototype.push=function(p){var x=p.meta.percent||0,g=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,l.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:g?(x+100*(g-y-1))/g:100}}))},m.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var x=this.streamFiles&&!p.file.dir;if(x){var g=a(p,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(p){this.accumulate=!1;var x=this.streamFiles&&!p.file.dir,g=a(p,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),x)this.push({data:function(y){return f.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var p=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var g=this.bytesWritten-p,y=function(b,_,S,k,C){var R=o.transformTo("string",C(k));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(b,2)+s(b,2)+s(_,4)+s(S,4)+s(R.length,2)+R}(this.dirRecords.length,g,p,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(p){this._sources.push(p);var x=this;return p.on("data",function(g){x.processChunk(g)}),p.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),p.on("error",function(g){x.error(g)}),this},m.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(p){var x=this._sources;if(!l.prototype.error.call(this,p))return!1;for(var g=0;g<x.length;g++)try{x[g].error(p)}catch{}return!0},m.prototype.lock=function(){l.prototype.lock.call(this);for(var p=this._sources,x=0;x<p.length;x++)p[x].lock()},r.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,n){var s=t("../compressions"),a=t("./ZipFileWorker");n.generateWorker=function(o,l,c){var h=new a(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{o.forEach(function(m,p){f++;var x=function(_,S){var k=_||S,C=s[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(p.options.compression,l.compression),g=p.options.compressionOptions||l.compressionOptions||{},y=p.dir,b=p.date;p._compressWorker(x,g).withStreamInfo("file",{name:m,dir:y,date:b,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(h)}),h.entriesCount=f}catch(m){h.error(m)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,n){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,n){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),h=t("./nodejsUtils");function f(m){return new a.Promise(function(p,x){var g=m.decompressed.getContentWorker().pipe(new c);g.on("error",function(y){x(y)}).on("end",function(){g.streamInfo.crc32!==m.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}r.exports=function(m,p){var x=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",m,!0,p.optimizedBinaryString,p.base64).then(function(g){var y=new l(p);return y.load(g),y}).then(function(g){var y=[a.Promise.resolve(g)],b=g.files;if(p.checkCRC32)for(var _=0;_<b.length;_++)y.push(f(b[_]));return a.Promise.all(y)}).then(function(g){for(var y=g.shift(),b=y.files,_=0;_<b.length;_++){var S=b[_],k=S.fileNameStr,C=s.resolve(S.fileNameStr);x.file(C,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:p.createFolders}),S.dir||(x.file(C).unsafeOriginalName=k)}return y.zipComment.length&&(x.comment=y.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,n){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(h){c.push({data:h,meta:{percent:0}})}).on("error",function(h){c.isPaused?this.generatedError=h:c.error(h)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,n){var s=t("readable-stream").Readable;function a(o,l,c){s.call(this,l),this._helper=o;var h=this;o.on("data",function(f,m){h.push(f)||h._helper.pause(),c&&c(m)}).on("error",function(f){h.emit("error",f)}).on("end",function(){h.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,n){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,r,n){function s(C,R,N){var O,I=o.getTypeOf(R),F=o.extend(N||{},h);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(C=b(C)),F.createFolders&&(O=y(C))&&_.call(this,O,!0);var G=I==="string"&&F.binary===!1&&F.base64===!1;N&&N.binary!==void 0||(F.binary=!G),(R instanceof f&&R.uncompressedSize===0||F.dir||!R||R.length===0)&&(F.base64=!1,F.binary=!0,R="",F.compression="STORE",I="string");var B=null;B=R instanceof f||R instanceof l?R:x.isNode&&x.isStream(R)?new g(C,R):o.prepareContent(C,R,F.binary,F.optimizedBinaryString,F.base64);var Y=new m(C,B,F);this.files[C]=Y}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),h=t("./defaults"),f=t("./compressedObject"),m=t("./zipObject"),p=t("./generate"),x=t("./nodejsUtils"),g=t("./nodejs/NodejsStreamInputAdapter"),y=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var R=C.lastIndexOf("/");return 0<R?C.substring(0,R):""},b=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},_=function(C,R){return R=R!==void 0?R:h.createFolders,C=b(C),this.files[C]||s.call(this,C,null,{dir:!0,createFolders:R}),this.files[C]};function S(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var R,N,O;for(R in this.files)O=this.files[R],(N=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&C(N,O)},filter:function(C){var R=[];return this.forEach(function(N,O){C(N,O)&&R.push(O)}),R},file:function(C,R,N){if(arguments.length!==1)return C=this.root+C,s.call(this,C,R,N),this;if(S(C)){var O=C;return this.filter(function(F,G){return!G.dir&&O.test(F)})}var I=this.files[this.root+C];return I&&!I.dir?I:null},folder:function(C){if(!C)return this;if(S(C))return this.filter(function(I,F){return F.dir&&C.test(I)});var R=this.root+C,N=_.call(this,R),O=this.clone();return O.root=N.name,O},remove:function(C){C=this.root+C;var R=this.files[C];if(R||(C.slice(-1)!=="/"&&(C+="/"),R=this.files[C]),R&&!R.dir)delete this.files[C];else for(var N=this.filter(function(I,F){return F.name.slice(0,C.length)===C}),O=0;O<N.length;O++)delete this.files[N[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var R,N={};try{if((N=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");o.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var O=N.comment||this.comment||"";R=p.generateWorker(this,N,O)}catch(I){(R=new l("error")).error(I)}return new c(R,N.type||"string",N.mimeType)},generateAsync:function(C,R){return this.generateInternalStream(C).accumulate(R)},generateNodeStream:function(C,R){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(R)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,n){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,n){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),h=o.charCodeAt(2),f=o.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===l&&this.data[m+1]===c&&this.data[m+2]===h&&this.data[m+3]===f)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),h=o.charCodeAt(2),f=o.charCodeAt(3),m=this.readData(4);return l===m[0]&&c===m[1]&&h===m[2]&&f===m[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,n){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(t,r,n){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,n){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,n){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,n){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");r.exports=function(f){var m=s.getTypeOf(f);return s.checkSupport(m),m!=="string"||a.uint8array?m==="nodebuffer"?new c(f):a.uint8array?new h(s.transformTo("uint8array",f)):new o(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,n){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,n){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,n){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,n){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(h){c.dataIsReady=!0,c.data=h,c.max=h&&h.length||0,c.type=s.getTypeOf(h),c.isPaused||c._tickAndRepeat()},function(h){c.error(h)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,n){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(t,r,n){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),h=t("../external"),f=null;if(c.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(x,g){return new h.Promise(function(y,b){var _=[],S=x._internalType,k=x._outputType,C=x._mimeType;x.on("data",function(R,N){_.push(R),g&&g(N)}).on("error",function(R){_=[],b(R)}).on("end",function(){try{var R=function(N,O,I){switch(N){case"blob":return s.newBlob(s.transformTo("arraybuffer",O),I);case"base64":return l.encode(O);default:return s.transformTo(N,O)}}(k,function(N,O){var I,F=0,G=null,B=0;for(I=0;I<O.length;I++)B+=O[I].length;switch(N){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for(G=new Uint8Array(B),I=0;I<O.length;I++)G.set(O[I],F),F+=O[I].length;return G;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+N+"'")}}(S,_),C);y(R)}catch(N){b(N)}_=[]}).resume()})}function p(x,g,y){var b=g;switch(g){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=g,this._mimeType=y,s.checkSupport(b),this._worker=x.pipe(new a(b)),x.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}p.prototype={accumulate:function(x){return m(this,x)},on:function(x,g){var y=this;return x==="data"?this._worker.on(x,function(b){g.call(y,b.data,b.meta)}):this._worker.on(x,function(){s.delay(g,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},x)}},r.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var s=new ArrayBuffer(0);try{n.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),n.blob=a.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,n){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),h=0;h<256;h++)c[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function m(){l.call(this,"utf-8 encode")}n.utf8encode=function(p){return a.nodebuffer?o.newBufferFrom(p,"utf-8"):function(x){var g,y,b,_,S,k=x.length,C=0;for(_=0;_<k;_++)(64512&(y=x.charCodeAt(_)))==55296&&_+1<k&&(64512&(b=x.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(b-56320),_++),C+=y<128?1:y<2048?2:y<65536?3:4;for(g=a.uint8array?new Uint8Array(C):new Array(C),_=S=0;S<C;_++)(64512&(y=x.charCodeAt(_)))==55296&&_+1<k&&(64512&(b=x.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(b-56320),_++),y<128?g[S++]=y:(y<2048?g[S++]=192|y>>>6:(y<65536?g[S++]=224|y>>>12:(g[S++]=240|y>>>18,g[S++]=128|y>>>12&63),g[S++]=128|y>>>6&63),g[S++]=128|63&y);return g}(p)},n.utf8decode=function(p){return a.nodebuffer?s.transformTo("nodebuffer",p).toString("utf-8"):function(x){var g,y,b,_,S=x.length,k=new Array(2*S);for(g=y=0;g<S;)if((b=x[g++])<128)k[y++]=b;else if(4<(_=c[b]))k[y++]=65533,g+=_-1;else{for(b&=_===2?31:_===3?15:7;1<_&&g<S;)b=b<<6|63&x[g++],_--;1<_?k[y++]=65533:b<65536?k[y++]=b:(b-=65536,k[y++]=55296|b>>10&1023,k[y++]=56320|1023&b)}return k.length!==y&&(k.subarray?k=k.subarray(0,y):k.length=y),s.applyFromCharCode(k)}(p=s.transformTo(a.uint8array?"uint8array":"array",p))},s.inherits(f,l),f.prototype.processChunk=function(p){var x=s.transformTo(a.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var g=x;(x=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),x.set(g,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var y=function(_,S){var k;for((S=S||_.length)>_.length&&(S=_.length),k=S-1;0<=k&&(192&_[k])==128;)k--;return k<0||k===0?S:k+c[_[k]]>S?k:S}(x),b=x;y!==x.length&&(a.uint8array?(b=x.subarray(0,y),this.leftOver=x.subarray(y,x.length)):(b=x.slice(0,y),this.leftOver=x.slice(y,x.length))),this.push({data:n.utf8decode(b),meta:p.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=f,s.inherits(m,l),m.prototype.processChunk=function(p){this.push({data:n.utf8encode(p.data),meta:p.meta})},n.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,n){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function c(g){return g}function h(g,y){for(var b=0;b<g.length;++b)y[b]=255&g.charCodeAt(b);return y}t("setimmediate"),n.newBlob=function(g,y){n.checkSupport("blob");try{return new Blob([g],{type:y})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(g),b.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(g,y,b){var _=[],S=0,k=g.length;if(k<=b)return String.fromCharCode.apply(null,g);for(;S<k;)y==="array"||y==="nodebuffer"?_.push(String.fromCharCode.apply(null,g.slice(S,Math.min(S+b,k)))):_.push(String.fromCharCode.apply(null,g.subarray(S,Math.min(S+b,k)))),S+=b;return _.join("")},stringifyByChar:function(g){for(var y="",b=0;b<g.length;b++)y+=String.fromCharCode(g[b]);return y},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function m(g){var y=65536,b=n.getTypeOf(g),_=!0;if(b==="uint8array"?_=f.applyCanBeUsed.uint8array:b==="nodebuffer"&&(_=f.applyCanBeUsed.nodebuffer),_)for(;1<y;)try{return f.stringifyByChunk(g,b,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(g)}function p(g,y){for(var b=0;b<g.length;b++)y[b]=g[b];return y}n.applyFromCharCode=m;var x={};x.string={string:c,array:function(g){return h(g,new Array(g.length))},arraybuffer:function(g){return x.string.uint8array(g).buffer},uint8array:function(g){return h(g,new Uint8Array(g.length))},nodebuffer:function(g){return h(g,o.allocBuffer(g.length))}},x.array={string:m,array:c,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return o.newBufferFrom(g)}},x.arraybuffer={string:function(g){return m(new Uint8Array(g))},array:function(g){return p(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:c,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return o.newBufferFrom(new Uint8Array(g))}},x.uint8array={string:m,array:function(g){return p(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:c,nodebuffer:function(g){return o.newBufferFrom(g)}},x.nodebuffer={string:m,array:function(g){return p(g,new Array(g.length))},arraybuffer:function(g){return x.nodebuffer.uint8array(g).buffer},uint8array:function(g){return p(g,new Uint8Array(g.length))},nodebuffer:c},n.transformTo=function(g,y){if(y=y||"",!g)return y;n.checkSupport(g);var b=n.getTypeOf(y);return x[b][g](y)},n.resolve=function(g){for(var y=g.split("/"),b=[],_=0;_<y.length;_++){var S=y[_];S==="."||S===""&&_!==0&&_!==y.length-1||(S===".."?b.pop():b.push(S))}return b.join("/")},n.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(g){var y,b,_="";for(b=0;b<(g||"").length;b++)_+="\\x"+((y=g.charCodeAt(b))<16?"0":"")+y.toString(16).toUpperCase();return _},n.delay=function(g,y,b){setImmediate(function(){g.apply(b||null,y||[])})},n.inherits=function(g,y){function b(){}b.prototype=y.prototype,g.prototype=new b},n.extend=function(){var g,y,b={};for(g=0;g<arguments.length;g++)for(y in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],y)&&b[y]===void 0&&(b[y]=arguments[g][y]);return b},n.prepareContent=function(g,y,b,_,S){return l.Promise.resolve(y).then(function(k){return s.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,R){var N=new FileReader;N.onload=function(O){C(O.target.result)},N.onerror=function(O){R(O.target.error)},N.readAsArrayBuffer(k)}):k}).then(function(k){var C=n.getTypeOf(k);return C?(C==="arraybuffer"?k=n.transformTo("uint8array",k):C==="string"&&(S?k=a.decode(k):b&&_!==!0&&(k=function(R){return h(R,s.uint8array?new Uint8Array(R.length):new Array(R.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,n){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function h(f){this.files=[],this.loadOptions=f}h.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(f)+")")}},isSignature:function(f,m){var p=this.reader.index;this.reader.setIndex(f);var x=this.reader.readString(4)===m;return this.reader.setIndex(p),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),m=c.uint8array?"uint8array":"array",p=a.transformTo(m,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,m,p,x=this.zip64EndOfCentralSize-44;0<x;)f=this.reader.readInt(2),m=this.reader.readInt(4),p=this.reader.readData(m),this.zip64ExtensibleData[f]={id:f,length:m,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,m;for(f=0;f<this.files.length;f++)m=this.files[f],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var m=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var x=m-p;if(0<x)this.isSignature(m,o.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,n){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),h=t("./compressions"),f=t("./support");function m(p,x){this.options=p,this.loadOptions=x}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var x,g;if(p.skip(22),this.fileNameLength=p.readInt(2),g=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(y){for(var b in h)if(Object.prototype.hasOwnProperty.call(h,b)&&h[b].magic===y)return h[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,x,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var x=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(x),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var x,g,y,b=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<b;)x=p.readInt(2),g=p.readInt(2),y=p.readData(g),this.extraFields[x]={id:x,length:g,value:y};p.setIndex(b)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var g=a.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var b=a.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var x=s(p.value);return x.readInt(1)!==1||l(this.fileName)!==x.readInt(4)?null:c.utf8decode(x.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var x=s(p.value);return x.readInt(1)!==1||l(this.fileComment)!==x.readInt(4)?null:c.utf8decode(x.readData(p.length-5))}return null}},r.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,n){function s(x,g,y){this.name=x,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=g,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),h=t("./stream/GenericWorker");s.prototype={internalStream:function(x){var g=null,y="string";try{if(!x)throw new Error("No output type specified.");var b=(y=x.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),g=this._decompressWorker();var _=!this._dataBinary;_&&!b&&(g=g.pipe(new l.Utf8EncodeWorker)),!_&&b&&(g=g.pipe(new l.Utf8DecodeWorker))}catch(S){(g=new h("error")).error(S)}return new a(g,y,"")},async:function(x,g){return this.internalStream(x).accumulate(g)},nodeStream:function(x,g){return this.internalStream(x||"nodebuffer").toNodejsStream(g)},_compressWorker:function(x,g){if(this._data instanceof c&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,x,g)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof h?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)s.prototype[f[p]]=m;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,n){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,h=new l(x),f=s.document.createTextNode("");h.observe(f,{characterData:!0}),a=function(){f.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){x(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(x,0)};else{var m=new s.MessageChannel;m.port1.onmessage=x,a=function(){m.port2.postMessage(0)}}var p=[];function x(){var g,y;o=!0;for(var b=p.length;b;){for(y=p,p=[],g=-1;++g<b;)y[g]();b=p.length}o=!1}r.exports=function(g){p.push(g)!==1||o||a()}}).call(this,typeof Li<"u"?Li:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,n){var s=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],h=["PENDING"];function f(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,b!==a&&g(this,b)}function m(b,_,S){this.promise=b,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function p(b,_,S){s(function(){var k;try{k=_(S)}catch(C){return o.reject(b,C)}k===b?o.reject(b,new TypeError("Cannot resolve promise with itself")):o.resolve(b,k)})}function x(b){var _=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof _=="function")return function(){_.apply(b,arguments)}}function g(b,_){var S=!1;function k(N){S||(S=!0,o.reject(b,N))}function C(N){S||(S=!0,o.resolve(b,N))}var R=y(function(){_(C,k)});R.status==="error"&&k(R.value)}function y(b,_){var S={};try{S.value=b(_),S.status="success"}catch(k){S.status="error",S.value=k}return S}(r.exports=f).prototype.finally=function(b){if(typeof b!="function")return this;var _=this.constructor;return this.then(function(S){return _.resolve(b()).then(function(){return S})},function(S){return _.resolve(b()).then(function(){throw S})})},f.prototype.catch=function(b){return this.then(null,b)},f.prototype.then=function(b,_){if(typeof b!="function"&&this.state===c||typeof _!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==h?p(S,this.state===c?b:_,this.outcome):this.queue.push(new m(S,b,_)),S},m.prototype.callFulfilled=function(b){o.resolve(this.promise,b)},m.prototype.otherCallFulfilled=function(b){p(this.promise,this.onFulfilled,b)},m.prototype.callRejected=function(b){o.reject(this.promise,b)},m.prototype.otherCallRejected=function(b){p(this.promise,this.onRejected,b)},o.resolve=function(b,_){var S=y(x,_);if(S.status==="error")return o.reject(b,S.value);var k=S.value;if(k)g(b,k);else{b.state=c,b.outcome=_;for(var C=-1,R=b.queue.length;++C<R;)b.queue[C].callFulfilled(_)}return b},o.reject=function(b,_){b.state=l,b.outcome=_;for(var S=-1,k=b.queue.length;++S<k;)b.queue[S].callRejected(_);return b},f.resolve=function(b){return b instanceof this?b:o.resolve(new this(a),b)},f.reject=function(b){var _=new this(a);return o.reject(_,b)},f.all=function(b){var _=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=b.length,k=!1;if(!S)return this.resolve([]);for(var C=new Array(S),R=0,N=-1,O=new this(a);++N<S;)I(b[N],N);return O;function I(F,G){_.resolve(F).then(function(B){C[G]=B,++R!==S||k||(k=!0,o.resolve(O,C))},function(B){k||(k=!0,o.reject(O,B))})}},f.race=function(b){var _=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=b.length,k=!1;if(!S)return this.resolve([]);for(var C=-1,R=new this(a);++C<S;)N=b[C],_.resolve(N).then(function(O){k||(k=!0,o.resolve(R,O))},function(O){k||(k=!0,o.reject(R,O))});var N;return R}},{immediate:36}],38:[function(t,r,n){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,n){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),h=Object.prototype.toString,f=0,m=-1,p=0,x=8;function g(b){if(!(this instanceof g))return new g(b);this.options=a.assign({level:m,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},b||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=s.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(S!==f)throw new Error(l[S]);if(_.header&&s.deflateSetHeader(this.strm,_.header),_.dictionary){var k;if(k=typeof _.dictionary=="string"?o.string2buf(_.dictionary):h.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(S=s.deflateSetDictionary(this.strm,k))!==f)throw new Error(l[S]);this._dict_set=!0}}function y(b,_){var S=new g(_);if(S.push(b,!0),S.err)throw S.msg||l[S.err];return S.result}g.prototype.push=function(b,_){var S,k,C=this.strm,R=this.options.chunkSize;if(this.ended)return!1;k=_===~~_?_:_===!0?4:0,typeof b=="string"?C.input=o.string2buf(b):h.call(b)==="[object ArrayBuffer]"?C.input=new Uint8Array(b):C.input=b,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(R),C.next_out=0,C.avail_out=R),(S=s.deflate(C,k))!==1&&S!==f)return this.onEnd(S),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&S!==1);return k===4?(S=s.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===f):k!==2||(this.onEnd(f),!(C.avail_out=0))},g.prototype.onData=function(b){this.chunks.push(b)},g.prototype.onEnd=function(b){b===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Deflate=g,n.deflate=y,n.deflateRaw=function(b,_){return(_=_||{}).raw=!0,y(b,_)},n.gzip=function(b,_){return(_=_||{}).gzip=!0,y(b,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,n){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),h=t("./zlib/zstream"),f=t("./zlib/gzheader"),m=Object.prototype.toString;function p(g){if(!(this instanceof p))return new p(g);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},g||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||g&&g.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var b=s.inflateInit2(this.strm,y.windowBits);if(b!==l.Z_OK)throw new Error(c[b]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function x(g,y){var b=new p(y);if(b.push(g,!0),b.err)throw b.msg||c[b.err];return b.result}p.prototype.push=function(g,y){var b,_,S,k,C,R,N=this.strm,O=this.options.chunkSize,I=this.options.dictionary,F=!1;if(this.ended)return!1;_=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?N.input=o.binstring2buf(g):m.call(g)==="[object ArrayBuffer]"?N.input=new Uint8Array(g):N.input=g,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new a.Buf8(O),N.next_out=0,N.avail_out=O),(b=s.inflate(N,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(R=typeof I=="string"?o.string2buf(I):m.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,b=s.inflateSetDictionary(this.strm,R)),b===l.Z_BUF_ERROR&&F===!0&&(b=l.Z_OK,F=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&b!==l.Z_STREAM_END&&(N.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(N.output,N.next_out),k=N.next_out-S,C=o.buf2string(N.output,S),N.next_out=k,N.avail_out=O-k,k&&a.arraySet(N.output,N.output,S,k,0),this.onData(C)):this.onData(a.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(F=!0)}while((0<N.avail_in||N.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(b=s.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(N.avail_out=0))},p.prototype.onData=function(g){this.chunks.push(g)},p.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},n.Inflate=p,n.inflate=x,n.inflateRaw=function(g,y){return(y=y||{}).raw=!0,x(g,y)},n.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var h=c.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var f in h)h.hasOwnProperty(f)&&(l[f]=h[f])}}return l},n.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,h,f,m){if(c.subarray&&l.subarray)l.set(c.subarray(h,h+f),m);else for(var p=0;p<f;p++)l[m+p]=c[h+p]},flattenChunks:function(l){var c,h,f,m,p,x;for(c=f=0,h=l.length;c<h;c++)f+=l[c].length;for(x=new Uint8Array(f),c=m=0,h=l.length;c<h;c++)p=l[c],x.set(p,m),m+=p.length;return x}},o={arraySet:function(l,c,h,f,m){for(var p=0;p<f;p++)l[m+p]=c[h+p]},flattenChunks:function(l){return[].concat.apply([],l)}};n.setTyped=function(l){l?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(s)},{}],42:[function(t,r,n){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function h(f,m){if(m<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,m));for(var p="",x=0;x<m;x++)p+=String.fromCharCode(f[x]);return p}l[254]=l[254]=1,n.string2buf=function(f){var m,p,x,g,y,b=f.length,_=0;for(g=0;g<b;g++)(64512&(p=f.charCodeAt(g)))==55296&&g+1<b&&(64512&(x=f.charCodeAt(g+1)))==56320&&(p=65536+(p-55296<<10)+(x-56320),g++),_+=p<128?1:p<2048?2:p<65536?3:4;for(m=new s.Buf8(_),g=y=0;y<_;g++)(64512&(p=f.charCodeAt(g)))==55296&&g+1<b&&(64512&(x=f.charCodeAt(g+1)))==56320&&(p=65536+(p-55296<<10)+(x-56320),g++),p<128?m[y++]=p:(p<2048?m[y++]=192|p>>>6:(p<65536?m[y++]=224|p>>>12:(m[y++]=240|p>>>18,m[y++]=128|p>>>12&63),m[y++]=128|p>>>6&63),m[y++]=128|63&p);return m},n.buf2binstring=function(f){return h(f,f.length)},n.binstring2buf=function(f){for(var m=new s.Buf8(f.length),p=0,x=m.length;p<x;p++)m[p]=f.charCodeAt(p);return m},n.buf2string=function(f,m){var p,x,g,y,b=m||f.length,_=new Array(2*b);for(p=x=0;p<b;)if((g=f[p++])<128)_[x++]=g;else if(4<(y=l[g]))_[x++]=65533,p+=y-1;else{for(g&=y===2?31:y===3?15:7;1<y&&p<b;)g=g<<6|63&f[p++],y--;1<y?_[x++]=65533:g<65536?_[x++]=g:(g-=65536,_[x++]=55296|g>>10&1023,_[x++]=56320|1023&g)}return h(_,x)},n.utf8border=function(f,m){var p;for((m=m||f.length)>f.length&&(m=f.length),p=m-1;0<=p&&(192&f[p])==128;)p--;return p<0||p===0?m:p+l[f[p]]>m?p:m}},{"./common":41}],43:[function(t,r,n){r.exports=function(s,a,o,l){for(var c=65535&s|0,h=s>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;h=h+(c=c+a[l++]|0)|0,--f;);c%=65521,h%=65521}return c|h<<16|0}},{}],44:[function(t,r,n){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,n){var s=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var h=s,f=c+l;a^=-1;for(var m=c;m<f;m++)a=a>>>8^h[255&(a^o[m])];return-1^a}},{}],46:[function(t,r,n){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),c=t("./crc32"),h=t("./messages"),f=0,m=4,p=0,x=-2,g=-1,y=4,b=2,_=8,S=9,k=286,C=30,R=19,N=2*k+1,O=15,I=3,F=258,G=F+I+1,B=42,Y=113,j=1,ae=2,he=3,ee=4;function Z(z,Le){return z.msg=h[Le],Le}function ie(z){return(z<<1)-(4<z?9:0)}function ge(z){for(var Le=z.length;0<=--Le;)z[Le]=0}function V(z){var Le=z.state,_e=Le.pending;_e>z.avail_out&&(_e=z.avail_out),_e!==0&&(a.arraySet(z.output,Le.pending_buf,Le.pending_out,_e,z.next_out),z.next_out+=_e,Le.pending_out+=_e,z.total_out+=_e,z.avail_out-=_e,Le.pending-=_e,Le.pending===0&&(Le.pending_out=0))}function K(z,Le){o._tr_flush_block(z,0<=z.block_start?z.block_start:-1,z.strstart-z.block_start,Le),z.block_start=z.strstart,V(z.strm)}function be(z,Le){z.pending_buf[z.pending++]=Le}function Ae(z,Le){z.pending_buf[z.pending++]=Le>>>8&255,z.pending_buf[z.pending++]=255&Le}function ce(z,Le){var _e,ue,oe=z.max_chain_length,le=z.strstart,Oe=z.prev_length,Te=z.nice_match,ye=z.strstart>z.w_size-G?z.strstart-(z.w_size-G):0,Ue=z.window,rt=z.w_mask,Ke=z.prev,yt=z.strstart+F,Rt=Ue[le+Oe-1],_t=Ue[le+Oe];z.prev_length>=z.good_match&&(oe>>=2),Te>z.lookahead&&(Te=z.lookahead);do if(Ue[(_e=Le)+Oe]===_t&&Ue[_e+Oe-1]===Rt&&Ue[_e]===Ue[le]&&Ue[++_e]===Ue[le+1]){le+=2,_e++;do;while(Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&Ue[++le]===Ue[++_e]&&le<yt);if(ue=F-(yt-le),le=yt-F,Oe<ue){if(z.match_start=Le,Te<=(Oe=ue))break;Rt=Ue[le+Oe-1],_t=Ue[le+Oe]}}while((Le=Ke[Le&rt])>ye&&--oe!=0);return Oe<=z.lookahead?Oe:z.lookahead}function Pe(z){var Le,_e,ue,oe,le,Oe,Te,ye,Ue,rt,Ke=z.w_size;do{if(oe=z.window_size-z.lookahead-z.strstart,z.strstart>=Ke+(Ke-G)){for(a.arraySet(z.window,z.window,Ke,Ke,0),z.match_start-=Ke,z.strstart-=Ke,z.block_start-=Ke,Le=_e=z.hash_size;ue=z.head[--Le],z.head[Le]=Ke<=ue?ue-Ke:0,--_e;);for(Le=_e=Ke;ue=z.prev[--Le],z.prev[Le]=Ke<=ue?ue-Ke:0,--_e;);oe+=Ke}if(z.strm.avail_in===0)break;if(Oe=z.strm,Te=z.window,ye=z.strstart+z.lookahead,Ue=oe,rt=void 0,rt=Oe.avail_in,Ue<rt&&(rt=Ue),_e=rt===0?0:(Oe.avail_in-=rt,a.arraySet(Te,Oe.input,Oe.next_in,rt,ye),Oe.state.wrap===1?Oe.adler=l(Oe.adler,Te,rt,ye):Oe.state.wrap===2&&(Oe.adler=c(Oe.adler,Te,rt,ye)),Oe.next_in+=rt,Oe.total_in+=rt,rt),z.lookahead+=_e,z.lookahead+z.insert>=I)for(le=z.strstart-z.insert,z.ins_h=z.window[le],z.ins_h=(z.ins_h<<z.hash_shift^z.window[le+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[le+I-1])&z.hash_mask,z.prev[le&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=le,le++,z.insert--,!(z.lookahead+z.insert<I)););}while(z.lookahead<G&&z.strm.avail_in!==0)}function Ve(z,Le){for(var _e,ue;;){if(z.lookahead<G){if(Pe(z),z.lookahead<G&&Le===f)return j;if(z.lookahead===0)break}if(_e=0,z.lookahead>=I&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),_e!==0&&z.strstart-_e<=z.w_size-G&&(z.match_length=ce(z,_e)),z.match_length>=I)if(ue=o._tr_tally(z,z.strstart-z.match_start,z.match_length-I),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=I){for(z.match_length--;z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart,--z.match_length!=0;);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else ue=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(ue&&(K(z,!1),z.strm.avail_out===0))return j}return z.insert=z.strstart<I-1?z.strstart:I-1,Le===m?(K(z,!0),z.strm.avail_out===0?he:ee):z.last_lit&&(K(z,!1),z.strm.avail_out===0)?j:ae}function $e(z,Le){for(var _e,ue,oe;;){if(z.lookahead<G){if(Pe(z),z.lookahead<G&&Le===f)return j;if(z.lookahead===0)break}if(_e=0,z.lookahead>=I&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=I-1,_e!==0&&z.prev_length<z.max_lazy_match&&z.strstart-_e<=z.w_size-G&&(z.match_length=ce(z,_e),z.match_length<=5&&(z.strategy===1||z.match_length===I&&4096<z.strstart-z.match_start)&&(z.match_length=I-1)),z.prev_length>=I&&z.match_length<=z.prev_length){for(oe=z.strstart+z.lookahead-I,ue=o._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-I),z.lookahead-=z.prev_length-1,z.prev_length-=2;++z.strstart<=oe&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,_e=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),--z.prev_length!=0;);if(z.match_available=0,z.match_length=I-1,z.strstart++,ue&&(K(z,!1),z.strm.avail_out===0))return j}else if(z.match_available){if((ue=o._tr_tally(z,0,z.window[z.strstart-1]))&&K(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return j}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(ue=o._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<I-1?z.strstart:I-1,Le===m?(K(z,!0),z.strm.avail_out===0?he:ee):z.last_lit&&(K(z,!1),z.strm.avail_out===0)?j:ae}function qe(z,Le,_e,ue,oe){this.good_length=z,this.max_lazy=Le,this.nice_length=_e,this.max_chain=ue,this.func=oe}function Ze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*N),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*R+1)),ge(this.dyn_ltree),ge(this.dyn_dtree),ge(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(O+1),this.heap=new a.Buf16(2*k+1),ge(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),ge(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function at(z){var Le;return z&&z.state?(z.total_in=z.total_out=0,z.data_type=b,(Le=z.state).pending=0,Le.pending_out=0,Le.wrap<0&&(Le.wrap=-Le.wrap),Le.status=Le.wrap?B:Y,z.adler=Le.wrap===2?0:1,Le.last_flush=f,o._tr_init(Le),p):Z(z,x)}function gt(z){var Le=at(z);return Le===p&&function(_e){_e.window_size=2*_e.w_size,ge(_e.head),_e.max_lazy_match=s[_e.level].max_lazy,_e.good_match=s[_e.level].good_length,_e.nice_match=s[_e.level].nice_length,_e.max_chain_length=s[_e.level].max_chain,_e.strstart=0,_e.block_start=0,_e.lookahead=0,_e.insert=0,_e.match_length=_e.prev_length=I-1,_e.match_available=0,_e.ins_h=0}(z.state),Le}function ut(z,Le,_e,ue,oe,le){if(!z)return x;var Oe=1;if(Le===g&&(Le=6),ue<0?(Oe=0,ue=-ue):15<ue&&(Oe=2,ue-=16),oe<1||S<oe||_e!==_||ue<8||15<ue||Le<0||9<Le||le<0||y<le)return Z(z,x);ue===8&&(ue=9);var Te=new Ze;return(z.state=Te).strm=z,Te.wrap=Oe,Te.gzhead=null,Te.w_bits=ue,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=oe+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+I-1)/I),Te.window=new a.Buf8(2*Te.w_size),Te.head=new a.Buf16(Te.hash_size),Te.prev=new a.Buf16(Te.w_size),Te.lit_bufsize=1<<oe+6,Te.pending_buf_size=4*Te.lit_bufsize,Te.pending_buf=new a.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=3*Te.lit_bufsize,Te.level=Le,Te.strategy=le,Te.method=_e,gt(z)}s=[new qe(0,0,0,0,function(z,Le){var _e=65535;for(_e>z.pending_buf_size-5&&(_e=z.pending_buf_size-5);;){if(z.lookahead<=1){if(Pe(z),z.lookahead===0&&Le===f)return j;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var ue=z.block_start+_e;if((z.strstart===0||z.strstart>=ue)&&(z.lookahead=z.strstart-ue,z.strstart=ue,K(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-G&&(K(z,!1),z.strm.avail_out===0))return j}return z.insert=0,Le===m?(K(z,!0),z.strm.avail_out===0?he:ee):(z.strstart>z.block_start&&(K(z,!1),z.strm.avail_out),j)}),new qe(4,4,8,4,Ve),new qe(4,5,16,8,Ve),new qe(4,6,32,32,Ve),new qe(4,4,16,16,$e),new qe(8,16,32,32,$e),new qe(8,16,128,128,$e),new qe(8,32,128,256,$e),new qe(32,128,258,1024,$e),new qe(32,258,258,4096,$e)],n.deflateInit=function(z,Le){return ut(z,Le,_,15,8,0)},n.deflateInit2=ut,n.deflateReset=gt,n.deflateResetKeep=at,n.deflateSetHeader=function(z,Le){return z&&z.state?z.state.wrap!==2?x:(z.state.gzhead=Le,p):x},n.deflate=function(z,Le){var _e,ue,oe,le;if(!z||!z.state||5<Le||Le<0)return z?Z(z,x):x;if(ue=z.state,!z.output||!z.input&&z.avail_in!==0||ue.status===666&&Le!==m)return Z(z,z.avail_out===0?-5:x);if(ue.strm=z,_e=ue.last_flush,ue.last_flush=Le,ue.status===B)if(ue.wrap===2)z.adler=0,be(ue,31),be(ue,139),be(ue,8),ue.gzhead?(be(ue,(ue.gzhead.text?1:0)+(ue.gzhead.hcrc?2:0)+(ue.gzhead.extra?4:0)+(ue.gzhead.name?8:0)+(ue.gzhead.comment?16:0)),be(ue,255&ue.gzhead.time),be(ue,ue.gzhead.time>>8&255),be(ue,ue.gzhead.time>>16&255),be(ue,ue.gzhead.time>>24&255),be(ue,ue.level===9?2:2<=ue.strategy||ue.level<2?4:0),be(ue,255&ue.gzhead.os),ue.gzhead.extra&&ue.gzhead.extra.length&&(be(ue,255&ue.gzhead.extra.length),be(ue,ue.gzhead.extra.length>>8&255)),ue.gzhead.hcrc&&(z.adler=c(z.adler,ue.pending_buf,ue.pending,0)),ue.gzindex=0,ue.status=69):(be(ue,0),be(ue,0),be(ue,0),be(ue,0),be(ue,0),be(ue,ue.level===9?2:2<=ue.strategy||ue.level<2?4:0),be(ue,3),ue.status=Y);else{var Oe=_+(ue.w_bits-8<<4)<<8;Oe|=(2<=ue.strategy||ue.level<2?0:ue.level<6?1:ue.level===6?2:3)<<6,ue.strstart!==0&&(Oe|=32),Oe+=31-Oe%31,ue.status=Y,Ae(ue,Oe),ue.strstart!==0&&(Ae(ue,z.adler>>>16),Ae(ue,65535&z.adler)),z.adler=1}if(ue.status===69)if(ue.gzhead.extra){for(oe=ue.pending;ue.gzindex<(65535&ue.gzhead.extra.length)&&(ue.pending!==ue.pending_buf_size||(ue.gzhead.hcrc&&ue.pending>oe&&(z.adler=c(z.adler,ue.pending_buf,ue.pending-oe,oe)),V(z),oe=ue.pending,ue.pending!==ue.pending_buf_size));)be(ue,255&ue.gzhead.extra[ue.gzindex]),ue.gzindex++;ue.gzhead.hcrc&&ue.pending>oe&&(z.adler=c(z.adler,ue.pending_buf,ue.pending-oe,oe)),ue.gzindex===ue.gzhead.extra.length&&(ue.gzindex=0,ue.status=73)}else ue.status=73;if(ue.status===73)if(ue.gzhead.name){oe=ue.pending;do{if(ue.pending===ue.pending_buf_size&&(ue.gzhead.hcrc&&ue.pending>oe&&(z.adler=c(z.adler,ue.pending_buf,ue.pending-oe,oe)),V(z),oe=ue.pending,ue.pending===ue.pending_buf_size)){le=1;break}le=ue.gzindex<ue.gzhead.name.length?255&ue.gzhead.name.charCodeAt(ue.gzindex++):0,be(ue,le)}while(le!==0);ue.gzhead.hcrc&&ue.pending>oe&&(z.adler=c(z.adler,ue.pending_buf,ue.pending-oe,oe)),le===0&&(ue.gzindex=0,ue.status=91)}else ue.status=91;if(ue.status===91)if(ue.gzhead.comment){oe=ue.pending;do{if(ue.pending===ue.pending_buf_size&&(ue.gzhead.hcrc&&ue.pending>oe&&(z.adler=c(z.adler,ue.pending_buf,ue.pending-oe,oe)),V(z),oe=ue.pending,ue.pending===ue.pending_buf_size)){le=1;break}le=ue.gzindex<ue.gzhead.comment.length?255&ue.gzhead.comment.charCodeAt(ue.gzindex++):0,be(ue,le)}while(le!==0);ue.gzhead.hcrc&&ue.pending>oe&&(z.adler=c(z.adler,ue.pending_buf,ue.pending-oe,oe)),le===0&&(ue.status=103)}else ue.status=103;if(ue.status===103&&(ue.gzhead.hcrc?(ue.pending+2>ue.pending_buf_size&&V(z),ue.pending+2<=ue.pending_buf_size&&(be(ue,255&z.adler),be(ue,z.adler>>8&255),z.adler=0,ue.status=Y)):ue.status=Y),ue.pending!==0){if(V(z),z.avail_out===0)return ue.last_flush=-1,p}else if(z.avail_in===0&&ie(Le)<=ie(_e)&&Le!==m)return Z(z,-5);if(ue.status===666&&z.avail_in!==0)return Z(z,-5);if(z.avail_in!==0||ue.lookahead!==0||Le!==f&&ue.status!==666){var Te=ue.strategy===2?function(ye,Ue){for(var rt;;){if(ye.lookahead===0&&(Pe(ye),ye.lookahead===0)){if(Ue===f)return j;break}if(ye.match_length=0,rt=o._tr_tally(ye,0,ye.window[ye.strstart]),ye.lookahead--,ye.strstart++,rt&&(K(ye,!1),ye.strm.avail_out===0))return j}return ye.insert=0,Ue===m?(K(ye,!0),ye.strm.avail_out===0?he:ee):ye.last_lit&&(K(ye,!1),ye.strm.avail_out===0)?j:ae}(ue,Le):ue.strategy===3?function(ye,Ue){for(var rt,Ke,yt,Rt,_t=ye.window;;){if(ye.lookahead<=F){if(Pe(ye),ye.lookahead<=F&&Ue===f)return j;if(ye.lookahead===0)break}if(ye.match_length=0,ye.lookahead>=I&&0<ye.strstart&&(Ke=_t[yt=ye.strstart-1])===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]){Rt=ye.strstart+F;do;while(Ke===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]&&Ke===_t[++yt]&&yt<Rt);ye.match_length=F-(Rt-yt),ye.match_length>ye.lookahead&&(ye.match_length=ye.lookahead)}if(ye.match_length>=I?(rt=o._tr_tally(ye,1,ye.match_length-I),ye.lookahead-=ye.match_length,ye.strstart+=ye.match_length,ye.match_length=0):(rt=o._tr_tally(ye,0,ye.window[ye.strstart]),ye.lookahead--,ye.strstart++),rt&&(K(ye,!1),ye.strm.avail_out===0))return j}return ye.insert=0,Ue===m?(K(ye,!0),ye.strm.avail_out===0?he:ee):ye.last_lit&&(K(ye,!1),ye.strm.avail_out===0)?j:ae}(ue,Le):s[ue.level].func(ue,Le);if(Te!==he&&Te!==ee||(ue.status=666),Te===j||Te===he)return z.avail_out===0&&(ue.last_flush=-1),p;if(Te===ae&&(Le===1?o._tr_align(ue):Le!==5&&(o._tr_stored_block(ue,0,0,!1),Le===3&&(ge(ue.head),ue.lookahead===0&&(ue.strstart=0,ue.block_start=0,ue.insert=0))),V(z),z.avail_out===0))return ue.last_flush=-1,p}return Le!==m?p:ue.wrap<=0?1:(ue.wrap===2?(be(ue,255&z.adler),be(ue,z.adler>>8&255),be(ue,z.adler>>16&255),be(ue,z.adler>>24&255),be(ue,255&z.total_in),be(ue,z.total_in>>8&255),be(ue,z.total_in>>16&255),be(ue,z.total_in>>24&255)):(Ae(ue,z.adler>>>16),Ae(ue,65535&z.adler)),V(z),0<ue.wrap&&(ue.wrap=-ue.wrap),ue.pending!==0?p:1)},n.deflateEnd=function(z){var Le;return z&&z.state?(Le=z.state.status)!==B&&Le!==69&&Le!==73&&Le!==91&&Le!==103&&Le!==Y&&Le!==666?Z(z,x):(z.state=null,Le===Y?Z(z,-3):p):x},n.deflateSetDictionary=function(z,Le){var _e,ue,oe,le,Oe,Te,ye,Ue,rt=Le.length;if(!z||!z.state||(le=(_e=z.state).wrap)===2||le===1&&_e.status!==B||_e.lookahead)return x;for(le===1&&(z.adler=l(z.adler,Le,rt,0)),_e.wrap=0,rt>=_e.w_size&&(le===0&&(ge(_e.head),_e.strstart=0,_e.block_start=0,_e.insert=0),Ue=new a.Buf8(_e.w_size),a.arraySet(Ue,Le,rt-_e.w_size,_e.w_size,0),Le=Ue,rt=_e.w_size),Oe=z.avail_in,Te=z.next_in,ye=z.input,z.avail_in=rt,z.next_in=0,z.input=Le,Pe(_e);_e.lookahead>=I;){for(ue=_e.strstart,oe=_e.lookahead-(I-1);_e.ins_h=(_e.ins_h<<_e.hash_shift^_e.window[ue+I-1])&_e.hash_mask,_e.prev[ue&_e.w_mask]=_e.head[_e.ins_h],_e.head[_e.ins_h]=ue,ue++,--oe;);_e.strstart=ue,_e.lookahead=I-1,Pe(_e)}return _e.strstart+=_e.lookahead,_e.block_start=_e.strstart,_e.insert=_e.lookahead,_e.lookahead=0,_e.match_length=_e.prev_length=I-1,_e.match_available=0,z.next_in=Te,z.input=ye,z.avail_in=Oe,_e.wrap=le,p},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,n){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,r,n){r.exports=function(s,a){var o,l,c,h,f,m,p,x,g,y,b,_,S,k,C,R,N,O,I,F,G,B,Y,j,ae;o=s.state,l=s.next_in,j=s.input,c=l+(s.avail_in-5),h=s.next_out,ae=s.output,f=h-(a-s.avail_out),m=h+(s.avail_out-257),p=o.dmax,x=o.wsize,g=o.whave,y=o.wnext,b=o.window,_=o.hold,S=o.bits,k=o.lencode,C=o.distcode,R=(1<<o.lenbits)-1,N=(1<<o.distbits)-1;e:do{S<15&&(_+=j[l++]<<S,S+=8,_+=j[l++]<<S,S+=8),O=k[_&R];t:for(;;){if(_>>>=I=O>>>24,S-=I,(I=O>>>16&255)===0)ae[h++]=65535&O;else{if(!(16&I)){if((64&I)==0){O=k[(65535&O)+(_&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}F=65535&O,(I&=15)&&(S<I&&(_+=j[l++]<<S,S+=8),F+=_&(1<<I)-1,_>>>=I,S-=I),S<15&&(_+=j[l++]<<S,S+=8,_+=j[l++]<<S,S+=8),O=C[_&N];r:for(;;){if(_>>>=I=O>>>24,S-=I,!(16&(I=O>>>16&255))){if((64&I)==0){O=C[(65535&O)+(_&(1<<I)-1)];continue r}s.msg="invalid distance code",o.mode=30;break e}if(G=65535&O,S<(I&=15)&&(_+=j[l++]<<S,(S+=8)<I&&(_+=j[l++]<<S,S+=8)),p<(G+=_&(1<<I)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(_>>>=I,S-=I,(I=h-f)<G){if(g<(I=G-I)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if(Y=b,(B=0)===y){if(B+=x-I,I<F){for(F-=I;ae[h++]=b[B++],--I;);B=h-G,Y=ae}}else if(y<I){if(B+=x+y-I,(I-=y)<F){for(F-=I;ae[h++]=b[B++],--I;);if(B=0,y<F){for(F-=I=y;ae[h++]=b[B++],--I;);B=h-G,Y=ae}}}else if(B+=y-I,I<F){for(F-=I;ae[h++]=b[B++],--I;);B=h-G,Y=ae}for(;2<F;)ae[h++]=Y[B++],ae[h++]=Y[B++],ae[h++]=Y[B++],F-=3;F&&(ae[h++]=Y[B++],1<F&&(ae[h++]=Y[B++]))}else{for(B=h-G;ae[h++]=ae[B++],ae[h++]=ae[B++],ae[h++]=ae[B++],2<(F-=3););F&&(ae[h++]=ae[B++],1<F&&(ae[h++]=ae[B++]))}break}}break}}while(l<c&&h<m);l-=F=S>>3,_&=(1<<(S-=F<<3))-1,s.next_in=l,s.next_out=h,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=h<m?m-h+257:257-(h-m),o.hold=_,o.bits=S}},{}],49:[function(t,r,n){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),h=1,f=2,m=0,p=-2,x=1,g=852,y=592;function b(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(B){var Y;return B&&B.state?(Y=B.state,B.total_in=B.total_out=Y.total=0,B.msg="",Y.wrap&&(B.adler=1&Y.wrap),Y.mode=x,Y.last=0,Y.havedict=0,Y.dmax=32768,Y.head=null,Y.hold=0,Y.bits=0,Y.lencode=Y.lendyn=new s.Buf32(g),Y.distcode=Y.distdyn=new s.Buf32(y),Y.sane=1,Y.back=-1,m):p}function k(B){var Y;return B&&B.state?((Y=B.state).wsize=0,Y.whave=0,Y.wnext=0,S(B)):p}function C(B,Y){var j,ae;return B&&B.state?(ae=B.state,Y<0?(j=0,Y=-Y):(j=1+(Y>>4),Y<48&&(Y&=15)),Y&&(Y<8||15<Y)?p:(ae.window!==null&&ae.wbits!==Y&&(ae.window=null),ae.wrap=j,ae.wbits=Y,k(B))):p}function R(B,Y){var j,ae;return B?(ae=new _,(B.state=ae).window=null,(j=C(B,Y))!==m&&(B.state=null),j):p}var N,O,I=!0;function F(B){if(I){var Y;for(N=new s.Buf32(512),O=new s.Buf32(32),Y=0;Y<144;)B.lens[Y++]=8;for(;Y<256;)B.lens[Y++]=9;for(;Y<280;)B.lens[Y++]=7;for(;Y<288;)B.lens[Y++]=8;for(c(h,B.lens,0,288,N,0,B.work,{bits:9}),Y=0;Y<32;)B.lens[Y++]=5;c(f,B.lens,0,32,O,0,B.work,{bits:5}),I=!1}B.lencode=N,B.lenbits=9,B.distcode=O,B.distbits=5}function G(B,Y,j,ae){var he,ee=B.state;return ee.window===null&&(ee.wsize=1<<ee.wbits,ee.wnext=0,ee.whave=0,ee.window=new s.Buf8(ee.wsize)),ae>=ee.wsize?(s.arraySet(ee.window,Y,j-ee.wsize,ee.wsize,0),ee.wnext=0,ee.whave=ee.wsize):(ae<(he=ee.wsize-ee.wnext)&&(he=ae),s.arraySet(ee.window,Y,j-ae,he,ee.wnext),(ae-=he)?(s.arraySet(ee.window,Y,j-ae,ae,0),ee.wnext=ae,ee.whave=ee.wsize):(ee.wnext+=he,ee.wnext===ee.wsize&&(ee.wnext=0),ee.whave<ee.wsize&&(ee.whave+=he))),0}n.inflateReset=k,n.inflateReset2=C,n.inflateResetKeep=S,n.inflateInit=function(B){return R(B,15)},n.inflateInit2=R,n.inflate=function(B,Y){var j,ae,he,ee,Z,ie,ge,V,K,be,Ae,ce,Pe,Ve,$e,qe,Ze,at,gt,ut,z,Le,_e,ue,oe=0,le=new s.Buf8(4),Oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return p;(j=B.state).mode===12&&(j.mode=13),Z=B.next_out,he=B.output,ge=B.avail_out,ee=B.next_in,ae=B.input,ie=B.avail_in,V=j.hold,K=j.bits,be=ie,Ae=ge,Le=m;e:for(;;)switch(j.mode){case x:if(j.wrap===0){j.mode=13;break}for(;K<16;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(2&j.wrap&&V===35615){le[j.check=0]=255&V,le[1]=V>>>8&255,j.check=o(j.check,le,2,0),K=V=0,j.mode=2;break}if(j.flags=0,j.head&&(j.head.done=!1),!(1&j.wrap)||(((255&V)<<8)+(V>>8))%31){B.msg="incorrect header check",j.mode=30;break}if((15&V)!=8){B.msg="unknown compression method",j.mode=30;break}if(K-=4,z=8+(15&(V>>>=4)),j.wbits===0)j.wbits=z;else if(z>j.wbits){B.msg="invalid window size",j.mode=30;break}j.dmax=1<<z,B.adler=j.check=1,j.mode=512&V?10:12,K=V=0;break;case 2:for(;K<16;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(j.flags=V,(255&j.flags)!=8){B.msg="unknown compression method",j.mode=30;break}if(57344&j.flags){B.msg="unknown header flags set",j.mode=30;break}j.head&&(j.head.text=V>>8&1),512&j.flags&&(le[0]=255&V,le[1]=V>>>8&255,j.check=o(j.check,le,2,0)),K=V=0,j.mode=3;case 3:for(;K<32;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}j.head&&(j.head.time=V),512&j.flags&&(le[0]=255&V,le[1]=V>>>8&255,le[2]=V>>>16&255,le[3]=V>>>24&255,j.check=o(j.check,le,4,0)),K=V=0,j.mode=4;case 4:for(;K<16;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}j.head&&(j.head.xflags=255&V,j.head.os=V>>8),512&j.flags&&(le[0]=255&V,le[1]=V>>>8&255,j.check=o(j.check,le,2,0)),K=V=0,j.mode=5;case 5:if(1024&j.flags){for(;K<16;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}j.length=V,j.head&&(j.head.extra_len=V),512&j.flags&&(le[0]=255&V,le[1]=V>>>8&255,j.check=o(j.check,le,2,0)),K=V=0}else j.head&&(j.head.extra=null);j.mode=6;case 6:if(1024&j.flags&&(ie<(ce=j.length)&&(ce=ie),ce&&(j.head&&(z=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),s.arraySet(j.head.extra,ae,ee,ce,z)),512&j.flags&&(j.check=o(j.check,ae,ce,ee)),ie-=ce,ee+=ce,j.length-=ce),j.length))break e;j.length=0,j.mode=7;case 7:if(2048&j.flags){if(ie===0)break e;for(ce=0;z=ae[ee+ce++],j.head&&z&&j.length<65536&&(j.head.name+=String.fromCharCode(z)),z&&ce<ie;);if(512&j.flags&&(j.check=o(j.check,ae,ce,ee)),ie-=ce,ee+=ce,z)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=8;case 8:if(4096&j.flags){if(ie===0)break e;for(ce=0;z=ae[ee+ce++],j.head&&z&&j.length<65536&&(j.head.comment+=String.fromCharCode(z)),z&&ce<ie;);if(512&j.flags&&(j.check=o(j.check,ae,ce,ee)),ie-=ce,ee+=ce,z)break e}else j.head&&(j.head.comment=null);j.mode=9;case 9:if(512&j.flags){for(;K<16;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(V!==(65535&j.check)){B.msg="header crc mismatch",j.mode=30;break}K=V=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),B.adler=j.check=0,j.mode=12;break;case 10:for(;K<32;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}B.adler=j.check=b(V),K=V=0,j.mode=11;case 11:if(j.havedict===0)return B.next_out=Z,B.avail_out=ge,B.next_in=ee,B.avail_in=ie,j.hold=V,j.bits=K,2;B.adler=j.check=1,j.mode=12;case 12:if(Y===5||Y===6)break e;case 13:if(j.last){V>>>=7&K,K-=7&K,j.mode=27;break}for(;K<3;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}switch(j.last=1&V,K-=1,3&(V>>>=1)){case 0:j.mode=14;break;case 1:if(F(j),j.mode=20,Y!==6)break;V>>>=2,K-=2;break e;case 2:j.mode=17;break;case 3:B.msg="invalid block type",j.mode=30}V>>>=2,K-=2;break;case 14:for(V>>>=7&K,K-=7&K;K<32;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if((65535&V)!=(V>>>16^65535)){B.msg="invalid stored block lengths",j.mode=30;break}if(j.length=65535&V,K=V=0,j.mode=15,Y===6)break e;case 15:j.mode=16;case 16:if(ce=j.length){if(ie<ce&&(ce=ie),ge<ce&&(ce=ge),ce===0)break e;s.arraySet(he,ae,ee,ce,Z),ie-=ce,ee+=ce,ge-=ce,Z+=ce,j.length-=ce;break}j.mode=12;break;case 17:for(;K<14;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(j.nlen=257+(31&V),V>>>=5,K-=5,j.ndist=1+(31&V),V>>>=5,K-=5,j.ncode=4+(15&V),V>>>=4,K-=4,286<j.nlen||30<j.ndist){B.msg="too many length or distance symbols",j.mode=30;break}j.have=0,j.mode=18;case 18:for(;j.have<j.ncode;){for(;K<3;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}j.lens[Oe[j.have++]]=7&V,V>>>=3,K-=3}for(;j.have<19;)j.lens[Oe[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,_e={bits:j.lenbits},Le=c(0,j.lens,0,19,j.lencode,0,j.work,_e),j.lenbits=_e.bits,Le){B.msg="invalid code lengths set",j.mode=30;break}j.have=0,j.mode=19;case 19:for(;j.have<j.nlen+j.ndist;){for(;qe=(oe=j.lencode[V&(1<<j.lenbits)-1])>>>16&255,Ze=65535&oe,!(($e=oe>>>24)<=K);){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(Ze<16)V>>>=$e,K-=$e,j.lens[j.have++]=Ze;else{if(Ze===16){for(ue=$e+2;K<ue;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(V>>>=$e,K-=$e,j.have===0){B.msg="invalid bit length repeat",j.mode=30;break}z=j.lens[j.have-1],ce=3+(3&V),V>>>=2,K-=2}else if(Ze===17){for(ue=$e+3;K<ue;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}K-=$e,z=0,ce=3+(7&(V>>>=$e)),V>>>=3,K-=3}else{for(ue=$e+7;K<ue;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}K-=$e,z=0,ce=11+(127&(V>>>=$e)),V>>>=7,K-=7}if(j.have+ce>j.nlen+j.ndist){B.msg="invalid bit length repeat",j.mode=30;break}for(;ce--;)j.lens[j.have++]=z}}if(j.mode===30)break;if(j.lens[256]===0){B.msg="invalid code -- missing end-of-block",j.mode=30;break}if(j.lenbits=9,_e={bits:j.lenbits},Le=c(h,j.lens,0,j.nlen,j.lencode,0,j.work,_e),j.lenbits=_e.bits,Le){B.msg="invalid literal/lengths set",j.mode=30;break}if(j.distbits=6,j.distcode=j.distdyn,_e={bits:j.distbits},Le=c(f,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,_e),j.distbits=_e.bits,Le){B.msg="invalid distances set",j.mode=30;break}if(j.mode=20,Y===6)break e;case 20:j.mode=21;case 21:if(6<=ie&&258<=ge){B.next_out=Z,B.avail_out=ge,B.next_in=ee,B.avail_in=ie,j.hold=V,j.bits=K,l(B,Ae),Z=B.next_out,he=B.output,ge=B.avail_out,ee=B.next_in,ae=B.input,ie=B.avail_in,V=j.hold,K=j.bits,j.mode===12&&(j.back=-1);break}for(j.back=0;qe=(oe=j.lencode[V&(1<<j.lenbits)-1])>>>16&255,Ze=65535&oe,!(($e=oe>>>24)<=K);){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(qe&&(240&qe)==0){for(at=$e,gt=qe,ut=Ze;qe=(oe=j.lencode[ut+((V&(1<<at+gt)-1)>>at)])>>>16&255,Ze=65535&oe,!(at+($e=oe>>>24)<=K);){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}V>>>=at,K-=at,j.back+=at}if(V>>>=$e,K-=$e,j.back+=$e,j.length=Ze,qe===0){j.mode=26;break}if(32&qe){j.back=-1,j.mode=12;break}if(64&qe){B.msg="invalid literal/length code",j.mode=30;break}j.extra=15&qe,j.mode=22;case 22:if(j.extra){for(ue=j.extra;K<ue;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}j.length+=V&(1<<j.extra)-1,V>>>=j.extra,K-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=23;case 23:for(;qe=(oe=j.distcode[V&(1<<j.distbits)-1])>>>16&255,Ze=65535&oe,!(($e=oe>>>24)<=K);){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if((240&qe)==0){for(at=$e,gt=qe,ut=Ze;qe=(oe=j.distcode[ut+((V&(1<<at+gt)-1)>>at)])>>>16&255,Ze=65535&oe,!(at+($e=oe>>>24)<=K);){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}V>>>=at,K-=at,j.back+=at}if(V>>>=$e,K-=$e,j.back+=$e,64&qe){B.msg="invalid distance code",j.mode=30;break}j.offset=Ze,j.extra=15&qe,j.mode=24;case 24:if(j.extra){for(ue=j.extra;K<ue;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}j.offset+=V&(1<<j.extra)-1,V>>>=j.extra,K-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){B.msg="invalid distance too far back",j.mode=30;break}j.mode=25;case 25:if(ge===0)break e;if(ce=Ae-ge,j.offset>ce){if((ce=j.offset-ce)>j.whave&&j.sane){B.msg="invalid distance too far back",j.mode=30;break}Pe=ce>j.wnext?(ce-=j.wnext,j.wsize-ce):j.wnext-ce,ce>j.length&&(ce=j.length),Ve=j.window}else Ve=he,Pe=Z-j.offset,ce=j.length;for(ge<ce&&(ce=ge),ge-=ce,j.length-=ce;he[Z++]=Ve[Pe++],--ce;);j.length===0&&(j.mode=21);break;case 26:if(ge===0)break e;he[Z++]=j.length,ge--,j.mode=21;break;case 27:if(j.wrap){for(;K<32;){if(ie===0)break e;ie--,V|=ae[ee++]<<K,K+=8}if(Ae-=ge,B.total_out+=Ae,j.total+=Ae,Ae&&(B.adler=j.check=j.flags?o(j.check,he,Ae,Z-Ae):a(j.check,he,Ae,Z-Ae)),Ae=ge,(j.flags?V:b(V))!==j.check){B.msg="incorrect data check",j.mode=30;break}K=V=0}j.mode=28;case 28:if(j.wrap&&j.flags){for(;K<32;){if(ie===0)break e;ie--,V+=ae[ee++]<<K,K+=8}if(V!==(4294967295&j.total)){B.msg="incorrect length check",j.mode=30;break}K=V=0}j.mode=29;case 29:Le=1;break e;case 30:Le=-3;break e;case 31:return-4;case 32:default:return p}return B.next_out=Z,B.avail_out=ge,B.next_in=ee,B.avail_in=ie,j.hold=V,j.bits=K,(j.wsize||Ae!==B.avail_out&&j.mode<30&&(j.mode<27||Y!==4))&&G(B,B.output,B.next_out,Ae-B.avail_out)?(j.mode=31,-4):(be-=B.avail_in,Ae-=B.avail_out,B.total_in+=be,B.total_out+=Ae,j.total+=Ae,j.wrap&&Ae&&(B.adler=j.check=j.flags?o(j.check,he,Ae,B.next_out-Ae):a(j.check,he,Ae,B.next_out-Ae)),B.data_type=j.bits+(j.last?64:0)+(j.mode===12?128:0)+(j.mode===20||j.mode===15?256:0),(be==0&&Ae===0||Y===4)&&Le===m&&(Le=-5),Le)},n.inflateEnd=function(B){if(!B||!B.state)return p;var Y=B.state;return Y.window&&(Y.window=null),B.state=null,m},n.inflateGetHeader=function(B,Y){var j;return B&&B.state?(2&(j=B.state).wrap)==0?p:((j.head=Y).done=!1,m):p},n.inflateSetDictionary=function(B,Y){var j,ae=Y.length;return B&&B.state?(j=B.state).wrap!==0&&j.mode!==11?p:j.mode===11&&a(1,Y,ae,0)!==j.check?-3:G(B,Y,ae,ae)?(j.mode=31,-4):(j.havedict=1,m):p},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,n){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(h,f,m,p,x,g,y,b){var _,S,k,C,R,N,O,I,F,G=b.bits,B=0,Y=0,j=0,ae=0,he=0,ee=0,Z=0,ie=0,ge=0,V=0,K=null,be=0,Ae=new s.Buf16(16),ce=new s.Buf16(16),Pe=null,Ve=0;for(B=0;B<=15;B++)Ae[B]=0;for(Y=0;Y<p;Y++)Ae[f[m+Y]]++;for(he=G,ae=15;1<=ae&&Ae[ae]===0;ae--);if(ae<he&&(he=ae),ae===0)return x[g++]=20971520,x[g++]=20971520,b.bits=1,0;for(j=1;j<ae&&Ae[j]===0;j++);for(he<j&&(he=j),B=ie=1;B<=15;B++)if(ie<<=1,(ie-=Ae[B])<0)return-1;if(0<ie&&(h===0||ae!==1))return-1;for(ce[1]=0,B=1;B<15;B++)ce[B+1]=ce[B]+Ae[B];for(Y=0;Y<p;Y++)f[m+Y]!==0&&(y[ce[f[m+Y]]++]=Y);if(N=h===0?(K=Pe=y,19):h===1?(K=a,be-=257,Pe=o,Ve-=257,256):(K=l,Pe=c,-1),B=j,R=g,Z=Y=V=0,k=-1,C=(ge=1<<(ee=he))-1,h===1&&852<ge||h===2&&592<ge)return 1;for(;;){for(O=B-Z,F=y[Y]<N?(I=0,y[Y]):y[Y]>N?(I=Pe[Ve+y[Y]],K[be+y[Y]]):(I=96,0),_=1<<B-Z,j=S=1<<ee;x[R+(V>>Z)+(S-=_)]=O<<24|I<<16|F|0,S!==0;);for(_=1<<B-1;V&_;)_>>=1;if(_!==0?(V&=_-1,V+=_):V=0,Y++,--Ae[B]==0){if(B===ae)break;B=f[m+y[Y]]}if(he<B&&(V&C)!==k){for(Z===0&&(Z=he),R+=j,ie=1<<(ee=B-Z);ee+Z<ae&&!((ie-=Ae[ee+Z])<=0);)ee++,ie<<=1;if(ge+=1<<ee,h===1&&852<ge||h===2&&592<ge)return 1;x[k=V&C]=he<<24|ee<<16|R-g|0}}return V!==0&&(x[R+V]=B-Z<<24|64<<16|0),b.bits=he,0}},{"../utils/common":41}],51:[function(t,r,n){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,n){var s=t("../utils/common"),a=0,o=1;function l(oe){for(var le=oe.length;0<=--le;)oe[le]=0}var c=0,h=29,f=256,m=f+1+h,p=30,x=19,g=2*m+1,y=15,b=16,_=7,S=256,k=16,C=17,R=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(m+2));l(G);var B=new Array(2*p);l(B);var Y=new Array(512);l(Y);var j=new Array(256);l(j);var ae=new Array(h);l(ae);var he,ee,Z,ie=new Array(p);function ge(oe,le,Oe,Te,ye){this.static_tree=oe,this.extra_bits=le,this.extra_base=Oe,this.elems=Te,this.max_length=ye,this.has_stree=oe&&oe.length}function V(oe,le){this.dyn_tree=oe,this.max_code=0,this.stat_desc=le}function K(oe){return oe<256?Y[oe]:Y[256+(oe>>>7)]}function be(oe,le){oe.pending_buf[oe.pending++]=255&le,oe.pending_buf[oe.pending++]=le>>>8&255}function Ae(oe,le,Oe){oe.bi_valid>b-Oe?(oe.bi_buf|=le<<oe.bi_valid&65535,be(oe,oe.bi_buf),oe.bi_buf=le>>b-oe.bi_valid,oe.bi_valid+=Oe-b):(oe.bi_buf|=le<<oe.bi_valid&65535,oe.bi_valid+=Oe)}function ce(oe,le,Oe){Ae(oe,Oe[2*le],Oe[2*le+1])}function Pe(oe,le){for(var Oe=0;Oe|=1&oe,oe>>>=1,Oe<<=1,0<--le;);return Oe>>>1}function Ve(oe,le,Oe){var Te,ye,Ue=new Array(y+1),rt=0;for(Te=1;Te<=y;Te++)Ue[Te]=rt=rt+Oe[Te-1]<<1;for(ye=0;ye<=le;ye++){var Ke=oe[2*ye+1];Ke!==0&&(oe[2*ye]=Pe(Ue[Ke]++,Ke))}}function $e(oe){var le;for(le=0;le<m;le++)oe.dyn_ltree[2*le]=0;for(le=0;le<p;le++)oe.dyn_dtree[2*le]=0;for(le=0;le<x;le++)oe.bl_tree[2*le]=0;oe.dyn_ltree[2*S]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function qe(oe){8<oe.bi_valid?be(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function Ze(oe,le,Oe,Te){var ye=2*le,Ue=2*Oe;return oe[ye]<oe[Ue]||oe[ye]===oe[Ue]&&Te[le]<=Te[Oe]}function at(oe,le,Oe){for(var Te=oe.heap[Oe],ye=Oe<<1;ye<=oe.heap_len&&(ye<oe.heap_len&&Ze(le,oe.heap[ye+1],oe.heap[ye],oe.depth)&&ye++,!Ze(le,Te,oe.heap[ye],oe.depth));)oe.heap[Oe]=oe.heap[ye],Oe=ye,ye<<=1;oe.heap[Oe]=Te}function gt(oe,le,Oe){var Te,ye,Ue,rt,Ke=0;if(oe.last_lit!==0)for(;Te=oe.pending_buf[oe.d_buf+2*Ke]<<8|oe.pending_buf[oe.d_buf+2*Ke+1],ye=oe.pending_buf[oe.l_buf+Ke],Ke++,Te===0?ce(oe,ye,le):(ce(oe,(Ue=j[ye])+f+1,le),(rt=N[Ue])!==0&&Ae(oe,ye-=ae[Ue],rt),ce(oe,Ue=K(--Te),Oe),(rt=O[Ue])!==0&&Ae(oe,Te-=ie[Ue],rt)),Ke<oe.last_lit;);ce(oe,S,le)}function ut(oe,le){var Oe,Te,ye,Ue=le.dyn_tree,rt=le.stat_desc.static_tree,Ke=le.stat_desc.has_stree,yt=le.stat_desc.elems,Rt=-1;for(oe.heap_len=0,oe.heap_max=g,Oe=0;Oe<yt;Oe++)Ue[2*Oe]!==0?(oe.heap[++oe.heap_len]=Rt=Oe,oe.depth[Oe]=0):Ue[2*Oe+1]=0;for(;oe.heap_len<2;)Ue[2*(ye=oe.heap[++oe.heap_len]=Rt<2?++Rt:0)]=1,oe.depth[ye]=0,oe.opt_len--,Ke&&(oe.static_len-=rt[2*ye+1]);for(le.max_code=Rt,Oe=oe.heap_len>>1;1<=Oe;Oe--)at(oe,Ue,Oe);for(ye=yt;Oe=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],at(oe,Ue,1),Te=oe.heap[1],oe.heap[--oe.heap_max]=Oe,oe.heap[--oe.heap_max]=Te,Ue[2*ye]=Ue[2*Oe]+Ue[2*Te],oe.depth[ye]=(oe.depth[Oe]>=oe.depth[Te]?oe.depth[Oe]:oe.depth[Te])+1,Ue[2*Oe+1]=Ue[2*Te+1]=ye,oe.heap[1]=ye++,at(oe,Ue,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(_t,ar){var cr,wr,Ir,Bt,Xt,Pn,se=ar.dyn_tree,Ye=ar.max_code,Qe=ar.stat_desc.static_tree,ft=ar.stat_desc.has_stree,we=ar.stat_desc.extra_bits,U=ar.stat_desc.extra_base,L=ar.stat_desc.max_length,re=0;for(Bt=0;Bt<=y;Bt++)_t.bl_count[Bt]=0;for(se[2*_t.heap[_t.heap_max]+1]=0,cr=_t.heap_max+1;cr<g;cr++)L<(Bt=se[2*se[2*(wr=_t.heap[cr])+1]+1]+1)&&(Bt=L,re++),se[2*wr+1]=Bt,Ye<wr||(_t.bl_count[Bt]++,Xt=0,U<=wr&&(Xt=we[wr-U]),Pn=se[2*wr],_t.opt_len+=Pn*(Bt+Xt),ft&&(_t.static_len+=Pn*(Qe[2*wr+1]+Xt)));if(re!==0){do{for(Bt=L-1;_t.bl_count[Bt]===0;)Bt--;_t.bl_count[Bt]--,_t.bl_count[Bt+1]+=2,_t.bl_count[L]--,re-=2}while(0<re);for(Bt=L;Bt!==0;Bt--)for(wr=_t.bl_count[Bt];wr!==0;)Ye<(Ir=_t.heap[--cr])||(se[2*Ir+1]!==Bt&&(_t.opt_len+=(Bt-se[2*Ir+1])*se[2*Ir],se[2*Ir+1]=Bt),wr--)}}(oe,le),Ve(Ue,Rt,oe.bl_count)}function z(oe,le,Oe){var Te,ye,Ue=-1,rt=le[1],Ke=0,yt=7,Rt=4;for(rt===0&&(yt=138,Rt=3),le[2*(Oe+1)+1]=65535,Te=0;Te<=Oe;Te++)ye=rt,rt=le[2*(Te+1)+1],++Ke<yt&&ye===rt||(Ke<Rt?oe.bl_tree[2*ye]+=Ke:ye!==0?(ye!==Ue&&oe.bl_tree[2*ye]++,oe.bl_tree[2*k]++):Ke<=10?oe.bl_tree[2*C]++:oe.bl_tree[2*R]++,Ue=ye,Rt=(Ke=0)===rt?(yt=138,3):ye===rt?(yt=6,3):(yt=7,4))}function Le(oe,le,Oe){var Te,ye,Ue=-1,rt=le[1],Ke=0,yt=7,Rt=4;for(rt===0&&(yt=138,Rt=3),Te=0;Te<=Oe;Te++)if(ye=rt,rt=le[2*(Te+1)+1],!(++Ke<yt&&ye===rt)){if(Ke<Rt)for(;ce(oe,ye,oe.bl_tree),--Ke!=0;);else ye!==0?(ye!==Ue&&(ce(oe,ye,oe.bl_tree),Ke--),ce(oe,k,oe.bl_tree),Ae(oe,Ke-3,2)):Ke<=10?(ce(oe,C,oe.bl_tree),Ae(oe,Ke-3,3)):(ce(oe,R,oe.bl_tree),Ae(oe,Ke-11,7));Ue=ye,Rt=(Ke=0)===rt?(yt=138,3):ye===rt?(yt=6,3):(yt=7,4)}}l(ie);var _e=!1;function ue(oe,le,Oe,Te){Ae(oe,(c<<1)+(Te?1:0),3),function(ye,Ue,rt,Ke){qe(ye),be(ye,rt),be(ye,~rt),s.arraySet(ye.pending_buf,ye.window,Ue,rt,ye.pending),ye.pending+=rt}(oe,le,Oe)}n._tr_init=function(oe){_e||(function(){var le,Oe,Te,ye,Ue,rt=new Array(y+1);for(ye=Te=0;ye<h-1;ye++)for(ae[ye]=Te,le=0;le<1<<N[ye];le++)j[Te++]=ye;for(j[Te-1]=ye,ye=Ue=0;ye<16;ye++)for(ie[ye]=Ue,le=0;le<1<<O[ye];le++)Y[Ue++]=ye;for(Ue>>=7;ye<p;ye++)for(ie[ye]=Ue<<7,le=0;le<1<<O[ye]-7;le++)Y[256+Ue++]=ye;for(Oe=0;Oe<=y;Oe++)rt[Oe]=0;for(le=0;le<=143;)G[2*le+1]=8,le++,rt[8]++;for(;le<=255;)G[2*le+1]=9,le++,rt[9]++;for(;le<=279;)G[2*le+1]=7,le++,rt[7]++;for(;le<=287;)G[2*le+1]=8,le++,rt[8]++;for(Ve(G,m+1,rt),le=0;le<p;le++)B[2*le+1]=5,B[2*le]=Pe(le,5);he=new ge(G,N,f+1,m,y),ee=new ge(B,O,0,p,y),Z=new ge(new Array(0),I,0,x,_)}(),_e=!0),oe.l_desc=new V(oe.dyn_ltree,he),oe.d_desc=new V(oe.dyn_dtree,ee),oe.bl_desc=new V(oe.bl_tree,Z),oe.bi_buf=0,oe.bi_valid=0,$e(oe)},n._tr_stored_block=ue,n._tr_flush_block=function(oe,le,Oe,Te){var ye,Ue,rt=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(Ke){var yt,Rt=4093624447;for(yt=0;yt<=31;yt++,Rt>>>=1)if(1&Rt&&Ke.dyn_ltree[2*yt]!==0)return a;if(Ke.dyn_ltree[18]!==0||Ke.dyn_ltree[20]!==0||Ke.dyn_ltree[26]!==0)return o;for(yt=32;yt<f;yt++)if(Ke.dyn_ltree[2*yt]!==0)return o;return a}(oe)),ut(oe,oe.l_desc),ut(oe,oe.d_desc),rt=function(Ke){var yt;for(z(Ke,Ke.dyn_ltree,Ke.l_desc.max_code),z(Ke,Ke.dyn_dtree,Ke.d_desc.max_code),ut(Ke,Ke.bl_desc),yt=x-1;3<=yt&&Ke.bl_tree[2*F[yt]+1]===0;yt--);return Ke.opt_len+=3*(yt+1)+5+5+4,yt}(oe),ye=oe.opt_len+3+7>>>3,(Ue=oe.static_len+3+7>>>3)<=ye&&(ye=Ue)):ye=Ue=Oe+5,Oe+4<=ye&&le!==-1?ue(oe,le,Oe,Te):oe.strategy===4||Ue===ye?(Ae(oe,2+(Te?1:0),3),gt(oe,G,B)):(Ae(oe,4+(Te?1:0),3),function(Ke,yt,Rt,_t){var ar;for(Ae(Ke,yt-257,5),Ae(Ke,Rt-1,5),Ae(Ke,_t-4,4),ar=0;ar<_t;ar++)Ae(Ke,Ke.bl_tree[2*F[ar]+1],3);Le(Ke,Ke.dyn_ltree,yt-1),Le(Ke,Ke.dyn_dtree,Rt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,rt+1),gt(oe,oe.dyn_ltree,oe.dyn_dtree)),$e(oe),Te&&qe(oe)},n._tr_tally=function(oe,le,Oe){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=le>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&le,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Oe,oe.last_lit++,le===0?oe.dyn_ltree[2*Oe]++:(oe.matches++,le--,oe.dyn_ltree[2*(j[Oe]+f+1)]++,oe.dyn_dtree[2*K(le)]++),oe.last_lit===oe.lit_bufsize-1},n._tr_align=function(oe){Ae(oe,2,3),ce(oe,S,G),function(le){le.bi_valid===16?(be(le,le.bi_buf),le.bi_buf=0,le.bi_valid=0):8<=le.bi_valid&&(le.pending_buf[le.pending++]=255&le.bi_buf,le.bi_buf>>=8,le.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(t,r,n){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,r,n){(function(s){(function(a,o){if(!a.setImmediate){var l,c,h,f,m=1,p={},x=!1,g=a.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(a);y=y&&y.setTimeout?y:a,l={}.toString.call(a.process)==="[object process]"?function(k){process.nextTick(function(){_(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,C=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=C,k}}()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(k){a.postMessage(f+k,"*")}):a.MessageChannel?((h=new MessageChannel).port1.onmessage=function(k){_(k.data)},function(k){h.port2.postMessage(k)}):g&&"onreadystatechange"in g.createElement("script")?(c=g.documentElement,function(k){var C=g.createElement("script");C.onreadystatechange=function(){_(k),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(k){setTimeout(_,0,k)},y.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),R=0;R<C.length;R++)C[R]=arguments[R+1];var N={callback:k,args:C};return p[m]=N,l(m),m++},y.clearImmediate=b}function b(k){delete p[k]}function _(k){if(x)setTimeout(_,0,k);else{var C=p[k];if(C){x=!0;try{(function(R){var N=R.callback,O=R.args;switch(O.length){case 0:N();break;case 1:N(O[0]);break;case 2:N(O[0],O[1]);break;case 3:N(O[0],O[1],O[2]);break;default:N.apply(o,O)}})(C)}finally{b(k),x=!1}}}}function S(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(f)===0&&_(+k.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Li<"u"?Li:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(r_)),r_.exports}var OU=PU();const IU=Do(OU);class qR{constructor(e){this.buffers=[],this.pos=0,this.size=0,e&&(this.buffers.push(e),this.size=e.byteLength,this.pos=0)}read(e){if(this.flatten(),e+this.pos>this.size)return null;const t=this.pos;return this.pos+=e,this.buffers[0].slice(t,this.pos)}readAll(){return this.flatten(),this.buffers[0]||new Uint8Array}write(e){return this.buffers.push(e),this.size+=e.byteLength,this.pos+=e.byteLength,!0}tell(){return this.pos}seek(e,t){let r=this.pos;return t==="SET"?r=e:t==="CUR"?r+=e:r=this.size-e,r<0||r>this.size?!1:(this.pos=r,!0)}flatten(){if(this.buffers.length<=1)return;const e=new Uint8Array(this.size);let t=0;for(const r of this.buffers)e.set(r,t),t+=r.byteLength;this.buffers=[e]}}const FU={0:"ERAR_SUCCESS",10:"ERAR_END_ARCHIVE",11:"ERAR_NO_MEMORY",12:"ERAR_BAD_DATA",13:"ERAR_BAD_ARCHIVE",14:"ERAR_UNKNOWN_FORMAT",15:"ERAR_EOPEN",16:"ERAR_ECREATE",17:"ERAR_ECLOSE",18:"ERAR_EREAD",19:"ERAR_EWRITE",20:"ERAR_SMALL_BUF",21:"ERAR_UNKNOWN",22:"ERAR_MISSING_PASSWORD",23:"ERAR_EREFERENCE",24:"ERAR_BAD_PASSWORD"},MU={ERAR_NO_MEMORY:"Not enough memory",ERAR_BAD_DATA:"Archive header or data are damaged",ERAR_BAD_ARCHIVE:"File is not RAR archive",ERAR_UNKNOWN_FORMAT:"Unknown archive format",ERAR_EOPEN:"File open error",ERAR_ECREATE:"File create error",ERAR_ECLOSE:"File close error",ERAR_EREAD:"File read error",ERAR_EWRITE:"File write error",ERAR_SMALL_BUF:"Buffer for archive comment is too small, comment truncated",ERAR_UNKNOWN:"Unknown error",ERAR_MISSING_PASSWORD:"Password for encrypted file or header is not specified",ERAR_EREFERENCE:"Cannot open file source for reference record",ERAR_BAD_PASSWORD:"Wrong password is specified"};class jU extends Error{constructor(e,t,r){super(t),this.reason=e,this.file=r}}class BU{constructor(e,t=""){this.unrar=e,this._password=t,this._archive=null}getFileList(){const e=this.openArc(!0);function*t(){for(;;){const r=this.processNextFile(()=>!0);if(r==="ERAR_END_ARCHIVE")break;yield r.fileHeader}this.closeArc()}return{arcHeader:e,fileHeaders:t.call(this)}}extract({files:e,password:t}={}){const r=this.openArc(!1,t);function*n(){let s=0;for(;;){let a=()=>!1;if(Array.isArray(e)){if(s===e.length)break;a=({name:l})=>!e.includes(l)}else e&&(a=l=>!e(l));const o=this.processNextFile(a);if(o==="ERAR_END_ARCHIVE")break;o.extraction!=="skipped"&&(s++,yield{fileHeader:o.fileHeader})}this.closeArc()}return{arcHeader:r,files:n.call(this)}}fileCreated(e){}close(e){this.closeFile(e)}openArc(e,t){this._archive=new this.unrar.RarArchive;const r=this._archive.open(this._filePath,t||this._password,e);if(r.state.errCode!==0)throw this.getFailException(r.state.errCode,r.state.errType);return{comment:r.comment,flags:{volume:(r.flags&1)!==0,lock:(r.flags&4)!==0,solid:(r.flags&8)!==0,authInfo:(r.flags&32)!==0,recoveryRecord:(r.flags&64)!==0,headerEncrypted:(r.flags&128)!==0}}}processNextFile(e){function t(l){const c=[5,6,5,5,4,7];let h=[];for(const m of c)h.push(l&(1<<m)-1),l>>=m;h=h.reverse();const f=m=>m<10?"0"+m:""+m;return`${1980+h[0]}-${f(h[1])}-${f(h[2])}T${f(h[3])}:${f(h[4])}:${f(h[5]*2)}.000`}function r(l){return{48:"Storing",49:"Fastest",50:"Fast",51:"Normal",52:"Good",53:"Best"}[l]||"Unknown"}const n=this._archive.getFileHeader();if(n.state.errCode===10)return"ERAR_END_ARCHIVE";if(n.state.errCode!==0)throw this.getFailException(n.state.errCode,n.state.errType);const s={name:n.name,flags:{encrypted:(n.flags&4)!==0,solid:(n.flags&16)!==0,directory:(n.flags&32)!==0},packSize:n.packSize,unpSize:n.unpSize,crc:n.crc,time:t(n.time),unpVer:`${Math.floor(n.unpVer/10)}.${n.unpVer%10}`,method:r(n.method),comment:n.comment},a=e(s),o=this._archive.readFile(a);if(o.errCode!==0)throw this.getFailException(o.errCode,o.errType,s.name);return{fileHeader:s,extraction:a?"skipped":"extracted"}}closeArc(){this._archive.delete(),this._archive=null}getFailException(e,t,r){const n=FU[e];return this.closeArc(),new jU(n,MU[n],r)}}class zU extends BU{constructor(e,t,r){super(e,r),this.dataFiles={},this.dataFileMap={},this.currentFd=1;const n={file:new qR(new Uint8Array(t)),fd:this.currentFd++};this._filePath="_defaultUnrarJS_.rar",this.dataFiles[this._filePath]=n,this.dataFileMap[n.fd]=this._filePath}extract(e={}){const{arcHeader:t,files:r}=super.extract(e);function*n(){for(const s of r)s.fileHeader.flags.directory||(s.extraction=this.dataFiles[this.getExtractedFileName(s.fileHeader.name)].file.readAll()),yield s}return{arcHeader:t,files:n.call(this)}}getExtractedFileName(e){return`*Extracted*/${e}`}open(e){const t=this.dataFiles[e];return t?t.fd:0}create(e){const t=this.currentFd++;return this.dataFiles[this.getExtractedFileName(e)]={file:new qR,fd:this.currentFd++},this.dataFileMap[t]=this.getExtractedFileName(e),t}closeFile(e){const t=this.dataFiles[this.dataFileMap[e]];t&&t.file.seek(0,"SET")}read(e,t,r){const n=this.dataFiles[this.dataFileMap[e]];if(!n)return-1;const s=n.file.read(r);return s===null?-1:(this.unrar.HEAPU8.set(s,t),s.byteLength)}write(e,t,r){const n=this.dataFiles[this.dataFileMap[e]];return n?(n.file.write(this.unrar.HEAPU8.slice(t,t+r)),!0):!1}tell(e){const t=this.dataFiles[this.dataFileMap[e]];return t?t.file.tell():-1}seek(e,t,r){const n=this.dataFiles[this.dataFileMap[e]];return n?n.file.seek(t,r):!1}}var $U=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(t){t=t||{};var t=typeof t<"u"?t:{},r,n;t.ready=new Promise(function(W,$){r=W,n=$});var s=Object.assign({},t),a="./this.program",o=typeof window=="object",l=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var c="";function h(W){return t.locateFile?t.locateFile(W,c):c+W}var f,m;(o||l)&&(l?c=self.location.href:typeof document<"u"&&document.currentScript&&(c=document.currentScript.src),i&&(c=i),c.indexOf("blob:")!==0?c=c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):c="",l&&(m=W=>{var $=new XMLHttpRequest;return $.open("GET",W,!1),$.responseType="arraybuffer",$.send(null),new Uint8Array($.response)}),f=(W,$,te)=>{var pe=new XMLHttpRequest;pe.open("GET",W,!0),pe.responseType="arraybuffer",pe.onload=()=>{if(pe.status==200||pe.status==0&&pe.response){$(pe.response);return}te()},pe.onerror=te,pe.send(null)}),t.print||console.log.bind(console);var p=t.printErr||console.warn.bind(console);Object.assign(t,s),s=null,t.arguments&&t.arguments,t.thisProgram&&(a=t.thisProgram),t.quit&&t.quit;var x=0,g=W=>{x=W},y=()=>x,b;t.wasmBinary&&(b=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&rt("no native wasm support detected");var _,S=!1;function k(W,$){W||rt($)}var C=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(W,$,te){for(var pe=$+te,Ne=$;W[Ne]&&!(Ne>=pe);)++Ne;if(Ne-$>16&&W.buffer&&C)return C.decode(W.subarray($,Ne));for(var je="";$<Ne;){var We=W[$++];if(!(We&128)){je+=String.fromCharCode(We);continue}var Be=W[$++]&63;if((We&224)==192){je+=String.fromCharCode((We&31)<<6|Be);continue}var Xe=W[$++]&63;if((We&240)==224?We=(We&15)<<12|Be<<6|Xe:We=(We&7)<<18|Be<<12|Xe<<6|W[$++]&63,We<65536)je+=String.fromCharCode(We);else{var pt=We-65536;je+=String.fromCharCode(55296|pt>>10,56320|pt&1023)}}return je}function N(W,$){return W?R(K,W,$):""}function O(W,$,te,pe){if(!(pe>0))return 0;for(var Ne=te,je=te+pe-1,We=0;We<W.length;++We){var Be=W.charCodeAt(We);if(Be>=55296&&Be<=57343){var Xe=W.charCodeAt(++We);Be=65536+((Be&1023)<<10)|Xe&1023}if(Be<=127){if(te>=je)break;$[te++]=Be}else if(Be<=2047){if(te+1>=je)break;$[te++]=192|Be>>6,$[te++]=128|Be&63}else if(Be<=65535){if(te+2>=je)break;$[te++]=224|Be>>12,$[te++]=128|Be>>6&63,$[te++]=128|Be&63}else{if(te+3>=je)break;$[te++]=240|Be>>18,$[te++]=128|Be>>12&63,$[te++]=128|Be>>6&63,$[te++]=128|Be&63}}return $[te]=0,te-Ne}function I(W,$,te){return O(W,K,$,te)}function F(W){for(var $=0,te=0;te<W.length;++te){var pe=W.charCodeAt(te);pe>=55296&&pe<=57343&&(pe=65536+((pe&1023)<<10)|W.charCodeAt(++te)&1023),pe<=127?++$:pe<=2047?$+=2:pe<=65535?$+=3:$+=4}return $}var G=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function B(W,$){for(var te=W,pe=te>>1,Ne=pe+$/2;!(pe>=Ne)&&Ae[pe];)++pe;if(te=pe<<1,te-W>32&&G)return G.decode(K.subarray(W,te));for(var je="",We=0;!(We>=$/2);++We){var Be=be[W+We*2>>1];if(Be==0)break;je+=String.fromCharCode(Be)}return je}function Y(W,$,te){if(te===void 0&&(te=2147483647),te<2)return 0;te-=2;for(var pe=$,Ne=te<W.length*2?te/2:W.length,je=0;je<Ne;++je){var We=W.charCodeAt(je);be[$>>1]=We,$+=2}return be[$>>1]=0,$-pe}function j(W){return W.length*2}function ae(W,$){for(var te=0,pe="";!(te>=$/4);){var Ne=ce[W+te*4>>2];if(Ne==0)break;if(++te,Ne>=65536){var je=Ne-65536;pe+=String.fromCharCode(55296|je>>10,56320|je&1023)}else pe+=String.fromCharCode(Ne)}return pe}function he(W,$,te){if(te===void 0&&(te=2147483647),te<4)return 0;for(var pe=$,Ne=pe+te-4,je=0;je<W.length;++je){var We=W.charCodeAt(je);if(We>=55296&&We<=57343){var Be=W.charCodeAt(++je);We=65536+((We&1023)<<10)|Be&1023}if(ce[$>>2]=We,$+=4,$+4>Ne)break}return ce[$>>2]=0,$-pe}function ee(W){for(var $=0,te=0;te<W.length;++te){var pe=W.charCodeAt(te);pe>=55296&&pe<=57343&&++te,$+=4}return $}function Z(W){var $=F(W)+1,te=_c($);return te&&O(W,V,te,$),te}function ie(W,$,te){for(var pe=0;pe<W.length;++pe)V[$++>>0]=W.charCodeAt(pe);V[$>>0]=0}var ge,V,K,be,Ae,ce,Pe,Ve,$e;function qe(W){ge=W,t.HEAP8=V=new Int8Array(W),t.HEAP16=be=new Int16Array(W),t.HEAP32=ce=new Int32Array(W),t.HEAPU8=K=new Uint8Array(W),t.HEAPU16=Ae=new Uint16Array(W),t.HEAPU32=Pe=new Uint32Array(W),t.HEAPF32=Ve=new Float32Array(W),t.HEAPF64=$e=new Float64Array(W)}t.INITIAL_MEMORY;var Ze,at=[],gt=[],ut=[];function z(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ue(t.preRun.shift());Ir(at)}function Le(){Ir(gt)}function _e(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)le(t.postRun.shift());Ir(ut)}function ue(W){at.unshift(W)}function oe(W){gt.unshift(W)}function le(W){ut.unshift(W)}var Oe=0,Te=null;function ye(W){Oe++,t.monitorRunDependencies&&t.monitorRunDependencies(Oe)}function Ue(W){if(Oe--,t.monitorRunDependencies&&t.monitorRunDependencies(Oe),Oe==0&&Te){var $=Te;Te=null,$()}}function rt(W){t.onAbort&&t.onAbort(W),W="Aborted("+W+")",p(W),S=!0,W+=". Build with -sASSERTIONS for more info.";var $=new WebAssembly.RuntimeError(W);throw n($),$}var Ke="data:application/octet-stream;base64,";function yt(W){return W.startsWith(Ke)}function Rt(W){return W.startsWith("file://")}var _t;_t="unrar.wasm",yt(_t)||(_t=h(_t));function ar(W){try{if(W==_t&&b)return new Uint8Array(b);if(m)return m(W);throw"both async and sync fetching of the wasm failed"}catch($){rt($)}}function cr(){if(!b&&(o||l)){if(typeof fetch=="function"&&!Rt(_t))return fetch(_t,{credentials:"same-origin"}).then(function(W){if(!W.ok)throw"failed to load wasm binary file at '"+_t+"'";return W.arrayBuffer()}).catch(function(){return ar(_t)});if(f)return new Promise(function(W,$){f(_t,function(te){W(new Uint8Array(te))},$)})}return Promise.resolve().then(function(){return ar(_t)})}function wr(){var W={a:rm};function $(We,Be){var Xe=We.exports;t.asm=Xe,_=t.asm.ka,qe(_.buffer),Ze=t.asm.oa,oe(t.asm.la),Ue()}ye();function te(We){$(We.instance)}function pe(We){return cr().then(function(Be){return WebAssembly.instantiate(Be,W)}).then(function(Be){return Be}).then(We,function(Be){p("failed to asynchronously prepare wasm: "+Be),rt(Be)})}function Ne(){return!b&&typeof WebAssembly.instantiateStreaming=="function"&&!yt(_t)&&!Rt(_t)&&typeof fetch=="function"?fetch(_t,{credentials:"same-origin"}).then(function(We){var Be=WebAssembly.instantiateStreaming(We,W);return Be.then(te,function(Xe){return p("wasm streaming compile failed: "+Xe),p("falling back to ArrayBuffer instantiation"),pe(te)})}):pe(te)}if(t.instantiateWasm)try{var je=t.instantiateWasm(W,$);return je}catch(We){return p("Module.instantiateWasm callback failed with error: "+We),!1}return Ne().catch(n),{}}function Ir(W){for(;W.length>0;){var $=W.shift();if(typeof $=="function"){$(t);continue}var te=$.func;typeof te=="number"?$.arg===void 0?Xt(te)():Xt(te)($.arg):te($.arg===void 0?null:$.arg)}}var Bt=[];function Xt(W){var $=Bt[W];return $||(W>=Bt.length&&(Bt.length=W+1),Bt[W]=$=Ze.get(W)),$}function Pn(W){return _c(W+24)+24}var se=[];function Ye(W){W.add_ref()}function Qe(W){var $=new we(W);return $.get_caught()||$.set_caught(!0),$.set_rethrown(!1),se.push($),Ye($),$.get_exception_ptr()}var ft=0;function we(W){this.excPtr=W,this.ptr=W-24,this.set_type=function($){Pe[this.ptr+4>>2]=$},this.get_type=function(){return Pe[this.ptr+4>>2]},this.set_destructor=function($){Pe[this.ptr+8>>2]=$},this.get_destructor=function(){return Pe[this.ptr+8>>2]},this.set_refcount=function($){ce[this.ptr>>2]=$},this.set_caught=function($){$=$?1:0,V[this.ptr+12>>0]=$},this.get_caught=function(){return V[this.ptr+12>>0]!=0},this.set_rethrown=function($){$=$?1:0,V[this.ptr+13>>0]=$},this.get_rethrown=function(){return V[this.ptr+13>>0]!=0},this.init=function($,te){this.set_adjusted_ptr(0),this.set_type($),this.set_destructor(te),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var $=ce[this.ptr>>2];ce[this.ptr>>2]=$+1},this.release_ref=function(){var $=ce[this.ptr>>2];return ce[this.ptr>>2]=$-1,$===1},this.set_adjusted_ptr=function($){Pe[this.ptr+16>>2]=$},this.get_adjusted_ptr=function(){return Pe[this.ptr+16>>2]},this.get_exception_ptr=function(){var $=jo(this.get_type());if($)return Pe[this.excPtr>>2];var te=this.get_adjusted_ptr();return te!==0?te:this.excPtr}}function U(W){return bi(new we(W).ptr)}function L(W){if(W.release_ref()&&!W.get_rethrown()){var $=W.get_destructor();$&&Xt($)(W.excPtr),U(W.excPtr)}}function re(){Zr(0);var W=se.pop();L(W),ft=0}function Ee(W){throw ft||(ft=W),W}function P(){var W=ft;if(!W)return g(0),0;var $=new we(W);$.set_adjusted_ptr(W);var te=$.get_type();if(!te)return g(0),W;for(var pe=Array.prototype.slice.call(arguments),Ne=0;Ne<pe.length;Ne++){var je=pe[Ne];if(je===0||je===te)break;var We=$.ptr+16;if(Ec(je,te,We))return g(je),W}return g(te),W}function Ce(){var W=ft;if(!W)return g(0),0;var $=new we(W);$.set_adjusted_ptr(W);var te=$.get_type();if(!te)return g(0),W;for(var pe=Array.prototype.slice.call(arguments),Ne=0;Ne<pe.length;Ne++){var je=pe[Ne];if(je===0||je===te)break;var We=$.ptr+16;if(Ec(je,te,We))return g(je),W}return g(te),W}function Ie(){var W=ft;if(!W)return g(0),0;var $=new we(W);$.set_adjusted_ptr(W);var te=$.get_type();if(!te)return g(0),W;for(var pe=Array.prototype.slice.call(arguments),Ne=0;Ne<pe.length;Ne++){var je=pe[Ne];if(je===0||je===te)break;var We=$.ptr+16;if(Ec(je,te,We))return g(je),W}return g(te),W}function J(W,$,te){var pe=new we(W);throw pe.init($,te),ft=W,W}function me(W,$,te,pe,Ne){}function Fe(W,$){}var vt={};function ct(W){for(;W.length;){var $=W.pop(),te=W.pop();te($)}}function mt(W){return this.fromWireType(Pe[W>>2])}var Ft={},vr={},Jt={},Vt=48,er=57;function Fr(W){if(W===void 0)return"_unknown";W=W.replace(/[^a-zA-Z0-9_]/g,"$");var $=W.charCodeAt(0);return $>=Vt&&$<=er?"_"+W:W}function Rr(W,$){return W=Fr(W),new Function("body","return function "+W+`() {
    "use strict";    return body.apply(this, arguments);
};
`)($)}function yn(W,$){var te=Rr($,function(pe){this.name=$,this.message=pe;var Ne=new Error(pe).stack;Ne!==void 0&&(this.stack=this.toString()+`
`+Ne.replace(/^Error(:[^\n]*)?\n/,""))});return te.prototype=Object.create(W.prototype),te.prototype.constructor=te,te.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},te}var Hs=void 0;function kr(W){throw new Hs(W)}function nn(W,$,te){W.forEach(function(Be){Jt[Be]=$});function pe(Be){var Xe=te(Be);Xe.length!==W.length&&kr("Mismatched type converter count");for(var pt=0;pt<W.length;++pt)kn(W[pt],Xe[pt])}var Ne=new Array($.length),je=[],We=0;$.forEach((Be,Xe)=>{vr.hasOwnProperty(Be)?Ne[Xe]=vr[Be]:(je.push(Be),Ft.hasOwnProperty(Be)||(Ft[Be]=[]),Ft[Be].push(()=>{Ne[Xe]=vr[Be],++We,We===je.length&&pe(Ne)}))}),je.length===0&&pe(Ne)}function Kr(W){var $=vt[W];delete vt[W];var te=$.rawConstructor,pe=$.rawDestructor,Ne=$.fields,je=Ne.map(We=>We.getterReturnType).concat(Ne.map(We=>We.setterArgumentType));nn([W],je,We=>{var Be={};return Ne.forEach((Xe,pt)=>{var kt=Xe.fieldName,Ot=We[pt],Zt=Xe.getter,$r=Xe.getterContext,bn=We[pt+Ne.length],wn=Xe.setter,Fi=Xe.setterContext;Be[kt]={read:bs=>Ot.fromWireType(Zt($r,bs)),write:(bs,Ql)=>{var Vs=[];wn(Fi,bs,bn.toWireType(Vs,Ql)),ct(Vs)}}}),[{name:$.name,fromWireType:function(Xe){var pt={};for(var kt in Be)pt[kt]=Be[kt].read(Xe);return pe(Xe),pt},toWireType:function(Xe,pt){for(var kt in Be)if(!(kt in pt))throw new TypeError('Missing field:  "'+kt+'"');var Ot=te();for(kt in Be)Be[kt].write(Ot,pt[kt]);return Xe!==null&&Xe.push(pe,Ot),Ot},argPackAdvance:8,readValueFromPointer:mt,destructorFunction:pe}]})}function vi(W,$,te,pe,Ne){}function On(W){switch(W){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+W)}}function Fo(){for(var W=new Array(256),$=0;$<256;++$)W[$]=String.fromCharCode($);xh=W}var xh=void 0;function In(W){for(var $="",te=W;K[te];)$+=xh[K[te++]];return $}var yr=void 0;function dr(W){throw new yr(W)}function kn(W,$,te={}){if(!("argPackAdvance"in $))throw new TypeError("registerType registeredInstance requires argPackAdvance");var pe=$.name;if(W||dr('type "'+pe+'" must have a positive integer typeid pointer'),vr.hasOwnProperty(W)){if(te.ignoreDuplicateRegistrations)return;dr("Cannot register type '"+pe+"' twice")}if(vr[W]=$,delete Jt[W],Ft.hasOwnProperty(W)){var Ne=Ft[W];delete Ft[W],Ne.forEach(je=>je())}}function _h(W,$,te,pe,Ne){var je=On(te);$=In($),kn(W,{name:$,fromWireType:function(We){return!!We},toWireType:function(We,Be){return Be?pe:Ne},argPackAdvance:8,readValueFromPointer:function(We){var Be;if(te===1)Be=V;else if(te===2)Be=be;else if(te===4)Be=ce;else throw new TypeError("Unknown boolean type size: "+$);return this.fromWireType(Be[We>>je])},destructorFunction:null})}function ga(W){if(!(this instanceof gs)||!(W instanceof gs))return!1;for(var $=this.$$.ptrType.registeredClass,te=this.$$.ptr,pe=W.$$.ptrType.registeredClass,Ne=W.$$.ptr;$.baseClass;)te=$.upcast(te),$=$.baseClass;for(;pe.baseClass;)Ne=pe.upcast(Ne),pe=pe.baseClass;return $===pe&&te===Ne}function pc(W){return{count:W.count,deleteScheduled:W.deleteScheduled,preservePointerOnDelete:W.preservePointerOnDelete,ptr:W.ptr,ptrType:W.ptrType,smartPtr:W.smartPtr,smartPtrType:W.smartPtrType}}function Gl(W){function $(te){return te.$$.ptrType.registeredClass.name}dr($(W)+" instance already deleted")}var Xa=!1;function ti(W){}function Vp(W){W.smartPtr?W.smartPtrType.rawDestructor(W.smartPtr):W.ptrType.registeredClass.rawDestructor(W.ptr)}function yi(W){W.count.value-=1;var $=W.count.value===0;$&&Vp(W)}function ne(W,$,te){if($===te)return W;if(te.baseClass===void 0)return null;var pe=ne(W,$,te.baseClass);return pe===null?null:te.downcast(pe)}var ve={};function de(){return Object.keys(nt).length}function Re(){var W=[];for(var $ in nt)nt.hasOwnProperty($)&&W.push(nt[$]);return W}var De=[];function Se(){for(;De.length;){var W=De.pop();W.$$.deleteScheduled=!1,W.delete()}}var Ge=void 0;function et(W){Ge=W,De.length&&Ge&&Ge(Se)}function lt(){t.getInheritedInstanceCount=de,t.getLiveInheritedInstances=Re,t.flushPendingDeletes=Se,t.setDelayFunction=et}var nt={};function ht(W,$){for($===void 0&&dr("ptr should not be undefined");W.baseClass;)$=W.upcast($),W=W.baseClass;return $}function Ct(W,$){return $=ht(W,$),nt[$]}function Wt(W,$){(!$.ptrType||!$.ptr)&&kr("makeClassHandle requires ptr and ptrType");var te=!!$.smartPtrType,pe=!!$.smartPtr;return te!==pe&&kr("Both smartPtrType and smartPtr must be specified"),$.count={value:1},sr(Object.create(W,{$$:{value:$}}))}function br(W){var $=this.getPointee(W);if(!$)return this.destructor(W),null;var te=Ct(this.registeredClass,$);if(te!==void 0){if(te.$$.count.value===0)return te.$$.ptr=$,te.$$.smartPtr=W,te.clone();var pe=te.clone();return this.destructor(W),pe}function Ne(){return this.isSmartPointer?Wt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:$,smartPtrType:this,smartPtr:W}):Wt(this.registeredClass.instancePrototype,{ptrType:this,ptr:W})}var je=this.registeredClass.getActualType($),We=ve[je];if(!We)return Ne.call(this);var Be;this.isConst?Be=We.constPointerType:Be=We.pointerType;var Xe=ne($,this.registeredClass,Be.registeredClass);return Xe===null?Ne.call(this):this.isSmartPointer?Wt(Be.registeredClass.instancePrototype,{ptrType:Be,ptr:Xe,smartPtrType:this,smartPtr:W}):Wt(Be.registeredClass.instancePrototype,{ptrType:Be,ptr:Xe})}function sr(W){return typeof FinalizationRegistry>"u"?(sr=$=>$,W):(Xa=new FinalizationRegistry($=>{yi($.$$)}),sr=$=>{var te=$.$$,pe=!!te.smartPtr;if(pe){var Ne={$$:te};Xa.register($,Ne,$)}return $},ti=$=>Xa.unregister($),sr(W))}function zt(){if(this.$$.ptr||Gl(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var W=sr(Object.create(Object.getPrototypeOf(this),{$$:{value:pc(this.$$)}}));return W.$$.count.value+=1,W.$$.deleteScheduled=!1,W}function zr(){this.$$.ptr||Gl(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&dr("Object already scheduled for deletion"),ti(this),yi(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ri(){return!this.$$.ptr}function va(){return this.$$.ptr||Gl(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&dr("Object already scheduled for deletion"),De.push(this),De.length===1&&Ge&&Ge(Se),this.$$.deleteScheduled=!0,this}function ql(){gs.prototype.isAliasOf=ga,gs.prototype.clone=zt,gs.prototype.delete=zr,gs.prototype.isDeleted=ri,gs.prototype.deleteLater=va}function gs(){}function Mo(W,$,te){if(W[$].overloadTable===void 0){var pe=W[$];W[$]=function(){return W[$].overloadTable.hasOwnProperty(arguments.length)||dr("Function '"+te+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+W[$].overloadTable+")!"),W[$].overloadTable[arguments.length].apply(this,arguments)},W[$].overloadTable=[],W[$].overloadTable[pe.argCount]=pe}}function Eh(W,$,te){t.hasOwnProperty(W)?(dr("Cannot register public name '"+W+"' twice"),Mo(t,W,W),t.hasOwnProperty(te)&&dr("Cannot register multiple overloads of a function with the same number of arguments ("+te+")!"),t[W].overloadTable[te]=$):t[W]=$}function Yl(W,$,te,pe,Ne,je,We,Be){this.name=W,this.constructor=$,this.instancePrototype=te,this.rawDestructor=pe,this.baseClass=Ne,this.getActualType=je,this.upcast=We,this.downcast=Be,this.pureVirtualFunctions=[]}function rs(W,$,te){for(;$!==te;)$.upcast||dr("Expected null or instance of "+te.name+", got an instance of "+$.name),W=$.upcast(W),$=$.baseClass;return W}function vs(W,$){if($===null)return this.isReference&&dr("null is not a valid "+this.name),0;$.$$||dr('Cannot pass "'+ni($)+'" as a '+this.name),$.$$.ptr||dr("Cannot pass deleted object as a pointer of type "+this.name);var te=$.$$.ptrType.registeredClass,pe=rs($.$$.ptr,te,this.registeredClass);return pe}function Ka(W,$){var te;if($===null)return this.isReference&&dr("null is not a valid "+this.name),this.isSmartPointer?(te=this.rawConstructor(),W!==null&&W.push(this.rawDestructor,te),te):0;$.$$||dr('Cannot pass "'+ni($)+'" as a '+this.name),$.$$.ptr||dr("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&$.$$.ptrType.isConst&&dr("Cannot convert argument of type "+($.$$.smartPtrType?$.$$.smartPtrType.name:$.$$.ptrType.name)+" to parameter type "+this.name);var pe=$.$$.ptrType.registeredClass;if(te=rs($.$$.ptr,pe,this.registeredClass),this.isSmartPointer)switch($.$$.smartPtr===void 0&&dr("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:$.$$.smartPtrType===this?te=$.$$.smartPtr:dr("Cannot convert argument of type "+($.$$.smartPtrType?$.$$.smartPtrType.name:$.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:te=$.$$.smartPtr;break;case 2:if($.$$.smartPtrType===this)te=$.$$.smartPtr;else{var Ne=$.clone();te=this.rawShare(te,Kl.toHandle(function(){Ne.delete()})),W!==null&&W.push(this.rawDestructor,te)}break;default:dr("Unsupporting sharing policy")}return te}function mc(W,$){if($===null)return this.isReference&&dr("null is not a valid "+this.name),0;$.$$||dr('Cannot pass "'+ni($)+'" as a '+this.name),$.$$.ptr||dr("Cannot pass deleted object as a pointer of type "+this.name),$.$$.ptrType.isConst&&dr("Cannot convert argument of type "+$.$$.ptrType.name+" to parameter type "+this.name);var te=$.$$.ptrType.registeredClass,pe=rs($.$$.ptr,te,this.registeredClass);return pe}function gc(W){return this.rawGetPointee&&(W=this.rawGetPointee(W)),W}function Za(W){this.rawDestructor&&this.rawDestructor(W)}function Kw(W){W!==null&&W.delete()}function _0(){Ii.prototype.getPointee=gc,Ii.prototype.destructor=Za,Ii.prototype.argPackAdvance=8,Ii.prototype.readValueFromPointer=mt,Ii.prototype.deleteObject=Kw,Ii.prototype.fromWireType=br}function Ii(W,$,te,pe,Ne,je,We,Be,Xe,pt,kt){this.name=W,this.registeredClass=$,this.isReference=te,this.isConst=pe,this.isSmartPointer=Ne,this.pointeeType=je,this.sharingPolicy=We,this.rawGetPointee=Be,this.rawConstructor=Xe,this.rawShare=pt,this.rawDestructor=kt,!Ne&&$.baseClass===void 0?pe?(this.toWireType=vs,this.destructorFunction=null):(this.toWireType=mc,this.destructorFunction=null):this.toWireType=Ka}function Zw(W,$,te){t.hasOwnProperty(W)||kr("Replacing nonexistant public symbol"),t[W].overloadTable!==void 0&&te!==void 0||(t[W]=$,t[W].argCount=te)}function E0(W,$,te){var pe=t["dynCall_"+W];return te&&te.length?pe.apply(null,[$].concat(te)):pe.call(null,$)}function Sh(W,$,te){return W.includes("j")?E0(W,$,te):Xt($).apply(null,te)}function S0(W,$){var te=[];return function(){return te.length=0,Object.assign(te,arguments),Sh(W,$,te)}}function Ws(W,$){W=In(W);function te(){return W.includes("j")?S0(W,$):Xt($)}var pe=te();return typeof pe!="function"&&dr("unknown function pointer with signature "+W+": "+$),pe}var Xl=void 0;function vc(W){var $=nm(W),te=In($);return bi($),te}function Qa(W,$){var te=[],pe={};function Ne(je){if(!pe[je]&&!vr[je]){if(Jt[je]){Jt[je].forEach(Ne);return}te.push(je),pe[je]=!0}}throw $.forEach(Ne),new Xl(W+": "+te.map(vc).join([", "]))}function Ah(W,$,te,pe,Ne,je,We,Be,Xe,pt,kt,Ot,Zt){kt=In(kt),je=Ws(Ne,je),Be&&(Be=Ws(We,Be)),pt&&(pt=Ws(Xe,pt)),Zt=Ws(Ot,Zt);var $r=Fr(kt);Eh($r,function(){Qa("Cannot construct "+kt+" due to unbound types",[pe])}),nn([W,$,te],pe?[pe]:[],function(bn){bn=bn[0];var wn,Fi;pe?(wn=bn.registeredClass,Fi=wn.instancePrototype):Fi=gs.prototype;var bs=Rr($r,function(){if(Object.getPrototypeOf(this)!==Ql)throw new yr("Use 'new' to construct "+kt);if(Vs.constructor_body===void 0)throw new yr(kt+" has no accessible constructor");var B0=Vs.constructor_body[arguments.length];if(B0===void 0)throw new yr("Tried to invoke ctor of "+kt+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Vs.constructor_body).toString()+") parameters instead!");return B0.apply(this,arguments)}),Ql=Object.create(Fi,{constructor:{value:bs}});bs.prototype=Ql;var Vs=new Yl(kt,bs,Ql,Zt,wn,je,Be,pt),Ja=new Ii(kt,Vs,!0,!1,!1),Lh=new Ii(kt+"*",Vs,!1,!1,!1),Ph=new Ii(kt+" const*",Vs,!1,!0,!1);return ve[W]={pointerType:Lh,constPointerType:Ph},Zw($r,bs),[Ja,Lh,Ph]})}function A0(W,$){for(var te=[],pe=0;pe<W;pe++)te.push(ce[($>>2)+pe]);return te}function Qw(W,$,te,pe,Ne,je){k($>0);var We=A0($,te);Ne=Ws(pe,Ne),nn([],[W],function(Be){Be=Be[0];var Xe="constructor "+Be.name;if(Be.registeredClass.constructor_body===void 0&&(Be.registeredClass.constructor_body=[]),Be.registeredClass.constructor_body[$-1]!==void 0)throw new yr("Cannot register multiple constructors with identical number of parameters ("+($-1)+") for class '"+Be.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Be.registeredClass.constructor_body[$-1]=()=>{Qa("Cannot construct "+Be.name+" due to unbound types",We)},nn([],We,function(pt){return pt.splice(1,0,null),Be.registeredClass.constructor_body[$-1]=yc(Xe,pt,null,Ne,je),[]}),[]})}function Gp(W,$){if(!(W instanceof Function))throw new TypeError("new_ called with constructor type "+typeof W+" which is not a function");var te=Rr(W.name||"unknownFunctionName",function(){});te.prototype=W.prototype;var pe=new te,Ne=W.apply(pe,$);return Ne instanceof Object?Ne:pe}function yc(W,$,te,pe,Ne){var je=$.length;je<2&&dr("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var We=$[1]!==null&&te!==null,Be=!1,Xe=1;Xe<$.length;++Xe)if($[Xe]!==null&&$[Xe].destructorFunction===void 0){Be=!0;break}for(var pt=$[0].name!=="void",kt="",Ot="",Xe=0;Xe<je-2;++Xe)kt+=(Xe!==0?", ":"")+"arg"+Xe,Ot+=(Xe!==0?", ":"")+"arg"+Xe+"Wired";var Zt="return function "+Fr(W)+"("+kt+`) {
if (arguments.length !== `+(je-2)+`) {
throwBindingError('function `+W+" called with ' + arguments.length + ' arguments, expected "+(je-2)+` args!');
}
`;Be&&(Zt+=`var destructors = [];
`);var $r=Be?"destructors":"null",bn=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],wn=[dr,pe,Ne,ct,$[0],$[1]];We&&(Zt+="var thisWired = classParam.toWireType("+$r+`, this);
`);for(var Xe=0;Xe<je-2;++Xe)Zt+="var arg"+Xe+"Wired = argType"+Xe+".toWireType("+$r+", arg"+Xe+"); // "+$[Xe+2].name+`
`,bn.push("argType"+Xe),wn.push($[Xe+2]);if(We&&(Ot="thisWired"+(Ot.length>0?", ":"")+Ot),Zt+=(pt?"var rv = ":"")+"invoker(fn"+(Ot.length>0?", ":"")+Ot+`);
`,Be)Zt+=`runDestructors(destructors);
`;else for(var Xe=We?1:2;Xe<$.length;++Xe){var Fi=Xe===1?"thisWired":"arg"+(Xe-2)+"Wired";$[Xe].destructorFunction!==null&&(Zt+=Fi+"_dtor("+Fi+"); // "+$[Xe].name+`
`,bn.push(Fi+"_dtor"),wn.push($[Xe].destructorFunction))}pt&&(Zt+=`var ret = retType.fromWireType(rv);
return ret;
`),Zt+=`}
`,bn.push(Zt);var bs=Gp(Function,bn).apply(null,wn);return bs}function qp(W,$,te,pe,Ne,je,We,Be){var Xe=A0(te,pe);$=In($),je=Ws(Ne,je),nn([],[W],function(pt){pt=pt[0];var kt=pt.name+"."+$;$.startsWith("@@")&&($=Symbol[$.substring(2)]),Be&&pt.registeredClass.pureVirtualFunctions.push($);function Ot(){Qa("Cannot call "+kt+" due to unbound types",Xe)}var Zt=pt.registeredClass.instancePrototype,$r=Zt[$];return $r===void 0||$r.overloadTable===void 0&&$r.className!==pt.name&&$r.argCount===te-2?(Ot.argCount=te-2,Ot.className=pt.name,Zt[$]=Ot):(Mo(Zt,$,kt),Zt[$].overloadTable[te-2]=Ot),nn([],Xe,function(bn){var wn=yc(kt,bn,pt,je,We);return Zt[$].overloadTable===void 0?(wn.argCount=te-2,Zt[$]=wn):Zt[$].overloadTable[te-2]=wn,[]}),[]})}var Ch=[],Fn=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Yp(W){W>4&&--Fn[W].refcount===0&&(Fn[W]=void 0,Ch.push(W))}function kh(){for(var W=0,$=5;$<Fn.length;++$)Fn[$]!==void 0&&++W;return W}function C0(){for(var W=5;W<Fn.length;++W)if(Fn[W]!==void 0)return Fn[W];return null}function Th(){t.count_emval_handles=kh,t.get_first_emval=C0}var Kl={toValue:W=>(W||dr("Cannot use deleted val. handle = "+W),Fn[W].value),toHandle:W=>{switch(W){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var $=Ch.length?Ch.pop():Fn.length;return Fn[$]={refcount:1,value:W},$}}}};function k0(W,$){$=In($),kn(W,{name:$,fromWireType:function(te){var pe=Kl.toValue(te);return Yp(te),pe},toWireType:function(te,pe){return Kl.toHandle(pe)},argPackAdvance:8,readValueFromPointer:mt,destructorFunction:null})}function ni(W){if(W===null)return"null";var $=typeof W;return $==="object"||$==="array"||$==="function"?W.toString():""+W}function Zl(W,$){switch($){case 2:return function(te){return this.fromWireType(Ve[te>>2])};case 3:return function(te){return this.fromWireType($e[te>>3])};default:throw new TypeError("Unknown float type: "+W)}}function Xp(W,$,te){var pe=On(te);$=In($),kn(W,{name:$,fromWireType:function(Ne){return Ne},toWireType:function(Ne,je){return je},argPackAdvance:8,readValueFromPointer:Zl($,pe),destructorFunction:null})}function bc(W,$,te){switch($){case 0:return te?function(Ne){return V[Ne]}:function(Ne){return K[Ne]};case 1:return te?function(Ne){return be[Ne>>1]}:function(Ne){return Ae[Ne>>1]};case 2:return te?function(Ne){return ce[Ne>>2]}:function(Ne){return Pe[Ne>>2]};default:throw new TypeError("Unknown integer type: "+W)}}function Jw(W,$,te,pe,Ne){$=In($);var je=On(te),We=Ot=>Ot;if(pe===0){var Be=32-8*te;We=Ot=>Ot<<Be>>>Be}var Xe=$.includes("unsigned"),pt=(Ot,Zt)=>{},kt;Xe?kt=function(Ot,Zt){return pt(Zt,this.name),Zt>>>0}:kt=function(Ot,Zt){return pt(Zt,this.name),Zt},kn(W,{name:$,fromWireType:We,toWireType:kt,argPackAdvance:8,readValueFromPointer:bc($,je,pe!==0),destructorFunction:null})}function Kp(W,$,te){var pe=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ne=pe[$];function je(We){We=We>>2;var Be=Pe,Xe=Be[We],pt=Be[We+1];return new Ne(ge,pt,Xe)}te=In(te),kn(W,{name:te,fromWireType:je,argPackAdvance:8,readValueFromPointer:je},{ignoreDuplicateRegistrations:!0})}function Zp(W,$){$=In($);var te=$==="std::string";kn(W,{name:$,fromWireType:function(pe){var Ne=Pe[pe>>2],je;if(te)for(var We=pe+4,Be=0;Be<=Ne;++Be){var Xe=pe+4+Be;if(Be==Ne||K[Xe]==0){var pt=Xe-We,kt=N(We,pt);je===void 0?je=kt:(je+="\0",je+=kt),We=Xe+1}}else{for(var Ot=new Array(Ne),Be=0;Be<Ne;++Be)Ot[Be]=String.fromCharCode(K[pe+4+Be]);je=Ot.join("")}return bi(pe),je},toWireType:function(pe,Ne){Ne instanceof ArrayBuffer&&(Ne=new Uint8Array(Ne));var je,We=typeof Ne=="string";We||Ne instanceof Uint8Array||Ne instanceof Uint8ClampedArray||Ne instanceof Int8Array||dr("Cannot pass non-string to std::string"),te&&We?je=()=>F(Ne):je=()=>Ne.length;var Be=je(),Xe=_c(4+Be+1);if(Pe[Xe>>2]=Be,te&&We)I(Ne,Xe+4,Be+1);else if(We)for(var pt=0;pt<Be;++pt){var kt=Ne.charCodeAt(pt);kt>255&&(bi(Xe),dr("String has UTF-16 code units that do not fit in 8 bits")),K[Xe+4+pt]=kt}else for(var pt=0;pt<Be;++pt)K[Xe+4+pt]=Ne[pt];return pe!==null&&pe.push(bi,Xe),Xe},argPackAdvance:8,readValueFromPointer:mt,destructorFunction:function(pe){bi(pe)}})}function wc(W,$,te){te=In(te);var pe,Ne,je,We,Be;$===2?(pe=B,Ne=Y,We=j,je=()=>Ae,Be=1):$===4&&(pe=ae,Ne=he,We=ee,je=()=>Pe,Be=2),kn(W,{name:te,fromWireType:function(Xe){for(var pt=Pe[Xe>>2],kt=je(),Ot,Zt=Xe+4,$r=0;$r<=pt;++$r){var bn=Xe+4+$r*$;if($r==pt||kt[bn>>Be]==0){var wn=bn-Zt,Fi=pe(Zt,wn);Ot===void 0?Ot=Fi:(Ot+="\0",Ot+=Fi),Zt=bn+$}}return bi(Xe),Ot},toWireType:function(Xe,pt){typeof pt!="string"&&dr("Cannot pass non-string to C++ string type "+te);var kt=We(pt),Ot=_c(4+kt+$);return Pe[Ot>>2]=kt>>Be,Ne(pt,Ot+4,kt+$),Xe!==null&&Xe.push(bi,Ot),Ot},argPackAdvance:8,readValueFromPointer:mt,destructorFunction:function(Xe){bi(Xe)}})}function Rh(W,$,te,pe,Ne,je){vt[W]={name:In($),rawConstructor:Ws(te,pe),rawDestructor:Ws(Ne,je),fields:[]}}function T0(W,$,te,pe,Ne,je,We,Be,Xe,pt){vt[W].fields.push({fieldName:In($),getterReturnType:te,getter:Ws(pe,Ne),getterContext:je,setterArgumentType:We,setter:Ws(Be,Xe),setterContext:pt})}function e1(W,$){$=In($),kn(W,{isVoid:!0,name:$,argPackAdvance:0,fromWireType:function(){},toWireType:function(te,pe){}})}function t1(){return Date.now()}function r1(W,$){var te=new Date(ce[W>>2]*1e3);ce[$>>2]=te.getSeconds(),ce[$+4>>2]=te.getMinutes(),ce[$+8>>2]=te.getHours(),ce[$+12>>2]=te.getDate(),ce[$+16>>2]=te.getMonth(),ce[$+20>>2]=te.getFullYear()-1900,ce[$+24>>2]=te.getDay();var pe=new Date(te.getFullYear(),0,1),Ne=(te.getTime()-pe.getTime())/(1e3*60*60*24)|0;ce[$+28>>2]=Ne,ce[$+36>>2]=-(te.getTimezoneOffset()*60);var je=new Date(te.getFullYear(),6,1).getTimezoneOffset(),We=pe.getTimezoneOffset(),Be=(je!=We&&te.getTimezoneOffset()==Math.min(We,je))|0;ce[$+32>>2]=Be}function Qp(W){var $=new Date(ce[W+20>>2]+1900,ce[W+16>>2],ce[W+12>>2],ce[W+8>>2],ce[W+4>>2],ce[W>>2],0),te=ce[W+32>>2],pe=$.getTimezoneOffset(),Ne=new Date($.getFullYear(),0,1),je=new Date($.getFullYear(),6,1).getTimezoneOffset(),We=Ne.getTimezoneOffset(),Be=Math.min(We,je);if(te<0)ce[W+32>>2]=+(je!=We&&Be==pe);else if(te>0!=(Be==pe)){var Xe=Math.max(We,je),pt=te>0?Be:Xe;$.setTime($.getTime()+(pt-pe)*6e4)}ce[W+24>>2]=$.getDay();var kt=($.getTime()-Ne.getTime())/(1e3*60*60*24)|0;return ce[W+28>>2]=kt,ce[W>>2]=$.getSeconds(),ce[W+4>>2]=$.getMinutes(),ce[W+8>>2]=$.getHours(),ce[W+12>>2]=$.getDate(),ce[W+16>>2]=$.getMonth(),$.getTime()/1e3|0}function n1(W,$,te){var pe=new Date().getFullYear(),Ne=new Date(pe,0,1),je=new Date(pe,6,1),We=Ne.getTimezoneOffset(),Be=je.getTimezoneOffset(),Xe=Math.max(We,Be);ce[W>>2]=Xe*60,ce[$>>2]=+(We!=Be);function pt(bn){var wn=bn.toTimeString().match(/\(([A-Za-z ]+)\)$/);return wn?wn[1]:"GMT"}var kt=pt(Ne),Ot=pt(je),Zt=Z(kt),$r=Z(Ot);Be<We?(Pe[te>>2]=Zt,Pe[te+4>>2]=$r):(Pe[te>>2]=$r,Pe[te+4>>2]=Zt)}function Jp(W,$,te){Jp.called||(Jp.called=!0,n1(W,$,te))}function i1(){rt("")}function s1(W,$,te){K.copyWithin(W,$,$+te)}function a1(){return 2147483648}function R0(W){try{return _.grow(W-ge.byteLength+65535>>>16),qe(_.buffer),1}catch{}}function o1(W){var $=K.length;W=W>>>0;var te=a1();if(W>te)return!1;let pe=(Xe,pt)=>Xe+(pt-Xe%pt)%pt;for(var Ne=1;Ne<=4;Ne*=2){var je=$*(1+.2/Ne);je=Math.min(je,W+100663296);var We=Math.min(te,pe(Math.max(W,je),65536)),Be=R0(We);if(Be)return!0}return!1}var em={};function l1(){return a||"./this.program"}function xc(){if(!xc.strings){var W=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",$={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:W,_:l1()};for(var te in em)em[te]===void 0?delete $[te]:$[te]=em[te];var pe=[];for(var te in $)pe.push(te+"="+$[te]);xc.strings=pe}return xc.strings}function tm(W,$){var te=0;return xc().forEach(function(pe,Ne){var je=$+te;Pe[W+Ne*4>>2]=je,ie(pe,je),te+=pe.length+1}),0}function u1(W,$){var te=xc();Pe[W>>2]=te.length;var pe=0;return te.forEach(function(Ne){pe+=Ne.length+1}),Pe[$>>2]=pe,0}function c1(){return y()}function d1(W,$){return t.extractor.close((W>>>0)+$*4294967296)}function N0(W){const $=t.extractor.create(ae(W));return t.setTempRet0($/4294967296|0),$%4294967296}function h1(W){const $=t.extractor.open(ae(W));return t.setTempRet0($/4294967296|0),$%4294967296}function f1(W,$,te,pe){return t.extractor.read((W>>>0)+$*4294967296,te,pe)}function p1(W,$,te,pe,Ne){return t.extractor.seek((W>>>0)+$*4294967296,(te>>>0)+pe*4294967296,N(Ne))}function m1(W,$){const te=t.extractor.tell((W>>>0)+$*4294967296);return t.setTempRet0(te/4294967296|0),te%4294967296}function g1(W,$,te,pe){return t.extractor.write((W>>>0)+$*4294967296,te,pe)}function v1(W){return W}function y1(W){g(W)}Hs=t.InternalError=yn(Error,"InternalError"),Fo(),yr=t.BindingError=yn(Error,"BindingError"),ql(),lt(),_0(),Xl=t.UnboundTypeError=yn(Error,"UnboundTypeError"),Th();var rm={p:Pn,r:Qe,t:re,c:P,d:Ce,l:Ie,ea:U,o:J,e:Ee,V:me,U:Fe,fa:Kr,F:vi,ca:_h,ia:Ah,ha:Qw,w:qp,ba:k0,z:Xp,q:Jw,j:Kp,y:Zp,u:wc,v:Rh,ga:T0,da:e1,Y:t1,Z:r1,_:Qp,$:Jp,x:i1,aa:s1,T:o1,W:tm,X:u1,a:c1,b:Ac,h:b1,g:am,n:O0,E:om,D:I0,O:Cc,Q:A1,A:x1,m:Sc,f:Nh,i:w1,C:F0,ja:_1,B:M0,k:E1,P:ys,R:S1,M:j0,N:d1,K:N0,L:h1,I:f1,H:p1,G:m1,J:g1,s:v1,S:y1};wr(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.la).apply(null,arguments)};var bi=t._free=function(){return(bi=t._free=t.asm.ma).apply(null,arguments)},_c=t._malloc=function(){return(_c=t._malloc=t.asm.na).apply(null,arguments)},nm=t.___getTypeName=function(){return(nm=t.___getTypeName=t.asm.pa).apply(null,arguments)};t.___embind_register_native_and_builtin_types=function(){return(t.___embind_register_native_and_builtin_types=t.asm.qa).apply(null,arguments)};var Zr=t._setThrew=function(){return(Zr=t._setThrew=t.asm.ra).apply(null,arguments)},sn=t.stackSave=function(){return(sn=t.stackSave=t.asm.sa).apply(null,arguments)},an=t.stackRestore=function(){return(an=t.stackRestore=t.asm.ta).apply(null,arguments)},Ec=t.___cxa_can_catch=function(){return(Ec=t.___cxa_can_catch=t.asm.ua).apply(null,arguments)},jo=t.___cxa_is_pointer_type=function(){return(jo=t.___cxa_is_pointer_type=t.asm.va).apply(null,arguments)},D0=t.dynCall_viji=function(){return(D0=t.dynCall_viji=t.asm.wa).apply(null,arguments)},L0=t.dynCall_ji=function(){return(L0=t.dynCall_ji=t.asm.xa).apply(null,arguments)},P0=t.dynCall_vij=function(){return(P0=t.dynCall_vij=t.asm.ya).apply(null,arguments)},im=t.dynCall_iiiiiijii=function(){return(im=t.dynCall_iiiiiijii=t.asm.za).apply(null,arguments)},sm=t.dynCall_vj=function(){return(sm=t.dynCall_vj=t.asm.Aa).apply(null,arguments)};function Sc(W,$){var te=sn();try{Xt(W)($)}catch(pe){if(an(te),pe!==pe+0)throw pe;Zr(1,0)}}function Ac(W,$){var te=sn();try{return Xt(W)($)}catch(pe){if(an(te),pe!==pe+0)throw pe;Zr(1,0)}}function b1(W,$,te){var pe=sn();try{return Xt(W)($,te)}catch(Ne){if(an(pe),Ne!==Ne+0)throw Ne;Zr(1,0)}}function Nh(W,$,te){var pe=sn();try{Xt(W)($,te)}catch(Ne){if(an(pe),Ne!==Ne+0)throw Ne;Zr(1,0)}}function w1(W,$,te,pe){var Ne=sn();try{Xt(W)($,te,pe)}catch(je){if(an(Ne),je!==je+0)throw je;Zr(1,0)}}function O0(W,$,te,pe,Ne){var je=sn();try{return Xt(W)($,te,pe,Ne)}catch(We){if(an(je),We!==We+0)throw We;Zr(1,0)}}function am(W,$,te,pe){var Ne=sn();try{return Xt(W)($,te,pe)}catch(je){if(an(Ne),je!==je+0)throw je;Zr(1,0)}}function om(W,$,te,pe,Ne,je,We){var Be=sn();try{return Xt(W)($,te,pe,Ne,je,We)}catch(Xe){if(an(Be),Xe!==Xe+0)throw Xe;Zr(1,0)}}function I0(W,$,te,pe,Ne,je,We,Be,Xe,pt){var kt=sn();try{return Xt(W)($,te,pe,Ne,je,We,Be,Xe,pt)}catch(Ot){if(an(kt),Ot!==Ot+0)throw Ot;Zr(1,0)}}function F0(W,$,te,pe,Ne){var je=sn();try{Xt(W)($,te,pe,Ne)}catch(We){if(an(je),We!==We+0)throw We;Zr(1,0)}}function M0(W,$,te,pe,Ne,je,We,Be,Xe,pt){var kt=sn();try{Xt(W)($,te,pe,Ne,je,We,Be,Xe,pt)}catch(Ot){if(an(kt),Ot!==Ot+0)throw Ot;Zr(1,0)}}function x1(W){var $=sn();try{Xt(W)()}catch(te){if(an($),te!==te+0)throw te;Zr(1,0)}}function _1(W,$,te,pe,Ne,je){var We=sn();try{Xt(W)($,te,pe,Ne,je)}catch(Be){if(an(We),Be!==Be+0)throw Be;Zr(1,0)}}function E1(W,$,te,pe,Ne,je,We,Be,Xe,pt,kt){var Ot=sn();try{Xt(W)($,te,pe,Ne,je,We,Be,Xe,pt,kt)}catch(Zt){if(an(Ot),Zt!==Zt+0)throw Zt;Zr(1,0)}}function S1(W,$,te,pe,Ne){var je=sn();try{D0(W,$,te,pe,Ne)}catch(We){if(an(je),We!==We+0)throw We;Zr(1,0)}}function A1(W,$){var te=sn();try{return L0(W,$)}catch(pe){if(an(te),pe!==pe+0)throw pe;Zr(1,0)}}function ys(W,$,te,pe){var Ne=sn();try{P0(W,$,te,pe)}catch(je){if(an(Ne),je!==je+0)throw je;Zr(1,0)}}function Cc(W,$,te,pe,Ne,je,We,Be,Xe,pt){var kt=sn();try{return im(W,$,te,pe,Ne,je,We,Be,Xe,pt)}catch(Ot){if(an(kt),Ot!==Ot+0)throw Ot;Zr(1,0)}}function j0(W,$,te){var pe=sn();try{sm(W,$,te)}catch(Ne){if(an(pe),Ne!==Ne+0)throw Ne;Zr(1,0)}}t.setTempRet0=g;var kc;Te=function W(){kc||Dh(),kc||(Te=W)};function Dh(W){if(Oe>0||(z(),Oe>0))return;function $(){kc||(kc=!0,t.calledRun=!0,!S&&(Le(),r(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),_e()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),$()},1)):$()}if(t.run=Dh,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Dh(),t.ready}})();let n_;async function UU(i){return n_||(n_=await $U(i)),n_}async function HU({wasmBinary:i,data:e,password:t=""}){const r=await UU(i&&{wasmBinary:i}),n=new zU(r,e,t);return r.extractor=n,n}function WU(){const{t:i}=ir(),{id:e}=cc(),[t]=Ul(),r=t.get("isLocal")==="true",n=t.get("server"),s=t.get("directOpen")==="true",a=t.get("directFile"),{retrieveFile:o,retrieveLocalFile:l}=Hp(),{pageEvent:c}=Vl(),h=T.useRef(!1),f=Br(),{server:m}=Ln(Dt(ce=>({server:ce.server}))),{libraryData:p}=Xr(Dt(ce=>({libraryData:ce.libraryData}))),{mangaDirection:x,mangaViewMode:g,mangaFitMode:y,setMangaDirection:b,setMangaViewMode:_,setMangaFitMode:S}=c0(Dt(ce=>({mangaDirection:ce.mangaDirection,mangaViewMode:ce.mangaViewMode,mangaFitMode:ce.mangaFitMode,setMangaDirection:ce.setMangaDirection,setMangaViewMode:ce.setMangaViewMode,setMangaFitMode:ce.setMangaFitMode}))),[k,C]=T.useState(!1),[R,N]=T.useState(null),[O,I]=T.useState(1),[F,G]=T.useState([]),[B,Y]=T.useState(!1),j=async ce=>{let Pe=null;F.forEach(Ve=>{Ve.startsWith("blob:")&&URL.revokeObjectURL(Ve)}),r?Pe=`/manga/read-bounce?isLocal=true&server=${n}&fileId=${ce}`:Pe=`/manga/read-bounce?fileId=${ce}`,f(Pe,{replace:!0,state:{key:Date.now()}})},ae=T.useCallback(async ce=>{if(!e)return null;if(h.current)return;h.current=!0;let Pe=null;if(r){if(Pe=await l(ce||Number(e),n||""),Pe.current_page&&Pe.current_page!==0&&I(Number(Pe.current_page)),!Pe)return V("Manga not found."),!1;N(Pe),await he(Pe,n||"")}else if(s&&a)a.endsWith(".zip")||a.endsWith(".cbz")?await Z(a,"zip"):(a.endsWith(".rar")||a.endsWith(".cbr"))&&await Z(a,"rar");else{if(Pe=await o(ce||Number(e)),console.log("Manga Entity",Pe),!Pe)return V("Manga not found."),!1;N(Pe),Pe.current_page&&Pe.current_page!==0&&I(Number(Pe.current_page)),await ee(Pe,m)}},[e,r,n,s,a,l,o,m,p]),he=async(ce,Pe)=>{const Ve=Pe.replace(/[/:?&]/g,"_")||"",$e=await Dl(),qe=await Gi($e,String(hr.AppLocalData),Ve,"series",String(ce.series_id),"files",ce.file_name);ce.file_format==="zip"||ce.file_format==="cbz"?await Z(qe,"zip"):(ce.file_format==="rar"||ce.file_format==="cbr")&&await Z(qe,"rar")},ee=async(ce,Pe)=>{if(!r){const $e=await(await fetch(`${Pe}/stream/${p==null?void 0:p.id}/${ce.id}`)).arrayBuffer();if(ce.file_format==="zip"||ce.file_format==="cbz"){const Ze=await new IU().loadAsync($e),at=Object.keys(Ze.files);at.sort((ut,z)=>ut.localeCompare(z));const gt=await Promise.all(at.map(async ut=>{const Le=await Ze.files[ut].async("blob");return URL.createObjectURL(Le)}));G(gt)}else if(ce.file_format==="rar"||ce.file_format==="cbr")try{const Ze=await fetch("/client/unrar.wasm").then(_e=>_e.arrayBuffer()),at=await HU({data:new Uint8Array($e),wasmBinary:Ze}),gt=at.getFileList(),z=Array.from(gt.fileHeaders).filter(_e=>!_e.flags.directory&&/\.(jpg|jpeg|png|gif|webp|bmp)$/i.test(_e.name)).sort((_e,ue)=>_e.name.localeCompare(ue.name,void 0,{numeric:!0})),Le=[];for(const _e of z){const ue=at.extract({files:[_e.name]}),le=Array.from(ue.files)[0].extraction;if(le){const Oe=new Blob([le]);Le.push(URL.createObjectURL(Oe))}}G(Le)}catch(qe){console.error("RAR extraction failed:",qe),V("Failed to extract RAR archive.")}}},Z=async(ce,Pe)=>{const Ve=await Dl(),$e=`${hr.AppLocalData}/currentlyReading`;try{await Um($e,{baseDir:hr.AppLocalData,recursive:!0})}catch(gt){console.error("Error removing directory",gt)}try{await B5($e,{baseDir:hr.AppLocalData,recursive:!0})}catch(gt){console.error("Error creating directory",gt)}const qe=await Gi(Ve,String(hr.AppLocalData),"currentlyReading");Pe==="zip"?await fi("unzip_file",{path:ce,destination:qe}):Pe==="rar"&&await fi("unrar_file",{path:ce,destination:qe}),console.log("File unzipped successfully."),await new Promise(gt=>setTimeout(gt,50));const Ze=await fi("get_files_in_directory",{path:qe});Ze.sort((gt,ut)=>gt.localeCompare(ut));const at=await Promise.all(Ze.map(async gt=>{const ut=gt.split(/[\/\\]/),z=await Gi(qe,...ut),Le=lg(z),_e=Date.now();return`${Le}?t=${_e}`}));G(at)},ie=T.useCallback(async()=>{let ce=1;g==="double"&&(ce=2);let Pe=O+ce;Pe>=F.length&&(Pe=F.length),s||c(Pe,r,(p==null?void 0:p.id)||0,r?(R==null?void 0:R.file_id)||0:(R==null?void 0:R.id)||0,n||""),I(Pe)},[g,O,F.length,s,c,r,p,R==null?void 0:R.file_id,R==null?void 0:R.id,n]),ge=T.useCallback(async()=>{let ce=1;g==="double"&&(ce=2);let Pe=O-ce;Pe<=0&&(Pe=1),s||c(Pe,r,(p==null?void 0:p.id)||0,r?(R==null?void 0:R.file_id)||0:(R==null?void 0:R.id)||0,n||""),I(Pe)},[g,O,s,c,r,p,R==null?void 0:R.file_id,R==null?void 0:R.id,n]),V=ce=>{wt.error(ce,{position:"bottom-right",style:{backgroundColor:"#111827",color:"#fff"}}),console.error("Error loading file, please try again."),f("/")};T.useEffect(()=>()=>{F.forEach(ce=>{ce.startsWith("blob:")&&URL.revokeObjectURL(ce)})},[]),T.useEffect(()=>{F.length>0||!r&&!p&&!s&&!a||!s&&(!m||R)||(e||s&&a)&&ae()},[e,ae,m,p,r,F,s,a]),T.useEffect(()=>{const ce=Pe=>{Pe.key==="ArrowLeft"?x==="ltr"?ge():ie():Pe.key==="ArrowRight"&&(x==="ltr"?ie():ge())};return window.addEventListener("keydown",ce),()=>{window.removeEventListener("keydown",ce)}},[x,ie,ge]),T.useEffect(()=>{const ce=document.querySelector(".titlebar");ce&&(ce.style.display="none")},[]);const K=(ce,Pe)=>E.jsx("button",{className:"bg-primary text-white rounded-full p-2 hover:bg-tertiary hover:cursor-pointer",onClick:Pe,style:{zIndex:2e3},children:ce}),be=()=>{if(x==="ltr"){if(F[O-1])return!0}else if(F[O])return!0;return!1},Ae=()=>{if(x==="ltr"){if(F[O])return!0}else if(F[O-1])return!0;return!1};return E.jsxs("div",{className:"h-[100dvh] max-h-[100dvh] w-screen overflow-y-auto",children:[k?E.jsxs("div",{className:"absolute w-full h-[50px] flex items-center justify-between bg-secondary px-3",style:{top:"0px",zIndex:2e3},children:[E.jsx("div",{children:K(E.jsx(Pp,{className:"size-4"}),()=>{const ce=document.querySelector(".titlebar");ce&&(ce.style.display="none"),f(s?"/libraries":r?`/manga/${R==null?void 0:R.series_id}?isLocal=true&server=${n}`:`/manga/${R==null?void 0:R.series_id}`)})}),E.jsxs("div",{className:"flex flex-row items-center gap-2",children:[g==="single"&&E.jsx(E.Fragment,{children:K(y==="contain"?E.jsx(CS,{className:"size-4"}):E.jsx(j8,{className:"size-4"}),()=>{S(y==="contain"?"actual":"contain")})}),K(x==="ltr"?E.jsx(w8,{className:"size-4"}):E.jsx(y8,{className:"size-4"}),()=>{b(x==="ltr"?"rtl":"ltr")}),K(g==="single"?E.jsx(L8,{className:"size-4"}):E.jsx(N8,{className:"size-4"}),()=>{_(g==="single"?"double":"single")}),K(B?E.jsx(Qk,{className:"size-4 text-gray-500"}):E.jsx(Qk,{className:"size-4"}),()=>{Y(!B)}),K(E.jsx(Zk,{className:"size-4"}),()=>{C(!k)})]})]}):E.jsxs("div",{className:"absolute w-full h-[50px] flex items-center justify-between bg-transparent px-3",style:{top:"0px",zIndex:2e3},children:[E.jsx("div",{children:" "}),E.jsx("div",{className:"flex flex-row items-center gap-2",children:K(E.jsx(Zk,{className:"size-4"}),()=>{C(!k)})})]}),(R==null?void 0:R.nextFile)&&F.length>0&&O>=F.length&&E.jsx("button",{className:"absolute top-[35%] left-[1rem] flex w-[10rem] h-[30%]",onClick:()=>{R.nextFile&&j(R.nextFile.id)},style:{zIndex:99999},children:E.jsx("img",{src:r?"":`${m}/preview-image/${p&&(p==null?void 0:p.id)}/${R.series_id}/${R.nextFile.id}.jpg`,className:"w-full h-full object-cover rounded-xl"})}),E.jsx("div",{id:"manga-reader",className:"h-[calc(100dvh-0px)] flex flex-row items-center justify-between",style:{marginTop:"0px"},children:F&&F.length>0?E.jsx(E.Fragment,{children:g==="single"?E.jsx("div",{className:`h-[calc(100dvh-0px)] ${y==="actual"?"flex-1":"flex-1 flex items-center justify-center"}`,children:y==="actual"?E.jsx(RU,{children:E.jsx(LU,{children:E.jsx("img",{src:F[O-1],alt:"Manga Page",className:"w-full",style:{filter:B?"grayscale(100%)":"none",WebkitFilter:B?"grayscale(100%)":"none"}})})}):E.jsx("img",{src:F[O-1],alt:"Manga Page",className:`${y==="contain"?"w-full h-full object-contain":"object-fit"}`,style:{filter:B?"grayscale(100%)":"none",WebkitFilter:B?"grayscale(100%)":"none"}})}):E.jsxs("div",{className:"flex w-full h-full max-h-full max-w-full object-contain",children:[E.jsx("div",{className:"w-1/2 h-full flex items-center justify-end",children:be()&&E.jsx("img",{src:x==="ltr"?F[O-1]:F[O],alt:"Manga Page",className:"max-h-full max-w-full object-contain",style:{marginLeft:"auto",marginRight:0,filter:B?"grayscale(100%)":"none",WebkitFilter:B?"grayscale(100%)":"none"}})}),E.jsx("div",{className:"w-1/2 h-full flex items-center justify-start",children:Ae()&&E.jsx("img",{src:x==="ltr"?F[O]:F[O-1],alt:"Manga Page",className:"max-h-full max-w-full object-contain",style:{marginLeft:0,marginRight:"auto",filter:B?"grayscale(100%)":"none",WebkitFilter:B?"grayscale(100%)":"none"}})})]})}):E.jsx("div",{className:"flex-1 flex items-center justify-center text-white",children:"Currently loading..."})}),k&&E.jsxs("div",{className:"fixed w-full h-[50px] flex flex-col md:flex-row items-center justify-between bg-secondary px-3 gap-5",style:{bottom:"0px",zIndex:2e3},children:[E.jsxs("div",{className:"w-full md:w-[25%] flex flex-row gap-2 text-sm items-center",children:[E.jsx("span",{className:"font-bold text-white",children:i("read.jumpTo")}),E.jsx("select",{className:"bg-primary border border-secondary p-1 text-white rounded-lg",value:O,onChange:ce=>I(Number(ce.target.value)),children:Array.from({length:F.length},(ce,Pe)=>E.jsx("option",{value:Pe+1,children:Pe+1},Pe+1))})]}),E.jsxs("div",{className:"flex flex-row items-center justify-center gap-5 w-full md:w-[50%]",children:[K(E.jsx(E8,{className:"size-4"}),()=>{x==="ltr"?ge():ie()}),E.jsxs("div",{className:"text-sm text-white",children:[i("read.page")," ",O," ",i("read.of")," ",F.length]}),K(E.jsx(A8,{className:"size-4"}),()=>{x==="ltr"?ie():ge()})]}),E.jsx("div",{className:"w-full md:w-[25%]",children:" "})]}),E.jsx("div",{className:"absolute top-0 left-0 h-[100dvh] w-[16rem]",style:{zIndex:100},onMouseDown:ce=>{ce.preventDefault(),x==="ltr"?ge():ie()},onWheel:ce=>{const Ve=document.getElementById("manga-reader");Ve&&(Ve.querySelector(".manga-height, .overflow-y-auto")||Ve.querySelector('[class*="h-[calc(100dvh-30px)]"]')||Ve).scrollBy(0,ce.deltaY)},children:" "}),E.jsx("div",{className:"absolute top-0 right-0 h-[100dvh] w-[16rem]",style:{zIndex:100},onMouseDown:ce=>{ce.preventDefault(),x==="ltr"?ie():ge()},onWheel:ce=>{const Ve=document.getElementById("manga-reader");Ve&&(Ve.querySelector(".manga-height, .overflow-y-auto")||Ve.querySelector('[class*="h-[calc(100dvh-30px)]"]')||Ve).scrollBy(0,ce.deltaY)},children:" "})]})}function VU(){const i=Br(),[e]=Ul(),t=e.get("fileId"),r=e.get("isLocal")==="true",n=e.get("server");return T.useEffect(()=>{t&&i(`/manga/${t}/read${r?`?isLocal=true&server=${n}`:""}`)},[t,r,n,i]),null}function GU({collectionId:i,libraryId:e,name:t}){const r=Br(),{t:n}=ir(),[s,a]=T.useState(!1),{deleteCollection:o,retrieveLibrary:l}=vn();return E.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-[1rem] gap-3",children:[E.jsxs("div",{className:"flex flex-row gap-3 md:gap-2 w-full md:w-auto items-center",children:[E.jsx(Yt,{"aria-label":n("common.returnToLibrary"),onPress:()=>{r(`/library/${e}?tab=collections`)},children:E.jsx(q5,{className:"w-4 h-4"})}),E.jsx("div",{children:E.jsx("h1",{className:"font-bold text-start text-xl text-white",children:t})})]}),E.jsx("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-auto",children:E.jsxs(Yt,{onPress:async()=>{if(s)return;if(await rc(n("collection.deleteCollectionConfirmation"),{title:"Devourer",kind:"warning"})){a(!0);try{await o(i)?(wt.success(n("collection.collectionDeleted"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"}),await l(e),r(`/library/${e}?tab=collections`)):wt.error(n("collection.collectionDeleteError"),{style:{backgroundColor:"#111827",color:"#fff"},position:"bottom-right"})}catch(h){console.error(h),a(!1)}}},disabled:s,children:[E.jsx(x6,{className:"w-4 h-4"}),n("collection.deleteCollection")]})})]})}function qU(){const{id:i}=cc(),{libraryData:e}=Xr(Dt(n=>({libraryId:n.libraryId,libraryData:n.libraryData}))),[t,r]=T.useState(null);return T.useEffect(()=>{var n;if(e&&i){const s=(n=e.collections)==null?void 0:n.find(a=>a.id===Number(i));s&&r(s)}},[e,i]),E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-24 pt-8",children:t?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"mt-[1rem]",children:E.jsx(GU,{libraryId:e.id,name:t.name,collectionId:t.id})}),E.jsx("div",{className:"mt-[1rem] grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 2xl:grid-cols-8 gap-5 auto-rows-fr",children:t.series.map((n,s)=>E.jsx(RS,{entity:e==null?void 0:e.series.find(a=>a.id===n),offline:!1},`collection-entity-card-${n}-${s}-${e.id}`))})]}):E.jsx($p,{})}),E.jsx(es,{})]})}function Cr(){return Cr=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Cr.apply(null,arguments)}function wh(i,e){if(i==null)return{};var t={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.indexOf(r)!==-1)continue;t[r]=i[r]}return t}var gf=255,Ju=100,YU=i=>{var{r:e,g:t,b:r,a:n}=i,s=Math.max(e,t,r),a=s-Math.min(e,t,r),o=a?s===e?(t-r)/a:s===t?2+(r-e)/a:4+(e-t)/a:0;return{h:60*(o<0?o+6:o),s:s?a/s*Ju:0,v:s/gf*Ju,a:n}},a3=i=>{var{h:e,s:t,l:r,a:n}=o3(i);return"hsla("+e+", "+t+"%, "+r+"%, "+n+")"},o3=i=>{var{h:e,s:t,v:r,a:n}=i,s=(200-t)*r/Ju;return{h:e,s:s>0&&s<200?t*r/Ju/(s<=Ju?s:200-s)*Ju:0,l:s/2,a:n}},l3=i=>{var{r:e,g:t,b:r}=i,n=e<<16|t<<8|r;return"#"+(s=>new Array(7-s.length).join("0")+s)(n.toString(16))},XU=i=>{var{r:e,g:t,b:r,a:n}=i,s=typeof n=="number"&&(n*255|256).toString(16).slice(1);return""+l3({r:e,g:t,b:r})+(s||"")},Xb=i=>YU(KU(i)),KU=i=>{var e=i.replace("#","");/^#?/.test(i)&&e.length===3&&(i="#"+e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2));var t=new RegExp("[A-Za-z0-9]{2}","g"),[r,n,s=0,a]=i.match(t).map(o=>parseInt(o,16));return{r,g:n,b:s,a:(a??255)/gf}},sA=i=>{var{h:e,s:t,v:r,a:n}=i,s=e/60,a=t/Ju,o=r/Ju,l=Math.floor(s)%6,c=s-Math.floor(s),h=gf*o*(1-a),f=gf*o*(1-a*c),m=gf*o*(1-a*(1-c));o*=gf;var p={};switch(l){case 0:p.r=o,p.g=m,p.b=h;break;case 1:p.r=f,p.g=o,p.b=h;break;case 2:p.r=h,p.g=o,p.b=m;break;case 3:p.r=h,p.g=f,p.b=o;break;case 4:p.r=m,p.g=h,p.b=o;break;case 5:p.r=o,p.g=h,p.b=f;break}return p.r=Math.round(p.r),p.g=Math.round(p.g),p.b=Math.round(p.b),Cr({},p,{a:n})},ZU=i=>{var{r:e,g:t,b:r,a:n}=sA(i);return"rgba("+e+", "+t+", "+r+", "+n+")"},QU=i=>{var{r:e,g:t,b:r}=i;return{r:e,g:t,b:r}},JU=i=>{var{h:e,s:t,l:r}=i;return{h:e,s:t,l:r}},vf=i=>l3(sA(i)),eH=i=>{var{h:e,s:t,v:r}=i;return{h:e,s:t,v:r}},tH=i=>{var{r:e,g:t,b:r}=i,n=function(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)},s=n(e/255),a=n(t/255),o=n(r/255),l={};return l.x=s*.4124+a*.3576+o*.1805,l.y=s*.2126+a*.7152+o*.0722,l.bri=s*.0193+a*.1192+o*.9505,l},rH=i=>{var e,t,r,n,s,a,o,l,c;return typeof i=="string"&&u3(i)?(a=Xb(i),l=i):typeof i!="string"&&(a=i),a&&(r=eH(a),s=o3(a),n=sA(a),c=XU(n),l=vf(a),t=JU(s),e=QU(n),o=tH(e)),{rgb:e,hsl:t,hsv:r,rgba:n,hsla:s,hsva:a,hex:l,hexa:c,xy:o}},u3=i=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(i);function YR(i){var e=T.useRef(i);return T.useEffect(()=>{e.current=i}),T.useCallback((t,r)=>e.current&&e.current(t,r),[])}var fg=i=>"touches"in i,XR=i=>{!fg(i)&&i.preventDefault&&i.preventDefault()},KR=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e<t?t:e},ZR=(i,e)=>{var t=i.getBoundingClientRect(),r=fg(e)?e.touches[0]:e;return{left:KR((r.pageX-(t.left+window.pageXOffset))/t.width),top:KR((r.pageY-(t.top+window.pageYOffset))/t.height),width:t.width,height:t.height,x:r.pageX-(t.left+window.pageXOffset),y:r.pageY-(t.top+window.pageYOffset)}},nH=["prefixCls","className","onMove","onDown"],aA=st.forwardRef((i,e)=>{var{prefixCls:t="w-color-interactive",className:r,onMove:n,onDown:s}=i,a=wh(i,nH),o=T.useRef(null),l=T.useRef(!1),[c,h]=T.useState(!1),f=YR(n),m=YR(s),p=_=>l.current&&!fg(_)?!1:(l.current=fg(_),!0),x=T.useCallback(_=>{if(XR(_),!!o.current){var S=fg(_)?_.touches.length>0:_.buttons>0;if(!S){h(!1);return}f==null||f(ZR(o.current,_),_)}},[f]),g=T.useCallback(()=>h(!1),[]),y=T.useCallback(_=>{_?(window.addEventListener(l.current?"touchmove":"mousemove",x),window.addEventListener(l.current?"touchend":"mouseup",g)):(window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",g),window.removeEventListener("touchmove",x),window.removeEventListener("touchend",g))},[x,g]);T.useEffect(()=>(y(c),()=>{y(!1)}),[c,x,g,y]);var b=T.useCallback(_=>{XR(_.nativeEvent),p(_.nativeEvent)&&o.current&&(m==null||m(ZR(o.current,_.nativeEvent),_.nativeEvent),h(!0))},[m]);return E.jsx("div",Cr({},a,{className:[t,r||""].filter(Boolean).join(" "),style:Cr({},a.style,{touchAction:"none"}),ref:o,tabIndex:0,onMouseDown:b,onTouchStart:b}))});aA.displayName="Interactive";var iH=["className","prefixCls","left","top","style","fillProps"],sH=i=>{var{className:e,prefixCls:t,left:r,top:n,style:s,fillProps:a}=i,o=wh(i,iH),l=Cr({},s,{position:"absolute",left:r,top:n}),c=Cr({width:18,height:18,boxShadow:"var(--alpha-pointer-box-shadow)",borderRadius:"50%",backgroundColor:"var(--alpha-pointer-background-color)"},a==null?void 0:a.style,{transform:r?"translate(-9px, -1px)":"translate(-1px, -9px)"});return E.jsx("div",Cr({className:t+"-pointer "+(e||""),style:l},o,{children:E.jsx("div",Cr({className:t+"-fill"},a,{style:c}))}))},aH=["prefixCls","className","hsva","background","bgProps","innerProps","pointerProps","radius","width","height","direction","style","onChange","pointer"],c3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==",oA=st.forwardRef((i,e)=>{var{prefixCls:t="w-color-alpha",className:r,hsva:n,background:s,bgProps:a={},innerProps:o={},pointerProps:l={},radius:c=0,width:h,height:f=16,direction:m="horizontal",style:p,onChange:x,pointer:g}=i,y=wh(i,aH),b=N=>{x&&x(Cr({},n,{a:m==="horizontal"?N.left:N.top}),N)},_=a3(Object.assign({},n,{a:1})),S="linear-gradient(to "+(m==="horizontal"?"right":"bottom")+", rgba(244, 67, 54, 0) 0%, "+_+" 100%)",k={};m==="horizontal"?k.left=n.a*100+"%":k.top=n.a*100+"%";var C=Cr({"--alpha-background-color":"#fff","--alpha-pointer-background-color":"rgb(248, 248, 248)","--alpha-pointer-box-shadow":"rgb(0 0 0 / 37%) 0px 1px 4px 0px",borderRadius:c,background:"url("+c3+") left center",backgroundColor:"var(--alpha-background-color)"},{width:h,height:f},p,{position:"relative"}),R=g&&typeof g=="function"?g(Cr({prefixCls:t},l,k)):E.jsx(sH,Cr({},l,{prefixCls:t},k));return E.jsxs("div",Cr({},y,{className:[t,t+"-"+m,r||""].filter(Boolean).join(" "),style:C,ref:e,children:[E.jsx("div",Cr({},a,{style:Cr({inset:0,position:"absolute",background:s||S,borderRadius:c},a.style)})),E.jsx(aA,Cr({},o,{style:Cr({},o.style,{inset:0,zIndex:1,position:"absolute"}),onMove:b,onDown:b,children:R}))]}))});oA.displayName="Alpha";var oH=i=>{var{className:e,color:t,left:r,top:n,prefixCls:s}=i,a={position:"absolute",top:n,left:r},o={"--saturation-pointer-box-shadow":"rgb(255 255 255) 0px 0px 0px 1.5px, rgb(0 0 0 / 30%) 0px 0px 1px 1px inset, rgb(0 0 0 / 40%) 0px 0px 1px 2px",width:6,height:6,transform:"translate(-3px, -3px)",boxShadow:"var(--saturation-pointer-box-shadow)",borderRadius:"50%",backgroundColor:t};return T.useMemo(()=>E.jsx("div",{className:s+"-pointer "+(e||""),style:a,children:E.jsx("div",{className:s+"-fill",style:o})}),[n,r,t,e,s])},lH=["prefixCls","radius","pointer","className","hue","style","hsva","onChange"],d3=st.forwardRef((i,e)=>{var t,{prefixCls:r="w-color-saturation",radius:n=0,pointer:s,className:a,hue:o=0,style:l,hsva:c,onChange:h}=i,f=wh(i,lH),m=Cr({width:200,height:200,borderRadius:n},l,{position:"relative"}),p=(g,y)=>{h&&c&&h({h:c.h,s:g.left*100,v:(1-g.top)*100,a:c.a})},x=T.useMemo(()=>{if(!c)return null;var g={top:100-c.v+"%",left:c.s+"%",color:a3(c)};return s&&typeof s=="function"?s(Cr({prefixCls:r},g)):E.jsx(oH,Cr({prefixCls:r},g))},[c,s,r]);return E.jsx(aA,Cr({className:[r,a||""].filter(Boolean).join(" ")},f,{style:Cr({position:"absolute",inset:0,cursor:"crosshair",backgroundImage:"linear-gradient(0deg, #000, transparent), linear-gradient(90deg, #fff, hsl("+((t=c==null?void 0:c.h)!=null?t:o)+", 100%, 50%))"},m),ref:e,onMove:p,onDown:p,children:x}))});d3.displayName="Saturation";var uH=["prefixCls","className","hue","onChange","direction"],h3=st.forwardRef((i,e)=>{var{prefixCls:t="w-color-hue",className:r,hue:n=0,onChange:s,direction:a="horizontal"}=i,o=wh(i,uH);return E.jsx(oA,Cr({ref:e,className:t+" "+(r||"")},o,{direction:a,background:"linear-gradient(to "+(a==="horizontal"?"right":"bottom")+", rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%)",hsva:{h:n,s:100,v:100,a:n/360},onChange:(l,c)=>{s&&s({h:a==="horizontal"?360*c.left:360*c.top})}}))});h3.displayName="Hue";var cH=["style","color"],dH=["prefixCls","className","onChange","color","style","disableAlpha"],i_=i=>{var{style:e,color:t}=i,r=wh(i,cH),n=Cr({"--colorful-pointer-background-color":"#fff","--colorful-pointer-border":"2px solid #fff",height:28,width:28,position:"absolute",transform:"translate(-16px, -16px)",boxShadow:"0 2px 4px rgb(0 0 0 / 20%)",borderRadius:"50%",background:"url("+c3+")",backgroundColor:"var(--colorful-pointer-background-color)",border:"var(--colorful-pointer-border)",zIndex:1},e);return E.jsx("div",Cr({},r,{style:n,children:E.jsx("div",{style:{backgroundColor:t,borderRadius:"50%",height:"100%",width:"100%"}})}))},nS=st.forwardRef((i,e)=>{var{prefixCls:t="w-color-colorful",className:r,onChange:n,color:s,style:a,disableAlpha:o}=i,l=wh(i,dH),c=typeof s=="string"&&u3(s)?Xb(s):s||{},h=f=>n&&n(rH(f));return E.jsxs("div",Cr({ref:e,style:Cr({width:200,position:"relative"},a)},l,{className:t+" "+(r||""),children:[E.jsx(d3,{hsva:c,className:t,radius:"8px 8px 0 0",style:{width:"auto",height:150,minWidth:120,borderBottom:"12px solid #000"},pointer:f=>{var{left:m,top:p,color:x}=f;return E.jsx(i_,{style:{left:m,top:p},color:vf(c)})},onChange:f=>h(Cr({},c,f))}),E.jsx(h3,{hue:c.h,height:24,radius:o?"0 0 8px 8px":0,className:t,onChange:f=>h(Cr({},c,f)),pointer:f=>{var{left:m}=f;return E.jsx(i_,{style:{left:m,transform:"translate(-16px, -5px)"},color:"hsl("+(c.h||0)+"deg 100% 50%)"})}}),!o&&E.jsx(oA,{hsva:c,height:24,className:t,radius:"0 0 8px 8px",pointer:f=>{var{left:m}=f;return E.jsx(i_,{style:{left:m,transform:"translate(-16px, -5px)"},color:ZU(c)})},onChange:f=>h(Cr({},c,f))})]}))});nS.displayName="Colorful";const hH=[10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200],fH=[10,25,50,100,250,500,1e3];function pH(){const{t:i}=ir(),{opdsUrl:e,setOpdsUrl:t,opdsLimit:r,setOpdsLimit:n}=gh(Dt(I=>({opdsUrl:I.opdsUrl,setOpdsUrl:I.setOpdsUrl,opdsLimit:I.opdsLimit,setOpdsLimit:I.setOpdsLimit}))),{bookTheme:s,setBookTheme:a,bookCustomBackground:o,setBookCustomBackground:l,bookCustomForeground:c,setBookCustomForeground:h,bookCustomFontSize:f,setBookCustomFontSize:m,bookCustomFontFamily:p,setBookCustomFontFamily:x,mangaDirection:g,setMangaDirection:y,mangaViewMode:b,setMangaViewMode:_,mangaFitMode:S,setMangaFitMode:k}=c0(Dt(I=>({bookTheme:I.bookTheme,setBookTheme:I.setBookTheme,bookCustomBackground:I.bookCustomBackground,setBookCustomBackground:I.setBookCustomBackground,bookCustomForeground:I.bookCustomForeground,setBookCustomForeground:I.setBookCustomForeground,bookCustomFontSize:I.bookCustomFontSize,setBookCustomFontSize:I.setBookCustomFontSize,bookCustomFontFamily:I.bookCustomFontFamily,setBookCustomFontFamily:I.setBookCustomFontFamily,mangaDirection:I.mangaDirection,setMangaDirection:I.setMangaDirection,mangaViewMode:I.mangaViewMode,setMangaViewMode:I.setMangaViewMode,mangaFitMode:I.mangaFitMode,setMangaFitMode:I.setMangaFitMode}))),[C,R]=T.useState(Xb(o)),[N,O]=T.useState(Xb(c));return E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-[8rem] pt-8",children:E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full md:w-1/2 md:mx-auto",children:E.jsxs("div",{className:"mx-auto w-full max-w-lg divide-y divide-white/5 rounded-xl bg-primary",children:[E.jsx(J2,{as:"div",className:"p-6",defaultOpen:!1,children:({open:I})=>E.jsxs(E.Fragment,{children:[E.jsxs(Yy,{className:"group flex w-full items-center justify-between",children:[E.jsx("h2",{className:"text-lg font-medium text-white group-data-hover:text-white/80",children:i("settings.bookSettings.title")}),E.jsx(Ky,{className:`size-5 fill-white/60 group-data-hover:fill-white/50 ${I&&"rotate-180"}`})]}),E.jsx(Xy,{className:"mt-2 text-sm/5 text-white",children:E.jsxs("div",{children:[E.jsx("label",{htmlFor:"book-default-theme",className:"text-sm/6 font-semibold text-white",children:i("settings.bookSettings.defaultTheme")}),E.jsx("div",{children:E.jsx("select",{id:"book-default-theme",className:"my-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500 capitalize",value:String(s),onChange:F=>a(F.target.value),children:["light","dark","custom"].map(F=>E.jsx("option",{value:F,className:"bg-gray-900 text-white capitalize",children:F},F))})}),E.jsx("label",{className:"text-sm/6 font-semibold text-white",children:i("settings.bookSettings.customBackground")}),E.jsxs("div",{className:"mt-2 mb-3 grid grid-cols-1 md:grid-cols-2 gap-5",children:[E.jsx("div",{children:E.jsx(nS,{color:C,onChange:F=>{R(F.hsva),l(vf(F.hsva))}})}),E.jsx("div",{className:"rounded-xl w-full h-full",style:{backgroundColor:vf(C)}})]}),E.jsx("label",{className:"text-sm/6 font-semibold text-white",children:i("settings.bookSettings.customForeground")}),E.jsxs("div",{className:"mt-2 mb-3 grid grid-cols-1 md:grid-cols-2 gap-5",children:[E.jsx("div",{children:E.jsx(nS,{color:N,onChange:F=>{O(F.hsva),h(vf(F.hsva))}})}),E.jsx("div",{className:"rounded-xl w-full h-full",style:{backgroundColor:vf(N)}})]}),E.jsx("label",{htmlFor:"book-font-size",className:"text-sm/6 font-semibold text-white",children:i("settings.bookSettings.fontSize")}),E.jsx("div",{className:"mb-2",children:E.jsx("select",{id:"book-font-size",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:String(f),onChange:F=>m(Number(F.target.value)),children:hH.map(F=>E.jsxs("option",{value:F,className:"bg-gray-900 text-white",children:[F,"%"]},F))})}),E.jsx("label",{htmlFor:"book-font-family",className:"text-sm/6 font-semibold text-white",children:i("settings.bookSettings.fontFamily")}),E.jsx("div",{children:E.jsx("select",{id:"book-font-family",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:String(p),onChange:F=>{x(F.target.value)},children:["Lexend","Baskervville","EBGaramond-Regular","ComicNeue-Regular"].map(F=>E.jsx("option",{value:F,className:`${F.toLowerCase()} bg-gray-900 text-white`,children:F},F))})})]})})]})}),E.jsx(J2,{as:"div",className:"p-6",defaultOpen:!1,children:({open:I})=>E.jsxs(E.Fragment,{children:[E.jsxs(Yy,{className:"group flex w-full items-center justify-between",children:[E.jsx("h2",{className:"text-lg font-medium text-white group-data-hover:text-white/80",children:i("settings.mangaSettings.title")}),E.jsx(Ky,{className:`size-5 fill-white/60 group-data-hover:fill-white/50 ${I&&"rotate-180"}`})]}),E.jsxs(Xy,{className:"mt-2 text-sm/5 text-white",children:[E.jsxs("div",{children:[E.jsx("label",{htmlFor:"manga-direction",className:"text-sm/6 font-semibold text-white",children:i("settings.mangaSettings.readingDirection")}),E.jsxs("select",{id:"manga-direction",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:g,onChange:F=>y(F.target.value),children:[E.jsx("option",{value:"ltr",children:"Left to right"}),E.jsx("option",{value:"rtl",children:"Right to left"})]})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"manga-fit-mode",className:"text-sm/6 font-semibold text-white",children:i("settings.mangaSettings.pageFitMode")}),E.jsxs("select",{id:"manga-fit-mode",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:S,onChange:F=>k(F.target.value),children:[E.jsx("option",{value:"contain",children:i("settings.mangaSettings.contain")}),E.jsx("option",{value:"actual",children:i("settings.mangaSettings.actual")})]})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"manga-direction",className:"text-sm/6 font-semibold text-white",children:i("settings.mangaSettings.viewMode")}),E.jsxs("select",{id:"manga-view-mode",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:b,onChange:F=>_(F.target.value),children:[E.jsx("option",{value:"single",children:i("settings.mangaSettings.single")}),E.jsx("option",{value:"double",children:i("settings.mangaSettings.double")})]})]})]})]})}),E.jsx(J2,{as:"div",className:"p-6",defaultOpen:!1,children:({open:I})=>E.jsxs(E.Fragment,{children:[E.jsxs(Yy,{className:"group flex w-full items-center justify-between",children:[E.jsx("h2",{className:"text-lg font-medium text-white group-data-hover:text-white/80",children:i("settings.opdsSettings.title")}),E.jsx(Ky,{className:`size-5 fill-white/60 group-data-hover:fill-white/50 ${I&&"rotate-180"}`})]}),E.jsx(Xy,{className:"mt-2 text-sm/5 text-white",children:E.jsxs("div",{children:[E.jsxs("div",{children:[E.jsx("label",{htmlFor:"opds-url",className:"text-sm/6 font-semibold text-white",children:i("settings.opdsSettings.savedOpdsUrl")}),E.jsx("input",{id:"opds-url",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:e||"",onChange:F=>t(F.target.value)})]}),E.jsxs("div",{className:"mt-2",children:[E.jsx("label",{htmlFor:"opds-url",className:"text-sm/6 font-semibold text-white",children:i("settings.opdsSettings.booksPerPage")}),E.jsx("select",{id:"opds-url",className:"mt-2 w-full bg-gray-900 text-white rounded-md p-2 border border-gray-500",value:String(r),onChange:F=>n(Number(F.target.value)),children:fH.map(F=>E.jsx("option",{value:F,className:"bg-gray-900 text-white",children:F},F))})]})]})})]})})]})})}),E.jsx(es,{})]})}async function s_(i,e){await fi("plugin:opener|open_path",{path:i,with:e})}const mH=T.memo(({path:i,files:e,isCollapsed:t,onToggle:r,onFileClick:n})=>{const{t:s}=ir();return E.jsxs("div",{className:"bg-primary text-white p-3 rounded-xl mt-5 w-full",children:[E.jsxs("div",{className:"text-left font-bold text-lg mb-2 border-b pb-1 flex items-center cursor-pointer",onClick:()=>r(i),children:[E.jsx("span",{className:"mr-2",children:t?"▶":"▼"}),E.jsxs("span",{children:["📁 ",i]}),E.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",e.length," files)"]})]}),!t&&E.jsx("div",{className:"pl-4",children:e.map(a=>E.jsx("div",{onClick:()=>n(a),className:"cursor-pointer hover:bg-secondary p-2 rounded text-left",children:E.jsxs("div",{className:"flex items-baseline gap-2",children:[E.jsxs("span",{className:"font-bold",children:[s("providers.read"),":"]}),E.jsx("span",{children:a.name})]})},a.id))})]})});function gH(){const i=Br(),{t:e}=ir(),{oauthGoogleAccessToken:t,setOauthGoogleAccessToken:r}=zs(Dt(k=>({oauthGoogleAccessToken:k.oauthGoogleAccessToken,setOauthGoogleAccessToken:k.setOauthGoogleAccessToken}))),n=T.useRef(!1),[s,a]=T.useState([]),[o,l]=T.useState(new Set),[c,h]=T.useState(!1),[f,m]=T.useState(!1),[p,x]=T.useState(null),g=T.useCallback(async k=>{const C=[".zip",".cbz",".rar",".cbr",".epub",".pdf"],R=[];async function N(O="root",I=""){const F=C.map(ae=>`name contains '${ae}'`).join(" or "),B=`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(`trashed=false and '${O}' in parents and (mimeType = 'application/vnd.google-apps.folder' or (${F}))`)}&fields=files(id,name,mimeType,parents)`,Y=await fetch(B,{headers:{Authorization:`Bearer ${k}`}});if(!Y.ok)throw new Error("Failed to fetch files");const j=await Y.json();for(const ae of j.files)if(ae.mimeType==="application/vnd.google-apps.folder"){const he=I?`${I}/${ae.name}`:ae.name;await N(ae.id,he)}else C.some(he=>ae.name.toLowerCase().endsWith(he))&&R.push({...ae,path:I})}try{h(!0),await N(),a(R)}catch(O){console.error("Error fetching files:",O),x(e("server.error"))}finally{h(!1)}},[e]),y=T.useCallback(async(k,C)=>{try{if((await fetch("https://www.googleapis.com/oauth2/v1/tokeninfo",{headers:{Authorization:`Bearer ${k}`}})).ok)return k;const O=await(await fetch("https://devourer.app/api/auth/google/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:C})})).json();if(O.error)throw new Error(O.error);return r(O.access_token),O.access_token}catch(R){return console.error("Token validation/refresh failed:",R),i("/oauth-google"),null}},[i,r]),b=T.useCallback(async k=>{m(!0),x(null);try{const C=`https://www.googleapis.com/drive/v3/files/${k.id}?alt=media`,R=await Dl(),N=k.name.split(".").pop();if(!N){m(!1),x("Invalid file extension.");return}const O=await Gi(R,String(hr.AppLocalData),`local.${N}`);await fi("download_file",{url:C,path:O,token:t});let I=null;if(["epub","pdf"].includes(N)?I=`/book/0/read?opdsType=${N==="pdf"?"opds-pdf":"opds-epub"}&opdsUrl=local:${O}`:I=`/manga/0/read?directOpen=true&directFile=${O}`,!I){m(!1),x("Invalid file extension.");return}i(I)}catch(C){console.error("Error downloading file:",C),x(e("server.error"))}finally{m(!1)}},[t,i,e]),_=T.useCallback(k=>{l(C=>{const R=new Set(C);return R.has(k)?R.delete(k):R.add(k),R})},[]),S=T.useCallback(k=>{const C=k.reduce((R,N)=>{const O=N.path||"Root";return R[O]||(R[O]=[]),R[O].push(N),R},{});return Object.keys(C).forEach(R=>{C[R].sort((N,O)=>N.name.localeCompare(O.name))}),C},[]);return T.useEffect(()=>{if(n.current)return;n.current=!0,(async()=>{try{const[C]=await nr.select("SELECT * FROM config WHERE key = $1",["oauthGoogleAccessToken"]),[R]=await nr.select("SELECT * FROM config WHERE key = $1",["oauthGoogleRefreshToken"]);if(!(C!=null&&C.value)||!(R!=null&&R.value)){await s_("https://devourer.app/oauth/google?mobile=true");return}const N=await y(C.value,R.value);N?(N!==C.value&&await nr.execute("UPDATE config SET value = $1 WHERE key = $2",[N,"oauthGoogleAccessToken"]),await g(N)):await s_("https://devourer.app/oauth/google?mobile=true")}catch{await s_("https://devourer.app/oauth/google?mobile=true");return}})()},[y,g,e]),E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsx(ts,{className:"flex-1 px-5 pb-[8rem] pt-8",children:E.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full md:w-1/2 md:mx-auto",children:[p&&E.jsx("div",{className:"text-red-500 mb-4",children:p}),f?E.jsx("div",{className:"text-white",children:e("providers.retrievingFile")}):E.jsx(E.Fragment,{children:c?E.jsx("div",{className:"text-white",children:e("providers.retrievingFiles")}):E.jsx(E.Fragment,{children:Object.entries(S(s)).sort(([k],[C])=>k==="Root"?-1:C==="Root"?1:k.localeCompare(C)).map(([k,C])=>E.jsx(mH,{path:k,files:C,isCollapsed:o.has(k),onToggle:_,onFileClick:b},k))})})]})}),E.jsx(es,{})]})}function vH(){const{setOauthGoogleRefreshToken:i,setOauthGoogleAccessToken:e}=zs(Dt(a=>({setOauthGoogleAccessToken:a.setOauthGoogleAccessToken,setOauthGoogleRefreshToken:a.setOauthGoogleRefreshToken}))),t=Br(),[r]=Ul(),{t:n}=ir();T.useEffect(()=>{const a=r.get("access_token"),o=r.get("refresh_token");a&&e(a),o&&i(o),a&&o&&s(a,o)},[]);const s=async(a,o)=>{(await nr.select("SELECT * FROM config WHERE key = $1",["oauthGoogleAccessToken"])).length>0?await nr.execute("UPDATE config SET value = $1 WHERE key = $2",[a,"oauthGoogleAccessToken"]):await nr.execute("INSERT INTO config (key, value) VALUES ($1, $2)",["oauthGoogleAccessToken",a]),(await nr.select("SELECT * FROM config WHERE key = $1",["oauthGoogleRefreshToken"])).length>0?await nr.execute("UPDATE config SET value = $1 WHERE key = $2",[o,"oauthGoogleRefreshToken"]):await nr.execute("INSERT INTO config (key, value) VALUES ($1, $2)",["oauthGoogleRefreshToken",o]),await new Promise(h=>setTimeout(h,100)),t("/providers/google")};return E.jsxs("div",{className:"h-screen flex flex-col",children:[E.jsx(ts,{className:"flex-1 px-5 pb-24 md:px-0",children:E.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full",children:E.jsx("div",{className:"mt-5 w-full md:w-1/2 text-center",children:n("providers.oauthValidity")})})}),E.jsx(es,{})]})}const yH=T.memo(({isOpen:i,onClose:e})=>{const{createUser:t,getUsers:r}=zp(),{t:n}=ir(),[s,a]=T.useState(!1),[o,l]=T.useState(null),[c,h]=T.useState({username:"",password:"",passwordConfirm:"",role:"user"}),f=T.useCallback(async()=>{if(c.username&&c.username.length===0){l(n("login.createErrorUsername"));return}if(c.password&&c.password.length<8){l(n("login.createErrorPasswordLength"));return}if(c.password!==c.passwordConfirm){l(n("login.createErrorPasswordConfirm"));return}a(!0),l(null);try{try{await t(c.username,c.password,c.role),await r(),e()}catch(m){l(m instanceof Error?m.message:"An error occurred")}}catch(m){l(m instanceof Error?m.message:"An error occurred")}finally{a(!1)}},[c,e,n]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsx(Ji,{as:"h3",className:"font-semibold text-2xl",children:n("users.createUser")}),E.jsxs("div",{className:"mt-5",children:[E.jsx("label",{htmlFor:"username",className:"font-semibold",children:n("login.username")}),E.jsx("input",{type:"text",id:"username",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:c.username,onChange:m=>h({...c,username:m.target.value})}),E.jsx("label",{htmlFor:"password",className:"font-semibold",children:n("login.password")}),E.jsx("input",{type:"password",id:"password",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:c.password,onChange:m=>h({...c,password:m.target.value})}),E.jsx("label",{htmlFor:"passwordConfirm",className:"font-semibold",children:n("login.passwordConfirm")}),E.jsx("input",{type:"password",id:"passwordConfirm",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:c.passwordConfirm,onChange:m=>h({...c,passwordConfirm:m.target.value})}),E.jsx("label",{htmlFor:"role",className:"font-semibold",children:n("users.role")}),E.jsx("select",{id:"role",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:c.role,onChange:m=>h({...c,role:m.target.value}),children:["admin","user","moderator","upload"].map(m=>E.jsx("option",{value:m,children:m},m))})]}),o&&E.jsx("div",{className:"mb-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:o}),E.jsx("div",{children:E.jsx(Yt,{className:"w-full",disabled:s,onPress:f,children:n("users.createUser")})})]})})})})}),bH=T.memo(({isOpen:i,onClose:e,user:t})=>{const{editUser:r,getUsers:n}=zp(),{t:s}=ir(),[a,o]=T.useState(!1),[l,c]=T.useState(null),[h,f]=T.useState({username:t.username,password:"",passwordConfirm:"",role:t.roles[0]}),m=T.useCallback(async()=>{if(h.username&&h.username.length===0){c(s("login.createErrorUsername"));return}if(h.password&&h.password.length<8){c(s("login.createErrorPasswordLength"));return}if(h.password!==h.passwordConfirm){c(s("login.createErrorPasswordConfirm"));return}o(!0),c(null);try{try{await r(t.id,h.role,h.password.length>=8?h.password:void 0),await n(),e()}catch(p){c(p instanceof Error?p.message:"An error occurred")}}catch(p){c(p instanceof Error?p.message:"An error occurred")}finally{o(!1)}},[h,e,s]);return E.jsx(ms,{open:i,as:"div",className:"relative z-10 focus:outline-none",onClose:e,style:{zIndex:99999},children:E.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto bg-black/85",children:E.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:E.jsxs(Qi,{transition:!0,className:"w-full max-w-md rounded-xl bg-gray-900 text-white p-6 backdrop-blur-2xl duration-300 ease-out data-closed:transform-[scale(95%)] data-closed:opacity-0",children:[E.jsxs(Ji,{as:"h3",className:"font-semibold text-2xl",children:["Edit ",t.email]}),E.jsxs("div",{className:"mt-5",children:[E.jsx("div",{className:"mb-5 text-sm text-gray-400",children:s("users.editUserDescription")}),E.jsx("label",{htmlFor:"password",className:"font-semibold",children:s("login.password")}),E.jsx("input",{type:"password",id:"password",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:h.password,onChange:p=>f({...h,password:p.target.value})}),E.jsx("label",{htmlFor:"passwordConfirm",className:"font-semibold",children:s("login.passwordConfirm")}),E.jsx("input",{type:"password",id:"passwordConfirm",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:h.passwordConfirm,onChange:p=>f({...h,passwordConfirm:p.target.value})}),E.jsx("label",{htmlFor:"role",className:"font-semibold",children:s("users.role")}),E.jsx("select",{id:"role",className:"w-full bg-gray-800 rounded-md p-2 text-white mb-5 mt-2 border border-gray-500",value:h.role,onChange:p=>f({...h,role:p.target.value}),children:["admin","user","moderator","upload"].map(p=>E.jsx("option",{value:p,children:p},p))})]}),l&&E.jsx("div",{className:"mb-5 p-2 bg-red-900/50 rounded-md text-white",role:"alert","aria-live":"assertive","aria-atomic":"true",children:l}),E.jsx("div",{children:E.jsx(Yt,{className:"w-full",disabled:a,onPress:m,children:s("users.editUser")})})]})})})})});function wH(){const{getUsers:i,deleteUser:e}=zp(),{users:t}=Ln(Dt(m=>({users:m.users}))),{username:r}=zs(Dt(m=>({username:m.username}))),{t:n}=ir(),s=Br(),[a,o]=T.useState(!1),[l,c]=T.useState(!1),[h,f]=T.useState(null);return T.useEffect(()=>{i()},[]),E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"h-screen flex flex-col bg-secondary",children:[E.jsxs(ts,{className:"flex-1 px-5 pb-24 pt-12",children:[E.jsx("div",{className:"flex flex-col md:flex-row gap-2 mb-5 mt-[1.5rem] md:mt-0",children:E.jsxs(Yt,{"aria-label":n("common.returnToLibraries"),onPress:()=>{s("/libraries")},children:[E.jsx(Pp,{className:"w-4 h-4"})," ",n("common.returnToLibraries")]})}),E.jsx("div",{className:"flex flex-col items-center justify-center mb-[4rem]",children:E.jsxs("div",{className:"w-full",children:[E.jsxs("div",{className:"bg-primary text-white p-3 text-sm rounded-lg",children:[E.jsx("span",{className:"font-bold",children:n("users.loggedInAs")})," ",E.jsx("span",{children:r})]}),E.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:justify-between md:items-center mt-3",children:[E.jsx("h1",{className:"text-2xl text-white font-bold",children:n("users.title")}),E.jsx(Yt,{className:"text-xs",onPress:()=>{o(!0)},children:n("users.createUser")})]}),E.jsx("div",{className:"mt-3 bg-primary text-white p-0 text-sm rounded-lg overflow-x-auto overflow-hidden",children:E.jsxs("table",{className:"w-full",children:[E.jsx("thead",{children:E.jsxs("tr",{children:[E.jsx("th",{className:"text-left p-3",children:n("users.username")}),E.jsx("th",{className:"text-left p-3",children:n("users.role")}),E.jsx("th",{className:"text-left p-3",children:n("users.collections")}),E.jsx("th",{className:"text-right p-3",children:" "})]})}),E.jsx("tbody",{children:t.map((m,p)=>E.jsxs("tr",{className:`${p%2===0?"bg-tertiary":"bg-primary"}`,children:[E.jsx("td",{className:"text-left p-3",children:m.email}),E.jsx("td",{className:"text-left p-3",children:m.roles[0]}),E.jsx("td",{className:"text-left p-3",children:m.collections}),E.jsx("td",{className:"justify-end text-right flex flex-row gap-2 py-3",children:m.email!=="admin"&&E.jsxs(E.Fragment,{children:[E.jsx(Yt,{className:"text-xs",onPress:()=>{e(m.id)},children:n("users.delete")}),E.jsx(Yt,{className:"text-xs mr-3",onPress:()=>{c(!0),f(m)},children:n("users.edit")})]})})]},m.id))})]})})]})})]}),E.jsx(es,{})]}),a&&E.jsx(yH,{isOpen:a,onClose:()=>{o(!1)}}),l&&h&&E.jsx(bH,{isOpen:l,user:h,onClose:()=>{f(null),c(!1)}})]})}function xH(){NS();const{currentQueue:i,processing:e}=D_(Dt(t=>({currentQueue:t.currentQueue,processing:t.processing})));return T.useEffect(()=>{},[i,e]),null}const qt=i=>typeof i=="string",jm=()=>{let i,e;const t=new Promise((r,n)=>{i=r,e=n});return t.resolve=i,t.reject=e,t},QR=i=>i==null?"":""+i,_H=(i,e,t)=>{i.forEach(r=>{e[r]&&(t[r]=e[r])})},EH=/###/g,JR=i=>i&&i.indexOf("###")>-1?i.replace(EH,"."):i,eN=i=>!i||qt(i),pg=(i,e,t)=>{const r=qt(e)?e.split("."):e;let n=0;for(;n<r.length-1;){if(eN(i))return{};const s=JR(r[n]);!i[s]&&t&&(i[s]=new t),Object.prototype.hasOwnProperty.call(i,s)?i=i[s]:i={},++n}return eN(i)?{}:{obj:i,k:JR(r[n])}},tN=(i,e,t)=>{const{obj:r,k:n}=pg(i,e,Object);if(r!==void 0||e.length===1){r[n]=t;return}let s=e[e.length-1],a=e.slice(0,e.length-1),o=pg(i,a,Object);for(;o.obj===void 0&&a.length;)s=`${a[a.length-1]}.${s}`,a=a.slice(0,a.length-1),o=pg(i,a,Object),o!=null&&o.obj&&typeof o.obj[`${o.k}.${s}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${s}`]=t},SH=(i,e,t,r)=>{const{obj:n,k:s}=pg(i,e,Object);n[s]=n[s]||[],n[s].push(t)},Kb=(i,e)=>{const{obj:t,k:r}=pg(i,e);if(t&&Object.prototype.hasOwnProperty.call(t,r))return t[r]},AH=(i,e,t)=>{const r=Kb(i,t);return r!==void 0?r:Kb(e,t)},f3=(i,e,t)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in i?qt(i[r])||i[r]instanceof String||qt(e[r])||e[r]instanceof String?t&&(i[r]=e[r]):f3(i[r],e[r],t):i[r]=e[r]);return i},rf=i=>i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var CH={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const kH=i=>qt(i)?i.replace(/[&<>"'\/]/g,e=>CH[e]):i;class TH{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const RH=[" ",",","?","!",";"],NH=new TH(20),DH=(i,e,t)=>{e=e||"",t=t||"";const r=RH.filter(a=>e.indexOf(a)<0&&t.indexOf(a)<0);if(r.length===0)return!0;const n=NH.getRegExp(`(${r.map(a=>a==="?"?"\\?":a).join("|")})`);let s=!n.test(i);if(!s){const a=i.indexOf(t);a>0&&!n.test(i.substring(0,a))&&(s=!0)}return s},iS=(i,e,t=".")=>{if(!i)return;if(i[e])return Object.prototype.hasOwnProperty.call(i,e)?i[e]:void 0;const r=e.split(t);let n=i;for(let s=0;s<r.length;){if(!n||typeof n!="object")return;let a,o="";for(let l=s;l<r.length;++l)if(l!==s&&(o+=t),o+=r[l],a=n[o],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&l<r.length-1)continue;s+=l-s+1;break}n=a}return n},Cg=i=>i==null?void 0:i.replace("_","-"),LH={type:"logger",log(i){this.output("log",i)},warn(i){this.output("warn",i)},error(i){this.output("error",i)},output(i,e){var t,r;(r=(t=console==null?void 0:console[i])==null?void 0:t.apply)==null||r.call(t,console,e)}};class Zb{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||LH,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,n){return n&&!this.debug?null:(qt(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Zb(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Zb(this.logger,e)}}var To=new Zb;class Xw{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const n=this.observers[r].get(t)||0;this.observers[r].set(t,n+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([n,s])=>{for(let a=0;a<s;a++)n(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([n,s])=>{for(let a=0;a<s;a++)n.apply(n,[e,...t])})}}class rN extends Xw{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r,n={}){var c,h;const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,a=n.ignoreJSONStructure!==void 0?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],r&&(Array.isArray(r)?o.push(...r):qt(r)&&s?o.push(...r.split(s)):o.push(r)));const l=Kb(this.data,o);return!l&&!t&&!r&&e.indexOf(".")>-1&&(e=o[0],t=o[1],r=o.slice(2).join(".")),l||!a||!qt(r)?l:iS((h=(c=this.data)==null?void 0:c[e])==null?void 0:h[t],r,s)}addResource(e,t,r,n,s={silent:!1}){const a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let o=[e,t];r&&(o=o.concat(a?r.split(a):r)),e.indexOf(".")>-1&&(o=e.split("."),n=t,t=o[1]),this.addNamespaces(t),tN(this.data,o,n),s.silent||this.emit("added",e,t,r,n)}addResources(e,t,r,n={silent:!1}){for(const s in r)(qt(r[s])||Array.isArray(r[s]))&&this.addResource(e,t,s,r[s],{silent:!0});n.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,n,s,a={silent:!1,skipCopy:!1}){let o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),n=r,r=t,t=o[1]),this.addNamespaces(t);let l=Kb(this.data,o)||{};a.skipCopy||(r=JSON.parse(JSON.stringify(r))),n?f3(l,r,s):l={...l,...r},tN(this.data,o,l),a.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(n=>t[n]&&Object.keys(t[n]).length>0)}toJSON(){return this.data}}var p3={processors:{},addPostProcessor(i){this.processors[i.name]=i},handle(i,e,t,r,n){return i.forEach(s=>{var a;e=((a=this.processors[s])==null?void 0:a.process(e,t,r,n))??e}),e}};const nN={},iN=i=>!qt(i)&&typeof i!="boolean"&&typeof i!="number";class Qb extends Xw{constructor(e,t={}){super(),_H(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=To.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const r={...t};if(e==null)return!1;const n=this.resolve(e,r);return(n==null?void 0:n.res)!==void 0}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const n=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const a=r&&e.indexOf(r)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!DH(e,r,n);if(a&&!o){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:qt(s)?[s]:s};const c=e.split(r);(r!==n||r===n&&this.options.ns.indexOf(c[0])>-1)&&(s=c.shift()),e=c.join(n)}return{key:e,namespaces:qt(s)?[s]:s}}translate(e,t,r){let n=typeof t=="object"?{...t}:t;if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const s=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:o,namespaces:l}=this.extractFromKey(e[e.length-1],n),c=l[l.length-1];let h=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;h===void 0&&(h=":");const f=n.lng||this.language,m=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode")return m?s?{res:`${c}${h}${o}`,usedKey:o,exactUsedKey:o,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(n)}:`${c}${h}${o}`:s?{res:o,usedKey:o,exactUsedKey:o,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(n)}:o;const p=this.resolve(e,n);let x=p==null?void 0:p.res;const g=(p==null?void 0:p.usedKey)||o,y=(p==null?void 0:p.exactUsedKey)||o,b=["[object Number]","[object Function]","[object RegExp]"],_=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,k=n.count!==void 0&&!qt(n.count),C=Qb.hasDefaultValue(n),R=k?this.pluralResolver.getSuffix(f,n.count,n):"",N=n.ordinal&&k?this.pluralResolver.getSuffix(f,n.count,{ordinal:!1}):"",O=k&&!n.ordinal&&n.count===0,I=O&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${R}`]||n[`defaultValue${N}`]||n.defaultValue;let F=x;S&&!x&&C&&(F=I);const G=iN(F),B=Object.prototype.toString.apply(F);if(S&&F&&G&&b.indexOf(B)<0&&!(qt(_)&&Array.isArray(F))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Y=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,F,{...n,ns:l}):`key '${o} (${this.language})' returned an object instead of string.`;return s?(p.res=Y,p.usedParams=this.getUsedParamsDetails(n),p):Y}if(a){const Y=Array.isArray(F),j=Y?[]:{},ae=Y?y:g;for(const he in F)if(Object.prototype.hasOwnProperty.call(F,he)){const ee=`${ae}${a}${he}`;C&&!x?j[he]=this.translate(ee,{...n,defaultValue:iN(I)?I[he]:void 0,joinArrays:!1,ns:l}):j[he]=this.translate(ee,{...n,joinArrays:!1,ns:l}),j[he]===ee&&(j[he]=F[he])}x=j}}else if(S&&qt(_)&&Array.isArray(x))x=x.join(_),x&&(x=this.extendTranslation(x,e,n,r));else{let Y=!1,j=!1;!this.isValidLookup(x)&&C&&(Y=!0,x=I),this.isValidLookup(x)||(j=!0,x=o);const he=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&j?void 0:x,ee=C&&I!==x&&this.options.updateMissing;if(j||Y||ee){if(this.logger.log(ee?"updateKey":"missingKey",f,c,o,ee?I:x),a){const V=this.resolve(o,{...n,keySeparator:!1});V&&V.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Z=[];const ie=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ie&&ie[0])for(let V=0;V<ie.length;V++)Z.push(ie[V]);else this.options.saveMissingTo==="all"?Z=this.languageUtils.toResolveHierarchy(n.lng||this.language):Z.push(n.lng||this.language);const ge=(V,K,be)=>{var ce;const Ae=C&&be!==x?be:he;this.options.missingKeyHandler?this.options.missingKeyHandler(V,c,K,Ae,ee,n):(ce=this.backendConnector)!=null&&ce.saveMissing&&this.backendConnector.saveMissing(V,c,K,Ae,ee,n),this.emit("missingKey",V,c,K,x)};this.options.saveMissing&&(this.options.saveMissingPlurals&&k?Z.forEach(V=>{const K=this.pluralResolver.getSuffixes(V,n);O&&n[`defaultValue${this.options.pluralSeparator}zero`]&&K.indexOf(`${this.options.pluralSeparator}zero`)<0&&K.push(`${this.options.pluralSeparator}zero`),K.forEach(be=>{ge([V],o+be,n[`defaultValue${be}`]||I)})}):ge(Z,o,I))}x=this.extendTranslation(x,e,n,p,r),j&&x===o&&this.options.appendNamespaceToMissingKey&&(x=`${c}${h}${o}`),(j||Y)&&this.options.parseMissingKeyHandler&&(x=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${h}${o}`:o,Y?x:void 0,n))}return s?(p.res=x,p.usedParams=this.getUsedParamsDetails(n),p):x}extendTranslation(e,t,r,n,s){var l,c;if((l=this.i18nFormat)!=null&&l.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const h=qt(e)&&(((c=r==null?void 0:r.interpolation)==null?void 0:c.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(h){const p=e.match(this.interpolator.nestingRegexp);f=p&&p.length}let m=r.replace&&!qt(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(m={...this.options.interpolation.defaultVariables,...m}),e=this.interpolator.interpolate(e,m,r.lng||this.language||n.usedLng,r),h){const p=e.match(this.interpolator.nestingRegexp),x=p&&p.length;f<x&&(r.nest=!1)}!r.lng&&n&&n.res&&(r.lng=this.language||n.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,(...p)=>(s==null?void 0:s[0])===p[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${t[0]}`),null):this.translate(...p,t),r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,o=qt(a)?[a]:a;return e!=null&&(o!=null&&o.length)&&r.applyPostProcessor!==!1&&(e=p3.handle(o,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,t={}){let r,n,s,a,o;return qt(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const c=this.extractFromKey(l,t),h=c.key;n=h;let f=c.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const m=t.count!==void 0&&!qt(t.count),p=m&&!t.ordinal&&t.count===0,x=t.context!==void 0&&(qt(t.context)||typeof t.context=="number")&&t.context!=="",g=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);f.forEach(y=>{var b,_;this.isValidLookup(r)||(o=y,!nN[`${g[0]}-${y}`]&&((b=this.utils)!=null&&b.hasLoadedNamespace)&&!((_=this.utils)!=null&&_.hasLoadedNamespace(o))&&(nN[`${g[0]}-${y}`]=!0,this.logger.warn(`key "${n}" for languages "${g.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(S=>{var R;if(this.isValidLookup(r))return;a=S;const k=[h];if((R=this.i18nFormat)!=null&&R.addLookupKeys)this.i18nFormat.addLookupKeys(k,h,S,y,t);else{let N;m&&(N=this.pluralResolver.getSuffix(S,t.count,t));const O=`${this.options.pluralSeparator}zero`,I=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(k.push(h+N),t.ordinal&&N.indexOf(I)===0&&k.push(h+N.replace(I,this.options.pluralSeparator)),p&&k.push(h+O)),x){const F=`${h}${this.options.contextSeparator}${t.context}`;k.push(F),m&&(k.push(F+N),t.ordinal&&N.indexOf(I)===0&&k.push(F+N.replace(I,this.options.pluralSeparator)),p&&k.push(F+O))}}let C;for(;C=k.pop();)this.isValidLookup(r)||(s=C,r=this.getResource(S,y,C,t))}))})}),{res:r,usedKey:n,exactUsedKey:s,usedLng:a,usedNS:o}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r,n={}){var s;return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(e,t,r,n):this.resourceStore.getResource(e,t,r,n)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!qt(e.replace);let n=r?e.replace:e;if(r&&typeof e.count<"u"&&(n.count=e.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!r){n={...n};for(const s of t)delete n[s]}return n}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}class sN{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=To.create("languageUtils")}getScriptPartFromCode(e){if(e=Cg(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Cg(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(qt(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const n=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(n))&&(t=n)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const n=this.getScriptPartFromCode(r);if(this.isSupportedCode(n))return t=n;const s=this.getLanguagePartFromCode(r);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find(a=>{if(a===s)return a;if(!(a.indexOf("-")<0&&s.indexOf("-")<0)&&(a.indexOf("-")>0&&s.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===s||a.indexOf(s)===0&&s.length>1))return a})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),qt(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),n=[],s=a=>{a&&(this.isSupportedCode(a)?n.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return qt(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):qt(e)&&s(this.formatLanguageCode(e)),r.forEach(a=>{n.indexOf(a)<0&&s(this.formatLanguageCode(a))}),n}}const aN={zero:0,one:1,two:2,few:3,many:4,other:5},oN={select:i=>i===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class PH{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=To.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const r=Cg(e==="dev"?"en":e),n=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:r,type:n});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let a;try{a=new Intl.PluralRules(r,{type:n})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),oN;if(!e.match(/-|_/))return oN;const l=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(l,t)}return this.pluralRulesCache[s]=a,a}needsPlural(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),(r==null?void 0:r.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,r={}){return this.getSuffixes(e,r).map(n=>`${t}${n}`)}getSuffixes(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?r.resolvedOptions().pluralCategories.sort((n,s)=>aN[n]-aN[s]).map(n=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${n}`):[]}getSuffix(e,t,r={}){const n=this.getRule(e,r);return n?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,r))}}const lN=(i,e,t,r=".",n=!0)=>{let s=AH(i,e,t);return!s&&n&&qt(t)&&(s=iS(i,t,r),s===void 0&&(s=iS(e,t,r))),s},a_=i=>i.replace(/\$/g,"$$$$");class OH{constructor(e={}){var t;this.logger=To.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(r=>r),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:n,prefix:s,prefixEscaped:a,suffix:o,suffixEscaped:l,formatSeparator:c,unescapeSuffix:h,unescapePrefix:f,nestingPrefix:m,nestingPrefixEscaped:p,nestingSuffix:x,nestingSuffixEscaped:g,nestingOptionsSeparator:y,maxReplaces:b,alwaysFormat:_}=e.interpolation;this.escape=t!==void 0?t:kH,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=n!==void 0?n:!1,this.prefix=s?rf(s):a||"{{",this.suffix=o?rf(o):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=h?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=m?rf(m):p||rf("$t("),this.nestingSuffix=x?rf(x):g||rf(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=b||1e3,this.alwaysFormat=_!==void 0?_:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,r)=>(t==null?void 0:t.source)===r?(t.lastIndex=0,t):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,n){var p;let s,a,o;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=x=>{if(x.indexOf(this.formatSeparator)<0){const _=lN(t,l,x,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(_,void 0,r,{...n,...t,interpolationkey:x}):_}const g=x.split(this.formatSeparator),y=g.shift().trim(),b=g.join(this.formatSeparator).trim();return this.format(lN(t,l,y,this.options.keySeparator,this.options.ignoreJSONStructure),b,r,{...n,...t,interpolationkey:y})};this.resetRegExp();const h=(n==null?void 0:n.missingInterpolationHandler)||this.options.missingInterpolationHandler,f=((p=n==null?void 0:n.interpolation)==null?void 0:p.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:x=>a_(x)},{regex:this.regexp,safeValue:x=>this.escapeValue?a_(this.escape(x)):a_(x)}].forEach(x=>{for(o=0;s=x.regex.exec(e);){const g=s[1].trim();if(a=c(g),a===void 0)if(typeof h=="function"){const b=h(e,s,n);a=qt(b)?b:""}else if(n&&Object.prototype.hasOwnProperty.call(n,g))a="";else if(f){a=s[0];continue}else this.logger.warn(`missed to pass in variable ${g} for interpolating ${e}`),a="";else!qt(a)&&!this.useRawValueToEscape&&(a=QR(a));const y=x.safeValue(a);if(e=e.replace(s[0],y),f?(x.regex.lastIndex+=a.length,x.regex.lastIndex-=s[0].length):x.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,t,r={}){let n,s,a;const o=(l,c)=>{const h=this.nestingOptionsSeparator;if(l.indexOf(h)<0)return l;const f=l.split(new RegExp(`${h}[ ]*{`));let m=`{${f[1]}`;l=f[0],m=this.interpolate(m,a);const p=m.match(/'/g),x=m.match(/"/g);(((p==null?void 0:p.length)??0)%2===0&&!x||x.length%2!==0)&&(m=m.replace(/'/g,'"'));try{a=JSON.parse(m),c&&(a={...c,...a})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,g),`${l}${h}${m}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,l};for(;n=this.nestingRegexp.exec(e);){let l=[];a={...r},a=a.replace&&!qt(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;const c=/{.*}/.test(n[1])?n[1].lastIndexOf("}")+1:n[1].indexOf(this.formatSeparator);if(c!==-1&&(l=n[1].slice(c).split(this.formatSeparator).map(h=>h.trim()).filter(Boolean),n[1]=n[1].slice(0,c)),s=t(o.call(this,n[1].trim(),a),a),s&&n[0]===e&&!qt(s))return s;qt(s)||(s=QR(s)),s||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${e}`),s=""),l.length&&(s=l.reduce((h,f)=>this.format(h,f,r.lng,{...r,interpolationkey:n[1].trim()}),s.trim())),e=e.replace(n[0],s),this.regexp.lastIndex=0}return e}}const IH=i=>{let e=i.toLowerCase().trim();const t={};if(i.indexOf("(")>-1){const r=i.split("(");e=r[0].toLowerCase().trim();const n=r[1].substring(0,r[1].length-1);e==="currency"&&n.indexOf(":")<0?t.currency||(t.currency=n.trim()):e==="relativetime"&&n.indexOf(":")<0?t.range||(t.range=n.trim()):n.split(";").forEach(a=>{if(a){const[o,...l]=a.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),h=o.trim();t[h]||(t[h]=c),c==="false"&&(t[h]=!1),c==="true"&&(t[h]=!0),isNaN(c)||(t[h]=parseInt(c,10))}})}return{formatName:e,formatOptions:t}},uN=i=>{const e={};return(t,r,n)=>{let s=n;n&&n.interpolationkey&&n.formatParams&&n.formatParams[n.interpolationkey]&&n[n.interpolationkey]&&(s={...s,[n.interpolationkey]:void 0});const a=r+JSON.stringify(s);let o=e[a];return o||(o=i(Cg(r),n),e[a]=o),o(t)}},FH=i=>(e,t,r)=>i(Cg(t),r)(e);class MH{constructor(e={}){this.logger=To.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const r=t.cacheInBuiltFormats?uN:FH;this.formats={number:r((n,s)=>{const a=new Intl.NumberFormat(n,{...s});return o=>a.format(o)}),currency:r((n,s)=>{const a=new Intl.NumberFormat(n,{...s,style:"currency"});return o=>a.format(o)}),datetime:r((n,s)=>{const a=new Intl.DateTimeFormat(n,{...s});return o=>a.format(o)}),relativetime:r((n,s)=>{const a=new Intl.RelativeTimeFormat(n,{...s});return o=>a.format(o,s.range||"day")}),list:r((n,s)=>{const a=new Intl.ListFormat(n,{...s});return o=>a.format(o)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=uN(t)}format(e,t,r,n={}){const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(o=>o.indexOf(")")>-1)){const o=s.findIndex(l=>l.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,o)].join(this.formatSeparator)}return s.reduce((o,l)=>{var f;const{formatName:c,formatOptions:h}=IH(l);if(this.formats[c]){let m=o;try{const p=((f=n==null?void 0:n.formatParams)==null?void 0:f[n.interpolationkey])||{},x=p.locale||p.lng||n.locale||n.lng||r;m=this.formats[c](o,x,{...h,...n,...p})}catch(p){this.logger.warn(p)}return m}else this.logger.warn(`there was no format function for ${c}`);return o},e)}}const jH=(i,e)=>{i.pending[e]!==void 0&&(delete i.pending[e],i.pendingCount--)};class BH extends Xw{constructor(e,t,r,n={}){var s,a;super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=n,this.logger=To.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],(a=(s=this.backend)==null?void 0:s.init)==null||a.call(s,r,n.backend,n)}queueLoad(e,t,r,n){const s={},a={},o={},l={};return e.forEach(c=>{let h=!0;t.forEach(f=>{const m=`${c}|${f}`;!r.reload&&this.store.hasResourceBundle(c,f)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?a[m]===void 0&&(a[m]=!0):(this.state[m]=1,h=!1,a[m]===void 0&&(a[m]=!0),s[m]===void 0&&(s[m]=!0),l[f]===void 0&&(l[f]=!0)))}),h||(o[c]=!0)}),(Object.keys(s).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(s),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(l)}}loaded(e,t,r){const n=e.split("|"),s=n[0],a=n[1];t&&this.emit("failedLoading",s,a,t),!t&&r&&this.store.addResourceBundle(s,a,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const o={};this.queue.forEach(l=>{SH(l.loaded,[s],a),jH(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{o[c]||(o[c]={});const h=l.loaded[c];h.length&&h.forEach(f=>{o[c][f]===void 0&&(o[c][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(l=>!l.done)}read(e,t,r,n=0,s=this.retryTimeout,a){if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:n,wait:s,callback:a});return}this.readingCalls++;const o=(c,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(c&&h&&n<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,n+1,s*2,a)},s);return}a(c,h)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const c=l(e,t);c&&typeof c.then=="function"?c.then(h=>o(null,h)).catch(o):o(null,c)}catch(c){o(c)}return}return l(e,t,o)}prepareLoading(e,t,r={},n){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();qt(e)&&(e=this.languageUtils.toResolveHierarchy(e)),qt(t)&&(t=[t]);const s=this.queueLoad(e,t,r,n);if(!s.toLoad.length)return s.pending.length||n(),null;s.toLoad.forEach(a=>{this.loadOne(a)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e,t=""){const r=e.split("|"),n=r[0],s=r[1];this.read(n,s,"read",void 0,void 0,(a,o)=>{a&&this.logger.warn(`${t}loading namespace ${s} for language ${n} failed`,a),!a&&o&&this.logger.log(`${t}loaded namespace ${s} for language ${n}`,o),this.loaded(e,a,o)})}saveMissing(e,t,r,n,s,a={},o=()=>{}){var l,c,h,f,m;if((c=(l=this.services)==null?void 0:l.utils)!=null&&c.hasLoadedNamespace&&!((f=(h=this.services)==null?void 0:h.utils)!=null&&f.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if((m=this.backend)!=null&&m.create){const p={...a,isUpdate:s},x=this.backend.create.bind(this.backend);if(x.length<6)try{let g;x.length===5?g=x(e,t,r,n,p):g=x(e,t,r,n),g&&typeof g.then=="function"?g.then(y=>o(null,y)).catch(o):o(null,g)}catch(g){o(g)}else x(e,t,r,n,o,p)}!e||!e[0]||this.store.addResource(e[0],t,r,n)}}}const cN=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:i=>{let e={};if(typeof i[1]=="object"&&(e=i[1]),qt(i[1])&&(e.defaultValue=i[1]),qt(i[2])&&(e.tDescription=i[2]),typeof i[2]=="object"||typeof i[3]=="object"){const t=i[3]||i[2];Object.keys(t).forEach(r=>{e[r]=t[r]})}return e},interpolation:{escapeValue:!0,format:i=>i,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),dN=i=>{var e,t;return qt(i.ns)&&(i.ns=[i.ns]),qt(i.fallbackLng)&&(i.fallbackLng=[i.fallbackLng]),qt(i.fallbackNS)&&(i.fallbackNS=[i.fallbackNS]),((t=(e=i.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(i.supportedLngs=i.supportedLngs.concat(["cimode"])),typeof i.initImmediate=="boolean"&&(i.initAsync=i.initImmediate),i},Vy=()=>{},zH=i=>{Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(t=>{typeof i[t]=="function"&&(i[t]=i[t].bind(i))})};class kg extends Xw{constructor(e={},t){if(super(),this.options=dN(e),this.services={},this.logger=To,this.modules={external:[]},zH(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(qt(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=cN();this.options={...r,...this.options,...dN(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const n=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?To.init(n(this.modules.logger),this.options):To.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=MH;const h=new sN(this.options);this.store=new rN(this.options.resources,this.options);const f=this.services;f.logger=To,f.resourceStore=this.store,f.languageUtils=h,f.pluralResolver=new PH(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.warn("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),c&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(f.formatter=n(c),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new OH(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new BH(n(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(p,...x)=>{this.emit(p,...x)}),this.modules.languageDetector&&(f.languageDetector=n(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=n(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Qb(this.services,this.options),this.translator.on("*",(p,...x)=>{this.emit(p,...x)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,t||(t=Vy),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=(...h)=>this.store[c](...h)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=(...h)=>(this.store[c](...h),this)});const o=jm(),l=()=>{const c=(h,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(f),t(h,f)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),o}loadResources(e,t=Vy){var s,a;let r=t;const n=qt(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if((n==null?void 0:n.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const o=[],l=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(f=>{f!=="cimode"&&o.indexOf(f)<0&&o.push(f)})};n?l(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(h=>l(h)),(a=(s=this.options.preload)==null?void 0:s.forEach)==null||a.call(s,c=>l(c)),this.services.backendConnector.load(o,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(c)})}else r(null)}reloadResources(e,t,r){const n=jm();return typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=Vy),this.services.backendConnector.reload(e,t,s=>{n.resolve(),r(s)}),n}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&p3.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const r=jm();this.emit("languageChanging",e);const n=o=>{this.language=o,this.languages=this.services.languageUtils.toResolveHierarchy(o),this.resolvedLanguage=void 0,this.setResolvedLanguage(o)},s=(o,l)=>{l?this.isLanguageChangingTo===e&&(n(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,r.resolve((...c)=>this.t(...c)),t&&t(o,(...c)=>this.t(...c))},a=o=>{var h,f;!e&&!o&&this.services.languageDetector&&(o=[]);const l=qt(o)?o:o&&o[0],c=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(qt(o)?[o]:o);c&&(this.language||n(c),this.translator.language||this.translator.changeLanguage(c),(f=(h=this.services.languageDetector)==null?void 0:h.cacheUserLanguage)==null||f.call(h,c)),this.loadResources(c,m=>{s(m,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),r}getFixedT(e,t,r){const n=(s,a,...o)=>{let l;typeof a!="object"?l=this.options.overloadTranslationOptionHandler([s,a].concat(o)):l={...a},l.lng=l.lng||n.lng,l.lngs=l.lngs||n.lngs,l.ns=l.ns||n.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||n.keyPrefix);const c=this.options.keySeparator||".";let h;return l.keyPrefix&&Array.isArray(s)?h=s.map(f=>`${l.keyPrefix}${c}${f}`):h=l.keyPrefix?`${l.keyPrefix}${c}${s}`:s,this.t(h,l)};return qt(e)?n.lng=e:n.lngs=e,n.ns=t,n.keyPrefix=r,n}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],n=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const a=(o,l)=>{const c=this.services.backendConnector.state[`${o}|${l}`];return c===-1||c===0||c===2};if(t.precheck){const o=t.precheck(this,a);if(o!==void 0)return o}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(r,e)&&(!n||a(s,e)))}loadNamespaces(e,t){const r=jm();return this.options.ns?(qt(e)&&(e=[e]),e.forEach(n=>{this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}),this.loadResources(n=>{r.resolve(),t&&t(n)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=jm();qt(e)&&(e=[e]);const n=this.options.preload||[],s=e.filter(a=>n.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return s.length?(this.options.preload=n.concat(s),this.loadResources(a=>{r.resolve(),t&&t(a)}),r):(t&&t(),Promise.resolve())}dir(e){var n,s;if(e||(e=this.resolvedLanguage||(((n=this.languages)==null?void 0:n.length)>0?this.languages[0]:this.language)),!e)return"rtl";if(Intl.Locale){const a=new Intl.Locale(e);if(a&&a.getTextInfo){const o=a.getTextInfo();if(o&&o.direction)return o.direction}}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=((s=this.services)==null?void 0:s.languageUtils)||new sN(cN());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new kg(e,t)}cloneInstance(e={},t=Vy){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const n={...this.options,...e,isClone:!0},s=new kg(n);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(o=>{s[o]=this[o]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},r){const o=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},l[c]=Object.keys(l[c]).reduce((h,f)=>(h[f]={...l[c][f]},h),l[c]),l),{});s.store=new rN(o,n),s.services.resourceStore=s.store}return s.translator=new Qb(s.services,n),s.translator.on("*",(o,...l)=>{s.emit(o,...l)}),s.init(n,t),s.translator.options=n,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Oi=kg.createInstance();Oi.createInstance=kg.createInstance;Oi.createInstance;Oi.dir;Oi.init;Oi.loadResources;Oi.reloadResources;Oi.use;Oi.changeLanguage;Oi.getFixedT;Oi.t;Oi.exists;Oi.setDefaultNamespace;Oi.hasLoadedNamespace;Oi.loadNamespaces;Oi.loadLanguages;const $H={yes:"Yes",no:"No",goBack:"Go Back",import:"Import",read:"Read",connectToServer:"Connect to Server",returnToLibraries:"Return to libraries",manga:"Manga / Comic",book:"Book",loading:"Loading...",addedToQueue:"Added to queue...",importSeriesConfirmation:"Are you sure you want to import this series?",error:"An error occurred. Please try again.",connecting:"Connecting...",serverUrl:"Enter server URL...",readNow:"Read now",makeAvailableOffline:"Add to local library",makeUnavailableOffline:"Remove from local library",editMetadata:"Edit metadata",returnToLibrary:"Return to library",addToCollection:"Add to collection",removeFromCollection:"Remove from collection",searchForMetadata:"Search for metadata",saveChanges:"Save changes",returnToBook:"Return to book",returnToManga:"Return to manga",collection:"Collection",selectCollection:"Select a collection...",addToCollectionSuccess:"Added to collection successfully.",addToCollectionError:"Failed to add to collection.",deleteCollection:"Delete collection",searchJikanMetadata:"Search MyAnimeList",manageTags:"Manage tags",addTag:"Add tag",tag:"Tag",addTagSuccess:"Tag added successfully.",addTagError:"Failed to add tag.",deleteTagError:"Failed to delete tag.",sendToKindle:"Send to Kindle",sendToKindleSuccess:"Email sent successfully.",sendToKindleError:"Failed to send email.",kindleEmail:"Kindle email",kindleDescription:"You must add kindle@devourer.app to your approved Kindle email list."},UH={error:"Failed to connect to server. Please check your server URL and try again."},HH={deleteCollection:"Delete collection",collectionDeleted:"Collection deleted.",collectionDeleteError:"Failed to delete collection.",deleteCollectionConfirmation:"Are you sure you want to delete this collection?"},WH={local:"Local libraries",remote:"Remote libraries",pleaseConnect:"Please connect to a remote server in order to enable remote libraries.",createRemoteLibrary:"Create remote library",editRemoteLibrary:"Edit remote library",name:"Name",path:"Path",type:"Type",metadataProvider:"Metadata provider",metadataApiKey:"Metadata API key",createLibrary:"Create library",importFromCalibre:"Import from Calibre",calibreAreYouSure:"Are you sure you want to import this Calibre library?",formFields:"Please fill in all fields.",importFromCalibreDescription:"When importing from Calibre, the path to the library is the path to your existing Calibre library.",editLibrary:"Edit library",deleteLibrary:"Delete library",openLocalFile:"Open local file",createErrorName:"Please enter a library name.",createErrorPath:"Please enter a path to the library.",general:"Libraries",viewOfflineBooks:"View offline books",viewOfflineManga:"View offline manga & comics",editPathInfo:"Only edit this path if you have moved or renamed the folder, as it relies on the existing structure."},VH={scan:"Scan library",scanInProgress:"Scan in progress...",collections:"Collections",createCollection:"Create collection",collectionValidation:"Please enter a collection title.",noCollections:"No collections found in this library.",files:"Files",noFiles:"No files found in this library.",tableHeaders:{title:"Title",authors:"Authors",genres:"Genres",publishers:"Publishers",publishDate:"Publish Date"},viewMode:{grid:"Grid",table:"Table"}},GH={readMore:"Read more",readLess:"Read less",makeAvailableOffline:"Make available offline",makeUnavailableOffline:"Make unavailable offline",editMetadata:"Edit metadata",authors:"Authors",genres:"Genres",subjects:"Subjects",downloadBook:"Download book",markAsRead:"Mark as read",markAsUnread:"Mark as unread",markedAsRead:"Marked as read",read:"Read",unread:"Unread",markedAsUnread:"Marked as unread",metadataSaved:"Metadata successfully updated.",themes:"Themes",removeFromLocalConfirmation:"Are you sure you want to remove this series from local storage?",removeFileFromLocalConfirmation:"Are you sure you want to remove this file from local storage?",addToLocalConfirmation:"Are you sure you want to add this file to local storage?",publishedFrom:"Published from",publishedTo:"Published to",volumes:"Total volumes",chapters:"Total chapters",readNow:"Read now"},qH={title:"Log in required",description:"This server requires your username and password to access.",username:"Username",password:"Password",passwordConfirm:"Confirm password",createErrorUsername:"Please enter a username",createErrorPasswordLength:"Password must be at least 8 characters long",createErrorPasswordConfirm:"Passwords do not match",login:"Log in"},YH={title:"Users",createUser:"Create user",editUser:"Edit user",editUserDescription:"Leave password empty to keep the current password.",loggedInAs:"Logged in as:",username:"Username",role:"Role",collections:"Collections",delete:"Delete",edit:"Edit"},XH={readNow:"Read now",publisher:"Publisher",published:"Published",pages:"Pages",description:"Description",authors:"Authors",genres:"Genres",subjects:"Subjects",isbn:"ISBN",bookNotFound:"Book not found.",errorLoadingBook:"Error loading book."},KH={jumpTo:"Jump to:",page:"Page",of:"of"},ZH={oauthValidity:"Validating token...",read:"Read",retrievingFile:"Retrieving file...",retrievingFiles:"Retrieving files..."},QH={bookSettings:{title:"Book settings",defaultTheme:"Default theme",customBackground:"Custom background",customForeground:"Custom text color",fontSize:"Font size",fontFamily:"Font family"},mangaSettings:{title:"Manga & comics settings",readingDirection:"Reading direction",pageFitMode:"Page fit mode",viewMode:"View mode",single:"Single",double:"Double",contain:"Contain",actual:"Actual"},opdsSettings:{title:"OPDS settings",savedOpdsUrl:"Saved OPDS URL",booksPerPage:"Books per page"}},JH={home:"Home",libraries:"Libraries",settings:"Settings"},eW={librariesRefreshed:"Libraries refreshed."},tW={common:$H,server:UH,collection:HH,libraries:WH,library:VH,series:GH,login:qH,users:YH,book:XH,read:KH,providers:ZH,settings:QH,tabBar:JH,toast:eW},rW={"en-GB":{translation:tW}};Oi.use(VF).init({lng:"en-GB",fallbackLng:"en-GB",debug:!0,interpolation:{escapeValue:!1},resources:rW});function nW(){Br(),T.useEffect(()=>{},[])}function iW(){return nW(),null}function sW(){const i=NF(e=>e.addLog);return T.useEffect(()=>{const e={log:console.log,error:console.error,warn:console.warn,info:console.info,debug:console.debug},t=(r,n)=>(...s)=>{e[r](...s);try{const a={level:n,timestamp:new Date().toISOString(),message:s.map(o=>typeof o=="object"?JSON.stringify(o):String(o)).join(" "),args:s};n==="error"&&i(a)}catch(a){e.error("Console interceptor error:",a)}};return console.log=t("log","log"),console.error=t("error","error"),console.warn=t("warn","warn"),console.info=t("info","info"),console.debug=t("debug","debug"),()=>{console.log=e.log,console.error=e.error,console.warn=e.warn,console.info=e.info,console.debug=e.debug}},[]),T.useEffect(()=>{},[]),E.jsxs(LI,{basename:"/client",children:[E.jsxs(oI,{children:[E.jsx(Bn,{path:"/",element:E.jsx(n8,{})}),E.jsx(Bn,{path:"/opds",element:E.jsx(l8,{})}),E.jsx(Bn,{path:"/libraries",element:E.jsx(s6,{})}),E.jsx(Bn,{path:"/libraries-opds",element:E.jsx(o6,{})}),E.jsx(Bn,{path:"/library/:id",element:E.jsx(L6,{})}),E.jsx(Bn,{path:"/library-opds",element:E.jsx(O6,{})}),E.jsx(Bn,{path:"/book/:id",element:E.jsx($6,{})}),E.jsx(Bn,{path:"/book/:id/metadata",element:E.jsx(H6,{})}),E.jsx(Bn,{path:"/book/:id/read",element:E.jsx(s9,{})}),E.jsx(Bn,{path:"/manga/:id",element:E.jsx(p9,{})}),E.jsx(Bn,{path:"/manga/:id/metadata",element:E.jsx(b9,{})}),E.jsx(Bn,{path:"/manga/:id/read",element:E.jsx(WU,{})}),E.jsx(Bn,{path:"/manga/read-bounce",element:E.jsx(VU,{})}),E.jsx(Bn,{path:"/collection/:id",element:E.jsx(qU,{})}),E.jsx(Bn,{path:"/settings/client",element:E.jsx(pH,{})}),E.jsx(Bn,{path:"/providers/google",element:E.jsx(gH,{})}),E.jsx(Bn,{path:"/oauth-google",element:E.jsx(vH,{})}),E.jsx(Bn,{path:"/users",element:E.jsx(wH,{})})]}),E.jsx(iW,{}),E.jsx(xH,{}),E.jsx(_F,{})]})}gO.createRoot(document.getElementById("root")).render(E.jsx(st.StrictMode,{children:E.jsx(sW,{})}));{const i=document.querySelector(".titlebar");i&&(i.style.display="none"),document.body.style.position="relative",document.body.style.height="100vh",document.addEventListener("touchmove",function(e){(e.target===document.body||e.target===document.documentElement)&&e.preventDefault()},{passive:!1})}
